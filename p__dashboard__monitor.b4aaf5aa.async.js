(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"+K+b":function(Re,y,o){var S=o("JHRd");function v(X){var B=new X.constructor(X.byteLength);return new S(B).set(new S(X)),B}Re.exports=v},"+Qka":function(Re,y,o){var S=o("fmRc"),v=o("t2Dn"),X=o("cq/+"),B=o("T1AV"),a=o("GoyQ"),W=o("mTTR"),D=o("itsj");function J(te,ce,Y,ke,Ke){te!==ce&&X(ce,function(We,Oe){if(Ke||(Ke=new S),a(We))B(te,ce,Oe,Y,J,ke,Ke);else{var st=ke?ke(D(te,Oe),We,Oe+"",te,ce,Ke):void 0;st===void 0&&(st=We),v(te,Oe,st)}},W)}Re.exports=J},"+VLl":function(Re,y,o){"use strict";o.d(y,"a",function(){return We});var S=o("lSNA"),v=o.n(S),X=o("J4zp"),B=o.n(X),a=o("Hel2"),W=Math.PI/3,D=[0,W,2*W,3*W,4*W,5*W];function J(Oe){return Oe[0]}function te(Oe){return Oe[1]}var ce=function(){var Oe=0,st=0,Le=1,xt=1,it=J,$e=te,Ze,St,bt;function Ne(Ue){var lt={},Me=[],ct,Gt=Ue.length;for(ct=0;ct<Gt;++ct)if(!(isNaN(ar=+it.call(null,$t=Ue[ct],ct,Ue))||isNaN(oe=+$e.call(null,$t,ct,Ue)))){var $t,ar,oe,Q=Math.round(oe=oe/bt),G=Math.round(ar=ar/St-(Q&1)/2),Ce=oe-Q;if(Math.abs(Ce)*3>1){var be=ar-G,Te=G+(ar<G?-1:1)/2,me=Q+(oe<Q?-1:1),rt=ar-Te,Kt=oe-me;be*be+Ce*Ce>rt*rt+Kt*Kt&&(G=Te+(Q&1?1:-1)/2,Q=me)}var _t=G+"-"+Q,ge=lt[_t];ge?ge.push($t):(Me.push(ge=lt[_t]=[$t]),ge.x=(G+(Q&1)/2)*St,ge.y=Q*bt)}return Me}function ze(Ue){var lt=0,Me=0;return D.map(function(ct){var Gt=Math.sin(ct)*Ue,$t=-Math.cos(ct)*Ue,ar=Gt-lt,oe=$t-Me;return lt=Gt,Me=$t,[ar,oe]})}return Ne.hexagon=function(Ue){return"m"+ze(Ue==null?Ze:+Ue).join("l")+"z"},Ne.centers=function(){for(var Ue=[],lt=Math.round(st/bt),Me=Math.round(Oe/St),ct=lt*bt;ct<xt+Ze;ct+=bt,++lt)for(var Gt=Me*St+(lt&1)*St/2;Gt<Le+St/2;Gt+=St)Ue.push([Gt,ct]);return Ue},Ne.mesh=function(){var Ue=ze(Ze).slice(0,4).join("l");return Ne.centers().map(function(lt){return"M"+lt+"m"+Ue}).join("")},Ne.x=function(Ue){return arguments.length?(it=Ue,Ne):it},Ne.y=function(Ue){return arguments.length?($e=Ue,Ne):$e},Ne.radius=function(Ue){return arguments.length?(Ze=+Ue,St=Ze*2*Math.sin(W),bt=Ze*1.5,Ne):Ze},Ne.size=function(Ue){return arguments.length?(Oe=st=0,Le=+Ue[0],xt=+Ue[1],Ne):[Le-Oe,xt-st]},Ne.extent=function(Ue){return arguments.length?(Oe=+Ue[0][0],st=+Ue[0][1],Le=+Ue[1][0],xt=+Ue[1][1],Ne):[[Oe,st],[Le,xt]]},Ne.radius(1)};function Y(Oe,st){var Le=Object.keys(Oe);if(Object.getOwnPropertySymbols){var xt=Object.getOwnPropertySymbols(Oe);st&&(xt=xt.filter(function(it){return Object.getOwnPropertyDescriptor(Oe,it).enumerable})),Le.push.apply(Le,xt)}return Le}function ke(Oe){for(var st=1;st<arguments.length;st++){var Le=arguments[st]!=null?arguments[st]:{};st%2?Y(Object(Le),!0).forEach(function(xt){v()(Oe,xt,Le[xt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Oe,Object.getOwnPropertyDescriptors(Le)):Y(Object(Le)).forEach(function(xt){Object.defineProperty(Oe,xt,Object.getOwnPropertyDescriptor(Le,xt))})}return Oe}var Ke=6378e3;function We(Oe,st){var Le=Oe.dataArray,xt=st.size,it=xt===void 0?10:xt,$e=st.method,Ze=$e===void 0?"sum":$e,St=it/(2*Math.PI*Ke)*(256<<20)/2,bt=Le.map(function(lt){var Me=Object(a.d)(lt.coordinates),ct=B()(Me,2),Gt=ct[0],$t=ct[1];return ke(ke({},lt),{},{coordinates:[Gt,$t]})}),Ne=ce().radius(St).x(function(lt){return lt.coordinates[0]}).y(function(lt){return lt.coordinates[1]}),ze=Ne(bt),Ue={dataArray:ze.map(function(lt,Me){var ct;if(st.field&&Ze){var Gt=a.c.getColumn(lt,st.field);lt[Ze]=a.c.statMap[Ze](Gt)}return ct={},v()(ct,st.method,lt[Ze]),v()(ct,"count",lt.length),v()(ct,"rawData",lt),v()(ct,"coordinates",[lt.x,lt.y]),v()(ct,"_id",Me),ct}),radius:St,xOffset:St,yOffset:St,type:"hexagon"};return Ue}},"+em5":function(Re,y,o){"use strict";o.d(y,"a",function(){return oe});var S=o("lSNA"),v=o.n(S),X=o("yG8O"),B=o.n(X),a=o("lwsE"),W=o.n(a),D=o("W8MJ"),J=o.n(D),te=o("U+yc"),ce=o.n(te),Y=o("1ABj"),ke=o.n(Y),Ke=o("gQMU"),We=o.n(Ke),Oe=o("J2iB"),st=o.n(Oe),Le=o("u6S6"),xt=o.n(Le),it=o("4cb6"),$e=o.n(it),Ze=o("h1nZ"),St=o("bB6j"),bt=o("bPkA"),Ne,ze,Ue,lt,Me,ct;function Gt(Q,G){var Ce=Object.keys(Q);if(Object.getOwnPropertySymbols){var be=Object.getOwnPropertySymbols(Q);G&&(be=be.filter(function(Te){return Object.getOwnPropertyDescriptor(Q,Te).enumerable})),Ce.push.apply(Ce,be)}return Ce}function $t(Q){for(var G=1;G<arguments.length;G++){var Ce=arguments[G]!=null?arguments[G]:{};G%2?Gt(Object(Ce),!0).forEach(function(be){v()(Q,be,Ce[be])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Q,Object.getOwnPropertyDescriptors(Ce)):Gt(Object(Ce)).forEach(function(be){Object.defineProperty(Q,be,Object.getOwnPropertyDescriptor(Ce,be))})}return Q}var ar=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,oe=(Ne=Object(it.injectable)(),ze=Object(it.inject)(St.a.IShaderModuleService),Ne(Ue=(lt=(ct=function(){function Q(){W()(this,Q),B()(this,"shaderModuleService",Me,this),this.rendererService=void 0,this.config=void 0,this.quad=ar,this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return J()(Q,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(Ce){this.name=Ce}},{key:"getType",value:function(){return bt.a.PostProcessing}},{key:"init",value:function(Ce,be){this.config=be,this.rendererService=Ce.getContainer().get(St.a.IRendererService);var Te=this.rendererService,me=Te.createAttribute,rt=Te.createBuffer,Kt=Te.createModel,_t=this.setupShaders(),ge=_t.vs,ye=_t.fs,Ve=_t.uniforms;this.model=Kt({vs:ge,fs:ye,attributes:{a_Position:me({buffer:rt({data:[-4,-4,4,-4,0,4],type:Ze.gl.FLOAT}),size:2})},uniforms:$t($t({u_Texture:null},Ve),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(Ce){var be=this,Te=Ce.multiPassRenderer.getPostProcessor(),me=this.rendererService,rt=me.useFramebuffer,Kt=me.getViewportSize,_t=me.clear,ge=Kt(),ye=ge.width,Ve=ge.height;rt(this.renderToScreen?null:Te.getWriteFBO(),function(){_t({framebuffer:Te.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),be.model.draw({uniforms:$t({u_Texture:Te.getReadFBO(),u_ViewportSize:[ye,Ve]},be.convertOptionsToUniforms(be.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(Ce){this.enabled=Ce}},{key:"setRenderToScreen",value:function(Ce){this.renderToScreen=Ce}},{key:"updateOptions",value:function(Ce){this.optionsToUpdate=$t($t({},this.optionsToUpdate),Ce)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(Ce){var be={};return Object.keys(Ce).forEach(function(Te){st()(Ce[Te])||(be["u_".concat(We()(xt()(Te)))]=Ce[Te])}),be}}]),Q}(),ct),Me=ce()(lt.prototype,"shaderModuleService",[ze],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lt))||Ue)},"+iFO":function(Re,y,o){var S=o("dTAl"),v=o("LcsW"),X=o("6sVZ");function B(a){return typeof a.constructor=="function"&&!X(a)?S(v(a)):{}}Re.exports=B},"/33/":function(Re,y){},"/Uc5":function(Re,y){},"/ezw":function(Re,y,o){"use strict";var S=o("lSNA"),v=o.n(S),X=o("pVnL"),B=o.n(X),a=o("cDf5"),W=o.n(a),D=o("q1tI"),J=o("TSYQ"),te=o.n(J),ce=function(be){var Te=be.prefixCls,me=be.className,rt=be.width,Kt=be.style;return D.createElement("h3",{className:te()(Te,me),style:B()({width:rt},Kt)})},Y=ce,ke=o("RIqP"),Ke=o.n(ke),We=function(be){var Te=function(Ve){var ft=be.width,Ie=be.rows,pt=Ie===void 0?2:Ie;if(Array.isArray(ft))return ft[Ve];if(pt-1===Ve)return ft},me=be.prefixCls,rt=be.className,Kt=be.style,_t=be.rows,ge=Ke()(Array(_t)).map(function(ye,Ve){return D.createElement("li",{key:Ve,style:{width:Te(Ve)}})});return D.createElement("ul",{className:te()(me,rt),style:Kt},ge)},Oe=We,st=o("H84U"),Le=function(be){var Te,me,rt=be.prefixCls,Kt=be.className,_t=be.style,ge=be.size,ye=be.shape,Ve=te()((Te={},v()(Te,"".concat(rt,"-lg"),ge==="large"),v()(Te,"".concat(rt,"-sm"),ge==="small"),Te)),ft=te()((me={},v()(me,"".concat(rt,"-circle"),ye==="circle"),v()(me,"".concat(rt,"-square"),ye==="square"),v()(me,"".concat(rt,"-round"),ye==="round"),me)),Ie=typeof ge=="number"?{width:ge,height:ge,lineHeight:"".concat(ge,"px")}:{};return D.createElement("span",{className:te()(rt,Ve,ft,Kt),style:B()(B()({},Ie),_t)})},xt=Le,it=o("BGR+"),$e=function(be){var Te=function(rt){var Kt=rt.getPrefixCls,_t=be.prefixCls,ge=be.className,ye=be.active,Ve=Kt("skeleton",_t),ft=Object(it.a)(be,["prefixCls"]),Ie=te()(Ve,"".concat(Ve,"-element"),v()({},"".concat(Ve,"-active"),ye),ge);return D.createElement("div",{className:Ie},D.createElement(xt,B()({prefixCls:"".concat(Ve,"-avatar")},ft)))};return D.createElement(st.a,null,Te)};$e.defaultProps={size:"default",shape:"circle"};var Ze=$e,St=function(be){var Te=function(rt){var Kt=rt.getPrefixCls,_t=be.prefixCls,ge=be.className,ye=be.active,Ve=Kt("skeleton",_t),ft=Object(it.a)(be,["prefixCls"]),Ie=te()(Ve,"".concat(Ve,"-element"),v()({},"".concat(Ve,"-active"),ye),ge);return D.createElement("div",{className:Ie},D.createElement(xt,B()({prefixCls:"".concat(Ve,"-button")},ft)))};return D.createElement(st.a,null,Te)};St.defaultProps={size:"default"};var bt=St,Ne=function(be){var Te=function(rt){var Kt=rt.getPrefixCls,_t=be.prefixCls,ge=be.className,ye=be.active,Ve=Kt("skeleton",_t),ft=Object(it.a)(be,["prefixCls"]),Ie=te()(Ve,"".concat(Ve,"-element"),v()({},"".concat(Ve,"-active"),ye),ge);return D.createElement("div",{className:Ie},D.createElement(xt,B()({prefixCls:"".concat(Ve,"-input")},ft)))};return D.createElement(st.a,null,Te)};Ne.defaultProps={size:"default"};var ze=Ne,Ue="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",lt=function(be){var Te=function(rt){var Kt=rt.getPrefixCls,_t=be.prefixCls,ge=be.className,ye=be.style,Ve=Kt("skeleton",_t),ft=te()(Ve,"".concat(Ve,"-element"),ge);return D.createElement("div",{className:ft},D.createElement("div",{className:te()("".concat(Ve,"-image"),ge),style:ye},D.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(Ve,"-image-svg")},D.createElement("path",{d:Ue,className:"".concat(Ve,"-image-path")}))))};return D.createElement(st.a,null,Te)},Me=lt;function ct(Ce){return Ce&&W()(Ce)==="object"?Ce:{}}function Gt(Ce,be){return Ce&&!be?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function $t(Ce,be){return!Ce&&be?{width:"38%"}:Ce&&be?{width:"50%"}:{}}function ar(Ce,be){var Te={};return(!Ce||!be)&&(Te.width="61%"),!Ce&&be?Te.rows=3:Te.rows=2,Te}var oe=function(be){var Te=function(rt){var Kt=rt.getPrefixCls,_t=rt.direction,ge=be.prefixCls,ye=be.loading,Ve=be.className,ft=be.children,Ie=be.avatar,pt=be.title,C=be.paragraph,R=be.active,q=be.round,fe=Kt("skeleton",ge);if(ye||!("loading"in be)){var Ge,Je=!!Ie,yt=!!pt,nt=!!C,Nt;if(Je){var $=B()(B()({prefixCls:"".concat(fe,"-avatar")},Gt(yt,nt)),ct(Ie));Nt=D.createElement("div",{className:"".concat(fe,"-header")},D.createElement(xt,$))}var Ye;if(yt||nt){var ie;if(yt){var et=B()(B()({prefixCls:"".concat(fe,"-title")},$t(Je,nt)),ct(pt));ie=D.createElement(Y,et)}var Bt;if(nt){var lr=B()(B()({prefixCls:"".concat(fe,"-paragraph")},ar(Je,yt)),ct(C));Bt=D.createElement(Oe,lr)}Ye=D.createElement("div",{className:"".concat(fe,"-content")},ie,Bt)}var dt=te()(fe,(Ge={},v()(Ge,"".concat(fe,"-with-avatar"),Je),v()(Ge,"".concat(fe,"-active"),R),v()(Ge,"".concat(fe,"-rtl"),_t==="rtl"),v()(Ge,"".concat(fe,"-round"),q),Ge),Ve);return D.createElement("div",{className:dt},Nt,Ye)}return ft};return D.createElement(st.a,null,Te)};oe.defaultProps={avatar:!1,title:!0,paragraph:!0},oe.Button=bt,oe.Avatar=Ze,oe.Input=ze,oe.Image=Me;var Q=oe,G=y.a=Q},"/rf6":function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.earthRadius=63710088e-1,y.factors={centimeters:y.earthRadius*100,centimetres:y.earthRadius*100,degrees:y.earthRadius/111325,feet:y.earthRadius*3.28084,inches:y.earthRadius*39.37,kilometers:y.earthRadius/1e3,kilometres:y.earthRadius/1e3,meters:y.earthRadius,metres:y.earthRadius,miles:y.earthRadius/1609.344,millimeters:y.earthRadius*1e3,millimetres:y.earthRadius*1e3,nauticalmiles:y.earthRadius/1852,radians:1,yards:y.earthRadius/1.0936},y.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/y.earthRadius,yards:1/1.0936},y.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function S(Q,G,Ce){Ce===void 0&&(Ce={});var be={type:"Feature"};return(Ce.id===0||Ce.id)&&(be.id=Ce.id),Ce.bbox&&(be.bbox=Ce.bbox),be.properties=G||{},be.geometry=Q,be}y.feature=S;function v(Q,G,Ce){switch(Ce===void 0&&(Ce={}),Q){case"Point":return X(G).geometry;case"LineString":return D(G).geometry;case"Polygon":return a(G).geometry;case"MultiPoint":return Y(G).geometry;case"MultiLineString":return ce(G).geometry;case"MultiPolygon":return ke(G).geometry;default:throw new Error(Q+" is invalid")}}y.geometry=v;function X(Q,G,Ce){Ce===void 0&&(Ce={});var be={type:"Point",coordinates:Q};return S(be,G,Ce)}y.point=X;function B(Q,G,Ce){return Ce===void 0&&(Ce={}),te(Q.map(function(be){return X(be,G)}),Ce)}y.points=B;function a(Q,G,Ce){Ce===void 0&&(Ce={});for(var be=0,Te=Q;be<Te.length;be++){var me=Te[be];if(me.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var rt=0;rt<me[me.length-1].length;rt++)if(me[me.length-1][rt]!==me[0][rt])throw new Error("First and last Position are not equivalent.")}var Kt={type:"Polygon",coordinates:Q};return S(Kt,G,Ce)}y.polygon=a;function W(Q,G,Ce){return Ce===void 0&&(Ce={}),te(Q.map(function(be){return a(be,G)}),Ce)}y.polygons=W;function D(Q,G,Ce){if(Ce===void 0&&(Ce={}),Q.length<2)throw new Error("coordinates must be an array of two or more positions");var be={type:"LineString",coordinates:Q};return S(be,G,Ce)}y.lineString=D;function J(Q,G,Ce){return Ce===void 0&&(Ce={}),te(Q.map(function(be){return D(be,G)}),Ce)}y.lineStrings=J;function te(Q,G){G===void 0&&(G={});var Ce={type:"FeatureCollection"};return G.id&&(Ce.id=G.id),G.bbox&&(Ce.bbox=G.bbox),Ce.features=Q,Ce}y.featureCollection=te;function ce(Q,G,Ce){Ce===void 0&&(Ce={});var be={type:"MultiLineString",coordinates:Q};return S(be,G,Ce)}y.multiLineString=ce;function Y(Q,G,Ce){Ce===void 0&&(Ce={});var be={type:"MultiPoint",coordinates:Q};return S(be,G,Ce)}y.multiPoint=Y;function ke(Q,G,Ce){Ce===void 0&&(Ce={});var be={type:"MultiPolygon",coordinates:Q};return S(be,G,Ce)}y.multiPolygon=ke;function Ke(Q,G,Ce){Ce===void 0&&(Ce={});var be={type:"GeometryCollection",geometries:Q};return S(be,G,Ce)}y.geometryCollection=Ke;function We(Q,G){if(G===void 0&&(G=0),G&&!(G>=0))throw new Error("precision must be a positive number");var Ce=Math.pow(10,G||0);return Math.round(Q*Ce)/Ce}y.round=We;function Oe(Q,G){G===void 0&&(G="kilometers");var Ce=y.factors[G];if(!Ce)throw new Error(G+" units is invalid");return Q*Ce}y.radiansToLength=Oe;function st(Q,G){G===void 0&&(G="kilometers");var Ce=y.factors[G];if(!Ce)throw new Error(G+" units is invalid");return Q/Ce}y.lengthToRadians=st;function Le(Q,G){return it(st(Q,G))}y.lengthToDegrees=Le;function xt(Q){var G=Q%360;return G<0&&(G+=360),G}y.bearingToAzimuth=xt;function it(Q){var G=Q%(2*Math.PI);return G*180/Math.PI}y.radiansToDegrees=it;function $e(Q){var G=Q%360;return G*Math.PI/180}y.degreesToRadians=$e;function Ze(Q,G,Ce){if(G===void 0&&(G="kilometers"),Ce===void 0&&(Ce="kilometers"),!(Q>=0))throw new Error("length must be a positive number");return Oe(st(Q,G),Ce)}y.convertLength=Ze;function St(Q,G,Ce){if(G===void 0&&(G="meters"),Ce===void 0&&(Ce="kilometers"),!(Q>=0))throw new Error("area must be a positive number");var be=y.areaFactors[G];if(!be)throw new Error("invalid original units");var Te=y.areaFactors[Ce];if(!Te)throw new Error("invalid final units");return Q/be*Te}y.convertArea=St;function bt(Q){return!isNaN(Q)&&Q!==null&&!Array.isArray(Q)&&!/^\s*$/.test(Q)}y.isNumber=bt;function Ne(Q){return!!Q&&Q.constructor===Object}y.isObject=Ne;function ze(Q){if(!Q)throw new Error("bbox is required");if(!Array.isArray(Q))throw new Error("bbox must be an Array");if(Q.length!==4&&Q.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Q.forEach(function(G){if(!bt(G))throw new Error("bbox must only contain numbers")})}y.validateBBox=ze;function Ue(Q){if(!Q)throw new Error("id is required");if(["string","number"].indexOf(typeof Q)===-1)throw new Error("id must be a number or a string")}y.validateId=Ue;function lt(){throw new Error("method has been renamed to `radiansToDegrees`")}y.radians2degrees=lt;function Me(){throw new Error("method has been renamed to `degreesToRadians`")}y.degrees2radians=Me;function ct(){throw new Error("method has been renamed to `lengthToDegrees`")}y.distanceToDegrees=ct;function Gt(){throw new Error("method has been renamed to `lengthToRadians`")}y.distanceToRadians=Gt;function $t(){throw new Error("method has been renamed to `radiansToLength`")}y.radiansToDistance=$t;function ar(){throw new Error("method has been renamed to `bearingToAzimuth`")}y.bearingToAngle=ar;function oe(){throw new Error("method has been renamed to `convertLength`")}y.convertDistance=oe},"0JQy":function(Re,y){var o="\\ud800-\\udfff",S="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",B=S+v+X,a="\\ufe0e\\ufe0f",W="["+o+"]",D="["+B+"]",J="\\ud83c[\\udffb-\\udfff]",te="(?:"+D+"|"+J+")",ce="[^"+o+"]",Y="(?:\\ud83c[\\udde6-\\uddff]){2}",ke="[\\ud800-\\udbff][\\udc00-\\udfff]",Ke="\\u200d",We=te+"?",Oe="["+a+"]?",st="(?:"+Ke+"(?:"+[ce,Y,ke].join("|")+")"+Oe+We+")*",Le=Oe+We+st,xt="(?:"+[ce+D+"?",D,Y,ke,W].join("|")+")",it=RegExp(J+"(?="+J+")|"+xt+Le,"g");function $e(Ze){return Ze.match(it)||[]}Re.exports=$e},"0ZTe":function(Re,y,o){var S=o("wy8a"),v=o("quyA"),X=o("Em2t"),B=o("dt0z");function a(W){return function(D){D=B(D);var J=v(D)?X(D):void 0,te=J?J[0]:D.charAt(0),ce=J?S(J,1).join(""):D.slice(1);return te[W]()+ce}}Re.exports=a},"0eqD":function(Re,y){},"0gSV":function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.tagged=void 0;var S=o("GXnB"),v=o("Ztfv");function X(B,a){return function(W,D,J){var te=new S.Metadata(B,a);typeof J=="number"?v.tagParameter(W,D,J,te):v.tagProperty(W,D,te)}}y.tagged=X},"1+5i":function(Re,y,o){var S=o("w/wX"),v=o("sEf8"),X=o("mdPL"),B=X&&X.isSet,a=B?v(B):S;Re.exports=a},"14J3":function(Re,y,o){"use strict";var S=o("cIOH"),v=o.n(S),X=o("1GLa")},"1ABj":function(Re,y){function o(S,v){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}Re.exports=o},"1XEM":function(Re,y,o){Re.exports={tagCloud:"antd-pro-pages-dashboard-monitor-components-charts-tag-cloud-index-tagCloud"}},"1gqn":function(Re,y){Re.exports=function(S){return S&&typeof S=="object"&&typeof S.copy=="function"&&typeof S.fill=="function"&&typeof S.readUInt8=="function"}},"1jvM":function(Re,y){},2:function(Re,y){},"2ajD":function(Re,y){function o(S){return S!==S}Re.exports=o},"3DfO":function(Re,y){function o(S){return S==null}Re.exports=o},"3L66":function(Re,y,o){var S=o("MMmD"),v=o("ExA7");function X(B){return v(B)&&S(B)}Re.exports=X},"3cYt":function(Re,y){function o(S){return function(v){return S==null?void 0:S[v]}}Re.exports=o},"406g":function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingOnSyntax=void 0;var S=o("z4Hk"),v=function(){function X(B){this._binding=B}return X.prototype.onActivation=function(B){return this._binding.onActivation=B,new S.BindingWhenSyntax(this._binding)},X}();y.BindingOnSyntax=v},"4U9+":function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.default=function(Oe){return(0,v.default)((0,J.default)(Oe)&&Oe.length>=1,"Must merge at least 1 JSON schema."),B.default.apply(void 0,[{}].concat(We(Oe),[function(st,Le,xt){if(!(0,W.default)(st)){if(xt==="required")return(0,ce.default)(st.concat(Le));if((0,ke.default)(st)){if(!(0,ke.default)(Le))throw new Error('Failed to merge schemas because "'+xt+'" has different values.');return}v.default.deepEqual(st,Le,'Failed to merge schemas because "'+xt+'" has different values: '+JSON.stringify(st)+" and "+JSON.stringify(Le)+".")}}]))};var S=o("9lTW"),v=Ke(S),X=o("qd8s"),B=Ke(X),a=o("3DfO"),W=Ke(a),D=o("WFAs"),J=Ke(D),te=o("w26f"),ce=Ke(te),Y=o("zZPE"),ke=Ke(Y);function Ke(Oe){return Oe&&Oe.__esModule?Oe:{default:Oe}}function We(Oe){if(Array.isArray(Oe)){for(var st=0,Le=Array(Oe.length);st<Oe.length;st++)Le[st]=Oe[st];return Le}else return Array.from(Oe)}Re.exports=y.default},"4ZJM":function(Re,y,o){(function(S,v){Re.exports=v()})(this,function(){"use strict";var S,v,X;function B(a,W){if(!S)S=W;else if(!v)v=W;else{var D="var sharedChunk = {}; ("+S+")(sharedChunk); ("+v+")(sharedChunk);",J={};S(J),X=W(J),typeof window!="undefined"&&(X.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}return B(["exports"],function(a){"use strict";function W(e,t){return e(t={exports:{}},t.exports),t.exports}var D=J;function J(e,t,r,l){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=r,this.p2y=l}J.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},J.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},J.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},J.prototype.solveCurveX=function(e,t){var r,l,f,m,A;for(t===void 0&&(t=1e-6),f=e,A=0;A<8;A++){if(m=this.sampleCurveX(f)-e,Math.abs(m)<t)return f;var I=this.sampleCurveDerivativeX(f);if(Math.abs(I)<1e-6)break;f-=m/I}if((f=e)<(r=0))return r;if(f>(l=1))return l;for(;r<l;){if(m=this.sampleCurveX(f),Math.abs(m-e)<t)return f;e>m?r=f:l=f,f=.5*(l-r)+r}return f},J.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var te=ce;function ce(e,t){this.x=e,this.y=t}ce.prototype={clone:function(){return new ce(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,l=t.y-this.y;return r*r+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),l=Math.sin(t),f=l*this.x+r*this.y;return this.x=r*this.x-l*this.y,this.y=f,this},_rotateAround:function(t,r){var l=Math.cos(t),f=Math.sin(t),m=r.y+f*(this.x-r.x)+l*(this.y-r.y);return this.x=r.x+l*(this.x-r.x)-f*(this.y-r.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ce.convert=function(e){return e instanceof ce?e:Array.isArray(e)?new ce(e[0],e[1]):e};var Y=typeof self!="undefined"?self:{},ke=Math.pow(2,53)-1;function Ke(e,t,r,l){var f=new D(e,t,r,l);return function(m){return f.solve(m)}}var We=Ke(.25,.1,.25,1);function Oe(e,t,r){return Math.min(r,Math.max(t,e))}function st(e,t,r){var l=r-t,f=((e-t)%l+l)%l+t;return f===t?r:f}function Le(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var l=0,f=t;l<f.length;l+=1){var m=f[l];for(var A in m)e[A]=m[A]}return e}var xt=1;function it(){return xt++}function $e(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Ze(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function St(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function bt(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Ne(e,t,r){var l={};for(var f in e)l[f]=t.call(r||this,e[f],f,e);return l}function ze(e,t,r){var l={};for(var f in e)t.call(r||this,e[f],f,e)&&(l[f]=e[f]);return l}function Ue(e){return Array.isArray(e)?e.map(Ue):typeof e=="object"&&e?Ne(e,Ue):e}var lt={};function Me(e){lt[e]||(typeof console!="undefined"&&console.warn(e),lt[e]=!0)}function ct(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Gt(e){for(var t=0,r=0,l=e.length,f=l-1,m=void 0,A=void 0;r<l;f=r++)t+=((A=e[f]).x-(m=e[r]).x)*(m.y+A.y);return t}function $t(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function ar(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,f,m,A){var I=m||A;return t[f]=!I||I.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var oe=null;function Q(e){if(oe==null){var t=e.navigator?e.navigator.userAgent:null;oe=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return oe}function G(e){try{var t=Y[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var Ce,be,Te,me,rt=Y.performance&&Y.performance.now?Y.performance.now.bind(Y.performance):Date.now.bind(Date),Kt=Y.requestAnimationFrame||Y.mozRequestAnimationFrame||Y.webkitRequestAnimationFrame||Y.msRequestAnimationFrame,_t=Y.cancelAnimationFrame||Y.mozCancelAnimationFrame||Y.webkitCancelAnimationFrame||Y.msCancelAnimationFrame,ge={now:rt,frame:function(t){var r=Kt(t);return{cancel:function(){return _t(r)}}},getImageData:function(t,r){r===void 0&&(r=0);var l=Y.document.createElement("canvas"),f=l.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return l.width=t.width,l.height=t.height,f.drawImage(t,0,0,t.width,t.height),f.getImageData(-r,-r,t.width+2*r,t.height+2*r)},resolveURL:function(t){return Ce||(Ce=Y.document.createElement("a")),Ce.href=t,Ce.href},hardwareConcurrency:Y.navigator&&Y.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Y.devicePixelRatio},get prefersReducedMotion(){return!!Y.matchMedia&&(be==null&&(be=Y.matchMedia("(prefers-reduced-motion: reduce)")),be.matches)}},ye={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ve={supported:!1,testSupport:function(t){!ft&&me&&(Ie?pt(t):Te=t)}},ft=!1,Ie=!1;function pt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,me),e.isContextLost())return;Ve.supported=!0}catch(r){}e.deleteTexture(t),ft=!0}Y.document&&((me=Y.document.createElement("img")).onload=function(){Te&&pt(Te),Te=null,Ie=!0},me.onerror=function(){ft=!0,Te=null},me.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var C="01",R=function(t,r){this._transformRequestFn=t,this._customAccessToken=r,this._createSkuToken()};function q(e){return e.indexOf("mapbox:")===0}R.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",C,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},R.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},R.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},R.prototype.normalizeStyleURL=function(e,t){if(!q(e))return e;var r=yt(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeGlyphsURL=function(e,t){if(!q(e))return e;var r=yt(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSourceURL=function(e,t){if(!q(e))return e;var r=yt(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSpriteURL=function(e,t,r,l){var f=yt(e);return q(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+r,this._makeAPIURL(f,this._customAccessToken||l)):(f.path+=""+t+r,nt(f))},R.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!q(e))return e;var r=yt(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(ge.devicePixelRatio>=2||t===512?"@2x":"")+(Ve.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var l=this._customAccessToken||function(f){for(var m=0,A=f;m<A.length;m+=1){var I=A[m].match(/^access_token=(.*)$/);if(I)return I[1]}return null}(r.params)||ye.ACCESS_TOKEN;return ye.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,l)},R.prototype.canonicalizeTileURL=function(e,t){var r=yt(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=r.path.replace("/v4/","");var f=r.params;return t&&(f=f.filter(function(m){return!m.match(/^access_token=/)})),f.length&&(l+="?"+f.join("&")),l},R.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&q(t),l=[],f=0,m=e.tiles||[];f<m.length;f+=1){var A=m[f];Ge(A)?l.push(this.canonicalizeTileURL(A,r)):l.push(A)}return l},R.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=yt(ye.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!ye.REQUIRE_ACCESS_TOKEN)return nt(e);if(!(t=t||ye.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(m){return m.indexOf("access_token")===-1}),e.params.push("access_token="+t),nt(e)};var fe=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ge(e){return fe.test(e)}var Je=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function yt(e){var t=e.match(Je);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function nt(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Nt(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(Y.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var $=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};$.prototype.getStorageKey=function(e){var t,r=Nt(ye.ACCESS_TOKEN);return t=r&&r.u?Y.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(l,f){return String.fromCharCode(Number("0x"+f))})):ye.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},$.prototype.fetchEventData=function(){var e=G("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var l=Y.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var f=Y.localStorage.getItem(r);f&&(this.anonId=f)}catch(m){Me("Unable to read from LocalStorage")}},$.prototype.saveEventData=function(){var e=G("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{Y.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&Y.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(l){Me("Unable to write to LocalStorage")}},$.prototype.processRequests=function(e){},$.prototype.postEvent=function(e,t,r,l){var f=this;if(ye.EVENTS_URL){var m=yt(ye.EVENTS_URL);m.params.push("access_token="+(l||ye.ACCESS_TOKEN||""));var A={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.0",skuId:C,userId:this.anonId},I=t?Le(A,t):A,U={url:nt(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([I])};this.pendingRequest=Hn(U,function(re){f.pendingRequest=null,r(re),f.saveEventData(),f.processRequests(l)})}},$.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Ye,ie,et=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,l,f,m){this.skuToken=f,(ye.EVENTS_URL&&m||ye.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(A){return q(A)||Ge(A)}))&&this.queueRequest({id:l,timestamp:Date.now()},m)},t.prototype.processRequests=function(r){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),m=f.id,A=f.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),Ze(this.anonId)||(this.anonId=$e()),this.postEvent(A,{skuToken:this.skuToken},function(I){I||m&&(l.success[m]=!0)},r))}},t}($),Bt=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,l){ye.EVENTS_URL&&ye.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(f){return q(f)||Ge(f)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(r){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=Nt(ye.ACCESS_TOKEN),m=f?f.u:ye.ACCESS_TOKEN,A=m!==this.eventData.tokenU;Ze(this.anonId)||(this.anonId=$e(),A=!0);var I=this.queue.shift();if(this.eventData.lastSuccess){var U=new Date(this.eventData.lastSuccess),re=new Date(I),he=(I-this.eventData.lastSuccess)/864e5;A=A||he>=1||he<-1||U.getDate()!==re.getDate()}else A=!0;if(!A)return this.processRequests();this.postEvent(I,{"enabled.telemetry":!1},function(Ae){Ae||(l.eventData.lastSuccess=I,l.eventData.tokenU=m)},r)}},t}($)),lr=Bt.postTurnstileEvent.bind(Bt),dt=new et,vt=dt.postMapLoadEvent.bind(dt),Ct=500,gt=50;function we(){Y.caches&&!Ye&&(Ye=Y.caches.open("mapbox-tiles"))}function ht(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var Qe,Vt=1/0;function pr(){return Qe==null&&(Qe=Y.OffscreenCanvas&&new Y.OffscreenCanvas(1,1).getContext("2d")&&typeof Y.createImageBitmap=="function"),Qe}var Zr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Zr);var cr=function(e){function t(r,l,f){l===401&&Ge(f)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=l,this.url=f,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),jn=$t()?function(){return self.worker&&self.worker.referrer}:function(){return(Y.location.protocol==="blob:"?Y.parent:Y).location.href},Sn,ai,fi=function(t,r){if(!(/^file:/.test(l=t.url)||/^file:/.test(jn())&&!/^\w+:/.test(l))){if(Y.fetch&&Y.Request&&Y.AbortController&&Y.Request.prototype.hasOwnProperty("signal"))return function(f,m){var A,I=new Y.AbortController,U=new Y.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:jn(),signal:I.signal}),re=!1,he=!1,Ae=(A=U.url).indexOf("sku=")>0&&Ge(A);f.type==="json"&&U.headers.set("Accept","application/json");var Pe=function(Tt,Wt,Zt){if(!he){if(Tt&&Tt.message!=="SecurityError"&&Me(Tt),Wt&&Zt)return ot(Wt);var nr=Date.now();Y.fetch(U).then(function(dr){if(dr.ok){var br=Ae?dr.clone():null;return ot(dr,br,nr)}return m(new cr(dr.statusText,dr.status,f.url))}).catch(function(dr){dr.code!==20&&m(new Error(dr.message))})}},ot=function(Tt,Wt,Zt){(f.type==="arrayBuffer"?Tt.arrayBuffer():f.type==="json"?Tt.json():Tt.text()).then(function(nr){he||(Wt&&Zt&&function(dr,br,zr){if(we(),Ye){var Rr={status:br.status,statusText:br.statusText,headers:new Y.Headers};br.headers.forEach(function(hn,Ln){return Rr.headers.set(Ln,hn)});var pn=ar(br.headers.get("Cache-Control")||"");pn["no-store"]||(pn["max-age"]&&Rr.headers.set("Expires",new Date(zr+1e3*pn["max-age"]).toUTCString()),new Date(Rr.headers.get("Expires")).getTime()-zr<42e4||function(hn,Ln){if(ie===void 0)try{new Response(new ReadableStream),ie=!0}catch(Jn){ie=!1}ie?Ln(hn.body):hn.blob().then(Ln)}(br,function(hn){var Ln=new Y.Response(hn,Rr);we(),Ye&&Ye.then(function(Jn){return Jn.put(ht(dr.url),Ln)}).catch(function(Jn){return Me(Jn.message)})}))}}(U,Wt,Zt),re=!0,m(null,nr,Tt.headers.get("Cache-Control"),Tt.headers.get("Expires")))}).catch(function(nr){he||m(new Error(nr.message))})};return Ae?function(wt,Tt){if(we(),!Ye)return Tt(null);var Wt=ht(wt.url);Ye.then(function(Zt){Zt.match(Wt).then(function(nr){var dr=function(br){if(!br)return!1;var zr=new Date(br.headers.get("Expires")||0),Rr=ar(br.headers.get("Cache-Control")||"");return zr>Date.now()&&!Rr["no-cache"]}(nr);Zt.delete(Wt),dr&&Zt.put(Wt,nr.clone()),Tt(null,nr,dr)}).catch(Tt)}).catch(Tt)}(U,Pe):Pe(null,null),{cancel:function(){he=!0,re||I.abort()}}}(t,r);if($t()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,r,void 0,!0)}var l;return function(f,m){var A=new Y.XMLHttpRequest;for(var I in A.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(A.responseType="arraybuffer"),f.headers)A.setRequestHeader(I,f.headers[I]);return f.type==="json"&&(A.responseType="text",A.setRequestHeader("Accept","application/json")),A.withCredentials=f.credentials==="include",A.onerror=function(){m(new Error(A.statusText))},A.onload=function(){if((A.status>=200&&A.status<300||A.status===0)&&A.response!==null){var U=A.response;if(f.type==="json")try{U=JSON.parse(A.response)}catch(re){return m(re)}m(null,U,A.getResponseHeader("Cache-Control"),A.getResponseHeader("Expires"))}else m(new cr(A.statusText,A.status,f.url))},A.send(f.body),{cancel:function(){return A.abort()}}}(t,r)},Zn=function(t,r){return fi(Le(t,{type:"arrayBuffer"}),r)},Hn=function(t,r){return fi(Le(t,{method:"POST"}),r)},k="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Sn=[],ai=0;var H=function e(t,r){if(Ve.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),ai>=ye.MAX_PARALLEL_IMAGE_REQUESTS){var l={requestParameters:t,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return Sn.push(l),l}ai++;var f=!1,m=function(){if(!f)for(f=!0,ai--;Sn.length&&ai<ye.MAX_PARALLEL_IMAGE_REQUESTS;){var U=Sn.shift();U.cancelled||(U.cancel=e(U.requestParameters,U.callback).cancel)}},A=Zn(t,function(I,U,re,he){m(),I?r(I):U&&(pr()?function(Ae,Pe){var ot=new Y.Blob([new Uint8Array(Ae)],{type:"image/png"});Y.createImageBitmap(ot).then(function(wt){Pe(null,wt)}).catch(function(wt){Pe(new Error("Could not load image because of "+wt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(U,r):function(Ae,Pe,ot,wt){var Tt=new Y.Image,Wt=Y.URL;Tt.onload=function(){Pe(null,Tt),Wt.revokeObjectURL(Tt.src),Tt.onload=null,Tt.src=k},Tt.onerror=function(){return Pe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Zt=new Y.Blob([new Uint8Array(Ae)],{type:"image/png"});Tt.cacheControl=ot,Tt.expires=wt,Tt.src=Ae.byteLength?Wt.createObjectURL(Zt):k}(U,r,re,he))});return{cancel:function(){A.cancel(),m()}}};function le(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function de(e,t,r){if(r&&r[e]){var l=r[e].indexOf(t);l!==-1&&r[e].splice(l,1)}}var at=function(t,r){r===void 0&&(r={}),Le(this,r),this.type=t},At=function(e){function t(r,l){l===void 0&&(l={}),e.call(this,"error",Le({error:r},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(at),Ft=function(){};Ft.prototype.on=function(e,t){return this._listeners=this._listeners||{},le(e,t,this._listeners),this},Ft.prototype.off=function(e,t){return de(e,t,this._listeners),de(e,t,this._oneTimeListeners),this},Ft.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},le(e,t,this._oneTimeListeners),this},Ft.prototype.fire=function(e,t){typeof e=="string"&&(e=new at(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var l=0,f=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];l<f.length;l+=1)f[l].call(this,e);for(var m=0,A=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];m<A.length;m+=1){var I=A[m];de(r,I,this._oneTimeListeners),I.call(this,e)}var U=this._eventedParent;U&&(Le(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),U.fire(e))}else e instanceof At&&console.error(e.error);return this},Ft.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Ft.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var He={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Pt=function(t,r,l,f){this.message=(t?t+": ":"")+l,f&&(this.identifier=f),r!=null&&r.__line__&&(this.line=r.__line__)};function or(e){var t=e.value;return t?[new Pt(e.key,t,"constants have been deprecated as of v8")]:[]}function jr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var l=0,f=t;l<f.length;l+=1){var m=f[l];for(var A in m)e[A]=m[A]}return e}function Hr(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function sr(e){if(Array.isArray(e))return e.map(sr);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=sr(e[r]);return t}return Hr(e)}var Fr=function(e){function t(r,l){e.call(this,l),this.message=l,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),_n=function(t,r){r===void 0&&(r=[]),this.parent=t,this.bindings={};for(var l=0,f=r;l<f.length;l+=1){var m=f[l];this.bindings[m[0]]=m[1]}};_n.prototype.concat=function(e){return new _n(this,e)},_n.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},_n.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var dn={kind:"null"},Er={kind:"number"},Tn={kind:"string"},vn={kind:"boolean"},gn={kind:"color"},Ar={kind:"object"},$r={kind:"value"},Mn={kind:"collator"},Xi={kind:"formatted"},vi={kind:"resolvedImage"};function wi(e,t){return{kind:"array",itemType:e,N:t}}function Di(e){if(e.kind==="array"){var t=Di(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var Ka=[dn,Er,Tn,vn,gn,Xi,Ar,wi($r),vi];function hi(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!hi(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,l=Ka;r<l.length;r+=1)if(!hi(l[r],t))return null}}return"Expected "+Di(e)+" but found "+Di(t)+" instead."}function ga(e,t){return t.some(function(r){return r.kind===e.kind})}function Pi(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var gi=W(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(I){return(I=Math.round(I))<0?0:I>255?255:I}function f(I){return l(I[I.length-1]==="%"?parseFloat(I)/100*255:parseInt(I))}function m(I){return(U=I[I.length-1]==="%"?parseFloat(I)/100:parseFloat(I))<0?0:U>1?1:U;var U}function A(I,U,re){return re<0?re+=1:re>1&&(re-=1),6*re<1?I+(U-I)*re*6:2*re<1?U:3*re<2?I+(U-I)*(2/3-re)*6:I}try{t.parseCSSColor=function(I){var U,re=I.replace(/ /g,"").toLowerCase();if(re in r)return r[re].slice();if(re[0]==="#")return re.length===4?(U=parseInt(re.substr(1),16))>=0&&U<=4095?[(3840&U)>>4|(3840&U)>>8,240&U|(240&U)>>4,15&U|(15&U)<<4,1]:null:re.length===7&&(U=parseInt(re.substr(1),16))>=0&&U<=16777215?[(16711680&U)>>16,(65280&U)>>8,255&U,1]:null;var he=re.indexOf("("),Ae=re.indexOf(")");if(he!==-1&&Ae+1===re.length){var Pe=re.substr(0,he),ot=re.substr(he+1,Ae-(he+1)).split(","),wt=1;switch(Pe){case"rgba":if(ot.length!==4)return null;wt=m(ot.pop());case"rgb":return ot.length!==3?null:[f(ot[0]),f(ot[1]),f(ot[2]),wt];case"hsla":if(ot.length!==4)return null;wt=m(ot.pop());case"hsl":if(ot.length!==3)return null;var Tt=(parseFloat(ot[0])%360+360)%360/360,Wt=m(ot[1]),Zt=m(ot[2]),nr=Zt<=.5?Zt*(Wt+1):Zt+Wt-Zt*Wt,dr=2*Zt-nr;return[l(255*A(dr,nr,Tt+1/3)),l(255*A(dr,nr,Tt)),l(255*A(dr,nr,Tt-1/3)),wt];default:return null}}return null}}catch(I){}}).parseCSSColor,ci=function(t,r,l,f){f===void 0&&(f=1),this.r=t,this.g=r,this.b=l,this.a=f};ci.parse=function(e){if(e){if(e instanceof ci)return e;if(typeof e=="string"){var t=gi(e);if(t)return new ci(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},ci.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+l+")"},ci.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},ci.black=new ci(0,0,0,1),ci.white=new ci(1,1,1,1),ci.transparent=new ci(0,0,0,0),ci.red=new ci(1,0,0,1);var Oa=function(t,r,l){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Oa.prototype.compare=function(e,t){return this.collator.compare(e,t)},Oa.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var mo=function(t,r,l,f,m){this.text=t,this.image=r,this.scale=l,this.fontStack=f,this.textColor=m},$a=function(t){this.sections=t};$a.fromString=function(e){return new $a([new mo(e,null,null,null,null)])},$a.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},$a.factory=function(e){return e instanceof $a?e:$a.fromString(e)},$a.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},$a.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var l=r[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var f={};l.fontStack&&(f["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(f["font-scale"]=l.scale),l.textColor&&(f["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(f)}}return e};var Ko=function(t){this.name=t.name,this.available=t.available};function Uu(e,t,r,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,r,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,r,l]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Ui(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof ci||e instanceof Oa||e instanceof $a||e instanceof Ko)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!Ui(r[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!Ui(e[l]))return!1;return!0}return!1}function Ca(e){if(e===null)return dn;if(typeof e=="string")return Tn;if(typeof e=="boolean")return vn;if(typeof e=="number")return Er;if(e instanceof ci)return gn;if(e instanceof Oa)return Mn;if(e instanceof $a)return Xi;if(e instanceof Ko)return vi;if(Array.isArray(e)){for(var t,r=e.length,l=0,f=e;l<f.length;l+=1){var m=Ca(f[l]);if(t){if(t===m)continue;t=$r;break}t=m}return wi(t||$r,r)}return Ar}function ns(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof ci||e instanceof $a||e instanceof Ko?e.toString():JSON.stringify(e)}Ko.prototype.toString=function(){return this.name},Ko.fromString=function(e){return e?new Ko({name:e,available:!1}):null},Ko.prototype.serialize=function(){return["image",this.name]};var na=function(t,r){this.type=t,this.value=r};na.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Ui(e[1]))return t.error("invalid value");var r=e[1],l=Ca(r),f=t.expectedType;return l.kind!=="array"||l.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(l=f),new na(l,r)},na.prototype.evaluate=function(){return this.value},na.prototype.eachChild=function(){},na.prototype.outputDefined=function(){return!0},na.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ci?["rgba"].concat(this.value.toArray()):this.value instanceof $a?this.value.serialize():this.value};var Ja=function(t){this.name="ExpressionEvaluationError",this.message=t};Ja.prototype.toJSON=function(){return this.message};var is={string:Tn,number:Er,boolean:vn,object:Ar},$i=function(t,r){this.type=t,this.args=r};$i.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,l=1,f=e[0];if(f==="array"){var m,A;if(e.length>2){var I=e[1];if(typeof I!="string"||!(I in is)||I==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);m=is[I],l++}else m=$r;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);A=e[2],l++}r=wi(m,A)}else r=is[f];for(var U=[];l<e.length;l++){var re=t.parse(e[l],l,$r);if(!re)return null;U.push(re)}return new $i(r,U)},$i.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!hi(this.type,Ca(r)))return r;if(t===this.args.length-1)throw new Ja("Expected value to be of type "+Di(this.type)+", but found "+Di(Ca(r))+" instead.")}return null},$i.prototype.eachChild=function(e){this.args.forEach(e)},$i.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},$i.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var oo=function(t){this.type=Xi,this.sections=t};oo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var l=[],f=!1,m=1;m<=e.length-1;++m){var A=e[m];if(f&&typeof A=="object"&&!Array.isArray(A)){f=!1;var I=null;if(A["font-scale"]&&!(I=t.parse(A["font-scale"],1,Er)))return null;var U=null;if(A["text-font"]&&!(U=t.parse(A["text-font"],1,wi(Tn))))return null;var re=null;if(A["text-color"]&&!(re=t.parse(A["text-color"],1,gn)))return null;var he=l[l.length-1];he.scale=I,he.font=U,he.textColor=re}else{var Ae=t.parse(e[m],1,$r);if(!Ae)return null;var Pe=Ae.type.kind;if(Pe!=="string"&&Pe!=="value"&&Pe!=="null"&&Pe!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,l.push({content:Ae,scale:null,font:null,textColor:null})}}return new oo(l)},oo.prototype.evaluate=function(e){return new $a(this.sections.map(function(t){var r=t.content.evaluate(e);return Ca(r)===vi?new mo("",r,null,null,null):new mo(ns(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},oo.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var l=r[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},oo.prototype.outputDefined=function(){return!1},oo.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var l=r[t];e.push(l.content.serialize());var f={};l.scale&&(f["font-scale"]=l.scale.serialize()),l.font&&(f["text-font"]=l.font.serialize()),l.textColor&&(f["text-color"]=l.textColor.serialize()),e.push(f)}return e};var so=function(t){this.type=vi,this.input=t};so.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Tn);return r?new so(r):t.error("No image name provided.")},so.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Ko.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},so.prototype.eachChild=function(e){e(this.input)},so.prototype.outputDefined=function(){return!1},so.prototype.serialize=function(){return["image",this.input.serialize()]};var Ys={"to-boolean":vn,"to-color":gn,"to-number":Er,"to-string":Tn},Ao=function(t,r){this.type=t,this.args=r};Ao.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=Ys[r],f=[],m=1;m<e.length;m++){var A=t.parse(e[m],m,$r);if(!A)return null;f.push(A)}return new Ao(l,f)},Ao.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,l=0,f=this.args;l<f.length;l+=1){if(r=null,(t=f[l].evaluate(e))instanceof ci)return t;if(typeof t=="string"){var m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Uu(t[0],t[1],t[2],t[3])))return new ci(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Ja(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var A=null,I=0,U=this.args;I<U.length;I+=1){if((A=U[I].evaluate(e))===null)return 0;var re=Number(A);if(!isNaN(re))return re}throw new Ja("Could not convert "+JSON.stringify(A)+" to number.")}return this.type.kind==="formatted"?$a.fromString(ns(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Ko.fromString(ns(this.args[0].evaluate(e))):ns(this.args[0].evaluate(e))},Ao.prototype.eachChild=function(e){this.args.forEach(e)},Ao.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ao.prototype.serialize=function(){if(this.type.kind==="formatted")return new oo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new so(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Zl=["Unknown","Point","LineString","Polygon"],Ks=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ks.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ks.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Zl[this.feature.type]:this.feature.type:null},Ks.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ks.prototype.canonicalID=function(){return this.canonical},Ks.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ks.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=ci.parse(e)),t};var _o=function(t,r,l,f){this.name=t,this.type=r,this._evaluate=l,this.args=f};_o.prototype.evaluate=function(e){return this._evaluate(e,this.args)},_o.prototype.eachChild=function(e){this.args.forEach(e)},_o.prototype.outputDefined=function(){return!1},_o.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},_o.parse=function(e,t){var r,l=e[0],f=_o.definitions[l];if(!f)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(f)?f[0]:f.type,A=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,I=A.filter(function(Kn){var Nn=Kn[0];return!Array.isArray(Nn)||Nn.length===e.length-1}),U=null,re=0,he=I;re<he.length;re+=1){var Ae=he[re],Pe=Ae[0],ot=Ae[1];U=new lu(t.registry,t.path,null,t.scope);for(var wt=[],Tt=!1,Wt=1;Wt<e.length;Wt++){var Zt=e[Wt],nr=Array.isArray(Pe)?Pe[Wt-1]:Pe.type,dr=U.parse(Zt,1+wt.length,nr);if(!dr){Tt=!0;break}wt.push(dr)}if(!Tt)if(Array.isArray(Pe)&&Pe.length!==wt.length)U.error("Expected "+Pe.length+" arguments, but found "+wt.length+" instead.");else{for(var br=0;br<wt.length;br++){var zr=Array.isArray(Pe)?Pe[br]:Pe.type,Rr=wt[br];U.concat(br+1).checkSubtype(zr,Rr.type)}if(U.errors.length===0)return new _o(l,m,ot,wt)}}if(I.length===1)(r=t.errors).push.apply(r,U.errors);else{for(var pn=(I.length?I:A).map(function(Kn){var Nn;return Nn=Kn[0],Array.isArray(Nn)?"("+Nn.map(Di).join(", ")+")":"("+Di(Nn.type)+"...)"}).join(" | "),hn=[],Ln=1;Ln<e.length;Ln++){var Jn=t.parse(e[Ln],1+hn.length);if(!Jn)return null;hn.push(Di(Jn.type))}t.error("Expected arguments of type "+pn+", but found ("+hn.join(", ")+") instead.")}return null},_o.register=function(e,t){for(var r in _o.definitions=t,t)e[r]=_o};var kt=function(t,r,l){this.type=Mn,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=r};function De(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function It(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function fr(e,t){var r=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(r*f*8192),Math.round(l*f*8192)]}function tn(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function En(e,t){for(var r,l,f,m,A,I,U,re=!1,he=0,Ae=t.length;he<Ae;he++)for(var Pe=t[he],ot=0,wt=Pe.length;ot<wt-1;ot++){if((m=(r=e)[0]-(l=Pe[ot])[0])*(U=r[1]-(f=Pe[ot+1])[1])-(I=r[0]-f[0])*(A=r[1]-l[1])==0&&m*I<=0&&A*U<=0)return!1;tn(e,Pe[ot],Pe[ot+1])&&(re=!re)}return re}function Un(e,t){for(var r=0;r<t.length;r++)if(En(e,t[r]))return!0;return!1}function La(e,t,r,l){var f=l[0]-r[0],m=l[1]-r[1],A=(e[0]-r[0])*m-f*(e[1]-r[1]),I=(t[0]-r[0])*m-f*(t[1]-r[1]);return A>0&&I<0||A<0&&I>0}function no(e,t,r){for(var l=0,f=r;l<f.length;l+=1)for(var m=f[l],A=0;A<m.length-1;++A)if((Ae=[(he=m[A+1])[0]-(re=m[A])[0],he[1]-re[1]])[0]*(Pe=[(U=t)[0]-(I=e)[0],U[1]-I[1]])[1]-Ae[1]*Pe[0]!=0&&La(I,U,re,he)&&La(re,he,I,U))return!0;var I,U,re,he,Ae,Pe;return!1}function go(e,t){for(var r=0;r<e.length;++r)if(!En(e[r],t))return!1;for(var l=0;l<e.length-1;++l)if(no(e[l],e[l+1],t))return!1;return!0}function No(e,t){for(var r=0;r<t.length;r++)if(go(e,t[r]))return!0;return!1}function Vu(e,t,r){for(var l=[],f=0;f<e.length;f++){for(var m=[],A=0;A<e[f].length;A++){var I=fr(e[f][A],r);De(t,I),m.push(I)}l.push(m)}return l}function Wl(e,t,r){for(var l=[],f=0;f<e.length;f++){var m=Vu(e[f],t,r);l.push(m)}return l}function $s(e,t,r,l){if(e[0]<r[0]||e[0]>r[2]){var f=.5*l,m=e[0]-r[0]>f?-l:r[0]-e[0]>f?l:0;m===0&&(m=e[0]-r[2]>f?-l:r[2]-e[0]>f?l:0),e[0]+=m}De(t,e)}function Ic(e,t,r,l){for(var f=8192*Math.pow(2,l.z),m=[8192*l.x,8192*l.y],A=[],I=0,U=e;I<U.length;I+=1)for(var re=0,he=U[I];re<he.length;re+=1){var Ae=he[re],Pe=[Ae.x+m[0],Ae.y+m[1]];$s(Pe,t,r,f),A.push(Pe)}return A}function Il(e,t,r,l){for(var f,m=8192*Math.pow(2,l.z),A=[8192*l.x,8192*l.y],I=[],U=0,re=e;U<re.length;U+=1){for(var he=[],Ae=0,Pe=re[U];Ae<Pe.length;Ae+=1){var ot=Pe[Ae],wt=[ot.x+A[0],ot.y+A[1]];De(t,wt),he.push(wt)}I.push(he)}if(t[2]-t[0]<=m/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var Tt=0,Wt=I;Tt<Wt.length;Tt+=1)for(var Zt=0,nr=Wt[Tt];Zt<nr.length;Zt+=1)$s(nr[Zt],t,r,m)}return I}kt.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var l=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,vn);if(!l)return null;var f=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,vn);if(!f)return null;var m=null;return r.locale&&!(m=t.parse(r.locale,1,Tn))?null:new kt(l,f,m)},kt.prototype.evaluate=function(e){return new Oa(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},kt.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},kt.prototype.outputDefined=function(){return!1},kt.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var fs=function(t,r){this.type=vn,this.geojson=t,this.geometries=r};function zs(e){if(e instanceof _o&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof fs)return!1;var t=!0;return e.eachChild(function(r){t&&!zs(r)&&(t=!1)}),t}function uo(e){if(e instanceof _o&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!uo(r)&&(t=!1)}),t}function hs(e,t){if(e instanceof _o&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(l){r&&!hs(l,t)&&(r=!1)}),r}fs.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Ui(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var l=0;l<r.features.length;++l){var f=r.features[l].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new fs(r,r.features[l].geometry)}else if(r.type==="Feature"){var m=r.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new fs(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new fs(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},fs.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var l=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(r.type==="Polygon"){var A=Vu(r.coordinates,f,m),I=Ic(t.geometry(),l,f,m);if(!It(l,f))return!1;for(var U=0,re=I;U<re.length;U+=1)if(!En(re[U],A))return!1}if(r.type==="MultiPolygon"){var he=Wl(r.coordinates,f,m),Ae=Ic(t.geometry(),l,f,m);if(!It(l,f))return!1;for(var Pe=0,ot=Ae;Pe<ot.length;Pe+=1)if(!Un(ot[Pe],he))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var l=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(r.type==="Polygon"){var A=Vu(r.coordinates,f,m),I=Il(t.geometry(),l,f,m);if(!It(l,f))return!1;for(var U=0,re=I;U<re.length;U+=1)if(!go(re[U],A))return!1}if(r.type==="MultiPolygon"){var he=Wl(r.coordinates,f,m),Ae=Il(t.geometry(),l,f,m);if(!It(l,f))return!1;for(var Pe=0,ot=Ae;Pe<ot.length;Pe+=1)if(!No(ot[Pe],he))return!1}return!0}(e,this.geometries)}return!1},fs.prototype.eachChild=function(){},fs.prototype.outputDefined=function(){return!0},fs.prototype.serialize=function(){return["within",this.geojson]};var Js=function(t,r){this.type=r.type,this.name=t,this.boundExpression=r};Js.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Js(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Js.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Js.prototype.eachChild=function(){},Js.prototype.outputDefined=function(){return!1},Js.prototype.serialize=function(){return["var",this.name]};var lu=function(t,r,l,f,m){r===void 0&&(r=[]),f===void 0&&(f=new _n),m===void 0&&(m=[]),this.registry=t,this.path=r,this.key=r.map(function(A){return"["+A+"]"}).join(""),this.scope=f,this.errors=m,this.expectedType=l};function Xl(e,t){for(var r,l=e.length-1,f=0,m=l,A=0;f<=m;)if((r=e[A=Math.floor((f+m)/2)])<=t){if(A===l||t<e[A+1])return A;f=A+1}else{if(!(r>t))throw new Ja("Input is not a number.");m=A-1}return 0}lu.prototype.parse=function(e,t,r,l,f){return f===void 0&&(f={}),t?this.concat(t,r,l)._parse(e,f):this._parse(e,f)},lu.prototype._parse=function(e,t){function r(re,he,Ae){return Ae==="assert"?new $i(he,[re]):Ae==="coerce"?new Ao(he,[re]):re}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[l];if(f){var m=f.parse(e,this);if(!m)return null;if(this.expectedType){var A=this.expectedType,I=m.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||I.kind!=="value")if(A.kind!=="color"&&A.kind!=="formatted"&&A.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string"){if(this.checkSubtype(A,I))return null}else m=r(m,A,t.typeAnnotation||"coerce");else m=r(m,A,t.typeAnnotation||"assert")}if(!(m instanceof na)&&m.type.kind!=="resolvedImage"&&function re(he){if(he instanceof Js)return re(he.boundExpression);if(he instanceof _o&&he.name==="error"||he instanceof kt||he instanceof fs)return!1;var Ae=he instanceof Ao||he instanceof $i,Pe=!0;return he.eachChild(function(ot){Pe=Ae?Pe&&re(ot):Pe&&ot instanceof na}),!!Pe&&zs(he)&&hs(he,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var U=new Ks;try{m=new na(m.type,m.evaluate(U))}catch(re){return this.error(re.message),null}}return m}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},lu.prototype.concat=function(e,t,r){var l=typeof e=="number"?this.path.concat(e):this.path,f=r?this.scope.concat(r):this.scope;return new lu(this.registry,l,t||null,f,this.errors)},lu.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var l=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new Fr(l,e))},lu.prototype.checkSubtype=function(e,t){var r=hi(e,t);return r&&this.error(r),r};var ya=function(t,r,l){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(var f=0,m=l;f<m.length;f+=1){var A=m[f],I=A[1];this.labels.push(A[0]),this.outputs.push(I)}};function Na(e,t,r){return e*(1-r)+t*r}ya.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,Er);if(!r)return null;var l=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var m=1;m<e.length;m+=2){var A=m===1?-1/0:e[m],I=e[m+1],U=m,re=m+1;if(typeof A!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(l.length&&l[l.length-1][0]>=A)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',U);var he=t.parse(I,re,f);if(!he)return null;f=f||he.type,l.push([A,he])}return new ya(f,r,l)},ya.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return r[0].evaluate(e);var f=t.length;return l>=t[f-1]?r[f-1].evaluate(e):r[Xl(t,l)].evaluate(e)},ya.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},ya.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},ya.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var ml=Object.freeze({__proto__:null,number:Na,color:function(t,r,l){return new ci(Na(t.r,r.r,l),Na(t.g,r.g,l),Na(t.b,r.b,l),Na(t.a,r.a,l))},array:function(t,r,l){return t.map(function(f,m){return Na(f,r[m],l)})}}),Ns=6/29*3*(6/29),ds=Math.PI/180,Mt=180/Math.PI;function rr(e){return e>.008856451679035631?Math.pow(e,1/3):e/Ns+4/29}function Pr(e){return e>6/29?e*e*e:Ns*(e-4/29)}function Vn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Ji(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Ra(e){var t=Ji(e.r),r=Ji(e.g),l=Ji(e.b),f=rr((.4124564*t+.3575761*r+.1804375*l)/.95047),m=rr((.2126729*t+.7151522*r+.072175*l)/1);return{l:116*m-16,a:500*(f-m),b:200*(m-rr((.0193339*t+.119192*r+.9503041*l)/1.08883)),alpha:e.a}}function Ha(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*Pr(t),r=.95047*Pr(r),l=1.08883*Pr(l),new ci(Vn(3.2404542*r-1.5371385*t-.4985314*l),Vn(-.969266*r+1.8760108*t+.041556*l),Vn(.0556434*r-.2040259*t+1.0572252*l),e.alpha)}function Qi(e,t,r){var l=t-e;return e+r*(l>180||l<-180?l-360*Math.round(l/360):l)}var xa={forward:Ra,reverse:Ha,interpolate:function(t,r,l){return{l:Na(t.l,r.l,l),a:Na(t.a,r.a,l),b:Na(t.b,r.b,l),alpha:Na(t.alpha,r.alpha,l)}}},Co={forward:function(t){var r=Ra(t),l=r.l,f=r.a,m=r.b,A=Math.atan2(m,f)*Mt;return{h:A<0?A+360:A,c:Math.sqrt(f*f+m*m),l,alpha:t.a}},reverse:function(t){var r=t.h*ds,l=t.c;return Ha({l:t.l,a:Math.cos(r)*l,b:Math.sin(r)*l,alpha:t.alpha})},interpolate:function(t,r,l){return{h:Qi(t.h,r.h,l),c:Na(t.c,r.c,l),l:Na(t.l,r.l,l),alpha:Na(t.alpha,r.alpha,l)}}},Fs=Object.freeze({__proto__:null,lab:xa,hcl:Co}),ha=function(t,r,l,f,m){this.type=t,this.operator=r,this.interpolation=l,this.input=f,this.labels=[],this.outputs=[];for(var A=0,I=m;A<I.length;A+=1){var U=I[A],re=U[1];this.labels.push(U[0]),this.outputs.push(re)}};function Yl(e,t,r,l){var f=l-r,m=e-r;return f===0?0:t===1?m/f:(Math.pow(t,m)-1)/(Math.pow(t,f)-1)}ha.interpolationFactor=function(e,t,r,l){var f=0;if(e.name==="exponential")f=Yl(t,e.base,r,l);else if(e.name==="linear")f=Yl(t,1,r,l);else if(e.name==="cubic-bezier"){var m=e.controlPoints;f=new D(m[0],m[1],m[2],m[3]).solve(Yl(t,1,r,l))}return f},ha.parse=function(e,t){var r=e[0],l=e[1],f=e[2],m=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var A=l[1];if(typeof A!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:A}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var I=l.slice(1);if(I.length!==4||I.some(function(Wt){return typeof Wt!="number"||Wt<0||Wt>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:I}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,Er)))return null;var U=[],re=null;r==="interpolate-hcl"||r==="interpolate-lab"?re=gn:t.expectedType&&t.expectedType.kind!=="value"&&(re=t.expectedType);for(var he=0;he<m.length;he+=2){var Ae=m[he],Pe=m[he+1],ot=he+3,wt=he+4;if(typeof Ae!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ot);if(U.length&&U[U.length-1][0]>=Ae)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ot);var Tt=t.parse(Pe,wt,re);if(!Tt)return null;re=re||Tt.type,U.push([Ae,Tt])}return re.kind==="number"||re.kind==="color"||re.kind==="array"&&re.itemType.kind==="number"&&typeof re.N=="number"?new ha(re,r,l,f,U):t.error("Type "+Di(re)+" is not interpolatable.")},ha.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return r[0].evaluate(e);var f=t.length;if(l>=t[f-1])return r[f-1].evaluate(e);var m=Xl(t,l),A=ha.interpolationFactor(this.interpolation,l,t[m],t[m+1]),I=r[m].evaluate(e),U=r[m+1].evaluate(e);return this.operator==="interpolate"?ml[this.type.kind.toLowerCase()](I,U,A):this.operator==="interpolate-hcl"?Co.reverse(Co.interpolate(Co.forward(I),Co.forward(U),A)):xa.reverse(xa.interpolate(xa.forward(I),xa.forward(U),A))},ha.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},ha.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},ha.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var cu=function(t,r){this.type=t,this.args=r};cu.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,l=t.expectedType;l&&l.kind!=="value"&&(r=l);for(var f=[],m=0,A=e.slice(1);m<A.length;m+=1){var I=t.parse(A[m],1+f.length,r,void 0,{typeAnnotation:"omit"});if(!I)return null;r=r||I.type,f.push(I)}var U=l&&f.some(function(re){return hi(l,re.type)});return new cu(U?$r:r,f)},cu.prototype.evaluate=function(e){for(var t,r=null,l=0,f=0,m=this.args;f<m.length&&(l++,(r=m[f].evaluate(e))&&r instanceof Ko&&!r.available&&(t||(t=r.name),r=null,l===this.args.length&&(r=t)),r===null);f+=1);return r},cu.prototype.eachChild=function(e){this.args.forEach(e)},cu.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},cu.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var ws=function(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r};ws.prototype.evaluate=function(e){return this.result.evaluate(e)},ws.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},ws.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],l=1;l<e.length-1;l+=2){var f=e[l];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",l);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var m=t.parse(e[l+1],l+1);if(!m)return null;r.push([f,m])}var A=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return A?new ws(r,A):null},ws.prototype.outputDefined=function(){return this.result.outputDefined()},ws.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var l=r[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var gl=function(t,r,l){this.type=t,this.index=r,this.input=l};gl.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Er),l=t.parse(e[2],2,wi(t.expectedType||$r));return r&&l?new gl(l.type.itemType,r,l):null},gl.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Ja("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new Ja("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new Ja("Array index must be an integer, but found "+t+" instead.");return r[t]},gl.prototype.eachChild=function(e){e(this.index),e(this.input)},gl.prototype.outputDefined=function(){return!1},gl.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var fu=function(t,r){this.type=vn,this.needle=t,this.haystack=r};fu.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,$r),l=t.parse(e[2],2,$r);return r&&l?ga(r.type,[vn,Tn,Er,dn,$r])?new fu(r,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Di(r.type)+" instead"):null},fu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Pi(t,["boolean","string","number","null"]))throw new Ja("Expected first argument to be of type boolean, string, number or null, but found "+Di(Ca(t))+" instead.");if(!Pi(r,["string","array"]))throw new Ja("Expected second argument to be of type array or string, but found "+Di(Ca(r))+" instead.");return r.indexOf(t)>=0},fu.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},fu.prototype.outputDefined=function(){return!0},fu.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Gu=function(t,r,l){this.type=Er,this.needle=t,this.haystack=r,this.fromIndex=l};Gu.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,$r),l=t.parse(e[2],2,$r);if(!r||!l)return null;if(!ga(r.type,[vn,Tn,Er,dn,$r]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Di(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,Er);return f?new Gu(r,l,f):null}return new Gu(r,l)},Gu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Pi(t,["boolean","string","number","null"]))throw new Ja("Expected first argument to be of type boolean, string, number or null, but found "+Di(Ca(t))+" instead.");if(!Pi(r,["string","array"]))throw new Ja("Expected second argument to be of type array or string, but found "+Di(Ca(r))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return r.indexOf(t,l)}return r.indexOf(t)},Gu.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Gu.prototype.outputDefined=function(){return!1},Gu.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Qs=function(t,r,l,f,m,A){this.inputType=t,this.type=r,this.input=l,this.cases=f,this.outputs=m,this.otherwise=A};Qs.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var f={},m=[],A=2;A<e.length-1;A+=2){var I=e[A],U=e[A+1];Array.isArray(I)||(I=[I]);var re=t.concat(A);if(I.length===0)return re.error("Expected at least one branch label.");for(var he=0,Ae=I;he<Ae.length;he+=1){var Pe=Ae[he];if(typeof Pe!="number"&&typeof Pe!="string")return re.error("Branch labels must be numbers or strings.");if(typeof Pe=="number"&&Math.abs(Pe)>Number.MAX_SAFE_INTEGER)return re.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Pe=="number"&&Math.floor(Pe)!==Pe)return re.error("Numeric branch labels must be integer values.");if(r){if(re.checkSubtype(r,Ca(Pe)))return null}else r=Ca(Pe);if(f[String(Pe)]!==void 0)return re.error("Branch labels must be unique.");f[String(Pe)]=m.length}var ot=t.parse(U,A,l);if(!ot)return null;l=l||ot.type,m.push(ot)}var wt=t.parse(e[1],1,$r);if(!wt)return null;var Tt=t.parse(e[e.length-1],e.length-1,l);return Tt?wt.type.kind!=="value"&&t.concat(1).checkSubtype(r,wt.type)?null:new Qs(r,l,wt,f,m,Tt):null},Qs.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Ca(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},Qs.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Qs.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},Qs.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],l={},f=0,m=Object.keys(this.cases).sort();f<m.length;f+=1){var A=m[f];(Ae=l[this.cases[A]])===void 0?(l[this.cases[A]]=r.length,r.push([this.cases[A],[A]])):r[Ae][1].push(A)}for(var I=function(wt){return e.inputType.kind==="number"?Number(wt):wt},U=0,re=r;U<re.length;U+=1){var he=re[U],Ae=he[0],Pe=he[1];t.push(Pe.length===1?I(Pe[0]):Pe.map(I)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var rl=function(t,r,l){this.type=t,this.branches=r,this.otherwise=l};rl.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var l=[],f=1;f<e.length-1;f+=2){var m=t.parse(e[f],f,vn);if(!m)return null;var A=t.parse(e[f+1],f+1,r);if(!A)return null;l.push([m,A]),r=r||A.type}var I=t.parse(e[e.length-1],e.length-1,r);return I?new rl(r,l,I):null},rl.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var l=r[t],f=l[1];if(l[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},rl.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var l=r[t],f=l[1];e(l[0]),e(f)}e(this.otherwise)},rl.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},rl.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var hu=function(t,r,l,f){this.type=t,this.input=r,this.beginIndex=l,this.endIndex=f};function pc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Pf(e,t,r,l){return l.compare(t,r)===0}function da(e,t,r){var l=e!=="=="&&e!=="!=";return function(){function f(m,A,I){this.type=vn,this.lhs=m,this.rhs=A,this.collator=I,this.hasUntypedArgument=m.type.kind==="value"||A.type.kind==="value"}return f.parse=function(m,A){if(m.length!==3&&m.length!==4)return A.error("Expected two or three arguments.");var I=m[0],U=A.parse(m[1],1,$r);if(!U)return null;if(!pc(I,U.type))return A.concat(1).error('"'+I+`" comparisons are not supported for type '`+Di(U.type)+"'.");var re=A.parse(m[2],2,$r);if(!re)return null;if(!pc(I,re.type))return A.concat(2).error('"'+I+`" comparisons are not supported for type '`+Di(re.type)+"'.");if(U.type.kind!==re.type.kind&&U.type.kind!=="value"&&re.type.kind!=="value")return A.error("Cannot compare types '"+Di(U.type)+"' and '"+Di(re.type)+"'.");l&&(U.type.kind==="value"&&re.type.kind!=="value"?U=new $i(re.type,[U]):U.type.kind!=="value"&&re.type.kind==="value"&&(re=new $i(U.type,[re])));var he=null;if(m.length===4){if(U.type.kind!=="string"&&re.type.kind!=="string"&&U.type.kind!=="value"&&re.type.kind!=="value")return A.error("Cannot use collator to compare non-string types.");if(!(he=A.parse(m[3],3,Mn)))return null}return new f(U,re,he)},f.prototype.evaluate=function(m){var A=this.lhs.evaluate(m),I=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){var U=Ca(A),re=Ca(I);if(U.kind!==re.kind||U.kind!=="string"&&U.kind!=="number")throw new Ja('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+U.kind+", "+re.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var he=Ca(A),Ae=Ca(I);if(he.kind!=="string"||Ae.kind!=="string")return t(m,A,I)}return this.collator?r(m,A,I,this.collator.evaluate(m)):t(m,A,I)},f.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var m=[e];return this.eachChild(function(A){m.push(A.serialize())}),m},f}()}hu.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,$r),l=t.parse(e[2],2,Er);if(!r||!l)return null;if(!ga(r.type,[wi($r),Tn,$r]))return t.error("Expected first argument to be of type array or string, but found "+Di(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,Er);return f?new hu(r.type,r,l,f):null}return new hu(r.type,r,l)},hu.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Pi(t,["string","array"]))throw new Ja("Expected first argument to be of type array or string, but found "+Di(Ca(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(r,l)}return t.slice(r)},hu.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},hu.prototype.outputDefined=function(){return!1},hu.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Oc=da("==",function(e,t,r){return t===r},Pf),vc=da("!=",function(e,t,r){return t!==r},function(e,t,r,l){return!Pf(0,t,r,l)}),qc=da("<",function(e,t,r){return t<r},function(e,t,r,l){return l.compare(t,r)<0}),ef=da(">",function(e,t,r){return t>r},function(e,t,r,l){return l.compare(t,r)>0}),tf=da("<=",function(e,t,r){return t<=r},function(e,t,r,l){return l.compare(t,r)<=0}),Qa=da(">=",function(e,t,r){return t>=r},function(e,t,r,l){return l.compare(t,r)>=0}),Au=function(t,r,l,f,m){this.type=Tn,this.number=t,this.locale=r,this.currency=l,this.minFractionDigits=f,this.maxFractionDigits=m};Au.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Er);if(!r)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var f=null;if(l.locale&&!(f=t.parse(l.locale,1,Tn)))return null;var m=null;if(l.currency&&!(m=t.parse(l.currency,1,Tn)))return null;var A=null;if(l["min-fraction-digits"]&&!(A=t.parse(l["min-fraction-digits"],1,Er)))return null;var I=null;return l["max-fraction-digits"]&&!(I=t.parse(l["max-fraction-digits"],1,Er))?null:new Au(r,f,m,A,I)},Au.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Au.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Au.prototype.outputDefined=function(){return!1},Au.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var qs=function(t){this.type=Er,this.input=t};qs.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Di(r.type)+" instead."):new qs(r):null},qs.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new Ja("Expected value to be of type string or array, but found "+Di(Ca(t))+" instead.")},qs.prototype.eachChild=function(e){e(this.input)},qs.prototype.outputDefined=function(){return!1},qs.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var ps={"==":Oc,"!=":vc,">":ef,"<":qc,">=":Qa,"<=":tf,array:$i,at:gl,boolean:$i,case:rl,coalesce:cu,collator:kt,format:oo,image:so,in:fu,"index-of":Gu,interpolate:ha,"interpolate-hcl":ha,"interpolate-lab":ha,length:qs,let:ws,literal:na,match:Qs,number:$i,"number-format":Au,object:$i,slice:hu,step:ya,string:$i,"to-boolean":Ao,"to-color":Ao,"to-number":Ao,"to-string":Ao,var:Js,within:fs};function Lc(e,t){var r=t[0],l=t[1],f=t[2],m=t[3];r=r.evaluate(e),l=l.evaluate(e),f=f.evaluate(e);var A=m?m.evaluate(e):1,I=Uu(r,l,f,A);if(I)throw new Ja(I);return new ci(r/255*A,l/255*A,f/255*A,A)}function mc(e,t){return e in t}function yl(e,t){var r=t[e];return r===void 0?null:r}function nl(e){return{type:e}}function gc(e){return{result:"success",value:e}}function eu(e){return{result:"error",value:e}}function Hu(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Rc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Kl(e){return!!e.expression&&e.expression.interpolated}function wa(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Dc(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Mf(e){return e}function yc(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function zc(e,t,r,l,f){return yc(typeof r===f?l[r]:void 0,e.default,t.default)}function $l(e,t,r){if(wa(r)!=="number")return yc(e.default,t.default);var l=e.stops.length;if(l===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[l-1][0])return e.stops[l-1][1];var f=Xl(e.stops.map(function(m){return m[0]}),r);return e.stops[f][1]}function Zu(e,t,r){var l=e.base!==void 0?e.base:1;if(wa(r)!=="number")return yc(e.default,t.default);var f=e.stops.length;if(f===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[f-1][0])return e.stops[f-1][1];var m=Xl(e.stops.map(function(Ae){return Ae[0]}),r),A=function(Ae,Pe,ot,wt){var Tt=wt-ot,Wt=Ae-ot;return Tt===0?0:Pe===1?Wt/Tt:(Math.pow(Pe,Wt)-1)/(Math.pow(Pe,Tt)-1)}(r,l,e.stops[m][0],e.stops[m+1][0]),I=e.stops[m][1],U=e.stops[m+1][1],re=ml[t.type]||Mf;if(e.colorSpace&&e.colorSpace!=="rgb"){var he=Fs[e.colorSpace];re=function(Pe,ot){return he.reverse(he.interpolate(he.forward(Pe),he.forward(ot),A))}}return typeof I.evaluate=="function"?{evaluate:function(){for(var Pe=[],ot=arguments.length;ot--;)Pe[ot]=arguments[ot];var wt=I.evaluate.apply(void 0,Pe),Tt=U.evaluate.apply(void 0,Pe);if(wt!==void 0&&Tt!==void 0)return re(wt,Tt,A)}}:re(I,U,A)}function _u(e,t,r){return t.type==="color"?r=ci.parse(r):t.type==="formatted"?r=$a.fromString(r.toString()):t.type==="resolvedImage"?r=Ko.fromString(r.toString()):wa(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),yc(r,e.default,t.default)}_o.register(ps,{error:[{kind:"error"},[Tn],function(e,t){throw new Ja(t[0].evaluate(e))}],typeof:[Tn,[$r],function(e,t){return Di(Ca(t[0].evaluate(e)))}],"to-rgba":[wi(Er,4),[gn],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[gn,[Er,Er,Er],Lc],rgba:[gn,[Er,Er,Er,Er],Lc],has:{type:vn,overloads:[[[Tn],function(e,t){return mc(t[0].evaluate(e),e.properties())}],[[Tn,Ar],function(e,t){var r=t[1];return mc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:$r,overloads:[[[Tn],function(e,t){return yl(t[0].evaluate(e),e.properties())}],[[Tn,Ar],function(e,t){var r=t[1];return yl(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[$r,[Tn],function(e,t){return yl(t[0].evaluate(e),e.featureState||{})}],properties:[Ar,[],function(e){return e.properties()}],"geometry-type":[Tn,[],function(e){return e.geometryType()}],id:[$r,[],function(e){return e.id()}],zoom:[Er,[],function(e){return e.globals.zoom}],"heatmap-density":[Er,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Er,[],function(e){return e.globals.lineProgress||0}],accumulated:[$r,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Er,nl(Er),function(e,t){for(var r=0,l=0,f=t;l<f.length;l+=1)r+=f[l].evaluate(e);return r}],"*":[Er,nl(Er),function(e,t){for(var r=1,l=0,f=t;l<f.length;l+=1)r*=f[l].evaluate(e);return r}],"-":{type:Er,overloads:[[[Er,Er],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[Er],function(e,t){return-t[0].evaluate(e)}]]},"/":[Er,[Er,Er],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[Er,[Er,Er],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[Er,[],function(){return Math.LN2}],pi:[Er,[],function(){return Math.PI}],e:[Er,[],function(){return Math.E}],"^":[Er,[Er,Er],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[Er,[Er],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Er,[Er],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Er,[Er],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Er,[Er],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Er,[Er],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Er,[Er],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Er,[Er],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Er,[Er],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Er,[Er],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Er,[Er],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Er,nl(Er),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[Er,nl(Er),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[Er,[Er],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Er,[Er],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Er,[Er],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Er,[Er],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[vn,[Tn,$r],function(e,t){var r=t[0],l=t[1];return e.properties()[r.value]===l.value}],"filter-id-==":[vn,[$r],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[vn,[Tn],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[vn,[Tn,$r],function(e,t){var r=t[0],l=t[1],f=e.properties()[r.value],m=l.value;return typeof f==typeof m&&f<m}],"filter-id-<":[vn,[$r],function(e,t){var r=t[0],l=e.id(),f=r.value;return typeof l==typeof f&&l<f}],"filter->":[vn,[Tn,$r],function(e,t){var r=t[0],l=t[1],f=e.properties()[r.value],m=l.value;return typeof f==typeof m&&f>m}],"filter-id->":[vn,[$r],function(e,t){var r=t[0],l=e.id(),f=r.value;return typeof l==typeof f&&l>f}],"filter-<=":[vn,[Tn,$r],function(e,t){var r=t[0],l=t[1],f=e.properties()[r.value],m=l.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[vn,[$r],function(e,t){var r=t[0],l=e.id(),f=r.value;return typeof l==typeof f&&l<=f}],"filter->=":[vn,[Tn,$r],function(e,t){var r=t[0],l=t[1],f=e.properties()[r.value],m=l.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[vn,[$r],function(e,t){var r=t[0],l=e.id(),f=r.value;return typeof l==typeof f&&l>=f}],"filter-has":[vn,[$r],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[vn,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[vn,[wi(Tn)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[vn,[wi($r)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[vn,[Tn,wi($r)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[vn,[Tn,wi($r)],function(e,t){var r=t[0],l=t[1];return function(f,m,A,I){for(;A<=I;){var U=A+I>>1;if(m[U]===f)return!0;m[U]>f?I=U-1:A=U+1}return!1}(e.properties()[r.value],l.value,0,l.value.length-1)}],all:{type:vn,overloads:[[[vn,vn],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[nl(vn),function(e,t){for(var r=0,l=t;r<l.length;r+=1)if(!l[r].evaluate(e))return!1;return!0}]]},any:{type:vn,overloads:[[[vn,vn],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[nl(vn),function(e,t){for(var r=0,l=t;r<l.length;r+=1)if(l[r].evaluate(e))return!0;return!1}]]},"!":[vn,[vn],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[vn,[Tn],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[Tn,[Tn],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Tn,[Tn],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Tn,nl($r),function(e,t){return t.map(function(r){return ns(r.evaluate(e))}).join("")}],"resolved-locale":[Tn,[Mn],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Ol=function(t,r){this.expression=t,this._warningHistory={},this._evaluator=new Ks,this._defaultValue=r?function(l){return l.type==="color"&&Dc(l.default)?new ci(0,0,0,0):l.type==="color"?ci.parse(l.default)||null:l.default===void 0?null:l.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null};function Fo(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in ps}function Jl(e,t){var r=new lu(ps,[],t?function(f){var m={color:gn,string:Tn,number:Er,enum:Tn,boolean:vn,formatted:Xi,resolvedImage:vi};return f.type==="array"?wi(m[f.value]||$r,f.length):m[f.type]}(t):void 0),l=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?gc(new Ol(l,t)):eu(r.errors)}Ol.prototype.evaluateWithoutErrorHandling=function(e,t,r,l,f,m){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=l,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},Ol.prototype.evaluate=function(e,t,r,l,f,m){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=l,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null;try{var A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new Ja("Expected value to be one of "+Object.keys(this._enumValues).map(function(I){return JSON.stringify(I)}).join(", ")+", but found "+JSON.stringify(A)+" instead.");return A}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console!="undefined"&&console.warn(I.message)),this._defaultValue}};var Ll=function(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!uo(r.expression)};Ll.prototype.evaluateWithoutErrorHandling=function(e,t,r,l,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,l,f,m)},Ll.prototype.evaluate=function(e,t,r,l,f,m){return this._styleExpression.evaluate(e,t,r,l,f,m)};var xl=function(t,r,l,f){this.kind=t,this.zoomStops=l,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!uo(r.expression),this.interpolationType=f};function Nc(e,t){if((e=Jl(e,t)).result==="error")return e;var r=e.value.expression,l=zs(r);if(!l&&!Hu(t))return eu([new Fr("","data expressions not supported")]);var f=hs(r,["zoom"]);if(!f&&!Rc(t))return eu([new Fr("","zoom expressions not supported")]);var m=function A(I){var U=null;if(I instanceof ws)U=A(I.result);else if(I instanceof cu)for(var re=0,he=I.args;re<he.length&&!(U=A(he[re]));re+=1);else(I instanceof ya||I instanceof ha)&&I.input instanceof _o&&I.input.name==="zoom"&&(U=I);return U instanceof Fr||I.eachChild(function(Ae){var Pe=A(Ae);Pe instanceof Fr?U=Pe:!U&&Pe?U=new Fr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):U&&Pe&&U!==Pe&&(U=new Fr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),U}(r);return m||f?m instanceof Fr?eu([m]):m instanceof ha&&!Kl(t)?eu([new Fr("",'"interpolate" expressions cannot be used with this property')]):gc(m?new xl(l?"camera":"composite",e.value,m.labels,m instanceof ha?m.interpolation:void 0):new Ll(l?"constant":"source",e.value)):eu([new Fr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}xl.prototype.evaluateWithoutErrorHandling=function(e,t,r,l,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,l,f,m)},xl.prototype.evaluate=function(e,t,r,l,f,m){return this._styleExpression.evaluate(e,t,r,l,f,m)},xl.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?ha.interpolationFactor(this.interpolationType,e,t,r):0};var Rl=function(t,r){this._parameters=t,this._specification=r,jr(this,function l(f,m){var A,I,U,re=m.type==="color",he=f.stops&&typeof f.stops[0][0]=="object",Ae=he||!(he||f.property!==void 0),Pe=f.type||(Kl(m)?"exponential":"interval");if(re&&((f=jr({},f)).stops&&(f.stops=f.stops.map(function(Kn){return[Kn[0],ci.parse(Kn[1])]})),f.default=ci.parse(f.default?f.default:m.default)),f.colorSpace&&f.colorSpace!=="rgb"&&!Fs[f.colorSpace])throw new Error("Unknown color space: "+f.colorSpace);if(Pe==="exponential")A=Zu;else if(Pe==="interval")A=$l;else if(Pe==="categorical"){A=zc,I=Object.create(null);for(var ot=0,wt=f.stops;ot<wt.length;ot+=1){var Tt=wt[ot];I[Tt[0]]=Tt[1]}U=typeof f.stops[0][0]}else{if(Pe!=="identity")throw new Error('Unknown function type "'+Pe+'"');A=_u}if(he){for(var Wt={},Zt=[],nr=0;nr<f.stops.length;nr++){var dr=f.stops[nr],br=dr[0].zoom;Wt[br]===void 0&&(Wt[br]={zoom:br,type:f.type,property:f.property,default:f.default,stops:[]},Zt.push(br)),Wt[br].stops.push([dr[0].value,dr[1]])}for(var zr=[],Rr=0,pn=Zt;Rr<pn.length;Rr+=1){var hn=pn[Rr];zr.push([Wt[hn].zoom,l(Wt[hn],m)])}var Ln={name:"linear"};return{kind:"composite",interpolationType:Ln,interpolationFactor:ha.interpolationFactor.bind(void 0,Ln),zoomStops:zr.map(function(Kn){return Kn[0]}),evaluate:function(Nn,Si){var li=Nn.zoom;return Zu({stops:zr,base:f.base},m,li).evaluate(li,Si)}}}if(Ae){var Jn=Pe==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:Jn,interpolationFactor:ha.interpolationFactor.bind(void 0,Jn),zoomStops:f.stops.map(function(Kn){return Kn[0]}),evaluate:function(Nn){return A(f,m,Nn.zoom,I,U)}}}return{kind:"source",evaluate:function(Nn,Si){var li=Si&&Si.properties?Si.properties[f.property]:void 0;return li===void 0?yc(f.default,m.default):A(f,m,li,I,U)}}}(this._parameters,this._specification))};function tu(e){var t=e.key,r=e.value,l=e.valueSpec||{},f=e.objectElementValidators||{},m=e.style,A=e.styleSpec,I=[],U=wa(r);if(U!=="object")return[new Pt(t,r,"object expected, "+U+" found")];for(var re in r){var he=re.split(".")[0],Ae=l[he]||l["*"],Pe=void 0;if(f[he])Pe=f[he];else if(l[he])Pe=zi;else if(f["*"])Pe=f["*"];else{if(!l["*"]){I.push(new Pt(t,r[re],'unknown property "'+re+'"'));continue}Pe=zi}I=I.concat(Pe({key:(t&&t+".")+re,value:r[re],valueSpec:Ae,style:m,styleSpec:A,object:r,objectKey:re},r))}for(var ot in l)f[ot]||l[ot].required&&l[ot].default===void 0&&r[ot]===void 0&&I.push(new Pt(t,r,'missing required property "'+ot+'"'));return I}function mf(e){var t=e.value,r=e.valueSpec,l=e.style,f=e.styleSpec,m=e.key,A=e.arrayElementValidator||zi;if(wa(t)!=="array")return[new Pt(m,t,"array expected, "+wa(t)+" found")];if(r.length&&t.length!==r.length)return[new Pt(m,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Pt(m,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var I={type:r.value,values:r.values};f.$version<7&&(I.function=r.function),wa(r.value)==="object"&&(I=r.value);for(var U=[],re=0;re<t.length;re++)U=U.concat(A({array:t,arrayIndex:re,value:t[re],valueSpec:I,style:l,styleSpec:f,key:m+"["+re+"]"}));return U}function gf(e){var t=e.key,r=e.value,l=e.valueSpec,f=wa(r);return f==="number"&&r!=r&&(f="NaN"),f!=="number"?[new Pt(t,r,"number expected, "+f+" found")]:"minimum"in l&&r<l.minimum?[new Pt(t,r,r+" is less than the minimum value "+l.minimum)]:"maximum"in l&&r>l.maximum?[new Pt(t,r,r+" is greater than the maximum value "+l.maximum)]:[]}function rf(e){var t,r,l,f=e.valueSpec,m=Hr(e.value.type),A={},I=m!=="categorical"&&e.value.property===void 0,U=!I,re=wa(e.value.stops)==="array"&&wa(e.value.stops[0])==="array"&&wa(e.value.stops[0][0])==="object",he=tu({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(wt){if(m==="identity")return[new Pt(wt.key,wt.value,'identity function may not have a "stops" property')];var Tt=[],Wt=wt.value;return Tt=Tt.concat(mf({key:wt.key,value:Wt,valueSpec:wt.valueSpec,style:wt.style,styleSpec:wt.styleSpec,arrayElementValidator:Ae})),wa(Wt)==="array"&&Wt.length===0&&Tt.push(new Pt(wt.key,Wt,"array must have at least one stop")),Tt},default:function(wt){return zi({key:wt.key,value:wt.value,valueSpec:f,style:wt.style,styleSpec:wt.styleSpec})}}});return m==="identity"&&I&&he.push(new Pt(e.key,e.value,'missing required property "property"')),m==="identity"||e.value.stops||he.push(new Pt(e.key,e.value,'missing required property "stops"')),m==="exponential"&&e.valueSpec.expression&&!Kl(e.valueSpec)&&he.push(new Pt(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(U&&!Hu(e.valueSpec)?he.push(new Pt(e.key,e.value,"property functions not supported")):I&&!Rc(e.valueSpec)&&he.push(new Pt(e.key,e.value,"zoom functions not supported"))),m!=="categorical"&&!re||e.value.property!==void 0||he.push(new Pt(e.key,e.value,'"property" property is required')),he;function Ae(ot){var wt=[],Tt=ot.value,Wt=ot.key;if(wa(Tt)!=="array")return[new Pt(Wt,Tt,"array expected, "+wa(Tt)+" found")];if(Tt.length!==2)return[new Pt(Wt,Tt,"array length 2 expected, length "+Tt.length+" found")];if(re){if(wa(Tt[0])!=="object")return[new Pt(Wt,Tt,"object expected, "+wa(Tt[0])+" found")];if(Tt[0].zoom===void 0)return[new Pt(Wt,Tt,"object stop key must have zoom")];if(Tt[0].value===void 0)return[new Pt(Wt,Tt,"object stop key must have value")];if(l&&l>Hr(Tt[0].zoom))return[new Pt(Wt,Tt[0].zoom,"stop zoom values must appear in ascending order")];Hr(Tt[0].zoom)!==l&&(l=Hr(Tt[0].zoom),r=void 0,A={}),wt=wt.concat(tu({key:Wt+"[0]",value:Tt[0],valueSpec:{zoom:{}},style:ot.style,styleSpec:ot.styleSpec,objectElementValidators:{zoom:gf,value:Pe}}))}else wt=wt.concat(Pe({key:Wt+"[0]",value:Tt[0],valueSpec:{},style:ot.style,styleSpec:ot.styleSpec},Tt));return Fo(sr(Tt[1]))?wt.concat([new Pt(Wt+"[1]",Tt[1],"expressions are not allowed in function stops.")]):wt.concat(zi({key:Wt+"[1]",value:Tt[1],valueSpec:f,style:ot.style,styleSpec:ot.styleSpec}))}function Pe(ot,wt){var Tt=wa(ot.value),Wt=Hr(ot.value),Zt=ot.value!==null?ot.value:wt;if(t){if(Tt!==t)return[new Pt(ot.key,Zt,Tt+" stop domain type must match previous stop domain type "+t)]}else t=Tt;if(Tt!=="number"&&Tt!=="string"&&Tt!=="boolean")return[new Pt(ot.key,Zt,"stop domain value must be a number, string, or boolean")];if(Tt!=="number"&&m!=="categorical"){var nr="number expected, "+Tt+" found";return Hu(f)&&m===void 0&&(nr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Pt(ot.key,Zt,nr)]}return m!=="categorical"||Tt!=="number"||isFinite(Wt)&&Math.floor(Wt)===Wt?m!=="categorical"&&Tt==="number"&&r!==void 0&&Wt<r?[new Pt(ot.key,Zt,"stop domain values must appear in ascending order")]:(r=Wt,m==="categorical"&&Wt in A?[new Pt(ot.key,Zt,"stop domain values must be unique")]:(A[Wt]=!0,[])):[new Pt(ot.key,Zt,"integer expected, found "+Wt)]}}function bl(e){var t=(e.expressionContext==="property"?Nc:Jl)(sr(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new Pt(""+e.key+l.key,e.value,l.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new Pt(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!uo(r))return[new Pt(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!uo(r))return[new Pt(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!hs(r,["zoom","feature-state"]))return[new Pt(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!zs(r))return[new Pt(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Fa(e){var t=e.key,r=e.value,l=e.valueSpec,f=[];return Array.isArray(l.values)?l.values.indexOf(Hr(r))===-1&&f.push(new Pt(t,r,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(l.values).indexOf(Hr(r))===-1&&f.push(new Pt(t,r,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(r)+" found")),f}function il(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var l=r[t];if(!il(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}Rl.deserialize=function(e){return new Rl(e._parameters,e._specification)},Rl.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Dl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function xc(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};il(e)||(e=zl(e));var t=Jl(e,Dl);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(l,f,m){return t.value.evaluate(l,f,{},m)},needGeometry:function r(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var f=1;f<l.length;f++)if(r(l[f]))return!0;return!1}(e)}}function Fc(e,t){return e<t?-1:e>t?1:0}function zl(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?If(e[1],e[2],"=="):r==="!="?Sl(If(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?If(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(zl))):r==="all"?["all"].concat(e.slice(1).map(zl)):r==="none"?["all"].concat(e.slice(1).map(zl).map(Sl)):r==="in"?Of(e[1],e.slice(2)):r==="!in"?Sl(Of(e[1],e.slice(2))):r==="has"?nf(e[1]):r==="!has"?Sl(nf(e[1])):r!=="within"||e}function If(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function Of(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Fc)]]:["filter-in-small",e,["literal",t]]}}function nf(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Sl(e){return["!",e]}function Ql(e){return il(sr(e.value))?bl(jr({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var l=r.value,f=r.key;if(wa(l)!=="array")return[new Pt(f,l,"array expected, "+wa(l)+" found")];var m,A=r.styleSpec,I=[];if(l.length<1)return[new Pt(f,l,"filter array must have at least 1 element")];switch(I=I.concat(Fa({key:f+"[0]",value:l[0],valueSpec:A.filter_operator,style:r.style,styleSpec:r.styleSpec})),Hr(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Hr(l[1])==="$type"&&I.push(new Pt(f,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&I.push(new Pt(f,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(m=wa(l[1]))!=="string"&&I.push(new Pt(f+"[1]",l[1],"string expected, "+m+" found"));for(var U=2;U<l.length;U++)m=wa(l[U]),Hr(l[1])==="$type"?I=I.concat(Fa({key:f+"["+U+"]",value:l[U],valueSpec:A.geometry_type,style:r.style,styleSpec:r.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&I.push(new Pt(f+"["+U+"]",l[U],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var re=1;re<l.length;re++)I=I.concat(t({key:f+"["+re+"]",value:l[re],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":m=wa(l[1]),l.length!==2?I.push(new Pt(f,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="string"&&I.push(new Pt(f+"[1]",l[1],"string expected, "+m+" found"));break;case"within":m=wa(l[1]),l.length!==2?I.push(new Pt(f,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="object"&&I.push(new Pt(f+"[1]",l[1],"object expected, "+m+" found"))}return I}(e)}function Cu(e,t){var r=e.key,l=e.style,f=e.styleSpec,m=e.value,A=e.objectKey,I=f[t+"_"+e.layerType];if(!I)return[];var U=A.match(/^(.*)-transition$/);if(t==="paint"&&U&&I[U[1]]&&I[U[1]].transition)return zi({key:r,value:m,valueSpec:f.transition,style:l,styleSpec:f});var re,he=e.valueSpec||I[A];if(!he)return[new Pt(r,m,'unknown property "'+A+'"')];if(wa(m)==="string"&&Hu(he)&&!he.tokens&&(re=/^{([^}]+)}$/.exec(m)))return[new Pt(r,m,'"'+A+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(re[1])+" }`.")];var Ae=[];return e.layerType==="symbol"&&(A==="text-field"&&l&&!l.glyphs&&Ae.push(new Pt(r,m,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&Dc(sr(m))&&Hr(m.type)==="identity"&&Ae.push(new Pt(r,m,'"text-font" does not support identity functions'))),Ae.concat(zi({key:e.key,value:m,valueSpec:he,style:l,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:A}))}function Bs(e){return Cu(e,"paint")}function al(e){return Cu(e,"layout")}function Bc(e){var t=[],r=e.value,l=e.key,f=e.style,m=e.styleSpec;r.type||r.ref||t.push(new Pt(l,r,'either "type" or "ref" is required'));var A,I=Hr(r.type),U=Hr(r.ref);if(r.id)for(var re=Hr(r.id),he=0;he<e.arrayIndex;he++){var Ae=f.layers[he];Hr(Ae.id)===re&&t.push(new Pt(l,r.id,'duplicate layer id "'+r.id+'", previously used at line '+Ae.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(wt){wt in r&&t.push(new Pt(l,r[wt],'"'+wt+'" is prohibited for ref layers'))}),f.layers.forEach(function(wt){Hr(wt.id)===U&&(A=wt)}),A?A.ref?t.push(new Pt(l,r.ref,"ref cannot reference another ref layer")):I=Hr(A.type):t.push(new Pt(l,r.ref,'ref layer "'+U+'" not found'));else if(I!=="background")if(r.source){var Pe=f.sources&&f.sources[r.source],ot=Pe&&Hr(Pe.type);Pe?ot==="vector"&&I==="raster"?t.push(new Pt(l,r.source,'layer "'+r.id+'" requires a raster source')):ot==="raster"&&I!=="raster"?t.push(new Pt(l,r.source,'layer "'+r.id+'" requires a vector source')):ot!=="vector"||r["source-layer"]?ot==="raster-dem"&&I!=="hillshade"?t.push(new Pt(l,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):I!=="line"||!r.paint||!r.paint["line-gradient"]||ot==="geojson"&&Pe.lineMetrics||t.push(new Pt(l,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Pt(l,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Pt(l,r.source,'source "'+r.source+'" not found'))}else t.push(new Pt(l,r,'missing required property "source"'));return t=t.concat(tu({key:l,value:r,valueSpec:m.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return zi({key:l+".type",value:r.type,valueSpec:m.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:Ql,layout:function(Tt){return tu({layer:r,key:Tt.key,value:Tt.value,style:Tt.style,styleSpec:Tt.styleSpec,objectElementValidators:{"*":function(Zt){return al(jr({layerType:I},Zt))}}})},paint:function(Tt){return tu({layer:r,key:Tt.key,value:Tt.value,style:Tt.style,styleSpec:Tt.styleSpec,objectElementValidators:{"*":function(Zt){return Bs(jr({layerType:I},Zt))}}})}}}))}function Wu(e){var t=e.value,r=e.key,l=wa(t);return l!=="string"?[new Pt(r,t,"string expected, "+l+" found")]:[]}var Ba={promoteId:function(t){var r=t.key,l=t.value;if(wa(l)==="string")return Wu({key:r,value:l});var f=[];for(var m in l)f.push.apply(f,Wu({key:r+"."+m,value:l[m]}));return f}};function du(e){var t=e.value,r=e.key,l=e.styleSpec,f=e.style;if(!t.type)return[new Pt(r,t,'"type" is required')];var m,A=Hr(t.type);switch(A){case"vector":case"raster":case"raster-dem":return tu({key:r,value:t,valueSpec:l["source_"+A.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Ba});case"geojson":if(m=tu({key:r,value:t,valueSpec:l.source_geojson,style:f,styleSpec:l,objectElementValidators:Ba}),t.cluster)for(var I in t.clusterProperties){var U=t.clusterProperties[I],re=U[0],he=typeof re=="string"?[re,["accumulated"],["get",I]]:re;m.push.apply(m,bl({key:r+"."+I+".map",value:U[1],expressionContext:"cluster-map"})),m.push.apply(m,bl({key:r+"."+I+".reduce",value:he,expressionContext:"cluster-reduce"}))}return m;case"video":return tu({key:r,value:t,valueSpec:l.source_video,style:f,styleSpec:l});case"image":return tu({key:r,value:t,valueSpec:l.source_image,style:f,styleSpec:l});case"canvas":return[new Pt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Fa({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:l})}}function ol(e){var t=e.value,r=e.styleSpec,l=r.light,f=e.style,m=[],A=wa(t);if(t===void 0)return m;if(A!=="object")return m.concat([new Pt("light",t,"object expected, "+A+" found")]);for(var I in t){var U=I.match(/^(.*)-transition$/);m=m.concat(U&&l[U[1]]&&l[U[1]].transition?zi({key:I,value:t[I],valueSpec:r.transition,style:f,styleSpec:r}):l[I]?zi({key:I,value:t[I],valueSpec:l[I],style:f,styleSpec:r}):[new Pt(I,t[I],'unknown property "'+I+'"')])}return m}var sl={"*":function(){return[]},array:mf,boolean:function(t){var r=t.value,l=t.key,f=wa(r);return f!=="boolean"?[new Pt(l,r,"boolean expected, "+f+" found")]:[]},number:gf,color:function(t){var r=t.key,l=t.value,f=wa(l);return f!=="string"?[new Pt(r,l,"color expected, "+f+" found")]:gi(l)===null?[new Pt(r,l,'color expected, "'+l+'" found')]:[]},constants:or,enum:Fa,filter:Ql,function:rf,layer:Bc,object:tu,source:du,light:ol,string:Wu,formatted:function(t){return Wu(t).length===0?[]:bl(t)},resolvedImage:function(t){return Wu(t).length===0?[]:bl(t)}};function zi(e){var t=e.value,r=e.valueSpec,l=e.styleSpec;return r.expression&&Dc(Hr(t))?rf(e):r.expression&&Fo(sr(t))?bl(e):r.type&&sl[r.type]?sl[r.type](e):tu(jr({},e,{valueSpec:r.type?l[r.type]:r}))}function pa(e){var t=e.value,r=e.key,l=Wu(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new Pt(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new Pt(r,t,'"glyphs" url must include a "{range}" token'))),l}function Ps(e,t){t===void 0&&(t=He);var r=[];return r=r.concat(zi({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:pa,"*":function(){return[]}}})),e.constants&&(r=r.concat(or({key:"constants",value:e.constants,style:e,styleSpec:t}))),Sa(r)}function Sa(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function Gi(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Sa(e.apply(this,t))}}Ps.source=Gi(du),Ps.light=Gi(ol),Ps.layer=Gi(Bc),Ps.filter=Gi(Ql),Ps.paintProperty=Gi(Bs),Ps.layoutProperty=Gi(al);var ql=Ps,yf=ql.light,as=ql.paintProperty,ul=ql.layoutProperty;function pu(e,t){var r=!1;if(t&&t.length)for(var l=0,f=t;l<f.length;l+=1)e.fire(new At(new Error(f[l].message))),r=!0;return r}var Xu=io;function io(e,t,r){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(r=f[2]);for(var m=0;m<this.d*this.d;m++){var A=f[3+m],I=f[3+m+1];l.push(A===I?null:f.subarray(A,I))}var U=f[3+l.length+1];this.keys=f.subarray(f[3+l.length],U),this.bboxes=f.subarray(U),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var re=0;re<this.d*this.d;re++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var he=r/t*e;this.min=-he,this.max=e+he}io.prototype.insert=function(e,t,r,l,f){this._forEachCell(t,r,l,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(f)},io.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},io.prototype._insertCell=function(e,t,r,l,f,m){this.cells[f].push(m)},io.prototype.query=function(e,t,r,l,f){var m=this.min,A=this.max;if(e<=m&&t<=m&&A<=r&&A<=l&&!f)return Array.prototype.slice.call(this.keys);var I=[];return this._forEachCell(e,t,r,l,this._queryCell,I,{},f),I},io.prototype._queryCell=function(e,t,r,l,f,m,A,I){var U=this.cells[f];if(U!==null)for(var re=this.keys,he=this.bboxes,Ae=0;Ae<U.length;Ae++){var Pe=U[Ae];if(A[Pe]===void 0){var ot=4*Pe;(I?I(he[ot+0],he[ot+1],he[ot+2],he[ot+3]):e<=he[ot+2]&&t<=he[ot+3]&&r>=he[ot+0]&&l>=he[ot+1])?(A[Pe]=!0,m.push(re[Pe])):A[Pe]=!1}}},io.prototype._forEachCell=function(e,t,r,l,f,m,A,I){for(var U=this._convertToCellCoord(e),re=this._convertToCellCoord(t),he=this._convertToCellCoord(r),Ae=this._convertToCellCoord(l),Pe=U;Pe<=he;Pe++)for(var ot=re;ot<=Ae;ot++){var wt=this.d*ot+Pe;if((!I||I(this._convertFromCellCoord(Pe),this._convertFromCellCoord(ot),this._convertFromCellCoord(Pe+1),this._convertFromCellCoord(ot+1)))&&f.call(this,e,t,r,l,wt,m,A,I))return}},io.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},io.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},io.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,l=0;l<this.cells.length;l++)r+=this.cells[l].length;var f=new Int32Array(t+r+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var m=t,A=0;A<e.length;A++){var I=e[A];f[3+A]=m,f.set(I,m),m+=I.length}return f[3+e.length]=m,f.set(this.keys,m),f[3+e.length+1]=m+=this.keys.length,f.set(this.bboxes,m),m+=this.bboxes.length,f.buffer};var os=Y.ImageData,Nl=Y.ImageBitmap,lo={};function In(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),lo[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var ks in In("Object",Object),Xu.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},Xu.deserialize=function(e){return new Xu(e.buffer)},In("Grid",Xu),In("Color",ci),In("Error",Error),In("ResolvedImage",Ko),In("StylePropertyFunction",Rl),In("StyleExpression",Ol,{omit:["_evaluator"]}),In("ZoomDependentExpression",xl),In("ZoomConstantExpression",Ll),In("CompoundExpression",_o,{omit:["_evaluate"]}),ps)ps[ks]._classRegistryKey||In("Expression_"+ks,ps[ks]);function bc(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function El(e){return Nl&&e instanceof Nl}function wu(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(bc(e)||El(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof os)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],f=0,m=e;f<m.length;f+=1)l.push(wu(m[f],t));return l}if(typeof e=="object"){var A=e.constructor,I=A._classRegistryKey;if(!I)throw new Error("can't serialize object of unregistered class");var U=A.serialize?A.serialize(e,t):{};if(!A.serialize){for(var re in e)if(e.hasOwnProperty(re)&&!(lo[I].omit.indexOf(re)>=0)){var he=e[re];U[re]=lo[I].shallow.indexOf(re)>=0?he:wu(he,t)}e instanceof Error&&(U.message=e.message)}if(U.$name)throw new Error("$name property is reserved for worker serialization logic.");return I!=="Object"&&(U.$name=I),U}throw new Error("can't serialize object of type "+typeof e)}function js(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||bc(e)||El(e)||ArrayBuffer.isView(e)||e instanceof os)return e;if(Array.isArray(e))return e.map(js);if(typeof e=="object"){var t=e.$name||"Object",r=lo[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var l=Object.create(r.prototype),f=0,m=Object.keys(e);f<m.length;f+=1){var A=m[f];if(A!=="$name"){var I=e[A];l[A]=lo[t].shallow.indexOf(A)>=0?I:js(I)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var qi=function(){this.first=!0};qi.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var qr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function kc(e){for(var t=0,r=e;t<r.length;t+=1)if(Sc(r[t].charCodeAt(0)))return!0;return!1}function Sc(e){return!(e!==746&&e!==747&&(e<4352||!(qr["Bopomofo Extended"](e)||qr.Bopomofo(e)||qr["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||qr["CJK Compatibility Ideographs"](e)||qr["CJK Compatibility"](e)||qr["CJK Radicals Supplement"](e)||qr["CJK Strokes"](e)||!(!qr["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||qr["CJK Unified Ideographs Extension A"](e)||qr["CJK Unified Ideographs"](e)||qr["Enclosed CJK Letters and Months"](e)||qr["Hangul Compatibility Jamo"](e)||qr["Hangul Jamo Extended-A"](e)||qr["Hangul Jamo Extended-B"](e)||qr["Hangul Jamo"](e)||qr["Hangul Syllables"](e)||qr.Hiragana(e)||qr["Ideographic Description Characters"](e)||qr.Kanbun(e)||qr["Kangxi Radicals"](e)||qr["Katakana Phonetic Extensions"](e)||qr.Katakana(e)&&e!==12540||!(!qr["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!qr["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||qr["Unified Canadian Aboriginal Syllabics"](e)||qr["Unified Canadian Aboriginal Syllabics Extended"](e)||qr["Vertical Forms"](e)||qr["Yijing Hexagram Symbols"](e)||qr["Yi Syllables"](e)||qr["Yi Radicals"](e))))}function ll(e){return!(Sc(e)||function(t){return!!(qr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||qr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||qr["Letterlike Symbols"](t)||qr["Number Forms"](t)||qr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||qr["Control Pictures"](t)&&t!==9251||qr["Optical Character Recognition"](t)||qr["Enclosed Alphanumerics"](t)||qr["Geometric Shapes"](t)||qr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||qr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||qr["CJK Symbols and Punctuation"](t)||qr.Katakana(t)||qr["Private Use Area"](t)||qr["CJK Compatibility Forms"](t)||qr["Small Form Variants"](t)||qr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function vu(e){return e>=1424&&e<=2303||qr["Arabic Presentation Forms-A"](e)||qr["Arabic Presentation Forms-B"](e)}function Ms(e,t){return!(!t&&vu(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||qr.Khmer(e))}function Is(e){for(var t=0,r=e;t<r.length;t+=1)if(vu(r[t].charCodeAt(0)))return!0;return!1}var $o=null,Bo="unavailable",cl=null,Tl=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Bo="error"),$o&&$o(t)};function Fl(){af.fire(new at("pluginStateChange",{pluginStatus:Bo,pluginURL:cl}))}var af=new Ft,Bl=function(){return Bo},Os=function(){if(Bo!=="deferred"||!cl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Bo="loading",Fl(),cl&&Zn({url:cl},function(t){t?Tl(t):(Bo="loaded",Fl())})},ss={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Bo==="loaded"||ss.applyArabicShaping!=null},isLoading:function(){return Bo==="loading"},setState:function(t){Bo=t.pluginStatus,cl=t.pluginURL},isParsed:function(){return ss.applyArabicShaping!=null&&ss.processBidirectionalText!=null&&ss.processStyledBidirectionalText!=null},getPluginURL:function(){return cl}},Mi=function(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new qi,this.transition={})};Mi.prototype.isSupportedScript=function(e){return function(t,r){for(var l=0,f=t;l<f.length;l+=1)if(!Ms(f[l].charCodeAt(0),r))return!1;return!0}(e,ss.isLoaded())},Mi.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Mi.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var Yu=function(t,r){this.property=t,this.value=r,this.expression=function(l,f){if(Dc(l))return new Rl(l,f);if(Fo(l)){var m=Nc(l,f);if(m.result==="error")throw new Error(m.value.map(function(I){return I.key+": "+I.message}).join(", "));return m.value}var A=l;return typeof l=="string"&&f.type==="color"&&(A=ci.parse(l)),{kind:"constant",evaluate:function(){return A}}}(r===void 0?t.specification.default:r,t.specification)};Yu.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Yu.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var ka=function(t){this.property=t,this.value=new Yu(t,void 0)};ka.prototype.transitioned=function(e,t){return new Al(this.property,this.value,t,Le({},e.transition,this.transition),e.now)},ka.prototype.untransitioned=function(){return new Al(this.property,this.value,null,{},0)};var wo=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};wo.prototype.getValue=function(e){return Ue(this._values[e].value.value)},wo.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new ka(this._values[e].property)),this._values[e].value=new Yu(this._values[e].property,t===null?void 0:Ue(t))},wo.prototype.getTransition=function(e){return Ue(this._values[e].transition)},wo.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new ka(this._values[e].property)),this._values[e].transition=Ue(t)||void 0},wo.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var l=r[t],f=this.getValue(l);f!==void 0&&(e[l]=f);var m=this.getTransition(l);m!==void 0&&(e[l+"-transition"]=m)}return e},wo.prototype.transitioned=function(e,t){for(var r=new mu(this._properties),l=0,f=Object.keys(this._values);l<f.length;l+=1){var m=f[l];r._values[m]=this._values[m].transitioned(e,t._values[m])}return r},wo.prototype.untransitioned=function(){for(var e=new mu(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var l=r[t];e._values[l]=this._values[l].untransitioned()}return e};var Al=function(t,r,l,f,m){this.property=t,this.value=r,this.begin=m+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=l)};Al.prototype.possiblyEvaluate=function(e,t,r){var l=e.now||0,f=this.value.possiblyEvaluate(e,t,r),m=this.prior;if(m){if(l>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(l<this.begin)return m.possiblyEvaluate(e,t,r);var A=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,t,r),f,function(I){if(I<=0)return 0;if(I>=1)return 1;var U=I*I,re=U*I;return 4*(I<.5?re:3*(I-U)+re-.75)}(A))}return f};var mu=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};mu.prototype.possiblyEvaluate=function(e,t,r){for(var l=new Ec(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var A=m[f];l._values[A]=this._values[A].possiblyEvaluate(e,t,r)}return l},mu.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var gu=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};gu.prototype.getValue=function(e){return Ue(this._values[e].value)},gu.prototype.setValue=function(e,t){this._values[e]=new Yu(this._values[e].property,t===null?void 0:Ue(t))},gu.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var l=r[t],f=this.getValue(l);f!==void 0&&(e[l]=f)}return e},gu.prototype.possiblyEvaluate=function(e,t,r){for(var l=new Ec(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var A=m[f];l._values[A]=this._values[A].possiblyEvaluate(e,t,r)}return l};var Es=function(t,r,l){this.property=t,this.value=r,this.parameters=l};Es.prototype.isConstant=function(){return this.value.kind==="constant"},Es.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Es.prototype.evaluate=function(e,t,r,l){return this.property.evaluate(this.value,this.parameters,e,t,r,l)};var Ec=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Ec.prototype.get=function(e){return this._values[e]};var $n=function(t){this.specification=t};$n.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},$n.prototype.interpolate=function(e,t,r){var l=ml[this.specification.type];return l?l(e,t,r):e};var Fn=function(t,r){this.specification=t,this.overrides=r};Fn.prototype.possiblyEvaluate=function(e,t,r,l){return new Es(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,l)}:e.expression,t)},Fn.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Es(this,{kind:"constant",value:void 0},e.parameters);var l=ml[this.specification.type];return l?new Es(this,{kind:"constant",value:l(e.value.value,t.value.value,r)},e.parameters):e},Fn.prototype.evaluate=function(e,t,r,l,f,m){return e.kind==="constant"?e.value:e.evaluate(t,r,l,f,m)};var Tc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,l,f,m){if(r.value===void 0)return new Es(this,{kind:"constant",value:void 0},l);if(r.expression.kind==="constant"){var A=r.expression.evaluate(l,null,{},f,m),I=r.property.specification.type==="resolvedImage"&&typeof A!="string"?A.name:A,U=this._calculate(I,I,I,l);return new Es(this,{kind:"constant",value:U},l)}if(r.expression.kind==="camera"){var re=this._calculate(r.expression.evaluate({zoom:l.zoom-1}),r.expression.evaluate({zoom:l.zoom}),r.expression.evaluate({zoom:l.zoom+1}),l);return new Es(this,{kind:"constant",value:re},l)}return new Es(this,r.expression,l)},t.prototype.evaluate=function(r,l,f,m,A,I){if(r.kind==="source"){var U=r.evaluate(l,f,m,A,I);return this._calculate(U,U,U,l)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(l.zoom)-1},f,m),r.evaluate({zoom:Math.floor(l.zoom)},f,m),r.evaluate({zoom:Math.floor(l.zoom)+1},f,m),l):r.value},t.prototype._calculate=function(r,l,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:r,to:l}:{from:f,to:l}},t.prototype.interpolate=function(r){return r},t}(Fn),vs=function(t){this.specification=t};vs.prototype.possiblyEvaluate=function(e,t,r,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},r,l);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new Mi(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Mi(Math.floor(t.zoom),t)),e.expression.evaluate(new Mi(Math.floor(t.zoom+1),t)),t)}},vs.prototype._calculate=function(e,t,r,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},vs.prototype.interpolate=function(e){return e};var ko=function(t){this.specification=t};ko.prototype.possiblyEvaluate=function(e,t,r,l){return!!e.expression.evaluate(t,null,{},r,l)},ko.prototype.interpolate=function(){return!1};var Po=function(t){for(var r in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var l=t[r];l.specification.overridable&&this.overridableProperties.push(r);var f=this.defaultPropertyValues[r]=new Yu(l,void 0),m=this.defaultTransitionablePropertyValues[r]=new ka(l);this.defaultTransitioningPropertyValues[r]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=f.possiblyEvaluate({})}};In("DataDrivenProperty",Fn),In("DataConstantProperty",$n),In("CrossFadedDataDrivenProperty",Tc),In("CrossFadedProperty",vs),In("ColorRampProperty",ko);var ru=function(e){function t(r,l){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),l.layout&&(this._unevaluatedLayout=new gu(l.layout)),l.paint)){for(var f in this._transitionablePaint=new wo(l.paint),r.paint)this.setPaintProperty(f,r.paint[f],{validate:!1});for(var m in r.layout)this.setLayoutProperty(m,r.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ec(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,l,f){f===void 0&&(f={}),l!=null&&this._validate(ul,"layers."+this.id+".layout."+r,r,l,f)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,l):this.visibility=l)},t.prototype.getPaintProperty=function(r){return bt(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,l,f){if(f===void 0&&(f={}),l!=null&&this._validate(as,"layers."+this.id+".paint."+r,r,l,f))return!1;if(bt(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),l||void 0),!1;var m=this._transitionablePaint._values[r],A=m.property.specification["property-type"]==="cross-faded-data-driven",I=m.value.isDataDriven(),U=m.value;this._transitionablePaint.setValue(r,l),this._handleSpecialPaintPropertyUpdate(r);var re=this._transitionablePaint._values[r].value;return re.isDataDriven()||I||A||this._handleOverridablePaintPropertyUpdate(r,U,re)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,l,f){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,l){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,l)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),ze(r,function(l,f){return!(l===void 0||f==="layout"&&!Object.keys(l).length||f==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(r,l,f,m,A){return A===void 0&&(A={}),(!A||A.validate!==!1)&&pu(this,r.call(ql,{key:l,layerType:this.type,objectKey:f,value:m,styleSpec:He,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var l=this.paint.get(r);if(l instanceof Es&&Hu(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(Ft),Pu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},ec=function(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Hi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Za(e,t){t===void 0&&(t=1);var r=0,l=0;return{members:e.map(function(f){var m=Pu[f.type].BYTES_PER_ELEMENT,A=r=fl(r,Math.max(t,m)),I=f.components||1;return l=Math.max(l,m),r+=m*I,{name:f.name,type:f.type,components:I,offset:A}}),size:fl(r,Math.max(l,t)),alignment:t}}function fl(e,t){return Math.ceil(e/t)*t}Hi.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Hi.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Hi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Hi.prototype.clear=function(){this.length=0},Hi.prototype.resize=function(e){this.reserve(e),this.length=e},Hi.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Hi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var hl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l){var f=this.length;return this.resize(f+1),this.emplace(f,r,l)},t.prototype.emplace=function(r,l,f){var m=2*r;return this.int16[m+0]=l,this.int16[m+1]=f,r},t}(Hi);hl.prototype.bytesPerElement=4,In("StructArrayLayout2i4",hl);var tc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m){var A=this.length;return this.resize(A+1),this.emplace(A,r,l,f,m)},t.prototype.emplace=function(r,l,f,m,A){var I=4*r;return this.int16[I+0]=l,this.int16[I+1]=f,this.int16[I+2]=m,this.int16[I+3]=A,r},t}(Hi);tc.prototype.bytesPerElement=8,In("StructArrayLayout4i8",tc);var Mu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I){var U=this.length;return this.resize(U+1),this.emplace(U,r,l,f,m,A,I)},t.prototype.emplace=function(r,l,f,m,A,I,U){var re=6*r;return this.int16[re+0]=l,this.int16[re+1]=f,this.int16[re+2]=m,this.int16[re+3]=A,this.int16[re+4]=I,this.int16[re+5]=U,r},t}(Hi);Mu.prototype.bytesPerElement=12,In("StructArrayLayout2i4i12",Mu);var Ls=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I){var U=this.length;return this.resize(U+1),this.emplace(U,r,l,f,m,A,I)},t.prototype.emplace=function(r,l,f,m,A,I,U){var re=4*r,he=8*r;return this.int16[re+0]=l,this.int16[re+1]=f,this.uint8[he+4]=m,this.uint8[he+5]=A,this.uint8[he+6]=I,this.uint8[he+7]=U,r},t}(Hi);Ls.prototype.bytesPerElement=8,In("StructArrayLayout2i4ub8",Ls);var kl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l){var f=this.length;return this.resize(f+1),this.emplace(f,r,l)},t.prototype.emplace=function(r,l,f){var m=2*r;return this.float32[m+0]=l,this.float32[m+1]=f,r},t}(Hi);kl.prototype.bytesPerElement=8,In("StructArrayLayout2f8",kl);var ms=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I,U,re,he,Ae){var Pe=this.length;return this.resize(Pe+1),this.emplace(Pe,r,l,f,m,A,I,U,re,he,Ae)},t.prototype.emplace=function(r,l,f,m,A,I,U,re,he,Ae,Pe){var ot=10*r;return this.uint16[ot+0]=l,this.uint16[ot+1]=f,this.uint16[ot+2]=m,this.uint16[ot+3]=A,this.uint16[ot+4]=I,this.uint16[ot+5]=U,this.uint16[ot+6]=re,this.uint16[ot+7]=he,this.uint16[ot+8]=Ae,this.uint16[ot+9]=Pe,r},t}(Hi);ms.prototype.bytesPerElement=20,In("StructArrayLayout10ui20",ms);var xf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I,U,re,he,Ae,Pe,ot){var wt=this.length;return this.resize(wt+1),this.emplace(wt,r,l,f,m,A,I,U,re,he,Ae,Pe,ot)},t.prototype.emplace=function(r,l,f,m,A,I,U,re,he,Ae,Pe,ot,wt){var Tt=12*r;return this.int16[Tt+0]=l,this.int16[Tt+1]=f,this.int16[Tt+2]=m,this.int16[Tt+3]=A,this.uint16[Tt+4]=I,this.uint16[Tt+5]=U,this.uint16[Tt+6]=re,this.uint16[Tt+7]=he,this.int16[Tt+8]=Ae,this.int16[Tt+9]=Pe,this.int16[Tt+10]=ot,this.int16[Tt+11]=wt,r},t}(Hi);xf.prototype.bytesPerElement=24,In("StructArrayLayout4i4ui4i24",xf);var jl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,l,f)},t.prototype.emplace=function(r,l,f,m){var A=3*r;return this.float32[A+0]=l,this.float32[A+1]=f,this.float32[A+2]=m,r},t}(Hi);jl.prototype.bytesPerElement=12,In("StructArrayLayout3f12",jl);var jc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var l=this.length;return this.resize(l+1),this.emplace(l,r)},t.prototype.emplace=function(r,l){return this.uint32[1*r+0]=l,r},t}(Hi);jc.prototype.bytesPerElement=4,In("StructArrayLayout1ul4",jc);var bf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I,U,re,he){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,r,l,f,m,A,I,U,re,he)},t.prototype.emplace=function(r,l,f,m,A,I,U,re,he,Ae){var Pe=10*r,ot=5*r;return this.int16[Pe+0]=l,this.int16[Pe+1]=f,this.int16[Pe+2]=m,this.int16[Pe+3]=A,this.int16[Pe+4]=I,this.int16[Pe+5]=U,this.uint32[ot+3]=re,this.uint16[Pe+8]=he,this.uint16[Pe+9]=Ae,r},t}(Hi);bf.prototype.bytesPerElement=20,In("StructArrayLayout6i1ul2ui20",bf);var Us=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I){var U=this.length;return this.resize(U+1),this.emplace(U,r,l,f,m,A,I)},t.prototype.emplace=function(r,l,f,m,A,I,U){var re=6*r;return this.int16[re+0]=l,this.int16[re+1]=f,this.int16[re+2]=m,this.int16[re+3]=A,this.int16[re+4]=I,this.int16[re+5]=U,r},t}(Hi);Us.prototype.bytesPerElement=12,In("StructArrayLayout2i2i2i12",Us);var _l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A){var I=this.length;return this.resize(I+1),this.emplace(I,r,l,f,m,A)},t.prototype.emplace=function(r,l,f,m,A,I){var U=4*r,re=8*r;return this.float32[U+0]=l,this.float32[U+1]=f,this.float32[U+2]=m,this.int16[re+6]=A,this.int16[re+7]=I,r},t}(Hi);_l.prototype.bytesPerElement=16,In("StructArrayLayout2f1f2i16",_l);var Ul=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m){var A=this.length;return this.resize(A+1),this.emplace(A,r,l,f,m)},t.prototype.emplace=function(r,l,f,m,A){var I=12*r,U=3*r;return this.uint8[I+0]=l,this.uint8[I+1]=f,this.float32[U+1]=m,this.float32[U+2]=A,r},t}(Hi);Ul.prototype.bytesPerElement=12,In("StructArrayLayout2ub2f12",Ul);var Iu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,l,f)},t.prototype.emplace=function(r,l,f,m){var A=3*r;return this.uint16[A+0]=l,this.uint16[A+1]=f,this.uint16[A+2]=m,r},t}(Hi);Iu.prototype.bytesPerElement=6,In("StructArrayLayout3ui6",Iu);var Ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I,U,re,he,Ae,Pe,ot,wt,Tt,Wt,Zt,nr){var dr=this.length;return this.resize(dr+1),this.emplace(dr,r,l,f,m,A,I,U,re,he,Ae,Pe,ot,wt,Tt,Wt,Zt,nr)},t.prototype.emplace=function(r,l,f,m,A,I,U,re,he,Ae,Pe,ot,wt,Tt,Wt,Zt,nr,dr){var br=24*r,zr=12*r,Rr=48*r;return this.int16[br+0]=l,this.int16[br+1]=f,this.uint16[br+2]=m,this.uint16[br+3]=A,this.uint32[zr+2]=I,this.uint32[zr+3]=U,this.uint32[zr+4]=re,this.uint16[br+10]=he,this.uint16[br+11]=Ae,this.uint16[br+12]=Pe,this.float32[zr+7]=ot,this.float32[zr+8]=wt,this.uint8[Rr+36]=Tt,this.uint8[Rr+37]=Wt,this.uint8[Rr+38]=Zt,this.uint32[zr+10]=nr,this.int16[br+22]=dr,r},t}(Hi);Ou.prototype.bytesPerElement=48,In("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ou);var Cl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I,U,re,he,Ae,Pe,ot,wt,Tt,Wt,Zt,nr,dr,br,zr,Rr,pn,hn,Ln,Jn,Kn,Nn,Si){var li=this.length;return this.resize(li+1),this.emplace(li,r,l,f,m,A,I,U,re,he,Ae,Pe,ot,wt,Tt,Wt,Zt,nr,dr,br,zr,Rr,pn,hn,Ln,Jn,Kn,Nn,Si)},t.prototype.emplace=function(r,l,f,m,A,I,U,re,he,Ae,Pe,ot,wt,Tt,Wt,Zt,nr,dr,br,zr,Rr,pn,hn,Ln,Jn,Kn,Nn,Si,li){var ei=34*r,Ki=17*r;return this.int16[ei+0]=l,this.int16[ei+1]=f,this.int16[ei+2]=m,this.int16[ei+3]=A,this.int16[ei+4]=I,this.int16[ei+5]=U,this.int16[ei+6]=re,this.int16[ei+7]=he,this.uint16[ei+8]=Ae,this.uint16[ei+9]=Pe,this.uint16[ei+10]=ot,this.uint16[ei+11]=wt,this.uint16[ei+12]=Tt,this.uint16[ei+13]=Wt,this.uint16[ei+14]=Zt,this.uint16[ei+15]=nr,this.uint16[ei+16]=dr,this.uint16[ei+17]=br,this.uint16[ei+18]=zr,this.uint16[ei+19]=Rr,this.uint16[ei+20]=pn,this.uint16[ei+21]=hn,this.uint16[ei+22]=Ln,this.uint32[Ki+12]=Jn,this.float32[Ki+13]=Kn,this.float32[Ki+14]=Nn,this.float32[Ki+15]=Si,this.float32[Ki+16]=li,r},t}(Hi);Cl.prototype.bytesPerElement=68,In("StructArrayLayout8i15ui1ul4f68",Cl);var Ku=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var l=this.length;return this.resize(l+1),this.emplace(l,r)},t.prototype.emplace=function(r,l){return this.float32[1*r+0]=l,r},t}(Hi);Ku.prototype.bytesPerElement=4,In("StructArrayLayout1f4",Ku);var Rs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,l,f)},t.prototype.emplace=function(r,l,f,m){var A=3*r;return this.int16[A+0]=l,this.int16[A+1]=f,this.int16[A+2]=m,r},t}(Hi);Rs.prototype.bytesPerElement=6,In("StructArrayLayout3i6",Rs);var Ac=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,l,f)},t.prototype.emplace=function(r,l,f,m){var A=4*r;return this.uint32[2*r+0]=l,this.uint16[A+2]=f,this.uint16[A+3]=m,r},t}(Hi);Ac.prototype.bytesPerElement=8,In("StructArrayLayout1ul2ui8",Ac);var rc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l){var f=this.length;return this.resize(f+1),this.emplace(f,r,l)},t.prototype.emplace=function(r,l,f){var m=2*r;return this.uint16[m+0]=l,this.uint16[m+1]=f,r},t}(Hi);rc.prototype.bytesPerElement=4,In("StructArrayLayout2ui4",rc);var nc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var l=this.length;return this.resize(l+1),this.emplace(l,r)},t.prototype.emplace=function(r,l){return this.uint16[1*r+0]=l,r},t}(Hi);nc.prototype.bytesPerElement=2,In("StructArrayLayout1ui2",nc);var ic=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m){var A=this.length;return this.resize(A+1),this.emplace(A,r,l,f,m)},t.prototype.emplace=function(r,l,f,m,A){var I=4*r;return this.float32[I+0]=l,this.float32[I+1]=f,this.float32[I+2]=m,this.float32[I+3]=A,r},t}(Hi);ic.prototype.bytesPerElement=16,In("StructArrayLayout4f16",ic);var u=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new te(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(ec);u.prototype.size=20;var i=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new u(this,r)},t}(bf);In("CollisionBoxArray",i);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(ec);n.prototype.size=48;var c=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new n(this,r)},t}(Ou);In("PlacedSymbolArray",c);var x=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(ec);x.prototype.size=68;var P=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new x(this,r)},t}(Cl);In("SymbolInstanceArray",P);var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(Ku);In("GlyphOffsetArray",O);var F=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(Rs);In("SymbolLineVertexArray",F);var ue=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(ec);ue.prototype.size=8;var Ee=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new ue(this,r)},t}(Ac);In("FeatureIndexArray",Ee);var Xe=Za([{name:"a_pos",components:2,type:"Int16"}],4).members,qe=function(t){t===void 0&&(t=[]),this.segments=t};function tt(e,t){return 256*(e=Oe(Math.floor(e),0,255))+Oe(Math.floor(t),0,255)}qe.prototype.prepareSegment=function(e,t,r,l){var f=this.segments[this.segments.length-1];return e>qe.MAX_VERTEX_ARRAY_LENGTH&&Me("Max vertices per segment is "+qe.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>qe.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==l)&&(f={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},l!==void 0&&(f.sortKey=l),this.segments.push(f)),f},qe.prototype.get=function(){return this.segments},qe.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var l in r.vaos)r.vaos[l].destroy()}},qe.simpleSegment=function(e,t,r,l){return new qe([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:l,vaos:{},sortKey:0}])},qe.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,In("SegmentVector",qe);var zt=Za([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Lt=W(function(e){e.exports=function(t,r){var l,f,m,A,I,U,re,he;for(f=t.length-(l=3&t.length),m=r,I=3432918353,U=461845907,he=0;he<f;)re=255&t.charCodeAt(he)|(255&t.charCodeAt(++he))<<8|(255&t.charCodeAt(++he))<<16|(255&t.charCodeAt(++he))<<24,++he,m=27492+(65535&(A=5*(65535&(m=(m^=re=(65535&(re=(re=(65535&re)*I+(((re>>>16)*I&65535)<<16)&4294967295)<<15|re>>>17))*U+(((re>>>16)*U&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(re=0,l){case 3:re^=(255&t.charCodeAt(he+2))<<16;case 2:re^=(255&t.charCodeAt(he+1))<<8;case 1:m^=re=(65535&(re=(re=(65535&(re^=255&t.charCodeAt(he)))*I+(((re>>>16)*I&65535)<<16)&4294967295)<<15|re>>>17))*U+(((re>>>16)*U&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),Xt=W(function(e){e.exports=function(t,r){for(var l,f=t.length,m=r^f,A=0;f>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(A)|(255&t.charCodeAt(++A))<<8|(255&t.charCodeAt(++A))<<16|(255&t.charCodeAt(++A))<<24))+((1540483477*(l>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),f-=4,++A;switch(f){case 3:m^=(255&t.charCodeAt(A+2))<<16;case 2:m^=(255&t.charCodeAt(A+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(A)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),Dt=Lt,Ut=Xt;Dt.murmur3=Lt,Dt.murmur2=Ut;var er=function(){this.ids=[],this.positions=[],this.indexed=!1};er.prototype.add=function(e,t,r,l){this.ids.push(Ir(e)),this.positions.push(t,r,l)},er.prototype.getPositions=function(e){for(var t=Ir(e),r=0,l=this.ids.length-1;r<l;){var f=r+l>>1;this.ids[f]>=t?l=f:r=f+1}for(var m=[];this.ids[r]===t;)m.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return m},er.serialize=function(e,t){var r=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function f(m,A,I,U){for(;I<U;){for(var re=m[I+U>>1],he=I-1,Ae=U+1;;){do he++;while(m[he]<re);do Ae--;while(m[Ae]>re);if(he>=Ae)break;hr(m,he,Ae),hr(A,3*he,3*Ae),hr(A,3*he+1,3*Ae+1),hr(A,3*he+2,3*Ae+2)}Ae-I<U-Ae?(f(m,A,I,Ae),I=Ae+1):(f(m,A,Ae+1,U),U=Ae)}}(r,l,0,r.length-1),t&&t.push(r.buffer,l.buffer),{ids:r,positions:l}},er.deserialize=function(e){var t=new er;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var qt=Math.pow(2,53)-1;function Ir(e){var t=+e;return!isNaN(t)&&t<=qt?t:Dt(String(e))}function hr(e,t,r){var l=e[t];e[t]=e[r],e[r]=l}In("FeaturePositionMap",er);var Tr=function(t,r){this.gl=t.gl,this.location=r},_r=function(e){function t(r,l){e.call(this,r,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(Tr),nn=function(e){function t(r,l){e.call(this,r,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(Tr),Yr=function(e){function t(r,l){e.call(this,r,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(Tr),yn=function(e){function t(r,l){e.call(this,r,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(Tr),On=function(e){function t(r,l){e.call(this,r,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(Tr),Qn=function(e){function t(r,l){e.call(this,r,l),this.current=ci.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(Tr),oi=new Float32Array(16),yi=function(e){function t(r,l){e.call(this,r,l),this.current=oi}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var l=1;l<16;l++)if(r[l]!==this.current[l]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(Tr);function Zi(e){return[tt(255*e.r,255*e.g),tt(255*e.b,255*e.a)]}var An=function(t,r,l){this.value=t,this.uniformNames=r.map(function(f){return"u_"+f}),this.type=l};An.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},An.prototype.getBinding=function(e,t,r){return this.type==="color"?new Qn(e,t):new nn(e,t)};var si=function(t,r){this.uniformNames=r.map(function(l){return"u_"+l}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};si.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},si.prototype.setUniform=function(e,t,r,l){var f=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},si.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new On(e,t):new nn(e,t)};var xi=function(t,r,l,f){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=r.map(function(m){return{name:"a_"+m,type:"Float32",components:l==="color"?2:1,offset:0}}),this.paintVertexArray=new f};xi.prototype.populatePaintArray=function(e,t,r,l,f){var m=this.paintVertexArray.length,A=this.expression.evaluate(new Mi(0),t,{},l,[],f);this.paintVertexArray.resize(e),this._setPaintValue(m,e,A)},xi.prototype.updatePaintArray=function(e,t,r,l){var f=this.expression.evaluate({zoom:0},r,l);this._setPaintValue(e,t,f)},xi.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var l=Zi(r),f=e;f<t;f++)this.paintVertexArray.emplace(f,l[0],l[1]);else{for(var m=e;m<t;m++)this.paintVertexArray.emplace(m,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},xi.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},xi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Wn=function(t,r,l,f,m,A){this.expression=t,this.uniformNames=r.map(function(I){return"u_"+I+"_t"}),this.type=l,this.useIntegerZoom=f,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=r.map(function(I){return{name:"a_"+I,type:"Float32",components:l==="color"?4:2,offset:0}}),this.paintVertexArray=new A};Wn.prototype.populatePaintArray=function(e,t,r,l,f){var m=this.expression.evaluate(new Mi(this.zoom),t,{},l,[],f),A=this.expression.evaluate(new Mi(this.zoom+1),t,{},l,[],f),I=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(I,e,m,A)},Wn.prototype.updatePaintArray=function(e,t,r,l){var f=this.expression.evaluate({zoom:this.zoom},r,l),m=this.expression.evaluate({zoom:this.zoom+1},r,l);this._setPaintValue(e,t,f,m)},Wn.prototype._setPaintValue=function(e,t,r,l){if(this.type==="color")for(var f=Zi(r),m=Zi(l),A=e;A<t;A++)this.paintVertexArray.emplace(A,f[0],f[1],m[0],m[1]);else{for(var I=e;I<t;I++)this.paintVertexArray.emplace(I,r,l);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(l))}},Wn.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Wn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Wn.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=Oe(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(l)},Wn.prototype.getBinding=function(e,t,r){return new nn(e,t)};var Ti=function(t,r,l,f,m,A){this.expression=t,this.type=r,this.useIntegerZoom=l,this.zoom=f,this.layerId=A,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m};Ti.prototype.populatePaintArray=function(e,t,r){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],r)},Ti.prototype.updatePaintArray=function(e,t,r,l,f){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],f)},Ti.prototype._setPaintValues=function(e,t,r,l){if(l&&r){var f=l[r.min],m=l[r.mid],A=l[r.max];if(f&&m&&A)for(var I=e;I<t;I++)this.zoomInPaintVertexArray.emplace(I,m.tl[0],m.tl[1],m.br[0],m.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],m.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(I,m.tl[0],m.tl[1],m.br[0],m.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],m.pixelRatio,A.pixelRatio)}},Ti.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,zt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,zt.members,this.expression.isStateDependent))},Ti.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var ri=function(t,r,l){this.binders={},this._buffers=[];var f=[];for(var m in t.paint._values)if(l(m)){var A=t.paint.get(m);if(A instanceof Es&&Hu(A.property.specification)){var I=Bi(m,t.type),U=A.value,re=A.property.specification.type,he=A.property.useIntegerZoom,Ae=A.property.specification["property-type"],Pe=Ae==="cross-faded"||Ae==="cross-faded-data-driven";if(U.kind==="constant")this.binders[m]=Pe?new si(U.value,I):new An(U.value,I,re),f.push("/u_"+m);else if(U.kind==="source"||Pe){var ot=qa(m,re,"source");this.binders[m]=Pe?new Ti(U,re,he,r,ot,t.id):new xi(U,I,re,ot),f.push("/a_"+m)}else{var wt=qa(m,re,"composite");this.binders[m]=new Wn(U,I,re,he,r,wt),f.push("/z_"+m)}}}this.cacheKey=f.sort().join("")};ri.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof xi||t instanceof Wn?t.maxValue:0},ri.prototype.populatePaintArrays=function(e,t,r,l,f){for(var m in this.binders){var A=this.binders[m];(A instanceof xi||A instanceof Wn||A instanceof Ti)&&A.populatePaintArray(e,t,r,l,f)}},ri.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var l=this.binders[r];l instanceof si&&l.setConstantPatternPositions(e,t)}},ri.prototype.updatePaintArrays=function(e,t,r,l,f){var m=!1;for(var A in e)for(var I=0,U=t.getPositions(A);I<U.length;I+=1){var re=U[I],he=r.feature(re.index);for(var Ae in this.binders){var Pe=this.binders[Ae];if((Pe instanceof xi||Pe instanceof Wn||Pe instanceof Ti)&&Pe.expression.isStateDependent===!0){var ot=l.paint.get(Ae);Pe.expression=ot.value,Pe.updatePaintArray(re.start,re.end,he,e[A],f),m=!0}}}return m},ri.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof An||r instanceof si)&&e.push.apply(e,r.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},ri.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof xi||r instanceof Wn)for(var l=0;l<r.paintVertexAttributes.length;l++)e.push(r.paintVertexAttributes[l].name);else if(r instanceof Ti)for(var f=0;f<zt.members.length;f++)e.push(zt.members[f].name)}return e},ri.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof An||r instanceof si||r instanceof Wn)for(var l=0,f=r.uniformNames;l<f.length;l+=1)e.push(f[l])}return e},ri.prototype.getPaintVertexBuffers=function(){return this._buffers},ri.prototype.getUniforms=function(e,t){var r=[];for(var l in this.binders){var f=this.binders[l];if(f instanceof An||f instanceof si||f instanceof Wn)for(var m=0,A=f.uniformNames;m<A.length;m+=1){var I=A[m];if(t[I]){var U=f.getBinding(e,t[I],I);r.push({name:I,property:l,binding:U})}}}return r},ri.prototype.setUniforms=function(e,t,r,l){for(var f=0,m=t;f<m.length;f+=1){var A=m[f],I=A.name,U=A.property;this.binders[U].setUniform(A.binding,l,r.get(U),I)}},ri.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Ti){var l=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(r instanceof xi||r instanceof Wn)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},ri.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof xi||r instanceof Wn||r instanceof Ti)&&r.upload(e)}this.updatePaintBuffers()},ri.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof xi||t instanceof Wn||t instanceof Ti)&&t.destroy()}};var Ii=function(t,r,l){l===void 0&&(l=function(){return!0}),this.programConfigurations={};for(var f=0,m=t;f<m.length;f+=1){var A=m[f];this.programConfigurations[A.id]=new ri(A,r,l)}this.needsUpload=!1,this._featureMap=new er,this._bufferOffset=0};function Bi(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function qa(e,t,r){var l={color:{source:kl,composite:ic},number:{source:Ku,composite:kl}},f=function(m){return{"line-pattern":{source:ms,composite:ms},"fill-pattern":{source:ms,composite:ms},"fill-extrusion-pattern":{source:ms,composite:ms}}[m]}(e);return f&&f[r]||l[t][r]}Ii.prototype.populatePaintArrays=function(e,t,r,l,f,m){for(var A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(e,t,l,f,m);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Ii.prototype.updatePaintArrays=function(e,t,r,l){for(var f=0,m=r;f<m.length;f+=1){var A=m[f];this.needsUpload=this.programConfigurations[A.id].updatePaintArrays(e,this._featureMap,t,A,l)||this.needsUpload}},Ii.prototype.get=function(e){return this.programConfigurations[e]},Ii.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Ii.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},In("ConstantBinder",An),In("CrossFadedConstantBinder",si),In("SourceExpressionBinder",xi),In("CrossFadedCompositeBinder",Ti),In("CompositeExpressionBinder",Wn),In("ProgramConfiguration",ri,{omit:["_buffers"]}),In("ProgramConfigurationSet",Ii);var Pa=Math.pow(2,14)-1,yo=-Pa-1;function Ea(e){for(var t=8192/e.extent,r=e.loadGeometry(),l=0;l<r.length;l++)for(var f=r[l],m=0;m<f.length;m++){var A=f[m],I=Math.round(A.x*t),U=Math.round(A.y*t);A.x=Oe(I,yo,Pa),A.y=Oe(U,yo,Pa),(I<A.x||I>A.x+1||U<A.y||U>A.y+1)&&Me("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Wa(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Ea(e):[]}}function Ds(e,t,r,l,f){e.emplaceBack(2*t+(l+1)/2,2*r+(f+1)/2)}var xo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new hl,this.indexArray=new Iu,this.segments=new qe,this.programConfigurations=new Ii(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function yu(e,t){for(var r=0;r<e.length;r++)if(Ru(t,e[r]))return!0;for(var l=0;l<t.length;l++)if(Ru(e,t[l]))return!0;return!!Lu(e,t)}function xu(e,t,r){return!!Ru(e,t)||!!$u(t,e,r)}function jo(e,t){if(e.length===1)return sc(t,e[0]);for(var r=0;r<t.length;r++)for(var l=t[r],f=0;f<l.length;f++)if(Ru(e,l[f]))return!0;for(var m=0;m<e.length;m++)if(sc(t,e[m]))return!0;for(var A=0;A<t.length;A++)if(Lu(e,t[A]))return!0;return!1}function Ts(e,t,r){if(e.length>1){if(Lu(e,t))return!0;for(var l=0;l<t.length;l++)if($u(t[l],e,r))return!0}for(var f=0;f<e.length;f++)if($u(e[f],t,r))return!0;return!1}function Lu(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var l=e[r],f=e[r+1],m=0;m<t.length-1;m++)if(ac(l,f,t[m],t[m+1]))return!0;return!1}function ac(e,t,r,l){return ct(e,r,l)!==ct(t,r,l)&&ct(e,t,r)!==ct(e,t,l)}function $u(e,t,r){var l=r*r;if(t.length===1)return e.distSqr(t[0])<l;for(var f=1;f<t.length;f++)if(oc(e,t[f-1],t[f])<l)return!0;return!1}function oc(e,t,r){var l=t.distSqr(r);if(l===0)return e.distSqr(t);var f=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/l;return e.distSqr(f<0?t:f>1?r:r.sub(t)._mult(f)._add(t))}function sc(e,t){for(var r,l,f,m=!1,A=0;A<e.length;A++)for(var I=0,U=(r=e[A]).length-1;I<r.length;U=I++)(l=r[I]).y>t.y!=(f=r[U]).y>t.y&&t.x<(f.x-l.x)*(t.y-l.y)/(f.y-l.y)+l.x&&(m=!m);return m}function Ru(e,t){for(var r=!1,l=0,f=e.length-1;l<e.length;f=l++){var m=e[l],A=e[f];m.y>t.y!=A.y>t.y&&t.x<(A.x-m.x)*(t.y-m.y)/(A.y-m.y)+m.x&&(r=!r)}return r}function dl(e,t,r){var l=r[0],f=r[2];if(e.x<l.x&&t.x<l.x||e.x>f.x&&t.x>f.x||e.y<l.y&&t.y<l.y||e.y>f.y&&t.y>f.y)return!1;var m=ct(e,t,r[0]);return m!==ct(e,t,r[1])||m!==ct(e,t,r[2])||m!==ct(e,t,r[3])}function As(e,t,r){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:r.programConfigurations.get(t.id).getMaxValue(e)}function co(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Du(e,t,r,l,f){if(!t[0]&&!t[1])return e;var m=te.convert(t)._mult(f);r==="viewport"&&m._rotate(-l);for(var A=[],I=0;I<e.length;I++)A.push(e[I].sub(m));return A}xo.prototype.populate=function(e,t,r){var l=this.layers[0],f=[],m=null;l.type==="circle"&&(m=l.layout.get("circle-sort-key"));for(var A=0,I=e;A<I.length;A+=1){var U=I[A],re=U.feature,he=U.id,Ae=U.index,Pe=U.sourceLayerIndex,ot=this.layers[0]._featureFilter.needGeometry,wt=Wa(re,ot);if(this.layers[0]._featureFilter.filter(new Mi(this.zoom),wt,r)){var Tt=m?m.evaluate(wt,{},r):void 0,Wt={id:he,properties:re.properties,type:re.type,sourceLayerIndex:Pe,index:Ae,geometry:ot?wt.geometry:Ea(re),patterns:{},sortKey:Tt};f.push(Wt)}}m&&f.sort(function(hn,Ln){return hn.sortKey-Ln.sortKey});for(var Zt=0,nr=f;Zt<nr.length;Zt+=1){var dr=nr[Zt],br=dr.geometry,zr=dr.index,Rr=dr.sourceLayerIndex,pn=e[zr].feature;this.addFeature(dr,br,zr,r),t.featureIndex.insert(pn,br,zr,Rr,this.index)}},xo.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},xo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},xo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Xe),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},xo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xo.prototype.addFeature=function(e,t,r,l){for(var f=0,m=t;f<m.length;f+=1)for(var A=0,I=m[f];A<I.length;A+=1){var U=I[A],re=U.x,he=U.y;if(!(re<0||re>=8192||he<0||he>=8192)){var Ae=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),Pe=Ae.vertexLength;Ds(this.layoutVertexArray,re,he,-1,-1),Ds(this.layoutVertexArray,re,he,1,-1),Ds(this.layoutVertexArray,re,he,1,1),Ds(this.layoutVertexArray,re,he,-1,1),this.indexArray.emplaceBack(Pe,Pe+1,Pe+2),this.indexArray.emplaceBack(Pe,Pe+3,Pe+2),Ae.vertexLength+=4,Ae.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},l)},In("CircleBucket",xo,{omit:["layers"]});var bu=new Po({"circle-sort-key":new Fn(He.layout_circle["circle-sort-key"])}),Mo={paint:new Po({"circle-radius":new Fn(He.paint_circle["circle-radius"]),"circle-color":new Fn(He.paint_circle["circle-color"]),"circle-blur":new Fn(He.paint_circle["circle-blur"]),"circle-opacity":new Fn(He.paint_circle["circle-opacity"]),"circle-translate":new $n(He.paint_circle["circle-translate"]),"circle-translate-anchor":new $n(He.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new $n(He.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new $n(He.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Fn(He.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Fn(He.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Fn(He.paint_circle["circle-stroke-opacity"])}),layout:bu},Io=typeof Float32Array!="undefined"?Float32Array:Array;function Oo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Jo(e,t,r){var l=t[0],f=t[1],m=t[2],A=t[3],I=t[4],U=t[5],re=t[6],he=t[7],Ae=t[8],Pe=t[9],ot=t[10],wt=t[11],Tt=t[12],Wt=t[13],Zt=t[14],nr=t[15],dr=r[0],br=r[1],zr=r[2],Rr=r[3];return e[0]=dr*l+br*I+zr*Ae+Rr*Tt,e[1]=dr*f+br*U+zr*Pe+Rr*Wt,e[2]=dr*m+br*re+zr*ot+Rr*Zt,e[3]=dr*A+br*he+zr*wt+Rr*nr,e[4]=(dr=r[4])*l+(br=r[5])*I+(zr=r[6])*Ae+(Rr=r[7])*Tt,e[5]=dr*f+br*U+zr*Pe+Rr*Wt,e[6]=dr*m+br*re+zr*ot+Rr*Zt,e[7]=dr*A+br*he+zr*wt+Rr*nr,e[8]=(dr=r[8])*l+(br=r[9])*I+(zr=r[10])*Ae+(Rr=r[11])*Tt,e[9]=dr*f+br*U+zr*Pe+Rr*Wt,e[10]=dr*m+br*re+zr*ot+Rr*Zt,e[11]=dr*A+br*he+zr*wt+Rr*nr,e[12]=(dr=r[12])*l+(br=r[13])*I+(zr=r[14])*Ae+(Rr=r[15])*Tt,e[13]=dr*f+br*U+zr*Pe+Rr*Wt,e[14]=dr*m+br*re+zr*ot+Rr*Zt,e[15]=dr*A+br*he+zr*wt+Rr*nr,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var bo,Uo=Jo;function Vs(e,t,r){var l=t[0],f=t[1],m=t[2],A=t[3];return e[0]=r[0]*l+r[4]*f+r[8]*m+r[12]*A,e[1]=r[1]*l+r[5]*f+r[9]*m+r[13]*A,e[2]=r[2]*l+r[6]*f+r[10]*m+r[14]*A,e[3]=r[3]*l+r[7]*f+r[11]*m+r[15]*A,e}bo=new Io(3),Io!=Float32Array&&(bo[0]=0,bo[1]=0,bo[2]=0),function(){var e=new Io(4);Io!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var wl=(function(){var e=new Io(2);Io!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,Mo)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new xo(r)},t.prototype.queryRadius=function(r){var l=r;return As("circle-radius",this,l)+As("circle-stroke-width",this,l)+co(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,l,f,m,A,I,U,re){for(var he=Du(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),I.angle,U),Ae=this.paint.get("circle-radius").evaluate(l,f)+this.paint.get("circle-stroke-width").evaluate(l,f),Pe=this.paint.get("circle-pitch-alignment")==="map",ot=Pe?he:function(pn,hn){return pn.map(function(Ln){return Uc(Ln,hn)})}(he,re),wt=Pe?Ae*U:Ae,Tt=0,Wt=m;Tt<Wt.length;Tt+=1)for(var Zt=0,nr=Wt[Tt];Zt<nr.length;Zt+=1){var dr=nr[Zt],br=Pe?dr:Uc(dr,re),zr=wt,Rr=Vs([],[dr.x,dr.y,0,1],re);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?zr*=Rr[3]/I.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(zr*=I.cameraToCenterDistance/Rr[3]),xu(ot,br,zr))return!0}return!1},t}(ru));function Uc(e,t){var r=Vs([],[e.x,e.y,0,1],t);return new te(r[0]/r[3],r[1]/r[3])}var Vl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(xo);function Ju(e,t,r,l){var f=t.width,m=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==f*m*r)throw new RangeError("mismatched image size")}else l=new Uint8Array(f*m*r);return e.width=f,e.height=m,e.data=l,e}function zu(e,t,r){var l=t.width,f=t.height;if(l!==e.width||f!==e.height){var m=Ju({},{width:l,height:f},r);Nu(e,m,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,f)},r),e.width=l,e.height=f,e.data=m.data}}function Nu(e,t,r,l,f,m){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||r.x>e.width-f.width||r.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||l.x>t.width-f.width||l.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var A=e.data,I=t.data,U=0;U<f.height;U++)for(var re=((r.y+U)*e.width+r.x)*m,he=((l.y+U)*t.width+l.x)*m,Ae=0;Ae<f.width*m;Ae++)I[he+Ae]=A[re+Ae];return t}In("HeatmapBucket",Vl,{omit:["layers"]});var Gs=function(t,r){Ju(this,t,1,r)};Gs.prototype.resize=function(e){zu(this,e,1)},Gs.prototype.clone=function(){return new Gs({width:this.width,height:this.height},new Uint8Array(this.data))},Gs.copy=function(e,t,r,l,f){Nu(e,t,r,l,f,1)};var Lo=function(t,r){Ju(this,t,4,r)};Lo.prototype.resize=function(e){zu(this,e,4)},Lo.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Lo.prototype.clone=function(){return new Lo({width:this.width,height:this.height},new Uint8Array(this.data))},Lo.copy=function(e,t,r,l,f){Nu(e,t,r,l,f,4)},In("AlphaImage",Gs),In("RGBAImage",Lo);var Vc={paint:new Po({"heatmap-radius":new Fn(He.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Fn(He.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new $n(He.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ko(He.paint_heatmap["heatmap-color"]),"heatmap-opacity":new $n(He.paint_heatmap["heatmap-opacity"])})};function gs(e){var t={},r=e.resolution||256,l=e.clips?e.clips.length:1,f=e.image||new Lo({width:r,height:l}),m=function(Tt,Wt,Zt){t[e.evaluationKey]=Zt;var nr=e.expression.evaluate(t);f.data[Tt+Wt+0]=Math.floor(255*nr.r/nr.a),f.data[Tt+Wt+1]=Math.floor(255*nr.g/nr.a),f.data[Tt+Wt+2]=Math.floor(255*nr.b/nr.a),f.data[Tt+Wt+3]=Math.floor(255*nr.a)};if(e.clips)for(var A=0,I=0;A<l;++A,I+=4*r)for(var U=0,re=0;U<r;U++,re+=4){var he=U/(r-1),Ae=e.clips[A];m(I,re,Ae.start*(1-he)+Ae.end*he)}else for(var Pe=0,ot=0;Pe<r;Pe++,ot+=4)m(0,ot,Pe/(r-1));return f}var of=function(e){function t(r){e.call(this,r,Vc),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Vl(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=gs({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(ru),Lf={paint:new Po({"hillshade-illumination-direction":new $n(He.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new $n(He.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new $n(He.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new $n(He.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new $n(He.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new $n(He.paint_hillshade["hillshade-accent-color"])})},Rf=function(e){function t(r){e.call(this,r,Lf)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(ru),Uf=Za([{name:"a_pos",components:2,type:"Int16"}],4).members,Qu=sf,Sf=sf;function sf(e,t,r){r=r||2;var l,f,m,A,I,U,re,he=t&&t.length,Ae=he?t[0]*r:e.length,Pe=uc(e,0,Ae,r,!0),ot=[];if(!Pe||Pe.next===Pe.prev)return ot;if(he&&(Pe=function(Tt,Wt,Zt,nr){var dr,br,zr,Rr=[];for(dr=0,br=Wt.length;dr<br;dr++)(zr=uc(Tt,Wt[dr]*nr,dr<br-1?Wt[dr+1]*nr:Tt.length,nr,!1))===zr.next&&(zr.steiner=!0),Rr.push(ch(zr));for(Rr.sort(Hf),dr=0;dr<Rr.length;dr++)ah(Rr[dr],Zt),Zt=Fu(Zt,Zt.next);return Zt}(e,t,Pe,r)),e.length>80*r){l=m=e[0],f=A=e[1];for(var wt=r;wt<Ae;wt+=r)(I=e[wt])<l&&(l=I),(U=e[wt+1])<f&&(f=U),I>m&&(m=I),U>A&&(A=U);re=(re=Math.max(m-l,A-f))!==0?1/re:0}return lc(Pe,ot,r,l,f,re),ot}function uc(e,t,r,l,f){var m,A;if(f===Zc(e,t,r,l)>0)for(m=t;m<r;m+=l)A=Tf(m,e[m],e[m+1],A);else for(m=r-l;m>=t;m-=l)A=Tf(m,e[m],e[m+1],A);return A&&Gl(A,A.next)&&(Hc(A),A=A.next),A}function Fu(e,t){if(!e)return e;t||(t=e);var r,l=e;do if(r=!1,l.steiner||!Gl(l,l.next)&&ao(l.prev,l,l.next)!==0)l=l.next;else{if(Hc(l),(l=t=l.prev)===l.next)break;r=!0}while(r||l!==t);return t}function lc(e,t,r,l,f,m,A){if(e){!A&&m&&function(he,Ae,Pe,ot){var wt=he;do wt.z===null&&(wt.z=Df(wt.x,wt.y,Ae,Pe,ot)),wt.prevZ=wt.prev,wt.nextZ=wt.next,wt=wt.next;while(wt!==he);wt.prevZ.nextZ=null,wt.prevZ=null,function(Tt){var Wt,Zt,nr,dr,br,zr,Rr,pn,hn=1;do{for(Zt=Tt,Tt=null,br=null,zr=0;Zt;){for(zr++,nr=Zt,Rr=0,Wt=0;Wt<hn&&(Rr++,nr=nr.nextZ);Wt++);for(pn=hn;Rr>0||pn>0&&nr;)Rr!==0&&(pn===0||!nr||Zt.z<=nr.z)?(dr=Zt,Zt=Zt.nextZ,Rr--):(dr=nr,nr=nr.nextZ,pn--),br?br.nextZ=dr:Tt=dr,dr.prevZ=br,br=dr;Zt=nr}br.nextZ=null,hn*=2}while(zr>1)}(wt)}(e,l,f,m);for(var I,U,re=e;e.prev!==e.next;)if(I=e.prev,U=e.next,m?_c(e,l,f,m):Vf(e))t.push(I.i/r),t.push(e.i/r),t.push(U.i/r),Hc(e),e=U.next,re=U.next;else if((e=U)===re){A?A===1?lc(e=Cc(Fu(e),t,r),t,r,l,f,m,2):A===2&&Gf(e,t,r,l,f,m):lc(Fu(e),t,r,l,f,m,1);break}}}function Vf(e){var t=e.prev,r=e,l=e.next;if(ao(t,r,l)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(cc(t.x,t.y,r.x,r.y,l.x,l.y,f.x,f.y)&&ao(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function _c(e,t,r,l){var f=e.prev,m=e,A=e.next;if(ao(f,m,A)>=0)return!1;for(var I=f.x>m.x?f.x>A.x?f.x:A.x:m.x>A.x?m.x:A.x,U=f.y>m.y?f.y>A.y?f.y:A.y:m.y>A.y?m.y:A.y,re=Df(f.x<m.x?f.x<A.x?f.x:A.x:m.x<A.x?m.x:A.x,f.y<m.y?f.y<A.y?f.y:A.y:m.y<A.y?m.y:A.y,t,r,l),he=Df(I,U,t,r,l),Ae=e.prevZ,Pe=e.nextZ;Ae&&Ae.z>=re&&Pe&&Pe.z<=he;){if(Ae!==e.prev&&Ae!==e.next&&cc(f.x,f.y,m.x,m.y,A.x,A.y,Ae.x,Ae.y)&&ao(Ae.prev,Ae,Ae.next)>=0||(Ae=Ae.prevZ,Pe!==e.prev&&Pe!==e.next&&cc(f.x,f.y,m.x,m.y,A.x,A.y,Pe.x,Pe.y)&&ao(Pe.prev,Pe,Pe.next)>=0))return!1;Pe=Pe.nextZ}for(;Ae&&Ae.z>=re;){if(Ae!==e.prev&&Ae!==e.next&&cc(f.x,f.y,m.x,m.y,A.x,A.y,Ae.x,Ae.y)&&ao(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.prevZ}for(;Pe&&Pe.z<=he;){if(Pe!==e.prev&&Pe!==e.next&&cc(f.x,f.y,m.x,m.y,A.x,A.y,Pe.x,Pe.y)&&ao(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.nextZ}return!0}function Cc(e,t,r){var l=e;do{var f=l.prev,m=l.next.next;!Gl(f,m)&&lf(f,l,l.next,m)&&Pl(f,m)&&Pl(m,f)&&(t.push(f.i/r),t.push(l.i/r),t.push(m.i/r),Hc(l),Hc(l.next),l=e=m),l=l.next}while(l!==e);return Fu(l)}function Gf(e,t,r,l,f,m){var A=e;do{for(var I=A.next.next;I!==A.prev;){if(A.i!==I.i&&uf(A,I)){var U=Ef(A,I);return A=Fu(A,A.next),U=Fu(U,U.next),lc(A,t,r,l,f,m),void lc(U,t,r,l,f,m)}I=I.next}A=A.next}while(A!==e)}function Hf(e,t){return e.x-t.x}function ah(e,t){if(t=function(l,f){var m,A=f,I=l.x,U=l.y,re=-1/0;do{if(U<=A.y&&U>=A.next.y&&A.next.y!==A.y){var he=A.x+(U-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(he<=I&&he>re){if(re=he,he===I){if(U===A.y)return A;if(U===A.next.y)return A.next}m=A.x<A.next.x?A:A.next}}A=A.next}while(A!==f);if(!m)return null;if(I===re)return m;var Ae,Pe=m,ot=m.x,wt=m.y,Tt=1/0;A=m;do I>=A.x&&A.x>=ot&&I!==A.x&&cc(U<wt?I:re,U,ot,wt,U<wt?re:I,U,A.x,A.y)&&(Ae=Math.abs(U-A.y)/(I-A.x),Pl(A,l)&&(Ae<Tt||Ae===Tt&&(A.x>m.x||A.x===m.x&&Zf(m,A)))&&(m=A,Tt=Ae)),A=A.next;while(A!==Pe);return m}(e,t)){var r=Ef(t,e);Fu(t,t.next),Fu(r,r.next)}}function Zf(e,t){return ao(e.prev,e,t.prev)<0&&ao(t.next,e,e.next)<0}function Df(e,t,r,l,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ch(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function cc(e,t,r,l,f,m,A,I){return(f-A)*(t-I)-(e-A)*(m-I)>=0&&(e-A)*(l-I)-(r-A)*(t-I)>=0&&(r-A)*(m-I)-(f-A)*(l-I)>=0}function uf(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,l){var f=r;do{if(f.i!==r.i&&f.next.i!==r.i&&f.i!==l.i&&f.next.i!==l.i&&lf(f,f.next,r,l))return!0;f=f.next}while(f!==r);return!1}(e,t)&&(Pl(e,t)&&Pl(t,e)&&function(r,l){var f=r,m=!1,A=(r.x+l.x)/2,I=(r.y+l.y)/2;do f.y>I!=f.next.y>I&&f.next.y!==f.y&&A<(f.next.x-f.x)*(I-f.y)/(f.next.y-f.y)+f.x&&(m=!m),f=f.next;while(f!==r);return m}(e,t)&&(ao(e.prev,e,t.prev)||ao(e,t.prev,t))||Gl(e,t)&&ao(e.prev,e,e.next)>0&&ao(t.prev,t,t.next)>0)}function ao(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Gl(e,t){return e.x===t.x&&e.y===t.y}function lf(e,t,r,l){var f=nu(ao(e,t,r)),m=nu(ao(e,t,l)),A=nu(ao(r,l,e)),I=nu(ao(r,l,t));return f!==m&&A!==I||!(f!==0||!Gc(e,r,t))||!(m!==0||!Gc(e,l,t))||!(A!==0||!Gc(r,e,l))||!(I!==0||!Gc(r,t,l))}function Gc(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function nu(e){return e>0?1:e<0?-1:0}function Pl(e,t){return ao(e.prev,e,e.next)<0?ao(e,t,e.next)>=0&&ao(e,e.prev,t)>=0:ao(e,t,e.prev)<0||ao(e,e.next,t)<0}function Ef(e,t){var r=new cf(e.i,e.x,e.y),l=new cf(t.i,t.x,t.y),f=e.next,m=t.prev;return e.next=t,t.prev=e,r.next=f,f.prev=r,l.next=r,r.prev=l,m.next=l,l.prev=m,l}function Tf(e,t,r,l){var f=new cf(e,t,r);return l?(f.next=l.next,f.prev=l,l.next.prev=f,l.next=f):(f.prev=f,f.next=f),f}function Hc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function cf(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Zc(e,t,r,l){for(var f=0,m=t,A=r-l;m<r;m+=l)f+=(e[A]-e[m])*(e[m+1]+e[A+1]),A=m;return f}function Hl(e,t,r,l,f){(function m(A,I,U,re,he){for(;re>U;){if(re-U>600){var Ae=re-U+1,Pe=I-U+1,ot=Math.log(Ae),wt=.5*Math.exp(2*ot/3),Tt=.5*Math.sqrt(ot*wt*(Ae-wt)/Ae)*(Pe-Ae/2<0?-1:1);m(A,I,Math.max(U,Math.floor(I-Pe*wt/Ae+Tt)),Math.min(re,Math.floor(I+(Ae-Pe)*wt/Ae+Tt)),he)}var Wt=A[I],Zt=U,nr=re;for(ne(A,U,I),he(A[re],Wt)>0&&ne(A,U,re);Zt<nr;){for(ne(A,Zt,nr),Zt++,nr--;he(A[Zt],Wt)<0;)Zt++;for(;he(A[nr],Wt)>0;)nr--}he(A[U],Wt)===0?ne(A,U,nr):ne(A,++nr,re),nr<=I&&(U=nr+1),I<=nr&&(re=nr-1)}})(e,t,r||0,l||e.length-1,f||se)}function ne(e,t,r){var l=e[t];e[t]=e[r],e[r]=l}function se(e,t){return e<t?-1:e>t?1:0}function z(e,t){var r=e.length;if(r<=1)return[e];for(var l,f,m=[],A=0;A<r;A++){var I=Gt(e[A]);I!==0&&(e[A].area=Math.abs(I),f===void 0&&(f=I<0),f===I<0?(l&&m.push(l),l=[e[A]]):l.push(e[A]))}if(l&&m.push(l),t>1)for(var U=0;U<m.length;U++)m[U].length<=t||(Hl(m[U],t,1,m[U].length-1,V),m[U]=m[U].slice(0,t));return m}function V(e,t){return t.area-e.area}function _e(e,t,r){for(var l=r.patternDependencies,f=!1,m=0,A=t;m<A.length;m+=1){var I=A[m].paint.get(e+"-pattern");I.isConstant()||(f=!0);var U=I.constantOr(null);U&&(f=!0,l[U.to]=!0,l[U.from]=!0)}return f}function ut(e,t,r,l,f){for(var m=f.patternDependencies,A=0,I=t;A<I.length;A+=1){var U=I[A],re=U.paint.get(e+"-pattern").value;if(re.kind!=="constant"){var he=re.evaluate({zoom:l-1},r,{},f.availableImages),Ae=re.evaluate({zoom:l},r,{},f.availableImages),Pe=re.evaluate({zoom:l+1},r,{},f.availableImages);Ae=Ae&&Ae.name?Ae.name:Ae,Pe=Pe&&Pe.name?Pe.name:Pe,m[he=he&&he.name?he.name:he]=!0,m[Ae]=!0,m[Pe]=!0,r.patterns[U.id]={min:he,mid:Ae,max:Pe}}}return r}sf.deviation=function(e,t,r,l){var f=t&&t.length,m=Math.abs(Zc(e,0,f?t[0]*r:e.length,r));if(f)for(var A=0,I=t.length;A<I;A++)m-=Math.abs(Zc(e,t[A]*r,A<I-1?t[A+1]*r:e.length,r));var U=0;for(A=0;A<l.length;A+=3){var re=l[A]*r,he=l[A+1]*r,Ae=l[A+2]*r;U+=Math.abs((e[re]-e[Ae])*(e[he+1]-e[re+1])-(e[re]-e[he])*(e[Ae+1]-e[re+1]))}return m===0&&U===0?0:Math.abs((U-m)/m)},sf.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},l=0,f=0;f<e.length;f++){for(var m=0;m<e[f].length;m++)for(var A=0;A<t;A++)r.vertices.push(e[f][m][A]);f>0&&r.holes.push(l+=e[f-1].length)}return r},Qu.default=Sf;var Ht=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new hl,this.indexArray=new Iu,this.indexArray2=new rc,this.programConfigurations=new Ii(t.layers,t.zoom),this.segments=new qe,this.segments2=new qe,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Ht.prototype.populate=function(e,t,r){this.hasPattern=_e("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),f=[],m=0,A=e;m<A.length;m+=1){var I=A[m],U=I.feature,re=I.id,he=I.index,Ae=I.sourceLayerIndex,Pe=this.layers[0]._featureFilter.needGeometry,ot=Wa(U,Pe);if(this.layers[0]._featureFilter.filter(new Mi(this.zoom),ot,r)){var wt=l?l.evaluate(ot,{},r,t.availableImages):void 0,Tt={id:re,properties:U.properties,type:U.type,sourceLayerIndex:Ae,index:he,geometry:Pe?ot.geometry:Ea(U),patterns:{},sortKey:wt};f.push(Tt)}}l&&f.sort(function(pn,hn){return pn.sortKey-hn.sortKey});for(var Wt=0,Zt=f;Wt<Zt.length;Wt+=1){var nr=Zt[Wt],dr=nr.geometry,br=nr.index,zr=nr.sourceLayerIndex;if(this.hasPattern){var Rr=ut("fill",this.layers,nr,this.zoom,t);this.patternFeatures.push(Rr)}else this.addFeature(nr,dr,br,r,{});t.featureIndex.insert(e[br].feature,dr,br,zr,this.index)}},Ht.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ht.prototype.addFeatures=function(e,t,r){for(var l=0,f=this.patternFeatures;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,r)}},Ht.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ht.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ht.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Uf),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Ht.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ht.prototype.addFeature=function(e,t,r,l,f){for(var m=0,A=z(t,500);m<A.length;m+=1){for(var I=A[m],U=0,re=0,he=I;re<he.length;re+=1)U+=he[re].length;for(var Ae=this.segments.prepareSegment(U,this.layoutVertexArray,this.indexArray),Pe=Ae.vertexLength,ot=[],wt=[],Tt=0,Wt=I;Tt<Wt.length;Tt+=1){var Zt=Wt[Tt];if(Zt.length!==0){Zt!==I[0]&&wt.push(ot.length/2);var nr=this.segments2.prepareSegment(Zt.length,this.layoutVertexArray,this.indexArray2),dr=nr.vertexLength;this.layoutVertexArray.emplaceBack(Zt[0].x,Zt[0].y),this.indexArray2.emplaceBack(dr+Zt.length-1,dr),ot.push(Zt[0].x),ot.push(Zt[0].y);for(var br=1;br<Zt.length;br++)this.layoutVertexArray.emplaceBack(Zt[br].x,Zt[br].y),this.indexArray2.emplaceBack(dr+br-1,dr+br),ot.push(Zt[br].x),ot.push(Zt[br].y);nr.vertexLength+=Zt.length,nr.primitiveLength+=Zt.length}}for(var zr=Qu(ot,wt),Rr=0;Rr<zr.length;Rr+=3)this.indexArray.emplaceBack(Pe+zr[Rr],Pe+zr[Rr+1],Pe+zr[Rr+2]);Ae.vertexLength+=U,Ae.primitiveLength+=zr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,l)},In("FillBucket",Ht,{omit:["layers","patternFeatures"]});var ir=new Po({"fill-sort-key":new Fn(He.layout_fill["fill-sort-key"])}),tr={paint:new Po({"fill-antialias":new $n(He.paint_fill["fill-antialias"]),"fill-opacity":new Fn(He.paint_fill["fill-opacity"]),"fill-color":new Fn(He.paint_fill["fill-color"]),"fill-outline-color":new Fn(He.paint_fill["fill-outline-color"]),"fill-translate":new $n(He.paint_fill["fill-translate"]),"fill-translate-anchor":new $n(He.paint_fill["fill-translate-anchor"]),"fill-pattern":new Tc(He.paint_fill["fill-pattern"])}),layout:ir},Or=function(e){function t(r){e.call(this,r,tr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,l){e.prototype.recalculate.call(this,r,l);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Ht(r)},t.prototype.queryRadius=function(){return co(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,l,f,m,A,I,U){return jo(Du(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),I.angle,U),m)},t.prototype.isTileClipped=function(){return!0},t}(ru),an=Za([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,zn=Xn;function Xn(e,t,r,l,f){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=f,e.readFields(ni,this,t)}function ni(e,t,r){e==1?t.id=r.readVarint():e==2?function(l,f){for(var m=l.readVarint()+l.pos;l.pos<m;){var A=f._keys[l.readVarint()],I=f._values[l.readVarint()];f.properties[A]=I}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function ra(e){for(var t,r,l=0,f=0,m=e.length,A=m-1;f<m;A=f++)l+=((r=e[A]).x-(t=e[f]).x)*(t.y+r.y);return l}Xn.types=["Unknown","Point","LineString","Polygon"],Xn.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,l=1,f=0,m=0,A=0,I=[];e.pos<r;){if(f<=0){var U=e.readVarint();l=7&U,f=U>>3}if(f--,l===1||l===2)m+=e.readSVarint(),A+=e.readSVarint(),l===1&&(t&&I.push(t),t=[]),t.push(new te(m,A));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&I.push(t),I},Xn.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,l=0,f=0,m=0,A=1/0,I=-1/0,U=1/0,re=-1/0;e.pos<t;){if(l<=0){var he=e.readVarint();r=7&he,l=he>>3}if(l--,r===1||r===2)(f+=e.readSVarint())<A&&(A=f),f>I&&(I=f),(m+=e.readSVarint())<U&&(U=m),m>re&&(re=m);else if(r!==7)throw new Error("unknown command "+r)}return[A,U,I,re]},Xn.prototype.toGeoJSON=function(e,t,r){var l,f,m=this.extent*Math.pow(2,r),A=this.extent*e,I=this.extent*t,U=this.loadGeometry(),re=Xn.types[this.type];function he(ot){for(var wt=0;wt<ot.length;wt++){var Tt=ot[wt];ot[wt]=[360*(Tt.x+A)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(Tt.y+I)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var Ae=[];for(l=0;l<U.length;l++)Ae[l]=U[l][0];he(U=Ae);break;case 2:for(l=0;l<U.length;l++)he(U[l]);break;case 3:for(U=function(ot){var wt=ot.length;if(wt<=1)return[ot];for(var Tt,Wt,Zt=[],nr=0;nr<wt;nr++){var dr=ra(ot[nr]);dr!==0&&(Wt===void 0&&(Wt=dr<0),Wt===dr<0?(Tt&&Zt.push(Tt),Tt=[ot[nr]]):Tt.push(ot[nr]))}return Tt&&Zt.push(Tt),Zt}(U),l=0;l<U.length;l++)for(f=0;f<U[l].length;f++)he(U[l][f])}U.length===1?U=U[0]:re="Multi"+re;var Pe={type:"Feature",geometry:{type:re,coordinates:U},properties:this.properties};return"id"in this&&(Pe.id=this.id),Pe};var Oi=la;function la(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Yi,this,t),this.length=this._features.length}function Yi(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(l){for(var f=null,m=l.readVarint()+l.pos;l.pos<m;){var A=l.readVarint()>>3;f=A===1?l.readString():A===2?l.readFloat():A===3?l.readDouble():A===4?l.readVarint64():A===5?l.readVarint():A===6?l.readSVarint():A===7?l.readBoolean():null}return f}(r))}function ja(e,t,r){if(e===3){var l=new Oi(r,r.readVarint()+r.pos);l.length&&(t[l.name]=l)}}la.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new zn(this._pbf,t,this.extent,this._keys,this._values)};var Ro={VectorTile:function(t,r){this.layers=t.readFields(ja,{},r)},VectorTileFeature:zn,VectorTileLayer:Oi},So=Ro.VectorTileFeature.types,Ya=Math.pow(2,13);function Vo(e,t,r,l,f,m,A,I){e.emplaceBack(t,r,2*Math.floor(l*Ya)+A,f*Ya*2,m*Ya*2,Math.round(I))}var ea=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Mu,this.indexArray=new Iu,this.programConfigurations=new Ii(t.layers,t.zoom),this.segments=new qe,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function fo(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}ea.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=_e("fill-extrusion",this.layers,t);for(var l=0,f=e;l<f.length;l+=1){var m=f[l],A=m.feature,I=m.id,U=m.index,re=m.sourceLayerIndex,he=this.layers[0]._featureFilter.needGeometry,Ae=Wa(A,he);if(this.layers[0]._featureFilter.filter(new Mi(this.zoom),Ae,r)){var Pe={id:I,sourceLayerIndex:re,index:U,geometry:he?Ae.geometry:Ea(A),properties:A.properties,type:A.type,patterns:{}};this.hasPattern?this.features.push(ut("fill-extrusion",this.layers,Pe,this.zoom,t)):this.addFeature(Pe,Pe.geometry,U,r,{}),t.featureIndex.insert(A,Pe.geometry,U,re,this.index,!0)}}},ea.prototype.addFeatures=function(e,t,r){for(var l=0,f=this.features;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,r)}},ea.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},ea.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ea.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ea.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,an),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},ea.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ea.prototype.addFeature=function(e,t,r,l,f){for(var m=0,A=z(t,500);m<A.length;m+=1){for(var I=A[m],U=0,re=0,he=I;re<he.length;re+=1)U+=he[re].length;for(var Ae=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Pe=0,ot=I;Pe<ot.length;Pe+=1){var wt=ot[Pe];if(wt.length!==0&&!((Ki=wt).every(function(Ri){return Ri.x<0})||Ki.every(function(Ri){return Ri.x>8192})||Ki.every(function(Ri){return Ri.y<0})||Ki.every(function(Ri){return Ri.y>8192})))for(var Tt=0,Wt=0;Wt<wt.length;Wt++){var Zt=wt[Wt];if(Wt>=1){var nr=wt[Wt-1];if(!fo(Zt,nr)){Ae.vertexLength+4>qe.MAX_VERTEX_ARRAY_LENGTH&&(Ae=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var dr=Zt.sub(nr)._perp()._unit(),br=nr.dist(Zt);Tt+br>32768&&(Tt=0),Vo(this.layoutVertexArray,Zt.x,Zt.y,dr.x,dr.y,0,0,Tt),Vo(this.layoutVertexArray,Zt.x,Zt.y,dr.x,dr.y,0,1,Tt),Vo(this.layoutVertexArray,nr.x,nr.y,dr.x,dr.y,0,0,Tt+=br),Vo(this.layoutVertexArray,nr.x,nr.y,dr.x,dr.y,0,1,Tt);var zr=Ae.vertexLength;this.indexArray.emplaceBack(zr,zr+2,zr+1),this.indexArray.emplaceBack(zr+1,zr+2,zr+3),Ae.vertexLength+=4,Ae.primitiveLength+=2}}}}if(Ae.vertexLength+U>qe.MAX_VERTEX_ARRAY_LENGTH&&(Ae=this.segments.prepareSegment(U,this.layoutVertexArray,this.indexArray)),So[e.type]==="Polygon"){for(var Rr=[],pn=[],hn=Ae.vertexLength,Ln=0,Jn=I;Ln<Jn.length;Ln+=1){var Kn=Jn[Ln];if(Kn.length!==0){Kn!==I[0]&&pn.push(Rr.length/2);for(var Nn=0;Nn<Kn.length;Nn++){var Si=Kn[Nn];Vo(this.layoutVertexArray,Si.x,Si.y,0,0,1,1,0),Rr.push(Si.x),Rr.push(Si.y)}}}for(var li=Qu(Rr,pn),ei=0;ei<li.length;ei+=3)this.indexArray.emplaceBack(hn+li[ei],hn+li[ei+2],hn+li[ei+1]);Ae.primitiveLength+=li.length/3,Ae.vertexLength+=U}}var Ki;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,l)},In("FillExtrusionBucket",ea,{omit:["layers","features"]});var iu={paint:new Po({"fill-extrusion-opacity":new $n(He["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Fn(He["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new $n(He["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new $n(He["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Tc(He["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Fn(He["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Fn(He["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new $n(He["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Ta=function(e){function t(r){e.call(this,r,iu)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new ea(r)},t.prototype.queryRadius=function(){return co(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,l,f,m,A,I,U,re){var he=Du(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),I.angle,U),Ae=this.paint.get("fill-extrusion-height").evaluate(l,f),Pe=this.paint.get("fill-extrusion-base").evaluate(l,f),ot=function(Tt,Wt,Zt,nr){for(var dr=[],br=0,zr=Tt;br<zr.length;br+=1){var Rr=zr[br],pn=[Rr.x,Rr.y,0,1];Vs(pn,pn,Wt),dr.push(new te(pn[0]/pn[3],pn[1]/pn[3]))}return dr}(he,re),wt=function(Tt,Wt,Zt,nr){for(var dr=[],br=[],zr=nr[8]*Wt,Rr=nr[9]*Wt,pn=nr[10]*Wt,hn=nr[11]*Wt,Ln=nr[8]*Zt,Jn=nr[9]*Zt,Kn=nr[10]*Zt,Nn=nr[11]*Zt,Si=0,li=Tt;Si<li.length;Si+=1){for(var ei=[],Ki=[],Ri=0,Va=li[Si];Ri<Va.length;Ri+=1){var mi=Va[Ri],ia=mi.x,Zo=mi.y,ba=nr[0]*ia+nr[4]*Zo+nr[12],Wo=nr[1]*ia+nr[5]*Zo+nr[13],Xo=nr[2]*ia+nr[6]*Zo+nr[14],ls=nr[3]*ia+nr[7]*Zo+nr[15],Eu=Xo+pn,cs=ls+hn,el=ba+Ln,ou=Wo+Jn,tl=Xo+Kn,su=ls+Nn,Ws=new te((ba+zr)/cs,(Wo+Rr)/cs);Ws.z=Eu/cs,ei.push(Ws);var uu=new te(el/su,ou/su);uu.z=tl/su,Ki.push(uu)}dr.push(ei),br.push(Ki)}return[dr,br]}(m,Pe,Ae,re);return function(Tt,Wt,Zt){var nr=1/0;jo(Zt,Wt)&&(nr=bi(Zt,Wt[0]));for(var dr=0;dr<Wt.length;dr++)for(var br=Wt[dr],zr=Tt[dr],Rr=0;Rr<br.length-1;Rr++){var pn=br[Rr],hn=[pn,br[Rr+1],zr[Rr+1],zr[Rr],pn];yu(Zt,hn)&&(nr=Math.min(nr,bi(Zt,hn)))}return nr!==1/0&&nr}(wt[0],wt[1],ot)},t}(ru);function Ua(e,t){return e.x*t.x+e.y*t.y}function bi(e,t){if(e.length===1){for(var r,l=0,f=t[l++];!r||f.equals(r);)if(!(r=t[l++]))return 1/0;for(;l<t.length;l++){var m=t[l],A=e[0],I=r.sub(f),U=m.sub(f),re=A.sub(f),he=Ua(I,I),Ae=Ua(I,U),Pe=Ua(U,U),ot=Ua(re,I),wt=Ua(re,U),Tt=he*Pe-Ae*Ae,Wt=(Pe*ot-Ae*wt)/Tt,Zt=(he*wt-Ae*ot)/Tt,nr=f.z*(1-Wt-Zt)+r.z*Wt+m.z*Zt;if(isFinite(nr))return nr}return 1/0}for(var dr=1/0,br=0,zr=t;br<zr.length;br+=1)dr=Math.min(dr,zr[br].z);return dr}var Do=Za([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,fc=Za([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Wf=Ro.VectorTileFeature.types,fh=Math.cos(Math.PI/180*37.5),Xf=Math.pow(2,14)/.5,Bu=function(t){var r=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(l){r.gradients[l.id]={}}),this.layoutVertexArray=new Ls,this.layoutVertexArray2=new kl,this.indexArray=new Iu,this.programConfigurations=new Ii(t.layers,t.zoom),this.segments=new qe,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};Bu.prototype.populate=function(e,t,r){this.hasPattern=_e("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),f=[],m=0,A=e;m<A.length;m+=1){var I=A[m],U=I.feature,re=I.id,he=I.index,Ae=I.sourceLayerIndex,Pe=this.layers[0]._featureFilter.needGeometry,ot=Wa(U,Pe);if(this.layers[0]._featureFilter.filter(new Mi(this.zoom),ot,r)){var wt=l?l.evaluate(ot,{},r):void 0,Tt={id:re,properties:U.properties,type:U.type,sourceLayerIndex:Ae,index:he,geometry:Pe?ot.geometry:Ea(U),patterns:{},sortKey:wt};f.push(Tt)}}l&&f.sort(function(pn,hn){return pn.sortKey-hn.sortKey});for(var Wt=0,Zt=f;Wt<Zt.length;Wt+=1){var nr=Zt[Wt],dr=nr.geometry,br=nr.index,zr=nr.sourceLayerIndex;if(this.hasPattern){var Rr=ut("line",this.layers,nr,this.zoom,t);this.patternFeatures.push(Rr)}else this.addFeature(nr,dr,br,r,{});t.featureIndex.insert(e[br].feature,dr,br,zr,this.index)}},Bu.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Bu.prototype.addFeatures=function(e,t,r){for(var l=0,f=this.patternFeatures;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,r)}},Bu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Bu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Bu.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,fc)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Do),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Bu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Bu.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Bu.prototype.addFeature=function(e,t,r,l,f){var m=this.layers[0].layout,A=m.get("line-join").evaluate(e,{}),I=m.get("line-cap"),U=m.get("line-miter-limit"),re=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var he=0,Ae=t;he<Ae.length;he+=1)this.addLine(Ae[he],e,A,I,U,re);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,l)},Bu.prototype.addLine=function(e,t,r,l,f,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var A=0;A<e.length-1;A++)this.totalDistance+=e[A].dist(e[A+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var I=Wf[t.type]==="Polygon",U=e.length;U>=2&&e[U-1].equals(e[U-2]);)U--;for(var re=0;re<U-1&&e[re].equals(e[re+1]);)re++;if(!(U<(I?3:2))){r==="bevel"&&(f=1.05);var he,Ae=this.overscaling<=16?122880/(512*this.overscaling):0,Pe=this.segments.prepareSegment(10*U,this.layoutVertexArray,this.indexArray),ot=void 0,wt=void 0,Tt=void 0,Wt=void 0;this.e1=this.e2=-1,I&&(Wt=e[re].sub(he=e[U-2])._unit()._perp());for(var Zt=re;Zt<U;Zt++)if(!(wt=Zt===U-1?I?e[re+1]:void 0:e[Zt+1])||!e[Zt].equals(wt)){Wt&&(Tt=Wt),he&&(ot=he),he=e[Zt],Wt=wt?wt.sub(he)._unit()._perp():Tt;var nr=(Tt=Tt||Wt).add(Wt);nr.x===0&&nr.y===0||nr._unit();var dr=Tt.x*Wt.x+Tt.y*Wt.y,br=nr.x*Wt.x+nr.y*Wt.y,zr=br!==0?1/br:1/0,Rr=2*Math.sqrt(2-2*br),pn=br<fh&&ot&&wt,hn=Tt.x*Wt.y-Tt.y*Wt.x>0;if(pn&&Zt>re){var Ln=he.dist(ot);if(Ln>2*Ae){var Jn=he.sub(he.sub(ot)._mult(Ae/Ln)._round());this.updateDistance(ot,Jn),this.addCurrentVertex(Jn,Tt,0,0,Pe),ot=Jn}}var Kn=ot&&wt,Nn=Kn?r:I?"butt":l;if(Kn&&Nn==="round"&&(zr<m?Nn="miter":zr<=2&&(Nn="fakeround")),Nn==="miter"&&zr>f&&(Nn="bevel"),Nn==="bevel"&&(zr>2&&(Nn="flipbevel"),zr<f&&(Nn="miter")),ot&&this.updateDistance(ot,he),Nn==="miter")nr._mult(zr),this.addCurrentVertex(he,nr,0,0,Pe);else if(Nn==="flipbevel"){if(zr>100)nr=Wt.mult(-1);else{var Si=zr*Tt.add(Wt).mag()/Tt.sub(Wt).mag();nr._perp()._mult(Si*(hn?-1:1))}this.addCurrentVertex(he,nr,0,0,Pe),this.addCurrentVertex(he,nr.mult(-1),0,0,Pe)}else if(Nn==="bevel"||Nn==="fakeround"){var li=-Math.sqrt(zr*zr-1),ei=hn?li:0,Ki=hn?0:li;if(ot&&this.addCurrentVertex(he,Tt,ei,Ki,Pe),Nn==="fakeround")for(var Ri=Math.round(180*Rr/Math.PI/20),Va=1;Va<Ri;Va++){var mi=Va/Ri;if(mi!==.5){var ia=mi-.5;mi+=mi*ia*(mi-1)*((1.0904+dr*(dr*(3.55645-1.43519*dr)-3.2452))*ia*ia+(.848013+dr*(.215638*dr-1.06021)))}var Zo=Wt.sub(Tt)._mult(mi)._add(Tt)._unit()._mult(hn?-1:1);this.addHalfVertex(he,Zo.x,Zo.y,!1,hn,0,Pe)}wt&&this.addCurrentVertex(he,Wt,-ei,-Ki,Pe)}else if(Nn==="butt")this.addCurrentVertex(he,nr,0,0,Pe);else if(Nn==="square"){var ba=ot?1:-1;this.addCurrentVertex(he,nr,ba,ba,Pe)}else Nn==="round"&&(ot&&(this.addCurrentVertex(he,Tt,0,0,Pe),this.addCurrentVertex(he,Tt,1,1,Pe,!0)),wt&&(this.addCurrentVertex(he,Wt,-1,-1,Pe,!0),this.addCurrentVertex(he,Wt,0,0,Pe)));if(pn&&Zt<U-1){var Wo=he.dist(wt);if(Wo>2*Ae){var Xo=he.add(wt.sub(he)._mult(Ae/Wo)._round());this.updateDistance(he,Xo),this.addCurrentVertex(Xo,Wt,0,0,Pe),he=Xo}}}}},Bu.prototype.addCurrentVertex=function(e,t,r,l,f,m){m===void 0&&(m=!1);var A=t.y*l-t.x,I=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,m,!1,r,f),this.addHalfVertex(e,A,I,m,!0,-l,f),this.distance>Xf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,l,f,m))},Bu.prototype.addHalfVertex=function(e,t,r,l,f,m,A){var I=.5*(this.lineClips?this.scaledDistance*(Xf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(m===0?0:m<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var U=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,U),A.primitiveLength++),f?this.e2=U:this.e1=U},Bu.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Bu.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},In("LineBucket",Bu,{omit:["layers","patternFeatures"]});var Yf=new Po({"line-cap":new $n(He.layout_line["line-cap"]),"line-join":new Fn(He.layout_line["line-join"]),"line-miter-limit":new $n(He.layout_line["line-miter-limit"]),"line-round-limit":new $n(He.layout_line["line-round-limit"]),"line-sort-key":new Fn(He.layout_line["line-sort-key"])}),ff={paint:new Po({"line-opacity":new Fn(He.paint_line["line-opacity"]),"line-color":new Fn(He.paint_line["line-color"]),"line-translate":new $n(He.paint_line["line-translate"]),"line-translate-anchor":new $n(He.paint_line["line-translate-anchor"]),"line-width":new Fn(He.paint_line["line-width"]),"line-gap-width":new Fn(He.paint_line["line-gap-width"]),"line-offset":new Fn(He.paint_line["line-offset"]),"line-blur":new Fn(He.paint_line["line-blur"]),"line-dasharray":new vs(He.paint_line["line-dasharray"]),"line-pattern":new Tc(He.paint_line["line-pattern"]),"line-gradient":new ko(He.paint_line["line-gradient"])}),layout:Yf},Kf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,l){return l=new Mi(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,r,l)},t.prototype.evaluate=function(r,l,f,m){return l=Le({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,r,l,f,m)},t}(Fn))(ff.paint.properties["line-width"].specification);Kf.useIntegerZoom=!0;var Th=function(e){function t(r){e.call(this,r,ff),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof ya,this.gradientVersion=(this.gradientVersion+1)%ke)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,l){e.prototype.recalculate.call(this,r,l),this.paint._values["line-floorwidth"]=Kf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Bu(r)},t.prototype.queryRadius=function(r){var l=r,f=hh(As("line-width",this,l),As("line-gap-width",this,l)),m=As("line-offset",this,l);return f/2+Math.abs(m)+co(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,l,f,m,A,I,U){var re=Du(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),I.angle,U),he=U/2*hh(this.paint.get("line-width").evaluate(l,f),this.paint.get("line-gap-width").evaluate(l,f)),Ae=this.paint.get("line-offset").evaluate(l,f);return Ae&&(m=function(Pe,ot){for(var wt=[],Tt=new te(0,0),Wt=0;Wt<Pe.length;Wt++){for(var Zt=Pe[Wt],nr=[],dr=0;dr<Zt.length;dr++){var br=Zt[dr],zr=Zt[dr+1],Rr=dr===0?Tt:br.sub(Zt[dr-1])._unit()._perp(),pn=dr===Zt.length-1?Tt:zr.sub(br)._unit()._perp(),hn=Rr._add(pn)._unit();hn._mult(1/(hn.x*pn.x+hn.y*pn.y)),nr.push(hn._mult(ot)._add(br))}wt.push(nr)}return wt}(m,Ae*U)),function(Pe,ot,wt){for(var Tt=0;Tt<ot.length;Tt++){var Wt=ot[Tt];if(Pe.length>=3){for(var Zt=0;Zt<Wt.length;Zt++)if(Ru(Pe,Wt[Zt]))return!0}if(Ts(Pe,Wt,wt))return!0}return!1}(re,m,he)},t.prototype.isTileClipped=function(){return!0},t}(ru);function hh(e,t){return t>0?t+2*e:e}var Af=Za([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),oh=Za([{name:"a_projected_pos",components:3,type:"Float32"}],4),$f=(Za([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Za([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),dh=(Za([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Za([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Fh=Za([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function _f(e,t,r){return e.sections.forEach(function(l){l.text=function(f,m,A){var I=m.layout.get("text-transform").evaluate(A,{});return I==="uppercase"?f=f.toLocaleUpperCase():I==="lowercase"&&(f=f.toLocaleLowerCase()),ss.applyArabicShaping&&(f=ss.applyArabicShaping(f)),f}(l.text,t,r)}),e}Za([{name:"triangle",components:3,type:"Uint16"}]),Za([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Za([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Za([{type:"Float32",name:"offsetX"}]),Za([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var zf={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Ah=function(t,r,l,f,m){var A,I,U=8*m-f-1,re=(1<<U)-1,he=re>>1,Ae=-7,Pe=l?m-1:0,ot=l?-1:1,wt=t[r+Pe];for(Pe+=ot,A=wt&(1<<-Ae)-1,wt>>=-Ae,Ae+=U;Ae>0;A=256*A+t[r+Pe],Pe+=ot,Ae-=8);for(I=A&(1<<-Ae)-1,A>>=-Ae,Ae+=f;Ae>0;I=256*I+t[r+Pe],Pe+=ot,Ae-=8);if(A===0)A=1-he;else{if(A===re)return I?NaN:1/0*(wt?-1:1);I+=Math.pow(2,f),A-=he}return(wt?-1:1)*I*Math.pow(2,A-f)},xe=function(t,r,l,f,m,A){var I,U,re,he=8*A-m-1,Ae=(1<<he)-1,Pe=Ae>>1,ot=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,wt=f?0:A-1,Tt=f?1:-1,Wt=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(U=isNaN(r)?1:0,I=Ae):(I=Math.floor(Math.log(r)/Math.LN2),r*(re=Math.pow(2,-I))<1&&(I--,re*=2),(r+=I+Pe>=1?ot/re:ot*Math.pow(2,1-Pe))*re>=2&&(I++,re/=2),I+Pe>=Ae?(U=0,I=Ae):I+Pe>=1?(U=(r*re-1)*Math.pow(2,m),I+=Pe):(U=r*Math.pow(2,Pe-1)*Math.pow(2,m),I=0));m>=8;t[l+wt]=255&U,wt+=Tt,U/=256,m-=8);for(I=I<<m|U,he+=m;he>0;t[l+wt]=255&I,wt+=Tt,I/=256,he-=8);t[l+wt-Tt]|=128*Wt},Be=Et;function Et(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Et.Varint=0,Et.Fixed64=1,Et.Bytes=2,Et.Fixed32=5;var gr=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Mr(e){return e.type===Et.Bytes?e.readVarint()+e.pos:e.pos+1}function Cr(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function xr(e,t,r){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(l);for(var f=r.pos-1;f>=e;f--)r.buf[f+l]=r.buf[f]}function Wr(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function sn(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function en(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function Qr(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function fn(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function Cn(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function cn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function rn(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function yr(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function vr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Xr(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function Pn(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Lr(e,t,r){e===1&&r.readMessage(qn,t)}function qn(e,t,r){if(e===3){var l=r.readMessage(Jr,{}),f=l.width,m=l.height,A=l.left,I=l.top,U=l.advance;t.push({id:l.id,bitmap:new Gs({width:f+6,height:m+6},l.bitmap),metrics:{width:f,height:m,left:A,top:I,advance:U}})}}function Jr(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function Br(e){for(var t=0,r=0,l=0,f=e;l<f.length;l+=1){var m=f[l];t+=m.w*m.h,r=Math.max(r,m.w)}e.sort(function(Tt,Wt){return Wt.h-Tt.h});for(var A=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],I=0,U=0,re=0,he=e;re<he.length;re+=1)for(var Ae=he[re],Pe=A.length-1;Pe>=0;Pe--){var ot=A[Pe];if(!(Ae.w>ot.w||Ae.h>ot.h)){if(Ae.x=ot.x,Ae.y=ot.y,U=Math.max(U,Ae.y+Ae.h),I=Math.max(I,Ae.x+Ae.w),Ae.w===ot.w&&Ae.h===ot.h){var wt=A.pop();Pe<A.length&&(A[Pe]=wt)}else Ae.h===ot.h?(ot.x+=Ae.w,ot.w-=Ae.w):Ae.w===ot.w?(ot.y+=Ae.h,ot.h-=Ae.h):(A.push({x:ot.x+Ae.w,y:ot.y,w:ot.w-Ae.w,h:Ae.h}),ot.y+=Ae.h,ot.h-=Ae.h);break}}return{w:I,h:U,fill:t/(I*U)||0}}Et.prototype={destroy:function(){this.buf=null},readFields:function(t,r,l){for(l=l||this.length;this.pos<l;){var f=this.readVarint(),m=f>>3,A=this.pos;this.type=7&f,t(m,r,this),this.pos===A&&this.skip(f)}return r},readMessage:function(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function(){var t=vr(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Pn(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=vr(this.buf,this.pos)+4294967296*vr(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=vr(this.buf,this.pos)+4294967296*Pn(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Ah(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Ah(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,l,f=this.buf;return r=127&(l=f[this.pos++]),l<128?r:(r|=(127&(l=f[this.pos++]))<<7,l<128?r:(r|=(127&(l=f[this.pos++]))<<14,l<128?r:(r|=(127&(l=f[this.pos++]))<<21,l<128?r:function(m,A,I){var U,re,he=I.buf;if(U=(112&(re=he[I.pos++]))>>4,re<128||(U|=(127&(re=he[I.pos++]))<<3,re<128)||(U|=(127&(re=he[I.pos++]))<<10,re<128)||(U|=(127&(re=he[I.pos++]))<<17,re<128)||(U|=(127&(re=he[I.pos++]))<<24,re<128)||(U|=(1&(re=he[I.pos++]))<<31,re<128))return Cr(m,U,A);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(l=f[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&gr?function(l,f,m){return gr.decode(l.subarray(f,m))}(this.buf,r,t):function(l,f,m){for(var A="",I=f;I<m;){var U,re,he,Ae=l[I],Pe=null,ot=Ae>239?4:Ae>223?3:Ae>191?2:1;if(I+ot>m)break;ot===1?Ae<128&&(Pe=Ae):ot===2?(192&(U=l[I+1]))==128&&(Pe=(31&Ae)<<6|63&U)<=127&&(Pe=null):ot===3?(re=l[I+2],(192&(U=l[I+1]))==128&&(192&re)==128&&((Pe=(15&Ae)<<12|(63&U)<<6|63&re)<=2047||Pe>=55296&&Pe<=57343)&&(Pe=null)):ot===4&&(re=l[I+2],he=l[I+3],(192&(U=l[I+1]))==128&&(192&re)==128&&(192&he)==128&&((Pe=(15&Ae)<<18|(63&U)<<12|(63&re)<<6|63&he)<=65535||Pe>=1114112)&&(Pe=null)),Pe===null?(Pe=65533,ot=1):Pe>65535&&(Pe-=65536,A+=String.fromCharCode(Pe>>>10&1023|55296),Pe=56320|1023&Pe),A+=String.fromCharCode(Pe),I+=ot}return A}(this.buf,r,t)},readBytes:function(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r},readPackedVarint:function(t,r){if(this.type!==Et.Bytes)return t.push(this.readVarint(r));var l=Mr(this);for(t=t||[];this.pos<l;)t.push(this.readVarint(r));return t},readPackedSVarint:function(t){if(this.type!==Et.Bytes)return t.push(this.readSVarint());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Et.Bytes)return t.push(this.readBoolean());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Et.Bytes)return t.push(this.readFloat());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Et.Bytes)return t.push(this.readDouble());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Et.Bytes)return t.push(this.readFixed32());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Et.Bytes)return t.push(this.readSFixed32());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Et.Bytes)return t.push(this.readFixed64());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Et.Bytes)return t.push(this.readSFixed64());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed64());return t},skip:function(t){var r=7&t;if(r===Et.Varint)for(;this.buf[this.pos++]>127;);else if(r===Et.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Et.Fixed32)this.pos+=4;else{if(r!==Et.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,r){this.writeVarint(t<<3|r)},realloc:function(t){for(var r=this.length||16;r<this.pos+t;)r*=2;if(r!==this.length){var l=new Uint8Array(r);l.set(this.buf),this.buf=l,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Xr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Xr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Xr(this.buf,-1&t,this.pos),Xr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Xr(this.buf,-1&t,this.pos),Xr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(r,l){var f,m;if(r>=0?(f=r%4294967296|0,m=r/4294967296|0):(m=~(-r/4294967296),4294967295^(f=~(-r%4294967296))?f=f+1|0:(f=0,m=m+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(A,I,U){U.buf[U.pos++]=127&A|128,A>>>=7,U.buf[U.pos++]=127&A|128,A>>>=7,U.buf[U.pos++]=127&A|128,A>>>=7,U.buf[U.pos++]=127&A|128,U.buf[U.pos]=127&(A>>>=7)}(f,0,l),function(A,I){var U=(7&A)<<4;I.buf[I.pos++]|=U|((A>>>=3)?128:0),A&&(I.buf[I.pos++]=127&A|((A>>>=7)?128:0),A&&(I.buf[I.pos++]=127&A|((A>>>=7)?128:0),A&&(I.buf[I.pos++]=127&A|((A>>>=7)?128:0),A&&(I.buf[I.pos++]=127&A|((A>>>=7)?128:0),A&&(I.buf[I.pos++]=127&A)))))}(m,l)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var r=this.pos;this.pos=function(f,m,A){for(var I,U,re=0;re<m.length;re++){if((I=m.charCodeAt(re))>55295&&I<57344){if(!U){I>56319||re+1===m.length?(f[A++]=239,f[A++]=191,f[A++]=189):U=I;continue}if(I<56320){f[A++]=239,f[A++]=191,f[A++]=189,U=I;continue}I=U-55296<<10|I-56320|65536,U=null}else U&&(f[A++]=239,f[A++]=191,f[A++]=189,U=null);I<128?f[A++]=I:(I<2048?f[A++]=I>>6|192:(I<65536?f[A++]=I>>12|224:(f[A++]=I>>18|240,f[A++]=I>>12&63|128),f[A++]=I>>6&63|128),f[A++]=63&I|128)}return A}(this.buf,t,this.pos);var l=this.pos-r;l>=128&&xr(r,l,this),this.pos=r-1,this.writeVarint(l),this.pos+=l},writeFloat:function(t){this.realloc(4),xe(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),xe(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var r=t.length;this.writeVarint(r),this.realloc(r);for(var l=0;l<r;l++)this.buf[this.pos++]=t[l]},writeRawMessage:function(t,r){this.pos++;var l=this.pos;t(r,this);var f=this.pos-l;f>=128&&xr(l,f,this),this.pos=l-1,this.writeVarint(f),this.pos+=f},writeMessage:function(t,r,l){this.writeTag(t,Et.Bytes),this.writeRawMessage(r,l)},writePackedVarint:function(t,r){r.length&&this.writeMessage(t,Wr,r)},writePackedSVarint:function(t,r){r.length&&this.writeMessage(t,sn,r)},writePackedBoolean:function(t,r){r.length&&this.writeMessage(t,fn,r)},writePackedFloat:function(t,r){r.length&&this.writeMessage(t,en,r)},writePackedDouble:function(t,r){r.length&&this.writeMessage(t,Qr,r)},writePackedFixed32:function(t,r){r.length&&this.writeMessage(t,Cn,r)},writePackedSFixed32:function(t,r){r.length&&this.writeMessage(t,cn,r)},writePackedFixed64:function(t,r){r.length&&this.writeMessage(t,rn,r)},writePackedSFixed64:function(t,r){r.length&&this.writeMessage(t,yr,r)},writeBytesField:function(t,r){this.writeTag(t,Et.Bytes),this.writeBytes(r)},writeFixed32Field:function(t,r){this.writeTag(t,Et.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(t,r){this.writeTag(t,Et.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(t,r){this.writeTag(t,Et.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(t,r){this.writeTag(t,Et.Fixed64),this.writeSFixed64(r)},writeVarintField:function(t,r){this.writeTag(t,Et.Varint),this.writeVarint(r)},writeSVarintField:function(t,r){this.writeTag(t,Et.Varint),this.writeSVarint(r)},writeStringField:function(t,r){this.writeTag(t,Et.Bytes),this.writeString(r)},writeFloatField:function(t,r){this.writeTag(t,Et.Fixed32),this.writeFloat(r)},writeDoubleField:function(t,r){this.writeTag(t,Et.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,r){this.writeVarintField(t,Boolean(r))}};var Ur=function(t,r){var l=r.pixelRatio,f=r.version,m=r.stretchX,A=r.stretchY,I=r.content;this.paddedRect=t,this.pixelRatio=l,this.stretchX=m,this.stretchY=A,this.content=I,this.version=f},Kr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Kr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Kr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Kr.tlbr.get=function(){return this.tl.concat(this.br)},Kr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Ur.prototype,Kr);var Yn=function(t,r){var l={},f={};this.haveRenderCallbacks=[];var m=[];this.addImages(t,l,m),this.addImages(r,f,m);var A=Br(m),I=new Lo({width:A.w||1,height:A.h||1});for(var U in t){var re=t[U],he=l[U].paddedRect;Lo.copy(re.data,I,{x:0,y:0},{x:he.x+1,y:he.y+1},re.data)}for(var Ae in r){var Pe=r[Ae],ot=f[Ae].paddedRect,wt=ot.x+1,Tt=ot.y+1,Wt=Pe.data.width,Zt=Pe.data.height;Lo.copy(Pe.data,I,{x:0,y:0},{x:wt,y:Tt},Pe.data),Lo.copy(Pe.data,I,{x:0,y:Zt-1},{x:wt,y:Tt-1},{width:Wt,height:1}),Lo.copy(Pe.data,I,{x:0,y:0},{x:wt,y:Tt+Zt},{width:Wt,height:1}),Lo.copy(Pe.data,I,{x:Wt-1,y:0},{x:wt-1,y:Tt},{width:1,height:Zt}),Lo.copy(Pe.data,I,{x:0,y:0},{x:wt+Wt,y:Tt},{width:1,height:Zt})}this.image=I,this.iconPositions=l,this.patternPositions=f};Yn.prototype.addImages=function(e,t,r){for(var l in e){var f=e[l],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};r.push(m),t[l]=new Ur(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},Yn.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},Yn.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;r.update(t.data,void 0,{x:l[0],y:l[1]})}},In("ImagePosition",Ur),In("ImageAtlas",Yn);var ti={horizontal:1,vertical:2,horizontalOnly:3},un=function(){this.scale=1,this.fontStack="",this.imageName=null};un.forText=function(e,t){var r=new un;return r.scale=e||1,r.fontStack=t,r},un.forImage=function(e){var t=new un;return t.imageName=e,t};var Vr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Nr(e,t,r,l,f,m,A,I,U,re,he,Ae,Pe,ot,wt,Tt){var Wt,Zt=Vr.fromFeature(e,f);Ae===ti.vertical&&Zt.verticalizePunctuation();var nr=ss.processBidirectionalText,dr=ss.processStyledBidirectionalText;if(nr&&Zt.sections.length===1){Wt=[];for(var br=0,zr=nr(Zt.toString(),ca(Zt,re,m,t,l,ot,wt));br<zr.length;br+=1){var Rr=zr[br],pn=new Vr;pn.text=Rr,pn.sections=Zt.sections;for(var hn=0;hn<Rr.length;hn++)pn.sectionIndex.push(0);Wt.push(pn)}}else if(dr){Wt=[];for(var Ln=0,Jn=dr(Zt.text,Zt.sectionIndex,ca(Zt,re,m,t,l,ot,wt));Ln<Jn.length;Ln+=1){var Kn=Jn[Ln],Nn=new Vr;Nn.text=Kn[0],Nn.sectionIndex=Kn[1],Nn.sections=Zt.sections,Wt.push(Nn)}}else Wt=function(ei,Ki){for(var Ri=[],Va=ei.text,mi=0,ia=0,Zo=Ki;ia<Zo.length;ia+=1){var ba=Zo[ia];Ri.push(ei.substring(mi,ba)),mi=ba}return mi<Va.length&&Ri.push(ei.substring(mi,Va.length)),Ri}(Zt,ca(Zt,re,m,t,l,ot,wt));var Si=[],li={positionedLines:Si,text:Zt.toString(),top:he[1],bottom:he[1],left:he[0],right:he[0],writingMode:Ae,iconsInText:!1,verticalizable:!1};return function(ei,Ki,Ri,Va,mi,ia,Zo,ba,Wo,Xo,ls,Eu){for(var cs=0,el=-17,ou=0,tl=0,su=ba==="right"?1:ba==="left"?0:.5,Ws=0,uu=0,ma=mi;uu<ma.length;uu+=1){var aa=ma[uu];aa.trim();var eo=aa.getMaxScale(),vo=24*(eo-1),Tu={positionedGlyphs:[],lineOffset:0};ei.positionedLines[Ws]=Tu;var Eo=Tu.positionedGlyphs,Yo=0;if(aa.length()){for(var ku=0;ku<aa.length();ku++){var fa=aa.getSection(ku),eh=aa.getSectionIndex(ku),Yc=aa.getCharCode(ku),pf=0,dc=null,ju=null,Bf=null,kf=24,th=!(Wo===ti.horizontal||!ls&&!Sc(Yc)||ls&&(di[Yc]||(vh=Yc,qr.Arabic(vh)||qr["Arabic Supplement"](vh)||qr["Arabic Extended-A"](vh)||qr["Arabic Presentation Forms-A"](vh)||qr["Arabic Presentation Forms-B"](vh))));if(fa.imageName){var wh=Va[fa.imageName];if(!wh)continue;Bf=fa.imageName,ei.iconsInText=ei.iconsInText||!0,ju=wh.paddedRect;var wf=wh.displaySize;fa.scale=24*fa.scale/Eu,pf=vo+(24-wf[1]*fa.scale),kf=(dc={width:wf[0],height:wf[1],left:1,top:-3,advance:th?wf[1]:wf[0]}).advance;var Ph=th?wf[0]*fa.scale-24*eo:wf[1]*fa.scale-24*eo;Ph>0&&Ph>Yo&&(Yo=Ph)}else{var rh=Ri[fa.fontStack],ph=rh&&rh[Yc];if(ph&&ph.rect)ju=ph.rect,dc=ph.metrics;else{var Wh=Ki[fa.fontStack],Bh=Wh&&Wh[Yc];if(!Bh)continue;dc=Bh.metrics}pf=24*(eo-fa.scale)}th?(ei.verticalizable=!0,Eo.push({glyph:Yc,imageName:Bf,x:cs,y:el+pf,vertical:th,scale:fa.scale,fontStack:fa.fontStack,sectionIndex:eh,metrics:dc,rect:ju}),cs+=kf*fa.scale+Xo):(Eo.push({glyph:Yc,imageName:Bf,x:cs,y:el+pf,vertical:th,scale:fa.scale,fontStack:fa.fontStack,sectionIndex:eh,metrics:dc,rect:ju}),cs+=dc.advance*fa.scale+Xo)}Eo.length!==0&&(ou=Math.max(cs-Xo,ou),Ho(Eo,0,Eo.length-1,su,Yo)),cs=0;var Xh=ia*eo+Yo;Tu.lineOffset=Math.max(Yo,vo),el+=Xh,tl=Math.max(Xh,tl),++Ws}else el+=ia,++Ws}var vh,Mh=el- -17,Yh=Go(Zo),mh=Yh.horizontalAlign,nh=Yh.verticalAlign;(function(sh,Kh,kh,gh,jh,Ih,yh,Uh,Vh){var Oh,Lh=(Kh-kh)*jh;Oh=Ih!==yh?-Uh*gh- -17:(-gh*Vh+.5)*yh;for(var xh=0,Rh=sh;xh<Rh.length;xh+=1)for(var bh=0,jf=Rh[xh].positionedGlyphs;bh<jf.length;bh+=1){var Dh=jf[bh];Dh.x+=Lh,Dh.y+=Oh}})(ei.positionedLines,su,mh,nh,ou,tl,ia,Mh,mi.length),ei.top+=-nh*Mh,ei.bottom=ei.top+Mh,ei.left+=-mh*ou,ei.right=ei.left+ou}(li,t,r,l,Wt,A,I,U,Ae,re,Pe,Tt),!function(ei){for(var Ki=0,Ri=ei;Ki<Ri.length;Ki+=1)if(Ri[Ki].positionedGlyphs.length!==0)return!1;return!0}(Si)&&li}Vr.fromFeature=function(e,t){for(var r=new Vr,l=0;l<e.sections.length;l++){var f=e.sections[l];f.image?r.addImageSection(f):r.addTextSection(f,t)}return r},Vr.prototype.length=function(){return this.text.length},Vr.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Vr.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Vr.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Vr.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var l=e.charCodeAt(r+1)||null,f=e.charCodeAt(r-1)||null;t+=l&&ll(l)&&!zf[e[r+1]]||f&&ll(f)&&!zf[e[r-1]]||!zf[e[r]]?e[r]:zf[e[r]]}return t}(this.text)},Vr.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&di[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,l=this.text.length-1;l>=0&&l>=e&&di[this.text.charCodeAt(l)];l--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},Vr.prototype.substring=function(e,t){var r=new Vr;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},Vr.prototype.toString=function(){return this.text},Vr.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},Vr.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(un.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(r)},Vr.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(un.forImage(t)),this.sectionIndex.push(this.sections.length-1)):Me("Reached maximum number of images 6401")}else Me("Can't add FormattedSection with an empty image.")},Vr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var di={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},pi={};function kn(e,t,r,l,f,m){if(t.imageName){var A=l[t.imageName];return A?A.displaySize[0]*t.scale*24/m+f:0}var I=r[t.fontStack],U=I&&I[e];return U?U.metrics.advance*t.scale+f:0}function Ni(e,t,r,l){var f=Math.pow(e-t,2);return l?e<t?f/2:2*f:f+Math.abs(r)*r}function Ci(e,t,r){var l=0;return e===10&&(l-=1e4),r&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function ki(e,t,r,l,f,m){for(var A=null,I=Ni(t,r,f,m),U=0,re=l;U<re.length;U+=1){var he=re[U],Ae=Ni(t-he.x,r,f,m)+he.badness;Ae<=I&&(A=he,I=Ae)}return{index:e,x:t,priorBreak:A,badness:I}}function ca(e,t,r,l,f,m,A){if(m!=="point")return[];if(!e)return[];for(var I,U=[],re=function(Wt,Zt,nr,dr,br,zr){for(var Rr=0,pn=0;pn<Wt.length();pn++){var hn=Wt.getSection(pn);Rr+=kn(Wt.getCharCode(pn),hn,dr,br,Zt,zr)}return Rr/Math.max(1,Math.ceil(Rr/nr))}(e,t,r,l,f,A),he=e.text.indexOf("\u200B")>=0,Ae=0,Pe=0;Pe<e.length();Pe++){var ot=e.getSection(Pe),wt=e.getCharCode(Pe);if(di[wt]||(Ae+=kn(wt,ot,l,f,t,A)),Pe<e.length()-1){var Tt=!((I=wt)<11904||!(qr["Bopomofo Extended"](I)||qr.Bopomofo(I)||qr["CJK Compatibility Forms"](I)||qr["CJK Compatibility Ideographs"](I)||qr["CJK Compatibility"](I)||qr["CJK Radicals Supplement"](I)||qr["CJK Strokes"](I)||qr["CJK Symbols and Punctuation"](I)||qr["CJK Unified Ideographs Extension A"](I)||qr["CJK Unified Ideographs"](I)||qr["Enclosed CJK Letters and Months"](I)||qr["Halfwidth and Fullwidth Forms"](I)||qr.Hiragana(I)||qr["Ideographic Description Characters"](I)||qr["Kangxi Radicals"](I)||qr["Katakana Phonetic Extensions"](I)||qr.Katakana(I)||qr["Vertical Forms"](I)||qr["Yi Radicals"](I)||qr["Yi Syllables"](I)));(pi[wt]||Tt||ot.imageName)&&U.push(ki(Pe+1,Ae,re,U,Ci(wt,e.getCharCode(Pe+1),Tt&&he),!1))}}return function Wt(Zt){return Zt?Wt(Zt.priorBreak).concat(Zt.index):[]}(ki(e.length(),Ae,re,U,0,!0))}function Go(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Ho(e,t,r,l,f){if(l||f)for(var m=e[r],A=(e[r].x+m.metrics.advance*m.scale)*l,I=t;I<=r;I++)e[I].x-=A,e[I].y+=f}function ta(e,t,r,l,f,m){var A,I=e.image;if(I.content){var U=I.content,re=I.pixelRatio||1;A=[U[0]/re,U[1]/re,I.displaySize[0]-U[2]/re,I.displaySize[1]-U[3]/re]}var he,Ae,Pe,ot,wt=t.left*m,Tt=t.right*m;r==="width"||r==="both"?(ot=f[0]+wt-l[3],Ae=f[0]+Tt+l[1]):Ae=(ot=f[0]+(wt+Tt-I.displaySize[0])/2)+I.displaySize[0];var Wt=t.top*m,Zt=t.bottom*m;return r==="height"||r==="both"?(he=f[1]+Wt-l[0],Pe=f[1]+Zt+l[2]):Pe=(he=f[1]+(Wt+Zt-I.displaySize[1])/2)+I.displaySize[1],{image:I,top:he,right:Ae,bottom:Pe,left:ot,collisionPadding:A}}pi[10]=!0,pi[32]=!0,pi[38]=!0,pi[40]=!0,pi[41]=!0,pi[43]=!0,pi[45]=!0,pi[47]=!0,pi[173]=!0,pi[183]=!0,pi[8203]=!0,pi[8208]=!0,pi[8211]=!0,pi[8231]=!0;var ho=function(e){function t(r,l,f,m){e.call(this,r,l),this.angle=f,m!==void 0&&(this.segment=m)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(te);function Ma(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Mi(e+1))};if(r.kind==="source")return{kind:"source"};for(var l=r.zoomStops,f=r.interpolationType,m=0;m<l.length&&l[m]<=e;)m++;for(var A=m=Math.max(0,m-1);A<l.length&&l[A]<e+1;)A++;A=Math.min(l.length-1,A);var I=l[m],U=l[A];return r.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:U,interpolationType:f}:{kind:"camera",minZoom:I,maxZoom:U,minSize:r.evaluate(new Mi(I)),maxSize:r.evaluate(new Mi(U)),interpolationType:f}}function _s(e,t,r){var l=t.uSize,f=r.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?Na(f/128,r.upperSize/128,t.uSizeT):l}function Qo(e,t){var r=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,m=f?Oe(ha.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=Na(e.minSize,e.maxSize,m):r=m}return{uSizeT:r,uSize:l}}In("Anchor",ho);var ys=Object.freeze({__proto__:null,getSizeData:Ma,evaluateSizeForFeature:_s,evaluateSizeForZoom:Qo,SIZE_PACK_FACTOR:128});function qo(e,t,r,l,f){if(t.segment===void 0)return!0;for(var m=t,A=t.segment+1,I=0;I>-r/2;){if(--A<0)return!1;I-=e[A].dist(m),m=e[A]}I+=e[A].dist(e[A+1]),A++;for(var U=[],re=0;I<r/2;){var he=e[A],Ae=e[A+1];if(!Ae)return!1;var Pe=e[A-1].angleTo(he)-he.angleTo(Ae);for(Pe=Math.abs((Pe+3*Math.PI)%(2*Math.PI)-Math.PI),U.push({distance:I,angleDelta:Pe}),re+=Pe;I-U[0].distance>l;)re-=U.shift().angleDelta;if(re>f)return!1;A++,I+=he.dist(Ae)}return!0}function Hs(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function zo(e,t,r){return e?.6*t*r:0}function ui(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Zs(e,t,r,l,f,m){for(var A=zo(r,f,m),I=ui(r,l)*m,U=0,re=Hs(e)/2,he=0;he<e.length-1;he++){var Ae=e[he],Pe=e[he+1],ot=Ae.dist(Pe);if(U+ot>re){var wt=(re-U)/ot,Tt=Na(Ae.x,Pe.x,wt),Wt=Na(Ae.y,Pe.y,wt),Zt=new ho(Tt,Wt,Pe.angleTo(Ae),he);return Zt._round(),!A||qo(e,Zt,I,A,t)?Zt:void 0}U+=ot}}function Aa(e,t,r,l,f,m,A,I,U){var re=zo(l,m,A),he=ui(l,f),Ae=he*A,Pe=e[0].x===0||e[0].x===U||e[0].y===0||e[0].y===U;return t-Ae<t/4&&(t=Ae+t/4),function ot(wt,Tt,Wt,Zt,nr,dr,br,zr,Rr){for(var pn=dr/2,hn=Hs(wt),Ln=0,Jn=Tt-Wt,Kn=[],Nn=0;Nn<wt.length-1;Nn++){for(var Si=wt[Nn],li=wt[Nn+1],ei=Si.dist(li),Ki=li.angleTo(Si);Jn+Wt<Ln+ei;){var Ri=((Jn+=Wt)-Ln)/ei,Va=Na(Si.x,li.x,Ri),mi=Na(Si.y,li.y,Ri);if(Va>=0&&Va<Rr&&mi>=0&&mi<Rr&&Jn-pn>=0&&Jn+pn<=hn){var ia=new ho(Va,mi,Ki,Nn);ia._round(),Zt&&!qo(wt,ia,dr,Zt,nr)||Kn.push(ia)}}Ln+=ei}return zr||Kn.length||br||(Kn=ot(wt,Ln/2,Wt,Zt,nr,dr,br,!0,Rr)),Kn}(e,Pe?t/2*I%t:(he/2+2*m)*A*I%t,t,re,r,Ae,Pe,!1,U)}function bn(e,t,r,l,f){for(var m=[],A=0;A<e.length;A++)for(var I=e[A],U=void 0,re=0;re<I.length-1;re++){var he=I[re],Ae=I[re+1];he.x<t&&Ae.x<t||(he.x<t?he=new te(t,he.y+(t-he.x)/(Ae.x-he.x)*(Ae.y-he.y))._round():Ae.x<t&&(Ae=new te(t,he.y+(t-he.x)/(Ae.x-he.x)*(Ae.y-he.y))._round()),he.y<r&&Ae.y<r||(he.y<r?he=new te(he.x+(r-he.y)/(Ae.y-he.y)*(Ae.x-he.x),r)._round():Ae.y<r&&(Ae=new te(he.x+(r-he.y)/(Ae.y-he.y)*(Ae.x-he.x),r)._round()),he.x>=l&&Ae.x>=l||(he.x>=l?he=new te(l,he.y+(l-he.x)/(Ae.x-he.x)*(Ae.y-he.y))._round():Ae.x>=l&&(Ae=new te(l,he.y+(l-he.x)/(Ae.x-he.x)*(Ae.y-he.y))._round()),he.y>=f&&Ae.y>=f||(he.y>=f?he=new te(he.x+(f-he.y)/(Ae.y-he.y)*(Ae.x-he.x),f)._round():Ae.y>=f&&(Ae=new te(he.x+(f-he.y)/(Ae.y-he.y)*(Ae.x-he.x),f)._round()),U&&he.equals(U[U.length-1])||m.push(U=[he]),U.push(Ae)))))}return m}function Li(e,t,r,l){var f=[],m=e.image,A=m.pixelRatio,I=m.paddedRect.w-2,U=m.paddedRect.h-2,re=e.right-e.left,he=e.bottom-e.top,Ae=m.stretchX||[[0,I]],Pe=m.stretchY||[[0,U]],ot=function(mi,ia){return mi+ia[1]-ia[0]},wt=Ae.reduce(ot,0),Tt=Pe.reduce(ot,0),Wt=I-wt,Zt=U-Tt,nr=0,dr=wt,br=0,zr=Tt,Rr=0,pn=Wt,hn=0,Ln=Zt;if(m.content&&l){var Jn=m.content;nr=ji(Ae,0,Jn[0]),br=ji(Pe,0,Jn[1]),dr=ji(Ae,Jn[0],Jn[2]),zr=ji(Pe,Jn[1],Jn[3]),Rr=Jn[0]-nr,hn=Jn[1]-br,pn=Jn[2]-Jn[0]-dr,Ln=Jn[3]-Jn[1]-zr}var Kn=function(mi,ia,Zo,ba){var Wo=au(mi.stretch-nr,dr,re,e.left),Xo=hc(mi.fixed-Rr,pn,mi.stretch,wt),ls=au(ia.stretch-br,zr,he,e.top),Eu=hc(ia.fixed-hn,Ln,ia.stretch,Tt),cs=au(Zo.stretch-nr,dr,re,e.left),el=hc(Zo.fixed-Rr,pn,Zo.stretch,wt),ou=au(ba.stretch-br,zr,he,e.top),tl=hc(ba.fixed-hn,Ln,ba.stretch,Tt),su=new te(Wo,ls),Ws=new te(cs,ls),uu=new te(cs,ou),ma=new te(Wo,ou),aa=new te(Xo/A,Eu/A),eo=new te(el/A,tl/A),vo=t*Math.PI/180;if(vo){var Tu=Math.sin(vo),Eo=Math.cos(vo),Yo=[Eo,-Tu,Tu,Eo];su._matMult(Yo),Ws._matMult(Yo),ma._matMult(Yo),uu._matMult(Yo)}var ku=mi.stretch+mi.fixed,fa=ia.stretch+ia.fixed;return{tl:su,tr:Ws,bl:ma,br:uu,tex:{x:m.paddedRect.x+1+ku,y:m.paddedRect.y+1+fa,w:Zo.stretch+Zo.fixed-ku,h:ba.stretch+ba.fixed-fa},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:aa,pixelOffsetBR:eo,minFontScaleX:pn/A/re,minFontScaleY:Ln/A/he,isSDF:r}};if(l&&(m.stretchX||m.stretchY))for(var Nn=es(Ae,Wt,wt),Si=es(Pe,Zt,Tt),li=0;li<Nn.length-1;li++)for(var ei=Nn[li],Ki=Nn[li+1],Ri=0;Ri<Si.length-1;Ri++)f.push(Kn(ei,Si[Ri],Ki,Si[Ri+1]));else f.push(Kn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:U+1}));return f}function ji(e,t,r){for(var l=0,f=0,m=e;f<m.length;f+=1){var A=m[f];l+=Math.max(t,Math.min(r,A[1]))-Math.max(t,Math.min(r,A[0]))}return l}function es(e,t,r){for(var l=[{fixed:-1,stretch:0}],f=0,m=e;f<m.length;f+=1){var A=m[f],I=A[0],U=A[1],re=l[l.length-1];l.push({fixed:I-re.stretch,stretch:re.stretch}),l.push({fixed:I-re.stretch,stretch:re.stretch+(U-I)})}return l.push({fixed:t+1,stretch:r}),l}function au(e,t,r,l){return e/t*r+l}function hc(e,t,r,l){return e-t*r/l}var Ot=function(t,r,l,f,m,A,I,U,re,he){if(this.boxStartIndex=t.length,re){var Ae=A.top,Pe=A.bottom,ot=A.collisionPadding;ot&&(Ae-=ot[1],Pe+=ot[3]);var wt=Pe-Ae;wt>0&&(wt=Math.max(10,wt),this.circleDiameter=wt)}else{var Tt=A.top*I-U,Wt=A.bottom*I+U,Zt=A.left*I-U,nr=A.right*I+U,dr=A.collisionPadding;if(dr&&(Zt-=dr[0]*I,Tt-=dr[1]*I,nr+=dr[2]*I,Wt+=dr[3]*I),he){var br=new te(Zt,Tt),zr=new te(nr,Tt),Rr=new te(Zt,Wt),pn=new te(nr,Wt),hn=he*Math.PI/180;br._rotate(hn),zr._rotate(hn),Rr._rotate(hn),pn._rotate(hn),Zt=Math.min(br.x,zr.x,Rr.x,pn.x),nr=Math.max(br.x,zr.x,Rr.x,pn.x),Tt=Math.min(br.y,zr.y,Rr.y,pn.y),Wt=Math.max(br.y,zr.y,Rr.y,pn.y)}t.emplaceBack(r.x,r.y,Zt,Tt,nr,Wt,l,f,m)}this.boxEndIndex=t.length},Sr=function(t,r){if(t===void 0&&(t=[]),r===void 0&&(r=mr),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var l=(this.length>>1)-1;l>=0;l--)this._down(l)};function mr(e,t){return e<t?-1:e>t?1:0}function Rn(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var l=1/0,f=1/0,m=-1/0,A=-1/0,I=e[0],U=0;U<I.length;U++){var re=I[U];(!U||re.x<l)&&(l=re.x),(!U||re.y<f)&&(f=re.y),(!U||re.x>m)&&(m=re.x),(!U||re.y>A)&&(A=re.y)}var he=Math.min(m-l,A-f),Ae=he/2,Pe=new Sr([],w);if(he===0)return new te(l,f);for(var ot=l;ot<m;ot+=he)for(var wt=f;wt<A;wt+=he)Pe.push(new p(ot+Ae,wt+Ae,Ae,e));for(var Tt=function(nr){for(var dr=0,br=0,zr=0,Rr=nr[0],pn=0,hn=Rr.length,Ln=hn-1;pn<hn;Ln=pn++){var Jn=Rr[pn],Kn=Rr[Ln],Nn=Jn.x*Kn.y-Kn.x*Jn.y;br+=(Jn.x+Kn.x)*Nn,zr+=(Jn.y+Kn.y)*Nn,dr+=3*Nn}return new p(br/dr,zr/dr,0,nr)}(e),Wt=Pe.length;Pe.length;){var Zt=Pe.pop();(Zt.d>Tt.d||!Tt.d)&&(Tt=Zt,r&&console.log("found best %d after %d probes",Math.round(1e4*Zt.d)/1e4,Wt)),Zt.max-Tt.d<=t||(Pe.push(new p(Zt.p.x-(Ae=Zt.h/2),Zt.p.y-Ae,Ae,e)),Pe.push(new p(Zt.p.x+Ae,Zt.p.y-Ae,Ae,e)),Pe.push(new p(Zt.p.x-Ae,Zt.p.y+Ae,Ae,e)),Pe.push(new p(Zt.p.x+Ae,Zt.p.y+Ae,Ae,e)),Wt+=4)}return r&&(console.log("num probes: "+Wt),console.log("best distance: "+Tt.d)),Tt.p}function w(e,t){return t.max-e.max}function p(e,t,r,l){this.p=new te(e,t),this.h=r,this.d=function(f,m){for(var A=!1,I=1/0,U=0;U<m.length;U++)for(var re=m[U],he=0,Ae=re.length,Pe=Ae-1;he<Ae;Pe=he++){var ot=re[he],wt=re[Pe];ot.y>f.y!=wt.y>f.y&&f.x<(wt.x-ot.x)*(f.y-ot.y)/(wt.y-ot.y)+ot.x&&(A=!A),I=Math.min(I,oc(f,ot,wt))}return(A?1:-1)*Math.sqrt(I)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}Sr.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},Sr.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},Sr.prototype.peek=function(){return this.data[0]},Sr.prototype._up=function(e){for(var t=this.data,r=this.compare,l=t[e];e>0;){var f=e-1>>1,m=t[f];if(r(l,m)>=0)break;t[e]=m,e=f}t[e]=l},Sr.prototype._down=function(e){for(var t=this.data,r=this.compare,l=this.length>>1,f=t[e];e<l;){var m=1+(e<<1),A=t[m],I=m+1;if(I<this.length&&r(t[I],A)<0&&(m=I,A=t[I]),r(A,f)>=0)break;t[e]=A,e=m}t[e]=f};var s=Number.POSITIVE_INFINITY;function d(e,t){return t[1]!==s?function(r,l,f){var m=0,A=0;switch(l=Math.abs(l),f=Math.abs(f),r){case"top-right":case"top-left":case"top":A=f-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-f}switch(r){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,A]}(e,t[0],t[1]):function(r,l){var f=0,m=0;l<0&&(l=0);var A=l/Math.sqrt(2);switch(r){case"top-right":case"top-left":m=A-7;break;case"bottom-right":case"bottom-left":m=7-A;break;case"bottom":m=7-l;break;case"top":m=l-7}switch(r){case"top-right":case"bottom-right":f=-A;break;case"top-left":case"bottom-left":f=A;break;case"left":f=l;break;case"right":f=-l}return[f,m]}(e,t[0])}function g(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function L(e,t,r,l,f,m,A,I,U,re,he,Ae,Pe,ot,wt){var Tt=function(br,zr,Rr,pn,hn,Ln,Jn,Kn){for(var Nn=pn.layout.get("text-rotate").evaluate(Ln,{})*Math.PI/180,Si=[],li=0,ei=zr.positionedLines;li<ei.length;li+=1)for(var Ki=ei[li],Ri=0,Va=Ki.positionedGlyphs;Ri<Va.length;Ri+=1){var mi=Va[Ri];if(mi.rect){var ia=mi.rect||{},Zo=4,ba=!0,Wo=1,Xo=0,ls=(hn||Kn)&&mi.vertical,Eu=mi.metrics.advance*mi.scale/2;if(Kn&&zr.verticalizable&&(Xo=Ki.lineOffset/2-(mi.imageName?-(24-mi.metrics.width*mi.scale)/2:24*(mi.scale-1))),mi.imageName){var cs=Jn[mi.imageName];ba=cs.sdf,Zo=1/(Wo=cs.pixelRatio)}var el=hn?[mi.x+Eu,mi.y]:[0,0],ou=hn?[0,0]:[mi.x+Eu+Rr[0],mi.y+Rr[1]-Xo],tl=[0,0];ls&&(tl=ou,ou=[0,0]);var su=(mi.metrics.left-Zo)*mi.scale-Eu+ou[0],Ws=(-mi.metrics.top-Zo)*mi.scale+ou[1],uu=su+ia.w*mi.scale/Wo,ma=Ws+ia.h*mi.scale/Wo,aa=new te(su,Ws),eo=new te(uu,Ws),vo=new te(su,ma),Tu=new te(uu,ma);if(ls){var Eo=new te(-Eu,Eu- -17),Yo=-Math.PI/2,ku=12-Eu,fa=new te(22-ku,-(mi.imageName?ku:0)),eh=new(Function.prototype.bind.apply(te,[null].concat(tl)));aa._rotateAround(Yo,Eo)._add(fa)._add(eh),eo._rotateAround(Yo,Eo)._add(fa)._add(eh),vo._rotateAround(Yo,Eo)._add(fa)._add(eh),Tu._rotateAround(Yo,Eo)._add(fa)._add(eh)}if(Nn){var Yc=Math.sin(Nn),pf=Math.cos(Nn),dc=[pf,-Yc,Yc,pf];aa._matMult(dc),eo._matMult(dc),vo._matMult(dc),Tu._matMult(dc)}var ju=new te(0,0),Bf=new te(0,0);Si.push({tl:aa,tr:eo,bl:vo,br:Tu,tex:ia,writingMode:zr.writingMode,glyphOffset:el,sectionIndex:mi.sectionIndex,isSDF:ba,pixelOffsetTL:ju,pixelOffsetBR:Bf,minFontScaleX:0,minFontScaleY:0})}}return Si}(0,r,I,f,m,A,l,e.allowVerticalPlacement),Wt=e.textSizeData,Zt=null;Wt.kind==="source"?(Zt=[128*f.layout.get("text-size").evaluate(A,{})])[0]>32640&&Me(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Wt.kind==="composite"&&((Zt=[128*ot.compositeTextSizes[0].evaluate(A,{},wt),128*ot.compositeTextSizes[1].evaluate(A,{},wt)])[0]>32640||Zt[1]>32640)&&Me(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,Tt,Zt,I,m,A,re,t,U.lineStartIndex,U.lineLength,Pe,wt);for(var nr=0,dr=he;nr<dr.length;nr+=1)Ae[dr[nr]]=e.text.placedSymbolArray.length-1;return 4*Tt.length}function N(e){for(var t in e)return e[t];return null}function K(e,t,r,l){var f=e.compareText;if(t in f){for(var m=f[t],A=m.length-1;A>=0;A--)if(l.dist(m[A])<r)return!0}else f[t]=[];return f[t].push(l),!1}var ee=Ro.VectorTileFeature.types,Z=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Se(e,t,r,l,f,m,A,I,U,re,he,Ae,Pe){var ot=I?Math.min(32640,Math.round(I[0])):0,wt=I?Math.min(32640,Math.round(I[1])):0;e.emplaceBack(t,r,Math.round(32*l),Math.round(32*f),m,A,(ot<<1)+(U?1:0),wt,16*re,16*he,256*Ae,256*Pe)}function pe(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function Fe(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(Is(r[t].text))return!0;return!1}var mt=function(t){this.layoutVertexArray=new xf,this.indexArray=new Iu,this.programConfigurations=t,this.segments=new qe,this.dynamicLayoutVertexArray=new jl,this.opacityVertexArray=new jc,this.placedSymbolArray=new c};mt.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},mt.prototype.upload=function(e,t,r,l){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Af.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,oh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Z,!0),this.opacityVertexBuffer.itemSize=1),(r||l)&&this.programConfigurations.upload(e))},mt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},In("SymbolBuffers",mt);var Yt=function(t,r,l){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new l,this.segments=new qe,this.collisionVertexArray=new Ul};Yt.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,$f.members,!0)},Yt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},In("CollisionBuffers",Yt);var jt=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(A){return A.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Oo([]),this.placementViewportMatrix=Oo([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ma(this.zoom,r["text-size"]),this.iconSizeData=Ma(this.zoom,r["icon-size"]);var l=this.layers[0].layout,f=l.get("symbol-sort-key"),m=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(function(A){return ti[A]})),this.stateDependentLayerIds=this.layers.filter(function(A){return A.isStateDependent()}).map(function(A){return A.id}),this.sourceID=t.sourceID};jt.prototype.createArrays=function(){this.text=new mt(new Ii(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new mt(new Ii(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new O,this.lineVertexArray=new F,this.symbolInstances=new P},jt.prototype.calculateGlyphDependencies=function(e,t,r,l,f){for(var m=0;m<e.length;m++)if(t[e.charCodeAt(m)]=!0,(r||l)&&f){var A=zf[e.charAt(m)];A&&(t[A.charCodeAt(0)]=!0)}},jt.prototype.populate=function(e,t,r){var l=this.layers[0],f=l.layout,m=f.get("text-font"),A=f.get("text-field"),I=f.get("icon-image"),U=(A.value.kind!=="constant"||A.value.value instanceof $a&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),re=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,he=f.get("symbol-sort-key");if(this.features=[],U||re){for(var Ae=t.iconDependencies,Pe=t.glyphDependencies,ot=t.availableImages,wt=new Mi(this.zoom),Tt=0,Wt=e;Tt<Wt.length;Tt+=1){var Zt=Wt[Tt],nr=Zt.feature,dr=Zt.id,br=Zt.index,zr=Zt.sourceLayerIndex,Rr=l._featureFilter.needGeometry,pn=Wa(nr,Rr);if(l._featureFilter.filter(wt,pn,r)){Rr||(pn.geometry=Ea(nr));var hn=void 0;if(U){var Ln=l.getValueAndResolveTokens("text-field",pn,r,ot),Jn=$a.factory(Ln);Fe(Jn)&&(this.hasRTLText=!0),(!this.hasRTLText||Bl()==="unavailable"||this.hasRTLText&&ss.isParsed())&&(hn=_f(Jn,l,pn))}var Kn=void 0;if(re){var Nn=l.getValueAndResolveTokens("icon-image",pn,r,ot);Kn=Nn instanceof Ko?Nn:Ko.fromString(Nn)}if(hn||Kn){var Si=this.sortFeaturesByKey?he.evaluate(pn,{},r):void 0;if(this.features.push({id:dr,text:hn,icon:Kn,index:br,sourceLayerIndex:zr,geometry:pn.geometry,properties:nr.properties,type:ee[nr.type],sortKey:Si}),Kn&&(Ae[Kn.name]=!0),hn){var li=m.evaluate(pn,{},r).join(","),ei=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ti.vertical)>=0;for(var Ki=0,Ri=hn.sections;Ki<Ri.length;Ki+=1){var Va=Ri[Ki];if(Va.image)Ae[Va.image.name]=!0;else{var mi=kc(hn.toString()),ia=Va.fontStack||li,Zo=Pe[ia]=Pe[ia]||{};this.calculateGlyphDependencies(Va.text,Zo,ei,this.allowVerticalPlacement,mi)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(ba){var Wo={},Xo={},ls=[],Eu=0;function cs(Eo){ls.push(ba[Eo]),Eu++}function el(Eo,Yo,ku){var fa=Xo[Eo];return delete Xo[Eo],Xo[Yo]=fa,ls[fa].geometry[0].pop(),ls[fa].geometry[0]=ls[fa].geometry[0].concat(ku[0]),fa}function ou(Eo,Yo,ku){var fa=Wo[Yo];return delete Wo[Yo],Wo[Eo]=fa,ls[fa].geometry[0].shift(),ls[fa].geometry[0]=ku[0].concat(ls[fa].geometry[0]),fa}function tl(Eo,Yo,ku){var fa=ku?Yo[0][Yo[0].length-1]:Yo[0][0];return Eo+":"+fa.x+":"+fa.y}for(var su=0;su<ba.length;su++){var Ws=ba[su],uu=Ws.geometry,ma=Ws.text?Ws.text.toString():null;if(ma){var aa=tl(ma,uu),eo=tl(ma,uu,!0);if(aa in Xo&&eo in Wo&&Xo[aa]!==Wo[eo]){var vo=ou(aa,eo,uu),Tu=el(aa,eo,ls[vo].geometry);delete Wo[aa],delete Xo[eo],Xo[tl(ma,ls[Tu].geometry,!0)]=Tu,ls[vo].geometry=null}else aa in Xo?el(aa,eo,uu):eo in Wo?ou(aa,eo,uu):(cs(su),Wo[aa]=Eu-1,Xo[eo]=Eu-1)}else cs(su)}return ls.filter(function(Eo){return Eo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(ba,Wo){return ba.sortKey-Wo.sortKey})}},jt.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},jt.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},jt.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},jt.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},jt.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},jt.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},jt.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),m={},A=e.segment+1;A<t.length;A++)m[A]={x:t[A].x,y:t[A].y,tileUnitDistanceFromAnchor:l},A<t.length-1&&(l+=t[A+1].dist(t[A]));for(var I=e.segment||0;I>=0;I--)m[I]={x:t[I].x,y:t[I].y,tileUnitDistanceFromAnchor:f},I>0&&(f+=t[I-1].dist(t[I]));for(var U=0;U<t.length;U++){var re=m[U];this.lineVertexArray.emplaceBack(re.x,re.y,re.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},jt.prototype.addSymbols=function(e,t,r,l,f,m,A,I,U,re,he,Ae){for(var Pe=e.indexArray,ot=e.layoutVertexArray,wt=e.segments.prepareSegment(4*t.length,ot,Pe,this.canOverlap?m.sortKey:void 0),Tt=this.glyphOffsetArray.length,Wt=wt.vertexLength,Zt=this.allowVerticalPlacement&&A===ti.vertical?Math.PI/2:0,nr=m.text&&m.text.sections,dr=0;dr<t.length;dr++){var br=t[dr],zr=br.tl,Rr=br.tr,pn=br.bl,hn=br.br,Ln=br.tex,Jn=br.pixelOffsetTL,Kn=br.pixelOffsetBR,Nn=br.minFontScaleX,Si=br.minFontScaleY,li=br.glyphOffset,ei=br.isSDF,Ki=br.sectionIndex,Ri=wt.vertexLength,Va=li[1];Se(ot,I.x,I.y,zr.x,Va+zr.y,Ln.x,Ln.y,r,ei,Jn.x,Jn.y,Nn,Si),Se(ot,I.x,I.y,Rr.x,Va+Rr.y,Ln.x+Ln.w,Ln.y,r,ei,Kn.x,Jn.y,Nn,Si),Se(ot,I.x,I.y,pn.x,Va+pn.y,Ln.x,Ln.y+Ln.h,r,ei,Jn.x,Kn.y,Nn,Si),Se(ot,I.x,I.y,hn.x,Va+hn.y,Ln.x+Ln.w,Ln.y+Ln.h,r,ei,Kn.x,Kn.y,Nn,Si),pe(e.dynamicLayoutVertexArray,I,Zt),Pe.emplaceBack(Ri,Ri+1,Ri+2),Pe.emplaceBack(Ri+1,Ri+2,Ri+3),wt.vertexLength+=4,wt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(li[0]),dr!==t.length-1&&Ki===t[dr+1].sectionIndex||e.programConfigurations.populatePaintArrays(ot.length,m,m.index,{},Ae,nr&&nr[Ki])}e.placedSymbolArray.emplaceBack(I.x,I.y,Tt,this.glyphOffsetArray.length-Tt,Wt,U,re,I.segment,r?r[0]:0,r?r[1]:0,l[0],l[1],A,0,!1,0,he)},jt.prototype._addCollisionDebugVertex=function(e,t,r,l,f,m){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,l,f,Math.round(m.x),Math.round(m.y))},jt.prototype.addCollisionDebugVertices=function(e,t,r,l,f,m,A){var I=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),U=I.vertexLength,re=f.layoutVertexArray,he=f.collisionVertexArray,Ae=A.anchorX,Pe=A.anchorY;this._addCollisionDebugVertex(re,he,m,Ae,Pe,new te(e,t)),this._addCollisionDebugVertex(re,he,m,Ae,Pe,new te(r,t)),this._addCollisionDebugVertex(re,he,m,Ae,Pe,new te(r,l)),this._addCollisionDebugVertex(re,he,m,Ae,Pe,new te(e,l)),I.vertexLength+=4;var ot=f.indexArray;ot.emplaceBack(U,U+1),ot.emplaceBack(U+1,U+2),ot.emplaceBack(U+2,U+3),ot.emplaceBack(U+3,U),I.primitiveLength+=4},jt.prototype.addDebugCollisionBoxes=function(e,t,r,l){for(var f=e;f<t;f++){var m=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,l?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,r)}},jt.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Yt(Us,dh.members,rc),this.iconCollisionBox=new Yt(Us,dh.members,rc);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},jt.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,l,f,m,A,I,U){for(var re={},he=t;he<r;he++){var Ae=e.get(he);re.textBox={x1:Ae.x1,y1:Ae.y1,x2:Ae.x2,y2:Ae.y2,anchorPointX:Ae.anchorPointX,anchorPointY:Ae.anchorPointY},re.textFeatureIndex=Ae.featureIndex;break}for(var Pe=l;Pe<f;Pe++){var ot=e.get(Pe);re.verticalTextBox={x1:ot.x1,y1:ot.y1,x2:ot.x2,y2:ot.y2,anchorPointX:ot.anchorPointX,anchorPointY:ot.anchorPointY},re.verticalTextFeatureIndex=ot.featureIndex;break}for(var wt=m;wt<A;wt++){var Tt=e.get(wt);re.iconBox={x1:Tt.x1,y1:Tt.y1,x2:Tt.x2,y2:Tt.y2,anchorPointX:Tt.anchorPointX,anchorPointY:Tt.anchorPointY},re.iconFeatureIndex=Tt.featureIndex;break}for(var Wt=I;Wt<U;Wt++){var Zt=e.get(Wt);re.verticalIconBox={x1:Zt.x1,y1:Zt.y1,x2:Zt.x2,y2:Zt.y2,anchorPointX:Zt.anchorPointX,anchorPointY:Zt.anchorPointY},re.verticalIconFeatureIndex=Zt.featureIndex;break}return re},jt.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},jt.prototype.hasTextData=function(){return this.text.segments.get().length>0},jt.prototype.hasIconData=function(){return this.icon.segments.get().length>0},jt.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},jt.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},jt.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},jt.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),l=r.vertexStartIndex+4*r.numGlyphs,f=r.vertexStartIndex;f<l;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},jt.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),l=[],f=[],m=[],A=0;A<this.symbolInstances.length;++A){m.push(A);var I=this.symbolInstances.get(A);l.push(0|Math.round(t*I.anchorX+r*I.anchorY)),f.push(I.featureIndex)}return m.sort(function(U,re){return l[U]-l[re]||f[re]-f[U]}),m},jt.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},jt.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,l=this.symbolInstanceIndexes;r<l.length;r+=1){var f=this.symbolInstances.get(l[r]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(m,A,I){m>=0&&I.indexOf(m)===A&&t.addIndicesForPlacedSymbol(t.text,m)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},In("SymbolBucket",jt,{omit:["layers","collisionBoxArray","features","compareText"]}),jt.MAX_GLYPHS=65535,jt.addDynamicAttributes=pe;var Qt=new Po({"symbol-placement":new $n(He.layout_symbol["symbol-placement"]),"symbol-spacing":new $n(He.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new $n(He.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Fn(He.layout_symbol["symbol-sort-key"]),"symbol-z-order":new $n(He.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new $n(He.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new $n(He.layout_symbol["icon-ignore-placement"]),"icon-optional":new $n(He.layout_symbol["icon-optional"]),"icon-rotation-alignment":new $n(He.layout_symbol["icon-rotation-alignment"]),"icon-size":new Fn(He.layout_symbol["icon-size"]),"icon-text-fit":new $n(He.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new $n(He.layout_symbol["icon-text-fit-padding"]),"icon-image":new Fn(He.layout_symbol["icon-image"]),"icon-rotate":new Fn(He.layout_symbol["icon-rotate"]),"icon-padding":new $n(He.layout_symbol["icon-padding"]),"icon-keep-upright":new $n(He.layout_symbol["icon-keep-upright"]),"icon-offset":new Fn(He.layout_symbol["icon-offset"]),"icon-anchor":new Fn(He.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new $n(He.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new $n(He.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new $n(He.layout_symbol["text-rotation-alignment"]),"text-field":new Fn(He.layout_symbol["text-field"]),"text-font":new Fn(He.layout_symbol["text-font"]),"text-size":new Fn(He.layout_symbol["text-size"]),"text-max-width":new Fn(He.layout_symbol["text-max-width"]),"text-line-height":new $n(He.layout_symbol["text-line-height"]),"text-letter-spacing":new Fn(He.layout_symbol["text-letter-spacing"]),"text-justify":new Fn(He.layout_symbol["text-justify"]),"text-radial-offset":new Fn(He.layout_symbol["text-radial-offset"]),"text-variable-anchor":new $n(He.layout_symbol["text-variable-anchor"]),"text-anchor":new Fn(He.layout_symbol["text-anchor"]),"text-max-angle":new $n(He.layout_symbol["text-max-angle"]),"text-writing-mode":new $n(He.layout_symbol["text-writing-mode"]),"text-rotate":new Fn(He.layout_symbol["text-rotate"]),"text-padding":new $n(He.layout_symbol["text-padding"]),"text-keep-upright":new $n(He.layout_symbol["text-keep-upright"]),"text-transform":new Fn(He.layout_symbol["text-transform"]),"text-offset":new Fn(He.layout_symbol["text-offset"]),"text-allow-overlap":new $n(He.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new $n(He.layout_symbol["text-ignore-placement"]),"text-optional":new $n(He.layout_symbol["text-optional"])}),ur={paint:new Po({"icon-opacity":new Fn(He.paint_symbol["icon-opacity"]),"icon-color":new Fn(He.paint_symbol["icon-color"]),"icon-halo-color":new Fn(He.paint_symbol["icon-halo-color"]),"icon-halo-width":new Fn(He.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Fn(He.paint_symbol["icon-halo-blur"]),"icon-translate":new $n(He.paint_symbol["icon-translate"]),"icon-translate-anchor":new $n(He.paint_symbol["icon-translate-anchor"]),"text-opacity":new Fn(He.paint_symbol["text-opacity"]),"text-color":new Fn(He.paint_symbol["text-color"],{runtimeType:gn,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new Fn(He.paint_symbol["text-halo-color"]),"text-halo-width":new Fn(He.paint_symbol["text-halo-width"]),"text-halo-blur":new Fn(He.paint_symbol["text-halo-blur"]),"text-translate":new $n(He.paint_symbol["text-translate"]),"text-translate-anchor":new $n(He.paint_symbol["text-translate-anchor"])}),layout:Qt},kr=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:dn,this.defaultValue=t};kr.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},kr.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},kr.prototype.outputDefined=function(){return!1},kr.prototype.serialize=function(){return null},In("FormatSectionOverride",kr,{omit:["defaultValue"]});var on=function(e){function t(r){e.call(this,r,ur)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,l){if(e.prototype.recalculate.call(this,r,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var m=[],A=0,I=f;A<I.length;A+=1){var U=I[A];m.indexOf(U)<0&&m.push(U)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,l,f,m){var A=this.layout.get(r).evaluate(l,{},f,m),I=this._unevaluatedLayout._values[r];return I.isDataDriven()||Fo(I.value)||!A?A:function(U,re){return re.replace(/{([^{}]+)}/g,function(he,Ae){return Ae in U?String(U[Ae]):""})}(l.properties,A)},t.prototype.createBucket=function(r){return new jt(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,l=ur.paint.overridableProperties;r<l.length;r+=1){var f=l[r];if(t.hasPaintOverride(this.layout,f)){var m,A=this.paint.get(f),I=new kr(A),U=new Ol(I,A.property.specification);m=A.value.kind==="constant"||A.value.kind==="source"?new Ll("source",U):new xl("composite",U,A.value.zoomStops,A.value._interpolationType),this.paint._values[f]=new Es(A.property,m,A.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,l,f){return!(!this.layout||l.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,l){var f=r.get("text-field"),m=ur.paint.properties[l],A=!1,I=function(Ae){for(var Pe=0,ot=Ae;Pe<ot.length;Pe+=1)if(m.overrides&&m.overrides.hasOverride(ot[Pe]))return void(A=!0)};if(f.value.kind==="constant"&&f.value.value instanceof $a)I(f.value.value.sections);else if(f.value.kind==="source"){var U=function he(Ae){A||(Ae instanceof na&&Ca(Ae.value)===Xi?I(Ae.value.sections):Ae instanceof oo?I(Ae.sections):Ae.eachChild(he))},re=f.value;re._styleExpression&&U(re._styleExpression.expression)}return A},t}(ru),Gr={paint:new Po({"background-color":new $n(He.paint_background["background-color"]),"background-pattern":new vs(He.paint_background["background-pattern"]),"background-opacity":new $n(He.paint_background["background-opacity"])})},ln=function(e){function t(r){e.call(this,r,Gr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ru),wn={paint:new Po({"raster-opacity":new $n(He.paint_raster["raster-opacity"]),"raster-hue-rotate":new $n(He.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new $n(He.paint_raster["raster-brightness-min"]),"raster-brightness-max":new $n(He.paint_raster["raster-brightness-max"]),"raster-saturation":new $n(He.paint_raster["raster-saturation"]),"raster-contrast":new $n(He.paint_raster["raster-contrast"]),"raster-resampling":new $n(He.paint_raster["raster-resampling"]),"raster-fade-duration":new $n(He.paint_raster["raster-fade-duration"])})},Gn=function(e){function t(r){e.call(this,r,wn)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ru),ii=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(ru),Vi={circle:wl,heatmap:of,hillshade:Rf,fill:Or,"fill-extrusion":Ta,line:Th,symbol:on,background:ln,raster:Gn},va=Y.HTMLImageElement,Ia=Y.HTMLCanvasElement,qu=Y.HTMLVideoElement,ts=Y.ImageData,us=Y.ImageBitmap,Su=function(t,r,l,f){this.context=t,this.format=l,this.texture=t.gl.createTexture(),this.update(r,f)};Su.prototype.update=function(e,t,r){var l=e.width,f=e.height,m=!(this.size&&this.size[0]===l&&this.size[1]===f||r),A=this.context,I=A.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!t||t.premultiply!==!1)),m)this.size=[l,f],e instanceof va||e instanceof Ia||e instanceof qu||e instanceof ts||us&&e instanceof us?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,e):I.texImage2D(I.TEXTURE_2D,0,this.format,l,f,0,this.format,I.UNSIGNED_BYTE,e.data);else{var U=r||{x:0,y:0},re=U.x,he=U.y;e instanceof va||e instanceof Ia||e instanceof qu||e instanceof ts||us&&e instanceof us?I.texSubImage2D(I.TEXTURE_2D,0,re,he,I.RGBA,I.UNSIGNED_BYTE,e):I.texSubImage2D(I.TEXTURE_2D,0,re,he,l,f,I.RGBA,I.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D)},Su.prototype.bind=function(e,t,r){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),r!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},Su.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Su.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Nf=function(t){var r=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};Nf.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},Nf.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Ml=function(t,r,l){this.target=t,this.parent=r,this.mapId=l,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},St(["receive","process"],this),this.invoker=new Nf(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=$t()?t:Y};function Wc(e,t,r){var l=2*Math.PI*6378137/256/Math.pow(2,r);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}Ml.prototype.send=function(e,t,r,l,f){var m=this;f===void 0&&(f=!1);var A=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[A]=r);var I=Q(this.globalScope)?void 0:[];return this.target.postMessage({id:A,type:e,hasCallback:!!r,targetMapId:l,mustQueue:f,sourceMapId:this.mapId,data:wu(t,I)},I),{cancel:function(){r&&delete m.callbacks[A],m.target.postMessage({id:A,type:"<cancel>",targetMapId:l,sourceMapId:m.mapId})}}},Ml.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var l=this.cancelCallbacks[r];delete this.cancelCallbacks[r],l&&l()}else $t()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},Ml.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},Ml.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(js(t.error)):l(null,js(t.data)))}else{var f=!1,m=Q(this.globalScope)?void 0:[],A=t.hasCallback?function(he,Ae){f=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:he?wu(he):null,data:wu(Ae,m)},m)}:function(he){f=!0},I=null,U=js(t.data);if(this.parent[t.type])I=this.parent[t.type](t.sourceMapId,U,A);else if(this.parent.getWorkerSource){var re=t.type.split(".");I=this.parent.getWorkerSource(t.sourceMapId,re[0],U.source)[re[1]](U,A)}else A(new Error("Could not find function "+t.type));!f&&I&&I.cancel&&(this.cancelCallbacks[e]=I.cancel)}},Ml.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var _a=function(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};_a.prototype.setNorthEast=function(e){return this._ne=e instanceof Da?new Da(e.lng,e.lat):Da.convert(e),this},_a.prototype.setSouthWest=function(e){return this._sw=e instanceof Da?new Da(e.lng,e.lat):Da.convert(e),this},_a.prototype.extend=function(e){var t,r,l=this._sw,f=this._ne;if(e instanceof Da)t=e,r=e;else{if(!(e instanceof _a))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(_a.convert(e)):this.extend(Da.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return l||f?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),f.lng=Math.max(r.lng,f.lng),f.lat=Math.max(r.lat,f.lat)):(this._sw=new Da(t.lng,t.lat),this._ne=new Da(r.lng,r.lat)),this},_a.prototype.getCenter=function(){return new Da((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},_a.prototype.getSouthWest=function(){return this._sw},_a.prototype.getNorthEast=function(){return this._ne},_a.prototype.getNorthWest=function(){return new Da(this.getWest(),this.getNorth())},_a.prototype.getSouthEast=function(){return new Da(this.getEast(),this.getSouth())},_a.prototype.getWest=function(){return this._sw.lng},_a.prototype.getSouth=function(){return this._sw.lat},_a.prototype.getEast=function(){return this._ne.lng},_a.prototype.getNorth=function(){return this._ne.lat},_a.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},_a.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},_a.prototype.isEmpty=function(){return!(this._sw&&this._ne)},_a.prototype.contains=function(e){var t=Da.convert(e),r=t.lng,l=t.lat,f=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&f},_a.convert=function(e){return!e||e instanceof _a?e:new _a(e)};var Da=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid LngLat object: ("+t+", "+r+")");if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Da.prototype.wrap=function(){return new Da(st(this.lng,-180,180),this.lat)},Da.prototype.toArray=function(){return[this.lng,this.lat]},Da.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Da.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,l=e.lat*t,f=Math.sin(r)*Math.sin(l)+Math.cos(r)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},Da.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new _a(new Da(this.lng-r,this.lat-t),new Da(this.lng+r,this.lat+t))},Da.convert=function(e){if(e instanceof Da)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Da(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Da(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var wc=2*Math.PI*63710088e-1;function pl(e){return wc*Math.cos(e*Math.PI/180)}function Xc(e){return(180+e)/360}function Jf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function po(e,t){return e/pl(t)}function vl(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var hf=function(t,r,l){l===void 0&&(l=0),this.x=+t,this.y=+r,this.z=+l};hf.fromLngLat=function(e,t){t===void 0&&(t=0);var r=Da.convert(e);return new hf(Xc(r.lng),Jf(r.lat),po(t,r.lat))},hf.prototype.toLngLat=function(){return new Da(360*this.x-180,vl(this.y))},hf.prototype.toAltitude=function(){return this.z*pl(vl(this.y))},hf.prototype.meterInMercatorCoordinateUnits=function(){return 1/wc*(e=vl(this.y),1/Math.cos(e*Math.PI/180));var e};var df=function(t,r,l){this.z=t,this.x=r,this.y=l,this.key=Cf(0,t,t,r,l)};df.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},df.prototype.url=function(e,t){var r,l,f,m,A,I=(l=this.y,f=this.z,m=Wc(256*(r=this.x),256*(l=Math.pow(2,f)-l-1),f),A=Wc(256*(r+1),256*(l+1),f),m[0]+","+m[1]+","+A[0]+","+A[1]),U=function(re,he,Ae){for(var Pe,ot="",wt=re;wt>0;wt--)ot+=(he&(Pe=1<<wt-1)?1:0)+(Ae&Pe?2:0);return ot}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",U).replace("{bbox-epsg-3857}",I)},df.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new te(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},df.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var _h=function(t,r){this.wrap=t,this.canonical=r,this.key=Cf(t,r.z,r.z,r.x,r.y)},Xa=function(t,r,l,f,m){this.overscaledZ=t,this.wrap=r,this.canonical=new df(l,+f,+m),this.key=Cf(r,t,l,f,m)};function Cf(e,t,r,l,f){(e*=2)<0&&(e=-1*e-1);var m=1<<r;return(m*m*e+m*f+l).toString(36)+r.toString(36)+t.toString(36)}Xa.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Xa.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Xa(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Xa(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Xa.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?Cf(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):Cf(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},Xa.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Xa.prototype.children=function(e){if(this.overscaledZ>=e)return[new Xa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,l=2*this.canonical.y;return[new Xa(t,this.wrap,t,r,l),new Xa(t,this.wrap,t,r+1,l),new Xa(t,this.wrap,t,r,l+1),new Xa(t,this.wrap,t,r+1,l+1)]},Xa.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Xa.prototype.wrapped=function(){return new Xa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Xa.prototype.unwrapTo=function(e){return new Xa(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Xa.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Xa.prototype.toUnwrapped=function(){return new _h(this.wrap,this.canonical)},Xa.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Xa.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new hf(e.x-this.wrap,e.y))},In("CanonicalTileID",df),In("OverscaledTileID",Xa,{omit:["posMatrix"]});var Ff=function(t,r,l){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return Me('"'+l+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var f=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=l||"mapbox";for(var m=0;m<f;m++)this.data[this._idx(-1,m)]=this.data[this._idx(0,m)],this.data[this._idx(f,m)]=this.data[this._idx(f-1,m)],this.data[this._idx(m,-1)]=this.data[this._idx(m,0)],this.data[this._idx(m,f)]=this.data[this._idx(m,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)]};Ff.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[l],r[l+1],r[l+2])},Ff.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ff.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Ff.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Ff.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Ff.prototype.getPixels=function(){return new Lo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ff.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,f=t*this.dim+this.dim,m=r*this.dim,A=r*this.dim+this.dim;switch(t){case-1:l=f-1;break;case 1:f=l+1}switch(r){case-1:m=A-1;break;case 1:A=m+1}for(var I=-t*this.dim,U=-r*this.dim,re=m;re<A;re++)for(var he=l;he<f;he++)this.data[this._idx(he,re)]=e.data[this._idx(he+I,re+U)]},In("DEMData",Ff);var Hh=function(t){this._stringToNumber={},this._numberToString=[];for(var r=0;r<t.length;r++){var l=t[r];this._stringToNumber[l]=r,this._numberToString[r]=l}};Hh.prototype.encode=function(e){return this._stringToNumber[e]},Hh.prototype.decode=function(e){return this._numberToString[e]};var Zh=function(t,r,l,f,m){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=l,t._y=f,this.properties=t.properties,this.id=m},ed={geometry:{configurable:!0}};ed.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ed.geometry.set=function(e){this._geometry=e},Zh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Zh.prototype,ed);var Ch=function(){this.state={},this.stateChanges={},this.deletedStates={}};Ch.prototype.updateState=function(e,t,r){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},Le(this.stateChanges[e][l],r),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==l&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var m in this.deletedStates[e][l]={},this.state[e][l])r[m]||(this.deletedStates[e][l][m]=null);else for(var A in r)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][A]===null&&delete this.deletedStates[e][l][A]},Ch.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(r in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][r]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},Ch.prototype.getState=function(e,t){var r=String(t),l=Le({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var m in f)delete l[m]}return l},Ch.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Ch.prototype.coalesceChanges=function(e,t){var r={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var f={};for(var m in this.stateChanges[l])this.state[l][m]||(this.state[l][m]={}),Le(this.state[l][m],this.stateChanges[l][m]),f[m]=this.state[l][m];r[l]=f}for(var A in this.deletedStates){this.state[A]=this.state[A]||{};var I={};if(this.deletedStates[A]===null)for(var U in this.state[A])I[U]={},this.state[A][U]={};else for(var re in this.deletedStates[A]){if(this.deletedStates[A][re]===null)this.state[A][re]={};else for(var he=0,Ae=Object.keys(this.deletedStates[A][re]);he<Ae.length;he+=1)delete this.state[A][re][Ae[he]];I[re]=this.state[A][re]}r[A]=r[A]||{},Le(r[A],I)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var Pe in e)e[Pe].setFeatureState(r,t)};var Qf=function(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Xu(8192,16,0),this.grid3D=new Xu(8192,16,0),this.featureIndexArray=new Ee,this.promoteId=r};function td(e,t,r,l,f){return Ne(e,function(m,A){var I=t instanceof Ec?t.get(A):null;return I&&I.evaluate?I.evaluate(r,l,f):I})}function rd(e){for(var t=1/0,r=1/0,l=-1/0,f=-1/0,m=0,A=e;m<A.length;m+=1){var I=A[m];t=Math.min(t,I.x),r=Math.min(r,I.y),l=Math.max(l,I.x),f=Math.max(f,I.y)}return{minX:t,minY:r,maxX:l,maxY:f}}function ld(e,t){return t-e}Qf.prototype.insert=function(e,t,r,l,f,m){var A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,l,f);for(var I=m?this.grid3D:this.grid,U=0;U<t.length;U++){for(var re=t[U],he=[1/0,1/0,-1/0,-1/0],Ae=0;Ae<re.length;Ae++){var Pe=re[Ae];he[0]=Math.min(he[0],Pe.x),he[1]=Math.min(he[1],Pe.y),he[2]=Math.max(he[2],Pe.x),he[3]=Math.max(he[3],Pe.y)}he[0]<8192&&he[1]<8192&&he[2]>=0&&he[3]>=0&&I.insert(A,he[0],he[1],he[2],he[3])}},Qf.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Ro.VectorTile(new Be(this.rawTileData)).layers,this.sourceLayerCoder=new Hh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Qf.prototype.query=function(e,t,r,l){var f=this;this.loadVTLayers();for(var m=e.params||{},A=8192/e.tileSize/e.scale,I=xc(m.filter),U=e.queryGeometry,re=e.queryPadding*A,he=rd(U),Ae=this.grid.query(he.minX-re,he.minY-re,he.maxX+re,he.maxY+re),Pe=rd(e.cameraQueryGeometry),ot=this.grid3D.query(Pe.minX-re,Pe.minY-re,Pe.maxX+re,Pe.maxY+re,function(br,zr,Rr,pn){return function(hn,Ln,Jn,Kn,Nn){for(var Si=0,li=hn;Si<li.length;Si+=1){var ei=li[Si];if(Ln<=ei.x&&Jn<=ei.y&&Kn>=ei.x&&Nn>=ei.y)return!0}var Ki=[new te(Ln,Jn),new te(Ln,Nn),new te(Kn,Nn),new te(Kn,Jn)];if(hn.length>2){for(var Ri=0,Va=Ki;Ri<Va.length;Ri+=1)if(Ru(hn,Va[Ri]))return!0}for(var mi=0;mi<hn.length-1;mi++)if(dl(hn[mi],hn[mi+1],Ki))return!0;return!1}(e.cameraQueryGeometry,br-re,zr-re,Rr+re,pn+re)}),wt=0,Tt=ot;wt<Tt.length;wt+=1)Ae.push(Tt[wt]);Ae.sort(ld);for(var Wt,Zt={},nr=function(zr){var Rr=Ae[zr];if(Rr!==Wt){Wt=Rr;var pn=f.featureIndexArray.get(Rr),hn=null;f.loadMatchingFeature(Zt,pn.bucketIndex,pn.sourceLayerIndex,pn.featureIndex,I,m.layers,m.availableImages,t,r,l,function(Ln,Jn,Kn){return hn||(hn=Ea(Ln)),Jn.queryIntersectsFeature(U,Ln,Kn,hn,f.z,e.transform,A,e.pixelPosMatrix)})}},dr=0;dr<Ae.length;dr++)nr(dr);return Zt},Qf.prototype.loadMatchingFeature=function(e,t,r,l,f,m,A,I,U,re,he){var Ae=this.bucketLayerIDs[t];if(!m||function(hn,Ln){for(var Jn=0;Jn<hn.length;Jn++)if(Ln.indexOf(hn[Jn])>=0)return!0;return!1}(m,Ae)){var Pe=this.sourceLayerCoder.decode(r),ot=this.vtLayers[Pe].feature(l);if(f.needGeometry){var wt=Wa(ot,!0);if(!f.filter(new Mi(this.tileID.overscaledZ),wt,this.tileID.canonical))return}else if(!f.filter(new Mi(this.tileID.overscaledZ),ot))return;for(var Tt=this.getId(ot,Pe),Wt=0;Wt<Ae.length;Wt++){var Zt=Ae[Wt];if(!(m&&m.indexOf(Zt)<0)){var nr=I[Zt];if(nr){var dr={};Tt!==void 0&&re&&(dr=re.getState(nr.sourceLayer||"_geojsonTileLayer",Tt));var br=Le({},U[Zt]);br.paint=td(br.paint,nr.paint,ot,dr,A),br.layout=td(br.layout,nr.layout,ot,dr,A);var zr=!he||he(ot,nr,dr);if(zr){var Rr=new Zh(ot,this.z,this.x,this.y,Tt);Rr.layer=br;var pn=e[Zt];pn===void 0&&(pn=e[Zt]=[]),pn.push({featureIndex:l,feature:Rr,intersectionZ:zr})}}}}}},Qf.prototype.lookupSymbolFeatures=function(e,t,r,l,f,m,A,I){var U={};this.loadVTLayers();for(var re=xc(f),he=0,Ae=e;he<Ae.length;he+=1)this.loadMatchingFeature(U,r,l,Ae[he],re,m,A,I,t);return U},Qf.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var l=0,f=r[t];l<f.length;l+=1)if(e===f[l])return!0;return!1},Qf.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},In("FeatureIndex",Qf,{omit:["rawTileData","sourceLayerCoder"]});var xs=function(t,r){this.tileID=t,this.uid=it(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};xs.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<ge.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},xs.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},xs.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(re,he){var Ae={};if(!he)return Ae;for(var Pe=function(){var Wt=wt[ot],Zt=Wt.layerIds.map(function(br){return he.getLayer(br)}).filter(Boolean);if(Zt.length!==0){Wt.layers=Zt,Wt.stateDependentLayerIds&&(Wt.stateDependentLayers=Wt.stateDependentLayerIds.map(function(br){return Zt.filter(function(zr){return zr.id===br})[0]}));for(var nr=0,dr=Zt;nr<dr.length;nr+=1)Ae[dr[nr].id]=Wt}},ot=0,wt=re;ot<wt.length;ot+=1)Pe();return Ae}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[l];if(f instanceof jt){if(this.hasSymbolBuckets=!0,!r)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var A=this.buckets[m];if(A instanceof jt&&A.hasRTLText){this.hasRTLText=!0,ss.isLoading()||ss.isLoaded()||Bl()!=="deferred"||Os();break}}for(var I in this.queryPadding=0,this.buckets){var U=this.buckets[I];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(I).queryRadius(U))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new i},xs.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},xs.prototype.getBucket=function(e){return this.buckets[e.id]},xs.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Su(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Su(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},xs.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},xs.prototype.queryRenderedFeatures=function(e,t,r,l,f,m,A,I,U,re){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:f,scale:m,tileSize:this.tileSize,pixelPosMatrix:re,transform:I,params:A,queryPadding:this.queryPadding*U},e,t,r):{}},xs.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var l=r.loadVTLayers(),f=t?t.sourceLayer:"",m=l._geojsonTileLayer||l[f];if(m)for(var A=xc(t&&t.filter),I=this.tileID.canonical,U=I.z,re=I.x,he=I.y,Ae={z:U,x:re,y:he},Pe=0;Pe<m.length;Pe++){var ot=m.feature(Pe);if(A.needGeometry){var wt=Wa(ot,!0);if(!A.filter(new Mi(this.tileID.overscaledZ),wt,this.tileID.canonical))continue}else if(!A.filter(new Mi(this.tileID.overscaledZ),ot))continue;var Tt=r.getId(ot,f),Wt=new Zh(ot,U,re,he,Tt);Wt.tile=Ae,e.push(Wt)}}},xs.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},xs.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},xs.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=ar(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),f=!1;if(this.expirationTime>l)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var m=this.expirationTime-t;m?this.expirationTime=l+Math.max(m,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},xs.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},xs.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var f=this.buckets[l],m=f.layers[0].sourceLayer||"_geojsonTileLayer",A=r[m],I=e[m];if(A&&I&&Object.keys(I).length!==0){f.update(I,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});var U=t&&t.style&&t.style.getLayer(l);U&&(this.queryPadding=Math.max(this.queryPadding,U.queryRadius(f)))}}}},xs.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},xs.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ge.now()},xs.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},xs.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=ge.now()+e},xs.prototype.setDependencies=function(e,t){for(var r={},l=0,f=t;l<f.length;l+=1)r[f[l]]=!0;this.dependencies[e]=r},xs.prototype.hasDependency=function(e,t){for(var r=0,l=e;r<l.length;r+=1){var f=this.dependencies[l[r]];if(f){for(var m=0,A=t;m<A.length;m+=1)if(f[A[m]])return!0}}return!1};var qf=Y.performance,cd=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},qf.mark(this._marks.start)};cd.prototype.finish=function(){qf.mark(this._marks.end);var e=qf.getEntriesByName(this._marks.measure);return e.length===0&&(qf.measure(this._marks.measure,this._marks.start,this._marks.end),e=qf.getEntriesByName(this._marks.measure),qf.clearMarks(this._marks.start),qf.clearMarks(this._marks.end),qf.clearMeasures(this._marks.measure)),e},a.Actor=Ml,a.AlphaImage=Gs,a.CanonicalTileID=df,a.CollisionBoxArray=i,a.Color=ci,a.DEMData=Ff,a.DataConstantProperty=$n,a.DictionaryCoder=Hh,a.EXTENT=8192,a.ErrorEvent=At,a.EvaluationParameters=Mi,a.Event=at,a.Evented=Ft,a.FeatureIndex=Qf,a.FillBucket=Ht,a.FillExtrusionBucket=ea,a.ImageAtlas=Yn,a.ImagePosition=Ur,a.LineBucket=Bu,a.LngLat=Da,a.LngLatBounds=_a,a.MercatorCoordinate=hf,a.ONE_EM=24,a.OverscaledTileID=Xa,a.Point=te,a.Point$1=te,a.Properties=Po,a.Protobuf=Be,a.RGBAImage=Lo,a.RequestManager=R,a.RequestPerformance=cd,a.ResourceType=Zr,a.SegmentVector=qe,a.SourceFeatureState=Ch,a.StructArrayLayout1ui2=nc,a.StructArrayLayout2f1f2i16=_l,a.StructArrayLayout2i4=hl,a.StructArrayLayout3ui6=Iu,a.StructArrayLayout4i8=tc,a.SymbolBucket=jt,a.Texture=Su,a.Tile=xs,a.Transitionable=wo,a.Uniform1f=nn,a.Uniform1i=_r,a.Uniform2f=Yr,a.Uniform3f=yn,a.Uniform4f=On,a.UniformColor=Qn,a.UniformMatrix4f=yi,a.UnwrappedTileID=_h,a.ValidationError=Pt,a.WritingMode=ti,a.ZoomHistory=qi,a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},a.addDynamicAttributes=pe,a.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var l=e.length,f=new Array(e.length),m=null;e.forEach(function(A,I){t(A,function(U,re){U&&(m=U),f[I]=re,--l==0&&r(m,f)})})},a.bezier=Ke,a.bindAll=St,a.browser=ge,a.cacheEntryPossiblyAdded=function(e){++Vt>gt&&(e.getActor().send("enforceCacheSizeLimit",Ct),Vt=0)},a.clamp=Oe,a.clearTileCache=function(e){var t=Y.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=bn,a.clone=function(e){var t=new Io(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=Ue,a.clone$2=function(e){var t=new Io(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=Fh,a.config=ye,a.create=function(){var e=new Io(16);return Io!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new Io(9);return Io!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new Io(4);return Io!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=W,a.createExpression=Jl,a.createLayout=Za,a.createStyleLayer=function(e){return e.type==="custom"?new ii(e):new Vi[e.type](e)},a.cross=function(e,t,r){var l=t[0],f=t[1],m=t[2],A=r[0],I=r[1],U=r[2];return e[0]=f*U-m*I,e[1]=m*A-l*U,e[2]=l*I-f*A,e},a.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],r[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(var f in t)if(!e(t[f],r[f]))return!1;return!0}return t===r},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=We,a.emitValidationErrors=pu,a.endsWith=bt,a.enforceCacheSizeLimit=function(e){we(),Ye&&Ye.then(function(t){t.keys().then(function(r){for(var l=0;l<r.length-e;l++)t.delete(r[l])})})},a.evaluateSizeForFeature=_s,a.evaluateSizeForZoom=Qo,a.evaluateVariableOffset=d,a.evented=af,a.extend=Le,a.featureFilter=xc,a.filterObject=ze,a.fromRotation=function(e,t){var r=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=r,e[2]=0,e[3]=-r,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=Go,a.getAnchorJustification=g,a.getArrayBuffer=Zn,a.getImage=H,a.getJSON=function(e,t){return fi(Le(e,{type:"json"}),t)},a.getRTLTextPluginStatus=Bl,a.getReferrer=jn,a.getVideo=function(e,t){var r,l,f=Y.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var m=0;m<e.length;m++){var A=Y.document.createElement("source");r=e[m],l=void 0,(l=Y.document.createElement("a")).href=r,(l.protocol!==Y.document.location.protocol||l.host!==Y.document.location.host)&&(f.crossOrigin="Anonymous"),A.src=e[m],f.appendChild(A)}return{cancel:function(){}}},a.identity=Oo,a.invert=function(e,t){var r=t[0],l=t[1],f=t[2],m=t[3],A=t[4],I=t[5],U=t[6],re=t[7],he=t[8],Ae=t[9],Pe=t[10],ot=t[11],wt=t[12],Tt=t[13],Wt=t[14],Zt=t[15],nr=r*I-l*A,dr=r*U-f*A,br=r*re-m*A,zr=l*U-f*I,Rr=l*re-m*I,pn=f*re-m*U,hn=he*Tt-Ae*wt,Ln=he*Wt-Pe*wt,Jn=he*Zt-ot*wt,Kn=Ae*Wt-Pe*Tt,Nn=Ae*Zt-ot*Tt,Si=Pe*Zt-ot*Wt,li=nr*Si-dr*Nn+br*Kn+zr*Jn-Rr*Ln+pn*hn;return li?(e[0]=(I*Si-U*Nn+re*Kn)*(li=1/li),e[1]=(f*Nn-l*Si-m*Kn)*li,e[2]=(Tt*pn-Wt*Rr+Zt*zr)*li,e[3]=(Pe*Rr-Ae*pn-ot*zr)*li,e[4]=(U*Jn-A*Si-re*Ln)*li,e[5]=(r*Si-f*Jn+m*Ln)*li,e[6]=(Wt*br-wt*pn-Zt*dr)*li,e[7]=(he*pn-Pe*br+ot*dr)*li,e[8]=(A*Nn-I*Jn+re*hn)*li,e[9]=(l*Jn-r*Nn-m*hn)*li,e[10]=(wt*Rr-Tt*br+Zt*nr)*li,e[11]=(Ae*br-he*Rr-ot*nr)*li,e[12]=(I*Ln-A*Kn-U*hn)*li,e[13]=(r*Kn-l*Ln+f*hn)*li,e[14]=(Tt*dr-wt*zr-Wt*nr)*li,e[15]=(he*zr-Ae*dr+Pe*nr)*li,e):null},a.isChar=qr,a.isMapboxURL=q,a.keysDifference=function(e,t){var r=[];for(var l in e)l in t||r.push(l);return r},a.makeRequest=fi,a.mapObject=Ne,a.mercatorXfromLng=Xc,a.mercatorYfromLat=Jf,a.mercatorZfromAltitude=po,a.mul=Uo,a.multiply=Jo,a.mvt=Ro,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var r=t[0],l=t[1],f=t[2],m=r*r+l*l+f*f;return m>0&&(m=1/Math.sqrt(m)),e[0]=t[0]*m,e[1]=t[1]*m,e[2]=t[2]*m,e},a.number=Na,a.offscreenCanvasSupported=pr,a.ortho=function(e,t,r,l,f,m,A){var I=1/(t-r),U=1/(l-f),re=1/(m-A);return e[0]=-2*I,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*U,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*re,e[11]=0,e[12]=(t+r)*I,e[13]=(f+l)*U,e[14]=(A+m)*re,e[15]=1,e},a.parseGlyphPBF=function(e){return new Be(e).readFields(Lr,[])},a.pbf=Be,a.performSymbolLayout=function(e,t,r,l,f,m,A){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var I=e.layers[0].layout,U=e.layers[0]._unevaluatedLayout._values,re={};if(e.textSizeData.kind==="composite"){var he=e.textSizeData,Ae=he.maxZoom;re.compositeTextSizes=[U["text-size"].possiblyEvaluate(new Mi(he.minZoom),A),U["text-size"].possiblyEvaluate(new Mi(Ae),A)]}if(e.iconSizeData.kind==="composite"){var Pe=e.iconSizeData,ot=Pe.maxZoom;re.compositeIconSizes=[U["icon-size"].possiblyEvaluate(new Mi(Pe.minZoom),A),U["icon-size"].possiblyEvaluate(new Mi(ot),A)]}re.layoutTextSize=U["text-size"].possiblyEvaluate(new Mi(e.zoom+1),A),re.layoutIconSize=U["icon-size"].possiblyEvaluate(new Mi(e.zoom+1),A),re.textMaxSize=U["text-size"].possiblyEvaluate(new Mi(18));for(var wt=24*I.get("text-line-height"),Tt=I.get("text-rotation-alignment")==="map"&&I.get("symbol-placement")!=="point",Wt=I.get("text-keep-upright"),Zt=I.get("text-size"),nr=function(){var Rr=br[dr],pn=I.get("text-font").evaluate(Rr,{},A).join(","),hn=Zt.evaluate(Rr,{},A),Ln=re.layoutTextSize.evaluate(Rr,{},A),Jn=re.layoutIconSize.evaluate(Rr,{},A),Kn={horizontal:{},vertical:void 0},Nn=Rr.text,Si=[0,0];if(Nn){var li=Nn.toString(),ei=24*I.get("text-letter-spacing").evaluate(Rr,{},A),Ki=function(ma){for(var aa=0,eo=ma;aa<eo.length;aa+=1)if(vo=eo[aa].charCodeAt(0),qr.Arabic(vo)||qr["Arabic Supplement"](vo)||qr["Arabic Extended-A"](vo)||qr["Arabic Presentation Forms-A"](vo)||qr["Arabic Presentation Forms-B"](vo))return!1;var vo;return!0}(li)?ei:0,Ri=I.get("text-anchor").evaluate(Rr,{},A),Va=I.get("text-variable-anchor");if(!Va){var mi=I.get("text-radial-offset").evaluate(Rr,{},A);Si=mi?d(Ri,[24*mi,s]):I.get("text-offset").evaluate(Rr,{},A).map(function(ma){return 24*ma})}var ia=Tt?"center":I.get("text-justify").evaluate(Rr,{},A),Zo=I.get("symbol-placement"),ba=Zo==="point"?24*I.get("text-max-width").evaluate(Rr,{},A):0,Wo=function(){e.allowVerticalPlacement&&kc(li)&&(Kn.vertical=Nr(Nn,t,r,f,pn,ba,wt,Ri,"left",Ki,Si,ti.vertical,!0,Zo,Ln,hn))};if(!Tt&&Va){for(var Xo=ia==="auto"?Va.map(function(ma){return g(ma)}):[ia],ls=!1,Eu=0;Eu<Xo.length;Eu++){var cs=Xo[Eu];if(!Kn.horizontal[cs])if(ls)Kn.horizontal[cs]=Kn.horizontal[0];else{var el=Nr(Nn,t,r,f,pn,ba,wt,"center",cs,Ki,Si,ti.horizontal,!1,Zo,Ln,hn);el&&(Kn.horizontal[cs]=el,ls=el.positionedLines.length===1)}}Wo()}else{ia==="auto"&&(ia=g(Ri));var ou=Nr(Nn,t,r,f,pn,ba,wt,Ri,ia,Ki,Si,ti.horizontal,!1,Zo,Ln,hn);ou&&(Kn.horizontal[ia]=ou),Wo(),kc(li)&&Tt&&Wt&&(Kn.vertical=Nr(Nn,t,r,f,pn,ba,wt,Ri,ia,Ki,Si,ti.vertical,!1,Zo,Ln,hn))}}var tl=void 0,su=!1;if(Rr.icon&&Rr.icon.name){var Ws=l[Rr.icon.name];Ws&&(tl=function(ma,aa,eo){var vo=Go(eo),Tu=aa[0]-ma.displaySize[0]*vo.horizontalAlign,Eo=aa[1]-ma.displaySize[1]*vo.verticalAlign;return{image:ma,top:Eo,bottom:Eo+ma.displaySize[1],left:Tu,right:Tu+ma.displaySize[0]}}(f[Rr.icon.name],I.get("icon-offset").evaluate(Rr,{},A),I.get("icon-anchor").evaluate(Rr,{},A)),su=Ws.sdf,e.sdfIcons===void 0?e.sdfIcons=Ws.sdf:e.sdfIcons!==Ws.sdf&&Me("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ws.pixelRatio!==e.pixelRatio||I.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var uu=N(Kn.horizontal)||Kn.vertical;e.iconsInText=!!uu&&uu.iconsInText,(uu||tl)&&function(ma,aa,eo,vo,Tu,Eo,Yo,ku,fa,eh,Yc){var pf=Eo.textMaxSize.evaluate(aa,{});pf===void 0&&(pf=Yo);var dc,ju=ma.layers[0].layout,Bf=ju.get("icon-offset").evaluate(aa,{},Yc),kf=N(eo.horizontal),th=Yo/24,wh=ma.tilePixelRatio*th,wf=ma.tilePixelRatio*pf/24,Ph=ma.tilePixelRatio*ku,rh=ma.tilePixelRatio*ju.get("symbol-spacing"),ph=ju.get("text-padding")*ma.tilePixelRatio,Wh=ju.get("icon-padding")*ma.tilePixelRatio,Bh=ju.get("text-max-angle")/180*Math.PI,Xh=ju.get("text-rotation-alignment")==="map"&&ju.get("symbol-placement")!=="point",vh=ju.get("icon-rotation-alignment")==="map"&&ju.get("symbol-placement")!=="point",Mh=ju.get("symbol-placement"),Yh=rh/2,mh=ju.get("icon-text-fit");vo&&mh!=="none"&&(ma.allowVerticalPlacement&&eo.vertical&&(dc=ta(vo,eo.vertical,mh,ju.get("icon-text-fit-padding"),Bf,th)),kf&&(vo=ta(vo,kf,mh,ju.get("icon-text-fit-padding"),Bf,th)));var nh=function(fd,zh){zh.x<0||zh.x>=8192||zh.y<0||zh.y>=8192||function(bs,Kc,hd,ih,od,h,T,E,b,_,M,j,ae,ve,je,Rt,Jt,wr,Dr,xn,mn,Bn,Ei,Ai,za){var oa,sa,to,_i,ro,To=bs.addToLineVertexArray(Kc,hd),Xs=0,Wi=0,Cs=0,rs=0,vf=-1,Nh=-1,Pc={},Sh=Dt(""),uh=0,$c=0;if(E._unevaluatedLayout.getValue("text-radial-offset")===void 0?(uh=(oa=E.layout.get("text-offset").evaluate(mn,{},Ai).map(function(Td){return 24*Td}))[0],$c=oa[1]):(uh=24*E.layout.get("text-radial-offset").evaluate(mn,{},Ai),$c=s),bs.allowVerticalPlacement&&ih.vertical){var dd=E.layout.get("text-rotate").evaluate(mn,{},Ai)+90;_i=new Ot(b,Kc,_,M,j,ih.vertical,ae,ve,je,dd),T&&(ro=new Ot(b,Kc,_,M,j,T,Jt,wr,je,dd))}if(od){var sd=E.layout.get("icon-rotate").evaluate(mn,{}),pd=E.layout.get("icon-text-fit")!=="none",vd=Li(od,sd,Ei,pd),ud=T?Li(T,sd,Ei,pd):void 0;to=new Ot(b,Kc,_,M,j,od,Jt,wr,!1,sd),Xs=4*vd.length;var md=bs.iconSizeData,Gh=null;md.kind==="source"?(Gh=[128*E.layout.get("icon-size").evaluate(mn,{})])[0]>32640&&Me(bs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):md.kind==="composite"&&((Gh=[128*Bn.compositeIconSizes[0].evaluate(mn,{},Ai),128*Bn.compositeIconSizes[1].evaluate(mn,{},Ai)])[0]>32640||Gh[1]>32640)&&Me(bs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),bs.addSymbols(bs.icon,vd,Gh,xn,Dr,mn,!1,Kc,To.lineStartIndex,To.lineLength,-1,Ai),vf=bs.icon.placedSymbolArray.length-1,ud&&(Wi=4*ud.length,bs.addSymbols(bs.icon,ud,Gh,xn,Dr,mn,ti.vertical,Kc,To.lineStartIndex,To.lineLength,-1,Ai),Nh=bs.icon.placedSymbolArray.length-1)}for(var gd in ih.horizontal){var qh=ih.horizontal[gd];if(!sa){Sh=Dt(qh.text);var Fi=E.layout.get("text-rotate").evaluate(mn,{},Ai);sa=new Ot(b,Kc,_,M,j,qh,ae,ve,je,Fi)}var Ga=qh.positionedLines.length===1;if(Cs+=L(bs,Kc,qh,h,E,je,mn,Rt,To,ih.vertical?ti.horizontal:ti.horizontalOnly,Ga?Object.keys(ih.horizontal):[gd],Pc,vf,Bn,Ai),Ga)break}ih.vertical&&(rs+=L(bs,Kc,ih.vertical,h,E,je,mn,Rt,To,ti.vertical,["vertical"],Pc,Nh,Bn,Ai));var ua=sa?sa.boxStartIndex:bs.collisionBoxArray.length,Dn=sa?sa.boxEndIndex:bs.collisionBoxArray.length,Mc=_i?_i.boxStartIndex:bs.collisionBoxArray.length,Ss=_i?_i.boxEndIndex:bs.collisionBoxArray.length,Jc=to?to.boxStartIndex:bs.collisionBoxArray.length,Qc=to?to.boxEndIndex:bs.collisionBoxArray.length,Eh=ro?ro.boxStartIndex:bs.collisionBoxArray.length,yd=ro?ro.boxEndIndex:bs.collisionBoxArray.length,lh=-1,xd=function(bd,Ad){return bd&&bd.circleDiameter?Math.max(bd.circleDiameter,Ad):Ad};lh=xd(sa,lh),lh=xd(_i,lh),lh=xd(to,lh);var Ed=(lh=xd(ro,lh))>-1?1:0;Ed&&(lh*=za/24),bs.glyphOffsetArray.length>=jt.MAX_GLYPHS&&Me("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),mn.sortKey!==void 0&&bs.addToSortKeyRanges(bs.symbolInstances.length,mn.sortKey),bs.symbolInstances.emplaceBack(Kc.x,Kc.y,Pc.right>=0?Pc.right:-1,Pc.center>=0?Pc.center:-1,Pc.left>=0?Pc.left:-1,Pc.vertical||-1,vf,Nh,Sh,ua,Dn,Mc,Ss,Jc,Qc,Eh,yd,_,Cs,rs,Xs,Wi,Ed,0,ae,uh,$c,lh)}(ma,zh,fd,eo,vo,Tu,dc,ma.layers[0],ma.collisionBoxArray,aa.index,aa.sourceLayerIndex,ma.index,wh,ph,Xh,fa,Ph,Wh,vh,Bf,aa,Eo,eh,Yc,Yo)};if(Mh==="line")for(var sh=0,Kh=bn(aa.geometry,0,0,8192,8192);sh<Kh.length;sh+=1)for(var kh=Kh[sh],gh=0,jh=Aa(kh,rh,Bh,eo.vertical||kf,vo,24,wf,ma.overscaling,8192);gh<jh.length;gh+=1){var Ih=jh[gh];kf&&K(ma,kf.text,Yh,Ih)||nh(kh,Ih)}else if(Mh==="line-center")for(var yh=0,Uh=aa.geometry;yh<Uh.length;yh+=1){var Vh=Uh[yh];if(Vh.length>1){var Oh=Zs(Vh,Bh,eo.vertical||kf,vo,24,wf);Oh&&nh(Vh,Oh)}}else if(aa.type==="Polygon")for(var Lh=0,xh=z(aa.geometry,0);Lh<xh.length;Lh+=1){var Rh=xh[Lh],bh=Rn(Rh,16);nh(Rh[0],new ho(bh.x,bh.y,0))}else if(aa.type==="LineString")for(var jf=0,Dh=aa.geometry;jf<Dh.length;jf+=1){var $h=Dh[jf];nh($h,new ho($h[0].x,$h[0].y,0))}else if(aa.type==="Point")for(var Jh=0,nd=aa.geometry;Jh<nd.length;Jh+=1)for(var id=0,ad=nd[Jh];id<ad.length;id+=1){var Qh=ad[id];nh([Qh],new ho(Qh.x,Qh.y,0))}}(e,Rr,Kn,tl,l,re,Ln,Jn,Si,su,A)},dr=0,br=e.features;dr<br.length;dr+=1)nr();m&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,r,l,f){var m,A=1/Math.tan(t/2);return e[0]=A/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=A,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+l)*(m=1/(l-f)),e[14]=2*f*l*m):(e[10]=-1,e[14]=-2*l),e},a.pick=function(e,t){for(var r={},l=0;l<t.length;l++){var f=t[l];f in e&&(r[f]=e[f])}return r},a.plugin=ss,a.polygonIntersectsPolygon=yu,a.postMapLoadEvent=vt,a.postTurnstileEvent=lr,a.potpack=Br,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=In,a.registerForPluginStateChange=function(e){return e({pluginStatus:Bo,pluginURL:cl}),af.on("pluginStateChange",e),e},a.renderColorRamp=gs,a.rotate=function(e,t,r){var l=t[0],f=t[1],m=t[2],A=t[3],I=Math.sin(r),U=Math.cos(r);return e[0]=l*U+m*I,e[1]=f*U+A*I,e[2]=l*-I+m*U,e[3]=f*-I+A*U,e},a.rotateX=function(e,t,r){var l=Math.sin(r),f=Math.cos(r),m=t[4],A=t[5],I=t[6],U=t[7],re=t[8],he=t[9],Ae=t[10],Pe=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=m*f+re*l,e[5]=A*f+he*l,e[6]=I*f+Ae*l,e[7]=U*f+Pe*l,e[8]=re*f-m*l,e[9]=he*f-A*l,e[10]=Ae*f-I*l,e[11]=Pe*f-U*l,e},a.rotateZ=function(e,t,r){var l=Math.sin(r),f=Math.cos(r),m=t[0],A=t[1],I=t[2],U=t[3],re=t[4],he=t[5],Ae=t[6],Pe=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=m*f+re*l,e[1]=A*f+he*l,e[2]=I*f+Ae*l,e[3]=U*f+Pe*l,e[4]=re*f-m*l,e[5]=he*f-A*l,e[6]=Ae*f-I*l,e[7]=Pe*f-U*l,e},a.scale=function(e,t,r){var l=r[0],f=r[1],m=r[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*m,e[9]=t[9]*m,e[10]=t[10]*m,e[11]=t[11]*m,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},a.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},a.setCacheLimits=function(e,t){Ct=e,gt=t},a.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),Bo==="deferred"||Bo==="loading"||Bo==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");cl=ge.resolveURL(e),Bo="deferred",$o=t,Fl(),r||Os()},a.sphericalToCartesian=function(e){var t=e[0],r=e[1],l=e[2];return r+=90,r*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(l),y:t*Math.sin(r)*Math.sin(l),z:t*Math.cos(l)}},a.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},a.styleSpec=He,a.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},a.symbolSize=ys,a.transformMat3=function(e,t,r){var l=t[0],f=t[1],m=t[2];return e[0]=l*r[0]+f*r[3]+m*r[6],e[1]=l*r[1]+f*r[4]+m*r[7],e[2]=l*r[2]+f*r[5]+m*r[8],e},a.transformMat4=Vs,a.translate=function(e,t,r){var l,f,m,A,I,U,re,he,Ae,Pe,ot,wt,Tt=r[0],Wt=r[1],Zt=r[2];return t===e?(e[12]=t[0]*Tt+t[4]*Wt+t[8]*Zt+t[12],e[13]=t[1]*Tt+t[5]*Wt+t[9]*Zt+t[13],e[14]=t[2]*Tt+t[6]*Wt+t[10]*Zt+t[14],e[15]=t[3]*Tt+t[7]*Wt+t[11]*Zt+t[15]):(f=t[1],m=t[2],A=t[3],I=t[4],U=t[5],re=t[6],he=t[7],Ae=t[8],Pe=t[9],ot=t[10],wt=t[11],e[0]=l=t[0],e[1]=f,e[2]=m,e[3]=A,e[4]=I,e[5]=U,e[6]=re,e[7]=he,e[8]=Ae,e[9]=Pe,e[10]=ot,e[11]=wt,e[12]=l*Tt+I*Wt+Ae*Zt+t[12],e[13]=f*Tt+U*Wt+Pe*Zt+t[13],e[14]=m*Tt+re*Wt+ot*Zt+t[14],e[15]=A*Tt+he*Wt+wt*Zt+t[15]),e},a.triggerPluginCompletionEvent=Tl,a.uniqueId=it,a.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=yf,a.validateStyle=ql,a.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},a.vectorTile=Ro,a.version="1.13.0",a.warnOnce=Me,a.webpSupported=Ve,a.window=Y,a.wrap=st}),B(["./shared"],function(a){"use strict";function W(k){var H=typeof k;if(H==="number"||H==="boolean"||H==="string"||k==null)return JSON.stringify(k);if(Array.isArray(k)){for(var le="[",de=0,at=k;de<at.length;de+=1)le+=W(at[de])+",";return le+"]"}for(var At=Object.keys(k).sort(),Ft="{",He=0;He<At.length;He++)Ft+=JSON.stringify(At[He])+":"+W(k[At[He]])+",";return Ft+"}"}function D(k){for(var H="",le=0,de=a.refProperties;le<de.length;le+=1)H+="/"+W(k[de[le]]);return H}var J=function(H){this.keyCache={},H&&this.replace(H)};J.prototype.replace=function(k){this._layerConfigs={},this._layers={},this.update(k,[])},J.prototype.update=function(k,H){for(var le=this,de=0,at=k;de<at.length;de+=1){var At=at[de];this._layerConfigs[At.id]=At;var Ft=this._layers[At.id]=a.createStyleLayer(At);Ft._featureFilter=a.featureFilter(Ft.filter),this.keyCache[At.id]&&delete this.keyCache[At.id]}for(var He=0,Pt=H;He<Pt.length;He+=1){var or=Pt[He];delete this.keyCache[or],delete this._layerConfigs[or],delete this._layers[or]}this.familiesBySource={};for(var jr=0,Hr=function(vn,gn){for(var Ar={},$r=0;$r<vn.length;$r++){var Mn=gn&&gn[vn[$r].id]||D(vn[$r]);gn&&(gn[vn[$r].id]=Mn);var Xi=Ar[Mn];Xi||(Xi=Ar[Mn]=[]),Xi.push(vn[$r])}var vi=[];for(var wi in Ar)vi.push(Ar[wi]);return vi}(a.values(this._layerConfigs),this.keyCache);jr<Hr.length;jr+=1){var sr=Hr[jr].map(function(vn){return le._layers[vn.id]}),Fr=sr[0];if(Fr.visibility!=="none"){var _n=Fr.source||"",dn=this.familiesBySource[_n];dn||(dn=this.familiesBySource[_n]={});var Er=Fr.sourceLayer||"_geojsonTileLayer",Tn=dn[Er];Tn||(Tn=dn[Er]=[]),Tn.push(sr)}}};var te=function(H){var le={},de=[];for(var at in H){var At=H[at],Ft=le[at]={};for(var He in At){var Pt=At[+He];if(Pt&&Pt.bitmap.width!==0&&Pt.bitmap.height!==0){var or={x:0,y:0,w:Pt.bitmap.width+2,h:Pt.bitmap.height+2};de.push(or),Ft[He]={rect:or,metrics:Pt.metrics}}}}var jr=a.potpack(de),Hr=new a.AlphaImage({width:jr.w||1,height:jr.h||1});for(var sr in H){var Fr=H[sr];for(var _n in Fr){var dn=Fr[+_n];if(dn&&dn.bitmap.width!==0&&dn.bitmap.height!==0){var Er=le[sr][_n].rect;a.AlphaImage.copy(dn.bitmap,Hr,{x:0,y:0},{x:Er.x+1,y:Er.y+1},dn.bitmap)}}}this.image=Hr,this.positions=le};a.register("GlyphAtlas",te);var ce=function(H){this.tileID=new a.OverscaledTileID(H.tileID.overscaledZ,H.tileID.wrap,H.tileID.canonical.z,H.tileID.canonical.x,H.tileID.canonical.y),this.uid=H.uid,this.zoom=H.zoom,this.pixelRatio=H.pixelRatio,this.tileSize=H.tileSize,this.source=H.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=H.showCollisionBoxes,this.collectResourceTiming=!!H.collectResourceTiming,this.returnDependencies=!!H.returnDependencies,this.promoteId=H.promoteId};function Y(k,H,le){for(var de=new a.EvaluationParameters(H),at=0,At=k;at<At.length;at+=1)At[at].recalculate(de,le)}function ke(k,H){var le=a.getArrayBuffer(k.request,function(de,at,At,Ft){de?H(de):at&&H(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(at)),rawData:at,cacheControl:At,expires:Ft})});return function(){le.cancel(),H()}}ce.prototype.parse=function(k,H,le,de,at){var At=this;this.status="parsing",this.data=k,this.collisionBoxArray=new a.CollisionBoxArray;var Ft=new a.DictionaryCoder(Object.keys(k.layers).sort()),He=new a.FeatureIndex(this.tileID,this.promoteId);He.bucketLayerIDs=[];var Pt,or,jr,Hr,sr={},Fr={featureIndex:He,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le},_n=H.familiesBySource[this.source];for(var dn in _n){var Er=k.layers[dn];if(Er){Er.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+dn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Tn=Ft.encode(dn),vn=[],gn=0;gn<Er.length;gn++){var Ar=Er.feature(gn),$r=He.getId(Ar,dn);vn.push({feature:Ar,id:$r,index:gn,sourceLayerIndex:Tn})}for(var Mn=0,Xi=_n[dn];Mn<Xi.length;Mn+=1){var vi=Xi[Mn],wi=vi[0];wi.minzoom&&this.zoom<Math.floor(wi.minzoom)||wi.maxzoom&&this.zoom>=wi.maxzoom||wi.visibility!=="none"&&(Y(vi,this.zoom,le),(sr[wi.id]=wi.createBucket({index:He.bucketLayerIDs.length,layers:vi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Tn,sourceID:this.source})).populate(vn,Fr,this.tileID.canonical),He.bucketLayerIDs.push(vi.map(function(Pi){return Pi.id})))}}}var Di=a.mapObject(Fr.glyphDependencies,function(Pi){return Object.keys(Pi).map(Number)});Object.keys(Di).length?de.send("getGlyphs",{uid:this.uid,stacks:Di},function(Pi,gi){Pt||(Pt=Pi,or=gi,ga.call(At))}):or={};var Ka=Object.keys(Fr.iconDependencies);Ka.length?de.send("getImages",{icons:Ka,source:this.source,tileID:this.tileID,type:"icons"},function(Pi,gi){Pt||(Pt=Pi,jr=gi,ga.call(At))}):jr={};var hi=Object.keys(Fr.patternDependencies);function ga(){if(Pt)return at(Pt);if(or&&jr&&Hr){var Pi=new te(or),gi=new a.ImageAtlas(jr,Hr);for(var ci in sr){var Oa=sr[ci];Oa instanceof a.SymbolBucket?(Y(Oa.layers,this.zoom,le),a.performSymbolLayout(Oa,or,Pi.positions,jr,gi.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Oa.hasPattern&&(Oa instanceof a.LineBucket||Oa instanceof a.FillBucket||Oa instanceof a.FillExtrusionBucket)&&(Y(Oa.layers,this.zoom,le),Oa.addFeatures(Fr,this.tileID.canonical,gi.patternPositions))}this.status="done",at(null,{buckets:a.values(sr).filter(function(mo){return!mo.isEmpty()}),featureIndex:He,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Pi.image,imageAtlas:gi,glyphMap:this.returnDependencies?or:null,iconMap:this.returnDependencies?jr:null,glyphPositions:this.returnDependencies?Pi.positions:null})}}hi.length?de.send("getImages",{icons:hi,source:this.source,tileID:this.tileID,type:"patterns"},function(Pi,gi){Pt||(Pt=Pi,Hr=gi,ga.call(At))}):Hr={},ga.call(this)};var Ke=function(H,le,de,at){this.actor=H,this.layerIndex=le,this.availableImages=de,this.loadVectorData=at||ke,this.loading={},this.loaded={}};Ke.prototype.loadTile=function(k,H){var le=this,de=k.uid;this.loading||(this.loading={});var at=!!(k&&k.request&&k.request.collectResourceTiming)&&new a.RequestPerformance(k.request),At=this.loading[de]=new ce(k);At.abort=this.loadVectorData(k,function(Ft,He){if(delete le.loading[de],Ft||!He)return At.status="done",le.loaded[de]=At,H(Ft);var Pt=He.rawData,or={};He.expires&&(or.expires=He.expires),He.cacheControl&&(or.cacheControl=He.cacheControl);var jr={};if(at){var Hr=at.finish();Hr&&(jr.resourceTiming=JSON.parse(JSON.stringify(Hr)))}At.vectorTile=He.vectorTile,At.parse(He.vectorTile,le.layerIndex,le.availableImages,le.actor,function(sr,Fr){if(sr||!Fr)return H(sr);H(null,a.extend({rawTileData:Pt.slice(0)},Fr,or,jr))}),le.loaded=le.loaded||{},le.loaded[de]=At})},Ke.prototype.reloadTile=function(k,H){var le=this,de=this.loaded,at=k.uid,At=this;if(de&&de[at]){var Ft=de[at];Ft.showCollisionBoxes=k.showCollisionBoxes;var He=function(or,jr){var Hr=Ft.reloadCallback;Hr&&(delete Ft.reloadCallback,Ft.parse(Ft.vectorTile,At.layerIndex,le.availableImages,At.actor,Hr)),H(or,jr)};Ft.status==="parsing"?Ft.reloadCallback=He:Ft.status==="done"&&(Ft.vectorTile?Ft.parse(Ft.vectorTile,this.layerIndex,this.availableImages,this.actor,He):He())}},Ke.prototype.abortTile=function(k,H){var le=this.loading,de=k.uid;le&&le[de]&&le[de].abort&&(le[de].abort(),delete le[de]),H()},Ke.prototype.removeTile=function(k,H){var le=this.loaded,de=k.uid;le&&le[de]&&delete le[de],H()};var We=a.window.ImageBitmap,Oe=function(){this.loaded={}};function st(k,H){if(k.length!==0){Le(k[0],H);for(var le=1;le<k.length;le++)Le(k[le],!H)}}function Le(k,H){for(var le=0,de=0,at=k.length,At=at-1;de<at;At=de++)le+=(k[de][0]-k[At][0])*(k[At][1]+k[de][1]);le>=0!=!!H&&k.reverse()}Oe.prototype.loadTile=function(k,H){var le=k.uid,de=k.encoding,at=k.rawImageData,At=We&&at instanceof We?this.getImageData(at):at,Ft=new a.DEMData(le,At,de);this.loaded=this.loaded||{},this.loaded[le]=Ft,H(null,Ft)},Oe.prototype.getImageData=function(k){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(k.width,k.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=k.width,this.offscreenCanvas.height=k.height,this.offscreenCanvasContext.drawImage(k,0,0,k.width,k.height);var H=this.offscreenCanvasContext.getImageData(-1,-1,k.width+2,k.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:H.width,height:H.height},H.data)},Oe.prototype.removeTile=function(k){var H=this.loaded,le=k.uid;H&&H[le]&&delete H[le]};var xt=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,it=function(H){this._feature=H,this.extent=a.EXTENT,this.type=H.type,this.properties=H.tags,"id"in H&&!isNaN(H.id)&&(this.id=parseInt(H.id,10))};it.prototype.loadGeometry=function(){if(this._feature.type===1){for(var k=[],H=0,le=this._feature.geometry;H<le.length;H+=1){var de=le[H];k.push([new a.Point$1(de[0],de[1])])}return k}for(var at=[],At=0,Ft=this._feature.geometry;At<Ft.length;At+=1){for(var He=[],Pt=0,or=Ft[At];Pt<or.length;Pt+=1){var jr=or[Pt];He.push(new a.Point$1(jr[0],jr[1]))}at.push(He)}return at},it.prototype.toGeoJSON=function(k,H,le){return xt.call(this,k,H,le)};var $e=function(H){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=H.length,this._features=H};$e.prototype.feature=function(k){return new it(this._features[k])};var Ze=a.vectorTile.VectorTileFeature,St=bt;function bt(k,H){this.options=H||{},this.features=k,this.length=k.length}function Ne(k,H){this.id=typeof k.id=="number"?k.id:void 0,this.type=k.type,this.rawGeometry=k.type===1?[k.geometry]:k.geometry,this.properties=k.tags,this.extent=H||4096}bt.prototype.feature=function(k){return new Ne(this.features[k],this.options.extent)},Ne.prototype.loadGeometry=function(){var k=this.rawGeometry;this.geometry=[];for(var H=0;H<k.length;H++){for(var le=k[H],de=[],at=0;at<le.length;at++)de.push(new a.Point$1(le[at][0],le[at][1]));this.geometry.push(de)}return this.geometry},Ne.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var k=this.geometry,H=1/0,le=-1/0,de=1/0,at=-1/0,At=0;At<k.length;At++)for(var Ft=k[At],He=0;He<Ft.length;He++){var Pt=Ft[He];H=Math.min(H,Pt.x),le=Math.max(le,Pt.x),de=Math.min(de,Pt.y),at=Math.max(at,Pt.y)}return[H,de,le,at]},Ne.prototype.toGeoJSON=Ze.prototype.toGeoJSON;var ze=lt,Ue=St;function lt(k){var H=new a.pbf;return function(le,de){for(var at in le.layers)de.writeMessage(3,Me,le.layers[at])}(k,H),H.finish()}function Me(k,H){var le;H.writeVarintField(15,k.version||1),H.writeStringField(1,k.name||""),H.writeVarintField(5,k.extent||4096);var de={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<k.length;le++)de.feature=k.feature(le),H.writeMessage(2,ct,de);var at=de.keys;for(le=0;le<at.length;le++)H.writeStringField(3,at[le]);var At=de.values;for(le=0;le<At.length;le++)H.writeMessage(4,Q,At[le])}function ct(k,H){var le=k.feature;le.id!==void 0&&H.writeVarintField(1,le.id),H.writeMessage(2,Gt,k),H.writeVarintField(3,le.type),H.writeMessage(4,oe,le)}function Gt(k,H){var le=k.feature,de=k.keys,at=k.values,At=k.keycache,Ft=k.valuecache;for(var He in le.properties){var Pt=At[He];Pt===void 0&&(de.push(He),At[He]=Pt=de.length-1),H.writeVarint(Pt);var or=le.properties[He],jr=typeof or;jr!=="string"&&jr!=="boolean"&&jr!=="number"&&(or=JSON.stringify(or));var Hr=jr+":"+or,sr=Ft[Hr];sr===void 0&&(at.push(or),Ft[Hr]=sr=at.length-1),H.writeVarint(sr)}}function $t(k,H){return(H<<3)+(7&k)}function ar(k){return k<<1^k>>31}function oe(k,H){for(var le=k.loadGeometry(),de=k.type,at=0,At=0,Ft=le.length,He=0;He<Ft;He++){var Pt=le[He],or=1;de===1&&(or=Pt.length),H.writeVarint($t(1,or));for(var jr=de===3?Pt.length-1:Pt.length,Hr=0;Hr<jr;Hr++){Hr===1&&de!==1&&H.writeVarint($t(2,jr-1));var sr=Pt[Hr].x-at,Fr=Pt[Hr].y-At;H.writeVarint(ar(sr)),H.writeVarint(ar(Fr)),at+=sr,At+=Fr}de===3&&H.writeVarint($t(7,1))}}function Q(k,H){var le=typeof k;le==="string"?H.writeStringField(1,k):le==="boolean"?H.writeBooleanField(7,k):le==="number"&&(k%1!=0?H.writeDoubleField(3,k):k<0?H.writeSVarintField(6,k):H.writeVarintField(5,k))}function G(k,H,le,de){Ce(k,le,de),Ce(H,2*le,2*de),Ce(H,2*le+1,2*de+1)}function Ce(k,H,le){var de=k[H];k[H]=k[le],k[le]=de}function be(k,H,le,de){var at=k-le,At=H-de;return at*at+At*At}ze.fromVectorTileJs=lt,ze.fromGeojsonVt=function(k,H){H=H||{};var le={};for(var de in k)le[de]=new St(k[de].features,H),le[de].name=de,le[de].version=H.version,le[de].extent=H.extent;return lt({layers:le})},ze.GeoJSONWrapper=Ue;var Te=function(H){return H[0]},me=function(H){return H[1]},rt=function(H,le,de,at,At){le===void 0&&(le=Te),de===void 0&&(de=me),at===void 0&&(at=64),At===void 0&&(At=Float64Array),this.nodeSize=at,this.points=H;for(var Ft=H.length<65536?Uint16Array:Uint32Array,He=this.ids=new Ft(H.length),Pt=this.coords=new At(2*H.length),or=0;or<H.length;or++)He[or]=or,Pt[2*or]=le(H[or]),Pt[2*or+1]=de(H[or]);(function jr(Hr,sr,Fr,_n,dn,Er){if(!(dn-_n<=Fr)){var Tn=_n+dn>>1;(function vn(gn,Ar,$r,Mn,Xi,vi){for(;Xi>Mn;){if(Xi-Mn>600){var wi=Xi-Mn+1,Di=$r-Mn+1,Ka=Math.log(wi),hi=.5*Math.exp(2*Ka/3),ga=.5*Math.sqrt(Ka*hi*(wi-hi)/wi)*(Di-wi/2<0?-1:1);vn(gn,Ar,$r,Math.max(Mn,Math.floor($r-Di*hi/wi+ga)),Math.min(Xi,Math.floor($r+(wi-Di)*hi/wi+ga)),vi)}var Pi=Ar[2*$r+vi],gi=Mn,ci=Xi;for(G(gn,Ar,Mn,$r),Ar[2*Xi+vi]>Pi&&G(gn,Ar,Mn,Xi);gi<ci;){for(G(gn,Ar,gi,ci),gi++,ci--;Ar[2*gi+vi]<Pi;)gi++;for(;Ar[2*ci+vi]>Pi;)ci--}Ar[2*Mn+vi]===Pi?G(gn,Ar,Mn,ci):G(gn,Ar,++ci,Xi),ci<=$r&&(Mn=ci+1),$r<=ci&&(Xi=ci-1)}})(Hr,sr,Tn,_n,dn,Er%2),jr(Hr,sr,Fr,_n,Tn-1,Er+1),jr(Hr,sr,Fr,Tn+1,dn,Er+1)}})(He,Pt,at,0,He.length-1,0)};rt.prototype.range=function(k,H,le,de){return function(at,At,Ft,He,Pt,or,jr){for(var Hr,sr,Fr=[0,at.length-1,0],_n=[];Fr.length;){var dn=Fr.pop(),Er=Fr.pop(),Tn=Fr.pop();if(Er-Tn<=jr)for(var vn=Tn;vn<=Er;vn++)sr=At[2*vn+1],(Hr=At[2*vn])>=Ft&&Hr<=Pt&&sr>=He&&sr<=or&&_n.push(at[vn]);else{var gn=Math.floor((Tn+Er)/2);sr=At[2*gn+1],(Hr=At[2*gn])>=Ft&&Hr<=Pt&&sr>=He&&sr<=or&&_n.push(at[gn]);var Ar=(dn+1)%2;(dn===0?Ft<=Hr:He<=sr)&&(Fr.push(Tn),Fr.push(gn-1),Fr.push(Ar)),(dn===0?Pt>=Hr:or>=sr)&&(Fr.push(gn+1),Fr.push(Er),Fr.push(Ar))}}return _n}(this.ids,this.coords,k,H,le,de,this.nodeSize)},rt.prototype.within=function(k,H,le){return function(de,at,At,Ft,He,Pt){for(var or=[0,de.length-1,0],jr=[],Hr=He*He;or.length;){var sr=or.pop(),Fr=or.pop(),_n=or.pop();if(Fr-_n<=Pt)for(var dn=_n;dn<=Fr;dn++)be(at[2*dn],at[2*dn+1],At,Ft)<=Hr&&jr.push(de[dn]);else{var Er=Math.floor((_n+Fr)/2),Tn=at[2*Er],vn=at[2*Er+1];be(Tn,vn,At,Ft)<=Hr&&jr.push(de[Er]);var gn=(sr+1)%2;(sr===0?At-He<=Tn:Ft-He<=vn)&&(or.push(_n),or.push(Er-1),or.push(gn)),(sr===0?At+He>=Tn:Ft+He>=vn)&&(or.push(Er+1),or.push(Fr),or.push(gn))}}return jr}(this.ids,this.coords,k,H,le,this.nodeSize)};var Kt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(H){return H}},_t=function(H){this.options=C(Object.create(Kt),H),this.trees=new Array(this.options.maxZoom+1)};function ge(k,H,le,de,at){return{x:k,y:H,zoom:1/0,id:le,parentId:-1,numPoints:de,properties:at}}function ye(k,H){var le=k.geometry.coordinates,de=le[1];return{x:Ie(le[0]),y:pt(de),zoom:1/0,index:H,parentId:-1}}function Ve(k){return{type:"Feature",id:k.id,properties:ft(k),geometry:{type:"Point",coordinates:[(de=k.x,360*(de-.5)),(H=k.y,le=(180-360*H)*Math.PI/180,360*Math.atan(Math.exp(le))/Math.PI-90)]}};var H,le,de}function ft(k){var H=k.numPoints,le=H>=1e4?Math.round(H/1e3)+"k":H>=1e3?Math.round(H/100)/10+"k":H;return C(C({},k.properties),{cluster:!0,cluster_id:k.id,point_count:H,point_count_abbreviated:le})}function Ie(k){return k/360+.5}function pt(k){var H=Math.sin(k*Math.PI/180),le=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return le<0?0:le>1?1:le}function C(k,H){for(var le in H)k[le]=H[le];return k}function R(k){return k.x}function q(k){return k.y}function fe(k,H,le,de,at,At){var Ft=at-le,He=At-de;if(Ft!==0||He!==0){var Pt=((k-le)*Ft+(H-de)*He)/(Ft*Ft+He*He);Pt>1?(le=at,de=At):Pt>0&&(le+=Ft*Pt,de+=He*Pt)}return(Ft=k-le)*Ft+(He=H-de)*He}function Ge(k,H,le,de){var at={id:k===void 0?null:k,type:H,geometry:le,tags:de,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(At){var Ft=At.geometry,He=At.type;if(He==="Point"||He==="MultiPoint"||He==="LineString")Je(At,Ft);else if(He==="Polygon"||He==="MultiLineString")for(var Pt=0;Pt<Ft.length;Pt++)Je(At,Ft[Pt]);else if(He==="MultiPolygon")for(Pt=0;Pt<Ft.length;Pt++)for(var or=0;or<Ft[Pt].length;or++)Je(At,Ft[Pt][or])}(at),at}function Je(k,H){for(var le=0;le<H.length;le+=3)k.minX=Math.min(k.minX,H[le]),k.minY=Math.min(k.minY,H[le+1]),k.maxX=Math.max(k.maxX,H[le]),k.maxY=Math.max(k.maxY,H[le+1])}function yt(k,H,le,de){if(H.geometry){var at=H.geometry.coordinates,At=H.geometry.type,Ft=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),He=[],Pt=H.id;if(le.promoteId?Pt=H.properties[le.promoteId]:le.generateId&&(Pt=de||0),At==="Point")nt(at,He);else if(At==="MultiPoint")for(var or=0;or<at.length;or++)nt(at[or],He);else if(At==="LineString")Nt(at,He,Ft,!1);else if(At==="MultiLineString"){if(le.lineMetrics){for(or=0;or<at.length;or++)Nt(at[or],He=[],Ft,!1),k.push(Ge(Pt,"LineString",He,H.properties));return}$(at,He,Ft,!1)}else if(At==="Polygon")$(at,He,Ft,!0);else{if(At!=="MultiPolygon"){if(At==="GeometryCollection"){for(or=0;or<H.geometry.geometries.length;or++)yt(k,{id:Pt,geometry:H.geometry.geometries[or],properties:H.properties},le,de);return}throw new Error("Input data is not a valid GeoJSON object.")}for(or=0;or<at.length;or++){var jr=[];$(at[or],jr,Ft,!0),He.push(jr)}}k.push(Ge(Pt,At,He,H.properties))}}function nt(k,H){H.push(Ye(k[0])),H.push(ie(k[1])),H.push(0)}function Nt(k,H,le,de){for(var at,At,Ft=0,He=0;He<k.length;He++){var Pt=Ye(k[He][0]),or=ie(k[He][1]);H.push(Pt),H.push(or),H.push(0),He>0&&(Ft+=de?(at*or-Pt*At)/2:Math.sqrt(Math.pow(Pt-at,2)+Math.pow(or-At,2))),at=Pt,At=or}var jr=H.length-3;H[2]=1,function Hr(sr,Fr,_n,dn){for(var Er,Tn=dn,vn=_n-Fr>>1,gn=_n-Fr,Ar=sr[Fr],$r=sr[Fr+1],Mn=sr[_n],Xi=sr[_n+1],vi=Fr+3;vi<_n;vi+=3){var wi=fe(sr[vi],sr[vi+1],Ar,$r,Mn,Xi);if(wi>Tn)Er=vi,Tn=wi;else if(wi===Tn){var Di=Math.abs(vi-vn);Di<gn&&(Er=vi,gn=Di)}}Tn>dn&&(Er-Fr>3&&Hr(sr,Fr,Er,dn),sr[Er+2]=Tn,_n-Er>3&&Hr(sr,Er,_n,dn))}(H,0,jr,le),H[jr+2]=1,H.size=Math.abs(Ft),H.start=0,H.end=H.size}function $(k,H,le,de){for(var at=0;at<k.length;at++){var At=[];Nt(k[at],At,le,de),H.push(At)}}function Ye(k){return k/360+.5}function ie(k){var H=Math.sin(k*Math.PI/180),le=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return le<0?0:le>1?1:le}function et(k,H,le,de,at,At,Ft,He){if(de/=H,At>=(le/=H)&&Ft<de)return k;if(Ft<le||At>=de)return null;for(var Pt=[],or=0;or<k.length;or++){var jr=k[or],Hr=jr.geometry,sr=jr.type,Fr=at===0?jr.minX:jr.minY,_n=at===0?jr.maxX:jr.maxY;if(Fr>=le&&_n<de)Pt.push(jr);else if(!(_n<le||Fr>=de)){var dn=[];if(sr==="Point"||sr==="MultiPoint")Bt(Hr,dn,le,de,at);else if(sr==="LineString")lr(Hr,dn,le,de,at,!1,He.lineMetrics);else if(sr==="MultiLineString")vt(Hr,dn,le,de,at,!1);else if(sr==="Polygon")vt(Hr,dn,le,de,at,!0);else if(sr==="MultiPolygon")for(var Er=0;Er<Hr.length;Er++){var Tn=[];vt(Hr[Er],Tn,le,de,at,!0),Tn.length&&dn.push(Tn)}if(dn.length){if(He.lineMetrics&&sr==="LineString"){for(Er=0;Er<dn.length;Er++)Pt.push(Ge(jr.id,sr,dn[Er],jr.tags));continue}sr!=="LineString"&&sr!=="MultiLineString"||(dn.length===1?(sr="LineString",dn=dn[0]):sr="MultiLineString"),sr!=="Point"&&sr!=="MultiPoint"||(sr=dn.length===3?"Point":"MultiPoint"),Pt.push(Ge(jr.id,sr,dn,jr.tags))}}}return Pt.length?Pt:null}function Bt(k,H,le,de,at){for(var At=0;At<k.length;At+=3){var Ft=k[At+at];Ft>=le&&Ft<=de&&(H.push(k[At]),H.push(k[At+1]),H.push(k[At+2]))}}function lr(k,H,le,de,at,At,Ft){for(var He,Pt,or=dt(k),jr=at===0?gt:we,Hr=k.start,sr=0;sr<k.length-3;sr+=3){var Fr=k[sr],_n=k[sr+1],dn=k[sr+2],Er=k[sr+3],Tn=k[sr+4],vn=at===0?Fr:_n,gn=at===0?Er:Tn,Ar=!1;Ft&&(He=Math.sqrt(Math.pow(Fr-Er,2)+Math.pow(_n-Tn,2))),vn<le?gn>le&&(Pt=jr(or,Fr,_n,Er,Tn,le),Ft&&(or.start=Hr+He*Pt)):vn>de?gn<de&&(Pt=jr(or,Fr,_n,Er,Tn,de),Ft&&(or.start=Hr+He*Pt)):Ct(or,Fr,_n,dn),gn<le&&vn>=le&&(Pt=jr(or,Fr,_n,Er,Tn,le),Ar=!0),gn>de&&vn<=de&&(Pt=jr(or,Fr,_n,Er,Tn,de),Ar=!0),!At&&Ar&&(Ft&&(or.end=Hr+He*Pt),H.push(or),or=dt(k)),Ft&&(Hr+=He)}var $r=k.length-3;Fr=k[$r],_n=k[$r+1],dn=k[$r+2],(vn=at===0?Fr:_n)>=le&&vn<=de&&Ct(or,Fr,_n,dn),$r=or.length-3,At&&$r>=3&&(or[$r]!==or[0]||or[$r+1]!==or[1])&&Ct(or,or[0],or[1],or[2]),or.length&&H.push(or)}function dt(k){var H=[];return H.size=k.size,H.start=k.start,H.end=k.end,H}function vt(k,H,le,de,at,At){for(var Ft=0;Ft<k.length;Ft++)lr(k[Ft],H,le,de,at,At,!1)}function Ct(k,H,le,de){k.push(H),k.push(le),k.push(de)}function gt(k,H,le,de,at,At){var Ft=(At-H)/(de-H);return k.push(At),k.push(le+(at-le)*Ft),k.push(1),Ft}function we(k,H,le,de,at,At){var Ft=(At-le)/(at-le);return k.push(H+(de-H)*Ft),k.push(At),k.push(1),Ft}function ht(k,H){for(var le=[],de=0;de<k.length;de++){var at,At=k[de],Ft=At.type;if(Ft==="Point"||Ft==="MultiPoint"||Ft==="LineString")at=Qe(At.geometry,H);else if(Ft==="MultiLineString"||Ft==="Polygon"){at=[];for(var He=0;He<At.geometry.length;He++)at.push(Qe(At.geometry[He],H))}else if(Ft==="MultiPolygon")for(at=[],He=0;He<At.geometry.length;He++){for(var Pt=[],or=0;or<At.geometry[He].length;or++)Pt.push(Qe(At.geometry[He][or],H));at.push(Pt)}le.push(Ge(At.id,Ft,at,At.tags))}return le}function Qe(k,H){var le=[];le.size=k.size,k.start!==void 0&&(le.start=k.start,le.end=k.end);for(var de=0;de<k.length;de+=3)le.push(k[de]+H,k[de+1],k[de+2]);return le}function Vt(k,H){if(k.transformed)return k;var le,de,at,At=1<<k.z,Ft=k.x,He=k.y;for(le=0;le<k.features.length;le++){var Pt=k.features[le],or=Pt.geometry,jr=Pt.type;if(Pt.geometry=[],jr===1)for(de=0;de<or.length;de+=2)Pt.geometry.push(pr(or[de],or[de+1],H,At,Ft,He));else for(de=0;de<or.length;de++){var Hr=[];for(at=0;at<or[de].length;at+=2)Hr.push(pr(or[de][at],or[de][at+1],H,At,Ft,He));Pt.geometry.push(Hr)}}return k.transformed=!0,k}function pr(k,H,le,de,at,At){return[Math.round(le*(k*de-at)),Math.round(le*(H*de-At))]}function Zr(k,H,le,de,at){for(var At=H===at.maxZoom?0:at.tolerance/((1<<H)*at.extent),Ft={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:de,z:H,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},He=0;He<k.length;He++){Ft.numFeatures++,cr(Ft,k[He],At,at);var Pt=k[He].minX,or=k[He].minY,jr=k[He].maxX,Hr=k[He].maxY;Pt<Ft.minX&&(Ft.minX=Pt),or<Ft.minY&&(Ft.minY=or),jr>Ft.maxX&&(Ft.maxX=jr),Hr>Ft.maxY&&(Ft.maxY=Hr)}return Ft}function cr(k,H,le,de){var at=H.geometry,At=H.type,Ft=[];if(At==="Point"||At==="MultiPoint")for(var He=0;He<at.length;He+=3)Ft.push(at[He]),Ft.push(at[He+1]),k.numPoints++,k.numSimplified++;else if(At==="LineString")jn(Ft,at,k,le,!1,!1);else if(At==="MultiLineString"||At==="Polygon")for(He=0;He<at.length;He++)jn(Ft,at[He],k,le,At==="Polygon",He===0);else if(At==="MultiPolygon")for(var Pt=0;Pt<at.length;Pt++){var or=at[Pt];for(He=0;He<or.length;He++)jn(Ft,or[He],k,le,!0,He===0)}if(Ft.length){var jr=H.tags||null;if(At==="LineString"&&de.lineMetrics){for(var Hr in jr={},H.tags)jr[Hr]=H.tags[Hr];jr.mapbox_clip_start=at.start/at.size,jr.mapbox_clip_end=at.end/at.size}var sr={geometry:Ft,type:At==="Polygon"||At==="MultiPolygon"?3:At==="LineString"||At==="MultiLineString"?2:1,tags:jr};H.id!==null&&(sr.id=H.id),k.features.push(sr)}}function jn(k,H,le,de,at,At){var Ft=de*de;if(de>0&&H.size<(at?Ft:de))le.numPoints+=H.length/3;else{for(var He=[],Pt=0;Pt<H.length;Pt+=3)(de===0||H[Pt+2]>Ft)&&(le.numSimplified++,He.push(H[Pt]),He.push(H[Pt+1])),le.numPoints++;at&&function(or,jr){for(var Hr=0,sr=0,Fr=or.length,_n=Fr-2;sr<Fr;_n=sr,sr+=2)Hr+=(or[sr]-or[_n])*(or[sr+1]+or[_n+1]);if(Hr>0===jr)for(sr=0,Fr=or.length;sr<Fr/2;sr+=2){var dn=or[sr],Er=or[sr+1];or[sr]=or[Fr-2-sr],or[sr+1]=or[Fr-1-sr],or[Fr-2-sr]=dn,or[Fr-1-sr]=Er}}(He,At),k.push(He)}}function Sn(k,H){var le=(H=this.options=function(at,At){for(var Ft in At)at[Ft]=At[Ft];return at}(Object.create(this.options),H)).debug;if(le&&console.time("preprocess data"),H.maxZoom<0||H.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(H.promoteId&&H.generateId)throw new Error("promoteId and generateId cannot be used together.");var de=function(at,At){var Ft=[];if(at.type==="FeatureCollection")for(var He=0;He<at.features.length;He++)yt(Ft,at.features[He],At,He);else yt(Ft,at.type==="Feature"?at:{geometry:at},At);return Ft}(k,H);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",H.indexMaxZoom,H.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(de=function(at,At){var Ft=At.buffer/At.extent,He=at,Pt=et(at,1,-1-Ft,Ft,0,-1,2,At),or=et(at,1,1-Ft,2+Ft,0,-1,2,At);return(Pt||or)&&(He=et(at,1,-Ft,1+Ft,0,-1,2,At)||[],Pt&&(He=ht(Pt,1).concat(He)),or&&(He=He.concat(ht(or,-1)))),He}(de,H)).length&&this.splitTile(de,0,0,0),le&&(de.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ai(k,H,le){return 32*((1<<k)*le+H)+k}function fi(k,H){var le=k.tileID.canonical;if(!this._geoJSONIndex)return H(null,null);var de=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!de)return H(null,null);var at=new $e(de.features),At=ze(at);At.byteOffset===0&&At.byteLength===At.buffer.byteLength||(At=new Uint8Array(At)),H(null,{vectorTile:at,rawData:At.buffer})}_t.prototype.load=function(k){var H=this.options,le=H.log,de=H.minZoom,at=H.maxZoom,At=H.nodeSize;le&&console.time("total time");var Ft="prepare "+k.length+" points";le&&console.time(Ft),this.points=k;for(var He=[],Pt=0;Pt<k.length;Pt++)k[Pt].geometry&&He.push(ye(k[Pt],Pt));this.trees[at+1]=new rt(He,R,q,At,Float32Array),le&&console.timeEnd(Ft);for(var or=at;or>=de;or--){var jr=+Date.now();He=this._cluster(He,or),this.trees[or]=new rt(He,R,q,At,Float32Array),le&&console.log("z%d: %d clusters in %dms",or,He.length,+Date.now()-jr)}return le&&console.timeEnd("total time"),this},_t.prototype.getClusters=function(k,H){var le=((k[0]+180)%360+360)%360-180,de=Math.max(-90,Math.min(90,k[1])),at=k[2]===180?180:((k[2]+180)%360+360)%360-180,At=Math.max(-90,Math.min(90,k[3]));if(k[2]-k[0]>=360)le=-180,at=180;else if(le>at){var Ft=this.getClusters([le,de,180,At],H),He=this.getClusters([-180,de,at,At],H);return Ft.concat(He)}for(var Pt=this.trees[this._limitZoom(H)],or=[],jr=0,Hr=Pt.range(Ie(le),pt(At),Ie(at),pt(de));jr<Hr.length;jr+=1){var sr=Pt.points[Hr[jr]];or.push(sr.numPoints?Ve(sr):this.points[sr.index])}return or},_t.prototype.getChildren=function(k){var H=this._getOriginId(k),le=this._getOriginZoom(k),de="No cluster with the specified id.",at=this.trees[le];if(!at)throw new Error(de);var At=at.points[H];if(!At)throw new Error(de);for(var Ft=this.options.radius/(this.options.extent*Math.pow(2,le-1)),He=[],Pt=0,or=at.within(At.x,At.y,Ft);Pt<or.length;Pt+=1){var jr=at.points[or[Pt]];jr.parentId===k&&He.push(jr.numPoints?Ve(jr):this.points[jr.index])}if(He.length===0)throw new Error(de);return He},_t.prototype.getLeaves=function(k,H,le){var de=[];return this._appendLeaves(de,k,H=H||10,le=le||0,0),de},_t.prototype.getTile=function(k,H,le){var de=this.trees[this._limitZoom(k)],at=Math.pow(2,k),At=this.options,Ft=At.radius/At.extent,He=(le-Ft)/at,Pt=(le+1+Ft)/at,or={features:[]};return this._addTileFeatures(de.range((H-Ft)/at,He,(H+1+Ft)/at,Pt),de.points,H,le,at,or),H===0&&this._addTileFeatures(de.range(1-Ft/at,He,1,Pt),de.points,at,le,at,or),H===at-1&&this._addTileFeatures(de.range(0,He,Ft/at,Pt),de.points,-1,le,at,or),or.features.length?or:null},_t.prototype.getClusterExpansionZoom=function(k){for(var H=this._getOriginZoom(k)-1;H<=this.options.maxZoom;){var le=this.getChildren(k);if(H++,le.length!==1)break;k=le[0].properties.cluster_id}return H},_t.prototype._appendLeaves=function(k,H,le,de,at){for(var At=0,Ft=this.getChildren(H);At<Ft.length;At+=1){var He=Ft[At],Pt=He.properties;if(Pt&&Pt.cluster?at+Pt.point_count<=de?at+=Pt.point_count:at=this._appendLeaves(k,Pt.cluster_id,le,de,at):at<de?at++:k.push(He),k.length===le)break}return at},_t.prototype._addTileFeatures=function(k,H,le,de,at,At){for(var Ft=0,He=k;Ft<He.length;Ft+=1){var Pt=H[He[Ft]],or=Pt.numPoints,jr={type:1,geometry:[[Math.round(this.options.extent*(Pt.x*at-le)),Math.round(this.options.extent*(Pt.y*at-de))]],tags:or?ft(Pt):this.points[Pt.index].properties},Hr=void 0;or?Hr=Pt.id:this.options.generateId?Hr=Pt.index:this.points[Pt.index].id&&(Hr=this.points[Pt.index].id),Hr!==void 0&&(jr.id=Hr),At.features.push(jr)}},_t.prototype._limitZoom=function(k){return Math.max(this.options.minZoom,Math.min(+k,this.options.maxZoom+1))},_t.prototype._cluster=function(k,H){for(var le=[],de=this.options,at=de.reduce,At=de.minPoints,Ft=de.radius/(de.extent*Math.pow(2,H)),He=0;He<k.length;He++){var Pt=k[He];if(!(Pt.zoom<=H)){Pt.zoom=H;for(var or=this.trees[H+1],jr=or.within(Pt.x,Pt.y,Ft),Hr=Pt.numPoints||1,sr=Hr,Fr=0,_n=jr;Fr<_n.length;Fr+=1){var dn=or.points[_n[Fr]];dn.zoom>H&&(sr+=dn.numPoints||1)}if(sr>=At){for(var Er=Pt.x*Hr,Tn=Pt.y*Hr,vn=at&&Hr>1?this._map(Pt,!0):null,gn=(He<<5)+(H+1)+this.points.length,Ar=0,$r=jr;Ar<$r.length;Ar+=1){var Mn=or.points[$r[Ar]];if(!(Mn.zoom<=H)){Mn.zoom=H;var Xi=Mn.numPoints||1;Er+=Mn.x*Xi,Tn+=Mn.y*Xi,Mn.parentId=gn,at&&(vn||(vn=this._map(Pt,!0)),at(vn,this._map(Mn)))}}Pt.parentId=gn,le.push(ge(Er/sr,Tn/sr,gn,sr,vn))}else if(le.push(Pt),sr>1)for(var vi=0,wi=jr;vi<wi.length;vi+=1){var Di=or.points[wi[vi]];Di.zoom<=H||(Di.zoom=H,le.push(Di))}}}return le},_t.prototype._getOriginId=function(k){return k-this.points.length>>5},_t.prototype._getOriginZoom=function(k){return(k-this.points.length)%32},_t.prototype._map=function(k,H){if(k.numPoints)return H?C({},k.properties):k.properties;var le=this.points[k.index].properties,de=this.options.map(le);return H&&de===le?C({},de):de},Sn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Sn.prototype.splitTile=function(k,H,le,de,at,At,Ft){for(var He=[k,H,le,de],Pt=this.options,or=Pt.debug;He.length;){de=He.pop(),le=He.pop(),H=He.pop(),k=He.pop();var jr=1<<H,Hr=ai(H,le,de),sr=this.tiles[Hr];if(!sr&&(or>1&&console.time("creation"),sr=this.tiles[Hr]=Zr(k,H,le,de,Pt),this.tileCoords.push({z:H,x:le,y:de}),or)){or>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",H,le,de,sr.numFeatures,sr.numPoints,sr.numSimplified),console.timeEnd("creation"));var Fr="z"+H;this.stats[Fr]=(this.stats[Fr]||0)+1,this.total++}if(sr.source=k,at){if(H===Pt.maxZoom||H===at)continue;var _n=1<<at-H;if(le!==Math.floor(At/_n)||de!==Math.floor(Ft/_n))continue}else if(H===Pt.indexMaxZoom||sr.numPoints<=Pt.indexMaxPoints)continue;if(sr.source=null,k.length!==0){or>1&&console.time("clipping");var dn,Er,Tn,vn,gn,Ar,$r=.5*Pt.buffer/Pt.extent,Mn=.5-$r,Xi=.5+$r,vi=1+$r;dn=Er=Tn=vn=null,gn=et(k,jr,le-$r,le+Xi,0,sr.minX,sr.maxX,Pt),Ar=et(k,jr,le+Mn,le+vi,0,sr.minX,sr.maxX,Pt),k=null,gn&&(dn=et(gn,jr,de-$r,de+Xi,1,sr.minY,sr.maxY,Pt),Er=et(gn,jr,de+Mn,de+vi,1,sr.minY,sr.maxY,Pt),gn=null),Ar&&(Tn=et(Ar,jr,de-$r,de+Xi,1,sr.minY,sr.maxY,Pt),vn=et(Ar,jr,de+Mn,de+vi,1,sr.minY,sr.maxY,Pt),Ar=null),or>1&&console.timeEnd("clipping"),He.push(dn||[],H+1,2*le,2*de),He.push(Er||[],H+1,2*le,2*de+1),He.push(Tn||[],H+1,2*le+1,2*de),He.push(vn||[],H+1,2*le+1,2*de+1)}}},Sn.prototype.getTile=function(k,H,le){var de=this.options,at=de.extent,At=de.debug;if(k<0||k>24)return null;var Ft=1<<k,He=ai(k,H=(H%Ft+Ft)%Ft,le);if(this.tiles[He])return Vt(this.tiles[He],at);At>1&&console.log("drilling down to z%d-%d-%d",k,H,le);for(var Pt,or=k,jr=H,Hr=le;!Pt&&or>0;)or--,jr=Math.floor(jr/2),Hr=Math.floor(Hr/2),Pt=this.tiles[ai(or,jr,Hr)];return Pt&&Pt.source?(At>1&&console.log("found parent tile z%d-%d-%d",or,jr,Hr),At>1&&console.time("drilling down"),this.splitTile(Pt.source,or,jr,Hr,k,H,le),At>1&&console.timeEnd("drilling down"),this.tiles[He]?Vt(this.tiles[He],at):null):null};var Zn=function(k){function H(le,de,at,At){k.call(this,le,de,at,fi),At&&(this.loadGeoJSON=At)}return k&&(H.__proto__=k),(H.prototype=Object.create(k&&k.prototype)).constructor=H,H.prototype.loadData=function(le,de){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=de,this._pendingLoadDataParams=le,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},H.prototype._loadData=function(){var le=this;if(this._pendingCallback&&this._pendingLoadDataParams){var de=this._pendingCallback,at=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var At=!!(at&&at.request&&at.request.collectResourceTiming)&&new a.RequestPerformance(at.request);this.loadGeoJSON(at,function(Ft,He){if(Ft||!He)return de(Ft);if(typeof He!="object")return de(new Error("Input data given to '"+at.source+"' is not a valid GeoJSON object."));(function sr(Fr,_n){var dn,Er=Fr&&Fr.type;if(Er==="FeatureCollection")for(dn=0;dn<Fr.features.length;dn++)sr(Fr.features[dn],_n);else if(Er==="GeometryCollection")for(dn=0;dn<Fr.geometries.length;dn++)sr(Fr.geometries[dn],_n);else if(Er==="Feature")sr(Fr.geometry,_n);else if(Er==="Polygon")st(Fr.coordinates,_n);else if(Er==="MultiPolygon")for(dn=0;dn<Fr.coordinates.length;dn++)st(Fr.coordinates[dn],_n);return Fr})(He,!0);try{if(at.filter){var Pt=a.createExpression(at.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Pt.result==="error")throw new Error(Pt.value.map(function(sr){return sr.key+": "+sr.message}).join(", "));var or=He.features.filter(function(sr){return Pt.value.evaluate({zoom:0},sr)});He={type:"FeatureCollection",features:or}}le._geoJSONIndex=at.cluster?new _t(function(sr){var Fr=sr.superclusterOptions,_n=sr.clusterProperties;if(!_n||!Fr)return Fr;for(var dn={},Er={},Tn={accumulated:null,zoom:0},vn={properties:null},gn=Object.keys(_n),Ar=0,$r=gn;Ar<$r.length;Ar+=1){var Mn=$r[Ar],Xi=_n[Mn],vi=Xi[0],wi=a.createExpression(Xi[1]),Di=a.createExpression(typeof vi=="string"?[vi,["accumulated"],["get",Mn]]:vi);dn[Mn]=wi.value,Er[Mn]=Di.value}return Fr.map=function(Ka){vn.properties=Ka;for(var hi={},ga=0,Pi=gn;ga<Pi.length;ga+=1){var gi=Pi[ga];hi[gi]=dn[gi].evaluate(Tn,vn)}return hi},Fr.reduce=function(Ka,hi){vn.properties=hi;for(var ga=0,Pi=gn;ga<Pi.length;ga+=1){var gi=Pi[ga];Tn.accumulated=Ka[gi],Ka[gi]=Er[gi].evaluate(Tn,vn)}},Fr}(at)).load(He.features):function(sr,Fr){return new Sn(sr,Fr)}(He,at.geojsonVtOptions)}catch(sr){return de(sr)}le.loaded={};var jr={};if(At){var Hr=At.finish();Hr&&(jr.resourceTiming={},jr.resourceTiming[at.source]=JSON.parse(JSON.stringify(Hr)))}de(null,jr)})}},H.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},H.prototype.reloadTile=function(le,de){var at=this.loaded;return at&&at[le.uid]?k.prototype.reloadTile.call(this,le,de):this.loadTile(le,de)},H.prototype.loadGeoJSON=function(le,de){if(le.request)a.getJSON(le.request,de);else{if(typeof le.data!="string")return de(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."));try{return de(null,JSON.parse(le.data))}catch(at){return de(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."))}}},H.prototype.removeSource=function(le,de){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),de()},H.prototype.getClusterExpansionZoom=function(le,de){try{de(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(at){de(at)}},H.prototype.getClusterChildren=function(le,de){try{de(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(at){de(at)}},H.prototype.getClusterLeaves=function(le,de){try{de(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(at){de(at)}},H}(Ke),Hn=function(H){var le=this;this.self=H,this.actor=new a.Actor(H,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Ke,geojson:Zn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(de,at){if(le.workerSourceTypes[de])throw new Error('Worker source with name "'+de+'" already registered.');le.workerSourceTypes[de]=at},this.self.registerRTLTextPlugin=function(de){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=de.applyArabicShaping,a.plugin.processBidirectionalText=de.processBidirectionalText,a.plugin.processStyledBidirectionalText=de.processStyledBidirectionalText}};return Hn.prototype.setReferrer=function(k,H){this.referrer=H},Hn.prototype.setImages=function(k,H,le){for(var de in this.availableImages[k]=H,this.workerSources[k]){var at=this.workerSources[k][de];for(var At in at)at[At].availableImages=H}le()},Hn.prototype.setLayers=function(k,H,le){this.getLayerIndex(k).replace(H),le()},Hn.prototype.updateLayers=function(k,H,le){this.getLayerIndex(k).update(H.layers,H.removedIds),le()},Hn.prototype.loadTile=function(k,H,le){this.getWorkerSource(k,H.type,H.source).loadTile(H,le)},Hn.prototype.loadDEMTile=function(k,H,le){this.getDEMWorkerSource(k,H.source).loadTile(H,le)},Hn.prototype.reloadTile=function(k,H,le){this.getWorkerSource(k,H.type,H.source).reloadTile(H,le)},Hn.prototype.abortTile=function(k,H,le){this.getWorkerSource(k,H.type,H.source).abortTile(H,le)},Hn.prototype.removeTile=function(k,H,le){this.getWorkerSource(k,H.type,H.source).removeTile(H,le)},Hn.prototype.removeDEMTile=function(k,H){this.getDEMWorkerSource(k,H.source).removeTile(H)},Hn.prototype.removeSource=function(k,H,le){if(this.workerSources[k]&&this.workerSources[k][H.type]&&this.workerSources[k][H.type][H.source]){var de=this.workerSources[k][H.type][H.source];delete this.workerSources[k][H.type][H.source],de.removeSource!==void 0?de.removeSource(H,le):le()}},Hn.prototype.loadWorkerSource=function(k,H,le){try{this.self.importScripts(H.url),le()}catch(de){le(de.toString())}},Hn.prototype.syncRTLPluginState=function(k,H,le){try{a.plugin.setState(H);var de=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&de!=null){this.self.importScripts(de);var at=a.plugin.isParsed();le(at?void 0:new Error("RTL Text Plugin failed to import scripts from "+de),at)}}catch(At){le(At.toString())}},Hn.prototype.getAvailableImages=function(k){var H=this.availableImages[k];return H||(H=[]),H},Hn.prototype.getLayerIndex=function(k){var H=this.layerIndexes[k];return H||(H=this.layerIndexes[k]=new J),H},Hn.prototype.getWorkerSource=function(k,H,le){var de=this;return this.workerSources[k]||(this.workerSources[k]={}),this.workerSources[k][H]||(this.workerSources[k][H]={}),this.workerSources[k][H][le]||(this.workerSources[k][H][le]=new this.workerSourceTypes[H]({send:function(At,Ft,He){de.actor.send(At,Ft,He,k)}},this.getLayerIndex(k),this.getAvailableImages(k))),this.workerSources[k][H][le]},Hn.prototype.getDEMWorkerSource=function(k,H){return this.demWorkerSources[k]||(this.demWorkerSources[k]={}),this.demWorkerSources[k][H]||(this.demWorkerSources[k][H]=new Oe),this.demWorkerSources[k][H]},Hn.prototype.enforceCacheSizeLimit=function(k,H){a.enforceCacheSizeLimit(H)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Hn(self)),Hn}),B(["./shared"],function(a){"use strict";var W=a.createCommonjsModule(function(u){function i(x){return!n(x)}function n(x){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var O,F,ue=new Blob([""],{type:"text/javascript"}),Ee=URL.createObjectURL(ue);try{F=new Worker(Ee),O=!0}catch(Xe){O=!1}return F&&F.terminate(),URL.revokeObjectURL(Ee),O}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var O=document.createElement("canvas");O.width=O.height=1;var F=O.getContext("2d");if(!F)return!1;var ue=F.getImageData(0,0,1,1);return ue&&ue.width===O.width}()?(c[P=x&&x.failIfMajorPerformanceCaveat]===void 0&&(c[P]=function(O){var F=function(Ee){var Xe=document.createElement("canvas"),qe=Object.create(i.webGLContextAttributes);return qe.failIfMajorPerformanceCaveat=Ee,Xe.probablySupportsContext?Xe.probablySupportsContext("webgl",qe)||Xe.probablySupportsContext("experimental-webgl",qe):Xe.supportsContext?Xe.supportsContext("webgl",qe)||Xe.supportsContext("experimental-webgl",qe):Xe.getContext("webgl",qe)||Xe.getContext("experimental-webgl",qe)}(O);if(!F)return!1;var ue=F.createShader(F.VERTEX_SHADER);return!(!ue||F.isContextLost())&&(F.shaderSource(ue,"void main() {}"),F.compileShader(ue),F.getShaderParameter(ue,F.COMPILE_STATUS)===!0)}(P)),c[P]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var P}u.exports?u.exports=i:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=i,window.mapboxgl.notSupportedReason=n);var c={};i.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),D={create:function(i,n,c){var x=a.window.document.createElement(i);return n!==void 0&&(x.className=n),c&&c.appendChild(x),x},createNS:function(i,n){return a.window.document.createElementNS(i,n)}},J=a.window.document&&a.window.document.documentElement.style;function te(u){if(!J)return u[0];for(var i=0;i<u.length;i++)if(u[i]in J)return u[i];return u[0]}var ce,Y=te(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);D.disableDrag=function(){J&&Y&&(ce=J[Y],J[Y]="none")},D.enableDrag=function(){J&&Y&&(J[Y]=ce)};var ke=te(["transform","WebkitTransform"]);D.setTransform=function(u,i){u.style[ke]=i};var Ke=!1;try{var We=Object.defineProperty({},"passive",{get:function(){Ke=!0}});a.window.addEventListener("test",We,We),a.window.removeEventListener("test",We,We)}catch(u){Ke=!1}D.addEventListener=function(u,i,n,c){c===void 0&&(c={}),u.addEventListener(i,n,"passive"in c&&Ke?c:c.capture)},D.removeEventListener=function(u,i,n,c){c===void 0&&(c={}),u.removeEventListener(i,n,"passive"in c&&Ke?c:c.capture)};var Oe=function u(i){i.preventDefault(),i.stopPropagation(),a.window.removeEventListener("click",u,!0)};function st(u){var i=u.userImage;return!!(i&&i.render&&i.render())&&(u.data.replace(new Uint8Array(i.data.buffer)),!0)}D.suppressClick=function(){a.window.addEventListener("click",Oe,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",Oe,!0)},0)},D.mousePos=function(u,i){var n=u.getBoundingClientRect();return new a.Point(i.clientX-n.left-u.clientLeft,i.clientY-n.top-u.clientTop)},D.touchPos=function(u,i){for(var n=u.getBoundingClientRect(),c=[],x=0;x<i.length;x++)c.push(new a.Point(i[x].clientX-n.left-u.clientLeft,i[x].clientY-n.top-u.clientTop));return c},D.mouseButton=function(u){return a.window.InstallTrigger!==void 0&&u.button===2&&u.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:u.button},D.remove=function(u){u.parentNode&&u.parentNode.removeChild(u)};var Le=function(u){function i(){u.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.isLoaded=function(){return this.loaded},i.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var c=0,x=this.requestors;c<x.length;c+=1){var P=x[c];this._notify(P.ids,P.callback)}this.requestors=[]}},i.prototype.getImage=function(n){return this.images[n]},i.prototype.addImage=function(n,c){this._validate(n,c)&&(this.images[n]=c)},i.prototype._validate=function(n,c){var x=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchX" value'))),x=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchY" value'))),x=!1),this._validateContent(c.content,c)||(this.fire(new a.ErrorEvent(new Error('Image "'+n+'" has invalid "content" value'))),x=!1),x},i.prototype._validateStretch=function(n,c){if(!n)return!0;for(var x=0,P=0,O=n;P<O.length;P+=1){var F=O[P];if(F[0]<x||F[1]<F[0]||c<F[1])return!1;x=F[1]}return!0},i.prototype._validateContent=function(n,c){return!(n&&(n.length!==4||n[0]<0||c.data.width<n[0]||n[1]<0||c.data.height<n[1]||n[2]<0||c.data.width<n[2]||n[3]<0||c.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))},i.prototype.updateImage=function(n,c){c.version=this.images[n].version+1,this.images[n]=c,this.updatedImages[n]=!0},i.prototype.removeImage=function(n){var c=this.images[n];delete this.images[n],delete this.patterns[n],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()},i.prototype.listImages=function(){return Object.keys(this.images)},i.prototype.getImages=function(n,c){var x=!0;if(!this.isLoaded())for(var P=0,O=n;P<O.length;P+=1)this.images[O[P]]||(x=!1);this.isLoaded()||x?this._notify(n,c):this.requestors.push({ids:n,callback:c})},i.prototype._notify=function(n,c){for(var x={},P=0,O=n;P<O.length;P+=1){var F=O[P];this.images[F]||this.fire(new a.Event("styleimagemissing",{id:F}));var ue=this.images[F];ue?x[F]={data:ue.data.clone(),pixelRatio:ue.pixelRatio,sdf:ue.sdf,version:ue.version,stretchX:ue.stretchX,stretchY:ue.stretchY,content:ue.content,hasRenderCallback:Boolean(ue.userImage&&ue.userImage.render)}:a.warnOnce('Image "'+F+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}c(null,x)},i.prototype.getPixelSize=function(){var n=this.atlasImage;return{width:n.width,height:n.height}},i.prototype.getPattern=function(n){var c=this.patterns[n],x=this.getImage(n);if(!x)return null;if(c&&c.position.version===x.version)return c.position;if(c)c.position.version=x.version;else{var P={w:x.data.width+2,h:x.data.height+2,x:0,y:0},O=new a.ImagePosition(P,x);this.patterns[n]={bin:P,position:O}}return this._updatePatternAtlas(),this.patterns[n].position},i.prototype.bind=function(n){var c=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(n,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)},i.prototype._updatePatternAtlas=function(){var n=[];for(var c in this.patterns)n.push(this.patterns[c].bin);var x=a.potpack(n),P=x.w,O=x.h,F=this.atlasImage;for(var ue in F.resize({width:P||1,height:O||1}),this.patterns){var Ee=this.patterns[ue].bin,Xe=Ee.x+1,qe=Ee.y+1,tt=this.images[ue].data,zt=tt.width,Lt=tt.height;a.RGBAImage.copy(tt,F,{x:0,y:0},{x:Xe,y:qe},{width:zt,height:Lt}),a.RGBAImage.copy(tt,F,{x:0,y:Lt-1},{x:Xe,y:qe-1},{width:zt,height:1}),a.RGBAImage.copy(tt,F,{x:0,y:0},{x:Xe,y:qe+Lt},{width:zt,height:1}),a.RGBAImage.copy(tt,F,{x:zt-1,y:0},{x:Xe-1,y:qe},{width:1,height:Lt}),a.RGBAImage.copy(tt,F,{x:0,y:0},{x:Xe+zt,y:qe},{width:1,height:Lt})}this.dirty=!0},i.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},i.prototype.dispatchRenderCallbacks=function(n){for(var c=0,x=n;c<x.length;c+=1){var P=x[c];if(!this.callbackDispatchedThisFrame[P]){this.callbackDispatchedThisFrame[P]=!0;var O=this.images[P];st(O)&&this.updateImage(P,O)}}},i}(a.Evented),xt=Ze,it=Ze,$e=1e20;function Ze(u,i,n,c,x,P){this.fontSize=u||24,this.buffer=i===void 0?3:i,this.cutoff=c||.25,this.fontFamily=x||"sans-serif",this.fontWeight=P||"normal",this.radius=n||8;var O=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=O,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(O*O),this.gridInner=new Float64Array(O*O),this.f=new Float64Array(O),this.d=new Float64Array(O),this.z=new Float64Array(O+1),this.v=new Int16Array(O),this.middle=Math.round(O/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function St(u,i,n,c,x,P,O){for(var F=0;F<i;F++){for(var ue=0;ue<n;ue++)c[ue]=u[ue*i+F];for(bt(c,x,P,O,n),ue=0;ue<n;ue++)u[ue*i+F]=x[ue]}for(ue=0;ue<n;ue++){for(F=0;F<i;F++)c[F]=u[ue*i+F];for(bt(c,x,P,O,i),F=0;F<i;F++)u[ue*i+F]=Math.sqrt(x[F])}}function bt(u,i,n,c,x){n[0]=0,c[0]=-$e,c[1]=+$e;for(var P=1,O=0;P<x;P++){for(var F=(u[P]+P*P-(u[n[O]]+n[O]*n[O]))/(2*P-2*n[O]);F<=c[O];)O--,F=(u[P]+P*P-(u[n[O]]+n[O]*n[O]))/(2*P-2*n[O]);n[++O]=P,c[O]=F,c[O+1]=+$e}for(P=0,O=0;P<x;P++){for(;c[O+1]<P;)O++;i[P]=(P-n[O])*(P-n[O])+u[n[O]]}}Ze.prototype.draw=function(u){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(u,this.buffer,this.middle);for(var i=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),c=0;c<this.size*this.size;c++){var x=i.data[4*c+3]/255;this.gridOuter[c]=x===1?0:x===0?$e:Math.pow(Math.max(0,.5-x),2),this.gridInner[c]=x===1?$e:x===0?0:Math.pow(Math.max(0,x-.5),2)}for(St(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),St(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),c=0;c<this.size*this.size;c++)n[c]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[c]-this.gridInner[c])/this.radius+this.cutoff))));return n},xt.default=it;var Ne=function(i,n){this.requestManager=i,this.localIdeographFontFamily=n,this.entries={}};Ne.prototype.setURL=function(u){this.url=u},Ne.prototype.getGlyphs=function(u,i){var n=this,c=[];for(var x in u)for(var P=0,O=u[x];P<O.length;P+=1)c.push({stack:x,id:O[P]});a.asyncAll(c,function(F,ue){var Ee=F.stack,Xe=F.id,qe=n.entries[Ee];qe||(qe=n.entries[Ee]={glyphs:{},requests:{},ranges:{}});var tt=qe.glyphs[Xe];if(tt===void 0){if(tt=n._tinySDF(qe,Ee,Xe))return qe.glyphs[Xe]=tt,void ue(null,{stack:Ee,id:Xe,glyph:tt});var zt=Math.floor(Xe/256);if(256*zt>65535)ue(new Error("glyphs > 65535 not supported"));else if(qe.ranges[zt])ue(null,{stack:Ee,id:Xe,glyph:tt});else{var Lt=qe.requests[zt];Lt||(Lt=qe.requests[zt]=[],Ne.loadGlyphRange(Ee,zt,n.url,n.requestManager,function(Xt,Dt){if(Dt){for(var Ut in Dt)n._doesCharSupportLocalGlyph(+Ut)||(qe.glyphs[+Ut]=Dt[+Ut]);qe.ranges[zt]=!0}for(var er=0,qt=Lt;er<qt.length;er+=1)(0,qt[er])(Xt,Dt);delete qe.requests[zt]})),Lt.push(function(Xt,Dt){Xt?ue(Xt):Dt&&ue(null,{stack:Ee,id:Xe,glyph:Dt[Xe]||null})})}}else ue(null,{stack:Ee,id:Xe,glyph:tt})},function(F,ue){if(F)i(F);else if(ue){for(var Ee={},Xe=0,qe=ue;Xe<qe.length;Xe+=1){var tt=qe[Xe],zt=tt.stack,Lt=tt.id,Xt=tt.glyph;(Ee[zt]||(Ee[zt]={}))[Lt]=Xt&&{id:Xt.id,bitmap:Xt.bitmap.clone(),metrics:Xt.metrics}}i(null,Ee)}})},Ne.prototype._doesCharSupportLocalGlyph=function(u){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](u)||a.isChar["Hangul Syllables"](u)||a.isChar.Hiragana(u)||a.isChar.Katakana(u))},Ne.prototype._tinySDF=function(u,i,n){var c=this.localIdeographFontFamily;if(c&&this._doesCharSupportLocalGlyph(n)){var x=u.tinySDF;if(!x){var P="400";/bold/i.test(i)?P="900":/medium/i.test(i)?P="500":/light/i.test(i)&&(P="200"),x=u.tinySDF=new Ne.TinySDF(24,3,8,.25,c,P)}return{id:n,bitmap:new a.AlphaImage({width:30,height:30},x.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ne.loadGlyphRange=function(u,i,n,c,x){var P=256*i,O=P+255,F=c.transformRequest(c.normalizeGlyphsURL(n).replace("{fontstack}",u).replace("{range}",P+"-"+O),a.ResourceType.Glyphs);a.getArrayBuffer(F,function(ue,Ee){if(ue)x(ue);else if(Ee){for(var Xe={},qe=0,tt=a.parseGlyphPBF(Ee);qe<tt.length;qe+=1){var zt=tt[qe];Xe[zt.id]=zt}x(null,Xe)}})},Ne.TinySDF=xt;var ze=function(){this.specification=a.styleSpec.light.position};ze.prototype.possiblyEvaluate=function(u,i){return a.sphericalToCartesian(u.expression.evaluate(i))},ze.prototype.interpolate=function(u,i,n){return{x:a.number(u.x,i.x,n),y:a.number(u.y,i.y,n),z:a.number(u.z,i.z,n)}};var Ue=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new ze,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),lt=function(u){function i(n){u.call(this),this._transitionable=new a.Transitionable(Ue),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getLight=function(){return this._transitionable.serialize()},i.prototype.setLight=function(n,c){if(c===void 0&&(c={}),!this._validate(a.validateLight,n,c))for(var x in n){var P=n[x];a.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-"-transition".length),P):this._transitionable.setValue(x,P)}},i.prototype.updateTransitions=function(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)},i.prototype.hasTransition=function(){return this._transitioning.hasTransition()},i.prototype.recalculate=function(n){this.properties=this._transitioning.possiblyEvaluate(n)},i.prototype._validate=function(n,c,x){return(!x||x.validate!==!1)&&a.emitValidationErrors(this,n.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},i}(a.Evented),Me=function(i,n){this.width=i,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Me.prototype.getDash=function(u,i){var n=u.join(",")+String(i);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(u,i)),this.dashEntry[n]},Me.prototype.getDashRanges=function(u,i,n){var c=[],x=u.length%2==1?-u[u.length-1]*n:0,P=u[0]*n,O=!0;c.push({left:x,right:P,isDash:O,zeroLength:u[0]===0});for(var F=u[0],ue=1;ue<u.length;ue++){var Ee=u[ue];c.push({left:x=F*n,right:P=(F+=Ee)*n,isDash:O=!O,zeroLength:Ee===0})}return c},Me.prototype.addRoundDash=function(u,i,n){for(var c=i/2,x=-n;x<=n;x++)for(var P=this.width*(this.nextRow+n+x),O=0,F=u[O],ue=0;ue<this.width;ue++){ue/F.right>1&&(F=u[++O]);var Ee=Math.abs(ue-F.left),Xe=Math.abs(ue-F.right),qe=Math.min(Ee,Xe),tt=void 0,zt=x/n*(c+1);if(F.isDash){var Lt=c-Math.abs(zt);tt=Math.sqrt(qe*qe+Lt*Lt)}else tt=c-Math.sqrt(qe*qe+zt*zt);this.data[P+ue]=Math.max(0,Math.min(255,tt+128))}},Me.prototype.addRegularDash=function(u){for(var i=u.length-1;i>=0;--i){var n=u[i],c=u[i+1];n.zeroLength?u.splice(i,1):c&&c.isDash===n.isDash&&(c.left=n.left,u.splice(i,1))}var x=u[0],P=u[u.length-1];x.isDash===P.isDash&&(x.left=P.left-this.width,P.right=x.right+this.width);for(var O=this.width*this.nextRow,F=0,ue=u[F],Ee=0;Ee<this.width;Ee++){Ee/ue.right>1&&(ue=u[++F]);var Xe=Math.abs(Ee-ue.left),qe=Math.abs(Ee-ue.right),tt=Math.min(Xe,qe);this.data[O+Ee]=Math.max(0,Math.min(255,(ue.isDash?tt:-tt)+128))}},Me.prototype.addDash=function(u,i){var n=i?7:0,c=2*n+1;if(this.nextRow+c>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var x=0,P=0;P<u.length;P++)x+=u[P];if(x!==0){var O=this.width/x,F=this.getDashRanges(u,this.width,O);i?this.addRoundDash(F,O,n):this.addRegularDash(F)}var ue={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:x};return this.nextRow+=c,this.dirty=!0,ue},Me.prototype.bind=function(u){var i=u.gl;this.texture?(i.bindTexture(i.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,i.texSubImage2D(i.TEXTURE_2D,0,0,0,this.width,this.height,i.ALPHA,i.UNSIGNED_BYTE,this.data))):(this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.ALPHA,this.width,this.height,0,i.ALPHA,i.UNSIGNED_BYTE,this.data))};var ct=function u(i,n){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var c=this.workerPool.acquire(this.id),x=0;x<c.length;x++){var P=new u.Actor(c[x],n,this.id);P.name="Worker "+x,this.actors.push(P)}};function Gt(u,i,n){var c=function(P,O){if(P)return n(P);if(O){var F=a.pick(a.extend(O,u),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);O.vector_layers&&(F.vectorLayers=O.vector_layers,F.vectorLayerIds=F.vectorLayers.map(function(ue){return ue.id})),F.tiles=i.canonicalizeTileset(F,u.url),n(null,F)}};return u.url?a.getJSON(i.transformRequest(i.normalizeSourceURL(u.url),a.ResourceType.Source),c):a.browser.frame(function(){return c(null,u)})}ct.prototype.broadcast=function(u,i,n){a.asyncAll(this.actors,function(c,x){c.send(u,i,x)},n=n||function(){})},ct.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},ct.prototype.remove=function(){this.actors.forEach(function(u){u.remove()}),this.actors=[],this.workerPool.release(this.id)},ct.Actor=a.Actor;var $t=function(i,n,c){this.bounds=a.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=n||0,this.maxzoom=c||24};$t.prototype.validateBounds=function(u){return Array.isArray(u)&&u.length===4?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]},$t.prototype.contains=function(u){var i=Math.pow(2,u.z),n=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*i),c=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*i),x=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*i),P=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*i);return u.x>=n&&u.x<x&&u.y>=c&&u.y<P};var ar=function(u){function i(n,c,x,P){if(u.call(this),this.id=n,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(c,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(P)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Gt(this._options,this.map._requestManager,function(c,x){n._tileJSONRequest=null,n._loaded=!0,c?n.fire(new a.ErrorEvent(c)):x&&(a.extend(n,x),x.bounds&&(n.tileBounds=new $t(x.bounds,n.minzoom,n.maxzoom)),a.postTurnstileEvent(x.tiles,n.map._requestManager._customAccessToken),a.postMapLoadEvent(x.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},i.prototype.loaded=function(){return this._loaded},i.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},i.prototype.onAdd=function(n){this.map=n,this.load()},i.prototype.setSourceProperty=function(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},i.prototype.setTiles=function(n){var c=this;return this.setSourceProperty(function(){c._options.tiles=n}),this},i.prototype.setUrl=function(n){var c=this;return this.setSourceProperty(function(){c.url=n,c._options.url=n}),this},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return a.extend({},this._options)},i.prototype.loadTile=function(n,c){var x=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),P={request:this.map._requestManager.transformRequest(x,a.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function O(F,ue){return delete n.request,n.aborted?c(null):F&&F.status!==404?c(F):(ue&&ue.resourceTiming&&(n.resourceTiming=ue.resourceTiming),this.map._refreshExpiredTiles&&ue&&n.setExpiryData(ue),n.loadVectorData(ue,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}P.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=c:n.request=n.actor.send("reloadTile",P,O.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",P,O.bind(this)))},i.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)},i.prototype.unloadTile=function(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)},i.prototype.hasTransition=function(){return!1},i}(a.Evented),oe=function(u){function i(n,c,x,P){u.call(this),this.id=n,this.dispatcher=x,this.setEventedParent(P),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},c),a.extend(this,a.pick(c,["url","scheme","tileSize"]))}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Gt(this._options,this.map._requestManager,function(c,x){n._tileJSONRequest=null,n._loaded=!0,c?n.fire(new a.ErrorEvent(c)):x&&(a.extend(n,x),x.bounds&&(n.tileBounds=new $t(x.bounds,n.minzoom,n.maxzoom)),a.postTurnstileEvent(x.tiles),a.postMapLoadEvent(x.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},i.prototype.loaded=function(){return this._loaded},i.prototype.onAdd=function(n){this.map=n,this.load()},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return a.extend({},this._options)},i.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},i.prototype.loadTile=function(n,c){var x=this,P=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=a.getImage(this.map._requestManager.transformRequest(P,a.ResourceType.Tile),function(O,F){if(delete n.request,n.aborted)n.state="unloaded",c(null);else if(O)n.state="errored",c(O);else if(F){x.map._refreshExpiredTiles&&n.setExpiryData(F),delete F.cacheControl,delete F.expires;var ue=x.map.painter.context,Ee=ue.gl;n.texture=x.map.painter.getTileTexture(F.width),n.texture?n.texture.update(F,{useMipmap:!0}):(n.texture=new a.Texture(ue,F,Ee.RGBA,{useMipmap:!0}),n.texture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE,Ee.LINEAR_MIPMAP_NEAREST),ue.extTextureFilterAnisotropic&&Ee.texParameterf(Ee.TEXTURE_2D,ue.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ue.extTextureFilterAnisotropicMax)),n.state="loaded",a.cacheEntryPossiblyAdded(x.dispatcher),c(null)}})},i.prototype.abortTile=function(n,c){n.request&&(n.request.cancel(),delete n.request),c()},i.prototype.unloadTile=function(n,c){n.texture&&this.map.painter.saveTileTexture(n.texture),c()},i.prototype.hasTransition=function(){return!1},i}(a.Evented),Q=function(u){function i(n,c,x,P){u.call(this,n,c,x,P),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},i.prototype.loadTile=function(n,c){var x=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function P(O,F){O&&(n.state="errored",c(O)),F&&(n.dem=F,n.needsHillshadePrepare=!0,n.state="loaded",c(null))}n.request=a.getImage(this.map._requestManager.transformRequest(x,a.ResourceType.Tile),function(O,F){if(delete n.request,n.aborted)n.state="unloaded",c(null);else if(O)n.state="errored",c(O);else if(F){this.map._refreshExpiredTiles&&n.setExpiryData(F),delete F.cacheControl,delete F.expires;var ue=a.window.ImageBitmap&&F instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?F:a.browser.getImageData(F,1),Ee={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:ue,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",Ee,P.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},i.prototype._getNeighboringTiles=function(n){var c=n.canonical,x=Math.pow(2,c.z),P=(c.x-1+x)%x,O=c.x===0?n.wrap-1:n.wrap,F=(c.x+1+x)%x,ue=c.x+1===x?n.wrap+1:n.wrap,Ee={};return Ee[new a.OverscaledTileID(n.overscaledZ,O,c.z,P,c.y).key]={backfilled:!1},Ee[new a.OverscaledTileID(n.overscaledZ,ue,c.z,F,c.y).key]={backfilled:!1},c.y>0&&(Ee[new a.OverscaledTileID(n.overscaledZ,O,c.z,P,c.y-1).key]={backfilled:!1},Ee[new a.OverscaledTileID(n.overscaledZ,n.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},Ee[new a.OverscaledTileID(n.overscaledZ,ue,c.z,F,c.y-1).key]={backfilled:!1}),c.y+1<x&&(Ee[new a.OverscaledTileID(n.overscaledZ,O,c.z,P,c.y+1).key]={backfilled:!1},Ee[new a.OverscaledTileID(n.overscaledZ,n.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},Ee[new a.OverscaledTileID(n.overscaledZ,ue,c.z,F,c.y+1).key]={backfilled:!1}),Ee},i.prototype.unloadTile=function(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})},i}(oe),G=function(u){function i(n,c,x,P){u.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=x.getActor(),this.setEventedParent(P),this._data=c.data,this._options=a.extend({},c),this._collectResourceTiming=c.collectResourceTiming,this._resourceTiming=[],c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;var O=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*O,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*O,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?Math.min(c.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:a.EXTENT,radius:(c.clusterRadius||50)*O,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.load=function(){var n=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(c){if(c)n.fire(new a.ErrorEvent(c));else{var x={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(x.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new a.Event("data",x))}})},i.prototype.onAdd=function(n){this.map=n,this.load()},i.prototype.setData=function(n){var c=this;return this._data=n,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(x){if(x)c.fire(new a.ErrorEvent(x));else{var P={dataType:"source",sourceDataType:"content"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(P.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new a.Event("data",P))}}),this},i.prototype.getClusterExpansionZoom=function(n,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},c),this},i.prototype.getClusterChildren=function(n,c){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},c),this},i.prototype.getClusterLeaves=function(n,c,x,P){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:c,offset:x},P),this},i.prototype._updateWorkerData=function(n){var c=this;this._loaded=!1;var x=a.extend({},this.workerOptions),P=this._data;typeof P=="string"?(x.request=this.map._requestManager.transformRequest(a.browser.resolveURL(P),a.ResourceType.Source),x.request.collectResourceTiming=this._collectResourceTiming):x.data=JSON.stringify(P),this.actor.send(this.type+".loadData",x,function(O,F){c._removed||F&&F.abandoned||(c._loaded=!0,F&&F.resourceTiming&&F.resourceTiming[c.id]&&(c._resourceTiming=F.resourceTiming[c.id].slice(0)),c.actor.send(c.type+".coalesce",{source:x.source},null),n(O))})},i.prototype.loaded=function(){return this._loaded},i.prototype.loadTile=function(n,c){var x=this,P=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(P,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(O,F){return delete n.request,n.unloadVectorData(),n.aborted?c(null):O?c(O):(n.loadVectorData(F,x.map.painter,P==="reloadTile"),c(null))})},i.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0},i.prototype.unloadTile=function(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})},i.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},i.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},i.prototype.hasTransition=function(){return!1},i}(a.Evented),Ce=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),be=function(u){function i(n,c,x,P){u.call(this),this.id=n,this.dispatcher=x,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(P),this.options=c}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.load=function(n,c){var x=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(P,O){x._loaded=!0,P?x.fire(new a.ErrorEvent(P)):O&&(x.image=O,n&&(x.coordinates=n),c&&c(),x._finishLoading())})},i.prototype.loaded=function(){return this._loaded},i.prototype.updateImage=function(n){var c=this;return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,function(){c.texture=null}),this):this},i.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},i.prototype.onAdd=function(n){this.map=n,this.load()},i.prototype.setCoordinates=function(n){var c=this;this.coordinates=n;var x=n.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(O){for(var F=1/0,ue=1/0,Ee=-1/0,Xe=-1/0,qe=0,tt=O;qe<tt.length;qe+=1){var zt=tt[qe];F=Math.min(F,zt.x),ue=Math.min(ue,zt.y),Ee=Math.max(Ee,zt.x),Xe=Math.max(Xe,zt.y)}var Lt=Math.max(Ee-F,Xe-ue),Xt=Math.max(0,Math.floor(-Math.log(Lt)/Math.LN2)),Dt=Math.pow(2,Xt);return new a.CanonicalTileID(Xt,Math.floor((F+Ee)/2*Dt),Math.floor((ue+Xe)/2*Dt))}(x),this.minzoom=this.maxzoom=this.tileID.z;var P=x.map(function(O){return c.tileID.getTilePoint(O)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(P[0].x,P[0].y,0,0),this._boundsArray.emplaceBack(P[1].x,P[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(P[3].x,P[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(P[2].x,P[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},i.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var n=this.map.painter.context,c=n.gl;for(var x in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Ce.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(n,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var P=this.tiles[x];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture)}}},i.prototype.loadTile=function(n,c){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},c(null)):(n.state="errored",c(null))},i.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return!1},i}(a.Evented),Te=function(u){function i(n,c,x,P){u.call(this,n,c,x,P),this.roundZoom=!0,this.type="video",this.options=c}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1;var c=this.options;this.urls=[];for(var x=0,P=c.urls;x<P.length;x+=1)this.urls.push(this.map._requestManager.transformRequest(P[x],a.ResourceType.Source).url);a.getVideo(this.urls,function(O,F){n._loaded=!0,O?n.fire(new a.ErrorEvent(O)):F&&(n.video=F,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},i.prototype.pause=function(){this.video&&this.video.pause()},i.prototype.play=function(){this.video&&this.video.play()},i.prototype.seek=function(n){if(this.video){var c=this.video.seekable;n<c.start(0)||n>c.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+c.start(0)+" and "+c.end(0)+"-second mark."))):this.video.currentTime=n}},i.prototype.getVideo=function(){return this.video},i.prototype.onAdd=function(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},i.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var n=this.map.painter.context,c=n.gl;for(var x in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Ce.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(n,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var P=this.tiles[x];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this.video&&!this.video.paused},i}(be),me=function(u){function i(n,c,x,P){u.call(this,n,c,x,P),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(function(O){return!Array.isArray(O)||O.length!==2||O.some(function(F){return typeof F!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+n,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},i.prototype.getCanvas=function(){return this.canvas},i.prototype.onAdd=function(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()},i.prototype.onRemove=function(){this.pause()},i.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var c=this.map.painter.context,x=c.gl;for(var P in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Ce.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(c,this.canvas,x.RGBA,{premultiply:!0}),this.tiles){var O=this.tiles[P];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this._playing},i.prototype._hasInvalidDimensions=function(){for(var n=0,c=[this.canvas.width,this.canvas.height];n<c.length;n+=1){var x=c[n];if(isNaN(x)||x<=0)return!0}return!1},i}(be),rt={vector:ar,raster:oe,"raster-dem":Q,geojson:G,video:Te,image:be,canvas:me};function Kt(u,i){var n=a.identity([]);return a.translate(n,n,[1,1,0]),a.scale(n,n,[.5*u.width,.5*u.height,1]),a.multiply(n,n,u.calculatePosMatrix(i.toUnwrapped()))}function _t(u,i,n,c,x,P){var O=function(Xt,Dt,Ut){if(Xt)for(var er=0,qt=Xt;er<qt.length;er+=1){var Ir=Dt[qt[er]];if(Ir&&Ir.source===Ut&&Ir.type==="fill-extrusion")return!0}else for(var hr in Dt){var Tr=Dt[hr];if(Tr.source===Ut&&Tr.type==="fill-extrusion")return!0}return!1}(x&&x.layers,i,u.id),F=P.maxPitchScaleFactor(),ue=u.tilesIn(c,F,O);ue.sort(ge);for(var Ee=[],Xe=0,qe=ue;Xe<qe.length;Xe+=1){var tt=qe[Xe];Ee.push({wrappedTileID:tt.tileID.wrapped().key,queryResults:tt.tile.queryRenderedFeatures(i,n,u._state,tt.queryGeometry,tt.cameraQueryGeometry,tt.scale,x,P,F,Kt(u.transform,tt.tileID))})}var zt=function(Xt){for(var Dt={},Ut={},er=0,qt=Xt;er<qt.length;er+=1){var Ir=qt[er],hr=Ir.queryResults,Tr=Ir.wrappedTileID,_r=Ut[Tr]=Ut[Tr]||{};for(var nn in hr)for(var Yr=hr[nn],yn=_r[nn]=_r[nn]||{},On=Dt[nn]=Dt[nn]||[],Qn=0,oi=Yr;Qn<oi.length;Qn+=1){var yi=oi[Qn];yn[yi.featureIndex]||(yn[yi.featureIndex]=!0,On.push(yi))}}return Dt}(Ee);for(var Lt in zt)zt[Lt].forEach(function(Xt){var Dt=Xt.feature,Ut=u.getFeatureState(Dt.layer["source-layer"],Dt.id);Dt.source=Dt.layer.source,Dt.layer["source-layer"]&&(Dt.sourceLayer=Dt.layer["source-layer"]),Dt.state=Ut});return zt}function ge(u,i){var n=u.tileID,c=i.tileID;return n.overscaledZ-c.overscaledZ||n.canonical.y-c.canonical.y||n.wrap-c.wrap||n.canonical.x-c.canonical.x}var ye=function(i,n){this.max=i,this.onRemove=n,this.reset()};ye.prototype.reset=function(){for(var u in this.data)for(var i=0,n=this.data[u];i<n.length;i+=1){var c=n[i];c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value)}return this.data={},this.order=[],this},ye.prototype.add=function(u,i,n){var c=this,x=u.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);var P={value:i,timeout:void 0};if(n!==void 0&&(P.timeout=setTimeout(function(){c.remove(u,P)},n)),this.data[x].push(P),this.order.push(x),this.order.length>this.max){var O=this._getAndRemoveByKey(this.order[0]);O&&this.onRemove(O)}return this},ye.prototype.has=function(u){return u.wrapped().key in this.data},ye.prototype.getAndRemove=function(u){return this.has(u)?this._getAndRemoveByKey(u.wrapped().key):null},ye.prototype._getAndRemoveByKey=function(u){var i=this.data[u].shift();return i.timeout&&clearTimeout(i.timeout),this.data[u].length===0&&delete this.data[u],this.order.splice(this.order.indexOf(u),1),i.value},ye.prototype.getByKey=function(u){var i=this.data[u];return i?i[0].value:null},ye.prototype.get=function(u){return this.has(u)?this.data[u.wrapped().key][0].value:null},ye.prototype.remove=function(u,i){if(!this.has(u))return this;var n=u.wrapped().key,c=i===void 0?0:this.data[n].indexOf(i),x=this.data[n][c];return this.data[n].splice(c,1),x.timeout&&clearTimeout(x.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(x.value),this.order.splice(this.order.indexOf(n),1),this},ye.prototype.setMaxSize=function(u){for(this.max=u;this.order.length>this.max;){var i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this},ye.prototype.filter=function(u){var i=[];for(var n in this.data)for(var c=0,x=this.data[n];c<x.length;c+=1){var P=x[c];u(P.value)||i.push(P)}for(var O=0,F=i;O<F.length;O+=1){var ue=F[O];this.remove(ue.value.tileID,ue)}};var Ve=function(i,n,c){this.context=i;var x=i.gl;this.buffer=x.createBuffer(),this.dynamicDraw=Boolean(c),this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Ve.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ve.prototype.updateData=function(u){var i=this.context.gl;this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)},Ve.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ft={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Ie=function(i,n,c,x){this.length=n.length,this.attributes=c,this.itemSize=n.bytesPerElement,this.dynamicDraw=x,this.context=i;var P=i.gl;this.buffer=P.createBuffer(),i.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Ie.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Ie.prototype.updateData=function(u){var i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,u.arrayBuffer)},Ie.prototype.enableAttributes=function(u,i){for(var n=0;n<this.attributes.length;n++){var c=i.attributes[this.attributes[n].name];c!==void 0&&u.enableVertexAttribArray(c)}},Ie.prototype.setVertexAttribPointers=function(u,i,n){for(var c=0;c<this.attributes.length;c++){var x=this.attributes[c],P=i.attributes[x.name];P!==void 0&&u.vertexAttribPointer(P,x.components,u[ft[x.type]],!1,this.itemSize,x.offset+this.itemSize*(n||0))}},Ie.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var pt=function(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};pt.prototype.get=function(){return this.current},pt.prototype.set=function(u){},pt.prototype.getDefault=function(){return this.default},pt.prototype.setDefault=function(){this.set(this.default)};var C=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return a.Color.transparent},i.prototype.set=function(n){var c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},i}(pt),R=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return 1},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)},i}(pt),q=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return 0},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)},i}(pt),fe=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return[!0,!0,!0,!0]},i.prototype.set=function(n){var c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},i}(pt),Ge=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!0},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)},i}(pt),Je=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return 255},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)},i}(pt),yt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},i.prototype.set=function(n){var c=this.current;(n.func!==c.func||n.ref!==c.ref||n.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)},i}(pt),nt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){var n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]},i.prototype.set=function(n){var c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)},i}(pt),Nt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;n?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=n,this.dirty=!1}},i}(pt),$=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return[0,1]},i.prototype.set=function(n){var c=this.current;(n[0]!==c[0]||n[1]!==c[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)},i}(pt),Ye=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;n?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=n,this.dirty=!1}},i}(pt),ie=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.LESS},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)},i}(pt),et=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;n?c.enable(c.BLEND):c.disable(c.BLEND),this.current=n,this.dirty=!1}},i}(pt),Bt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){var n=this.gl;return[n.ONE,n.ZERO]},i.prototype.set=function(n){var c=this.current;(n[0]!==c[0]||n[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)},i}(pt),lr=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return a.Color.transparent},i.prototype.set=function(n){var c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},i}(pt),dt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.FUNC_ADD},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)},i}(pt),vt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;n?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=n,this.dirty=!1}},i}(pt),Ct=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.BACK},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)},i}(pt),gt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.CCW},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)},i}(pt),we=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)},i}(pt),ht=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.TEXTURE0},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)},i}(pt),Qe=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){var n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]},i.prototype.set=function(n){var c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},i}(pt),Vt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,n),this.current=n,this.dirty=!1}},i}(pt),pr=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,n),this.current=n,this.dirty=!1}},i}(pt),Zr=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.bindTexture(c.TEXTURE_2D,n),this.current=n,this.dirty=!1}},i}(pt),cr=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}},i}(pt),jn=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){var c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1},i}(pt),Sn=function(u){function i(n){u.call(this,n),this.vao=n.extVertexArrayObject}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)},i}(pt),ai=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return 4},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}},i}(pt),fi=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}},i}(pt),Zn=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}},i}(pt),Hn=function(u){function i(n,c){u.call(this,n),this.context=n,this.parent=c}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i}(pt),k=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.setDirty=function(){this.dirty=!0},i.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}},i}(Hn),H=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,n),this.current=n,this.dirty=!1}},i}(Hn),le=function(i,n,c,x){this.context=i,this.width=n,this.height=c;var P=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new k(i,P),x&&(this.depthAttachment=new H(i,P))};le.prototype.destroy=function(){var u=this.context.gl,i=this.colorAttachment.get();if(i&&u.deleteTexture(i),this.depthAttachment){var n=this.depthAttachment.get();n&&u.deleteRenderbuffer(n)}u.deleteFramebuffer(this.framebuffer)};var de=function(i,n,c){this.func=i,this.mask=n,this.range=c};de.ReadOnly=!1,de.ReadWrite=!0,de.disabled=new de(519,de.ReadOnly,[0,1]);var at=function(i,n,c,x,P,O){this.test=i,this.ref=n,this.mask=c,this.fail=x,this.depthFail=P,this.pass=O};at.disabled=new at({func:519,mask:0},0,0,7680,7680,7680);var At=function(i,n,c){this.blendFunction=i,this.blendColor=n,this.mask=c};At.disabled=new At(At.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),At.unblended=new At(At.Replace,a.Color.transparent,[!0,!0,!0,!0]),At.alphaBlended=new At([1,771],a.Color.transparent,[!0,!0,!0,!0]);var Ft=function(i,n,c){this.enable=i,this.mode=n,this.frontFace=c};Ft.disabled=new Ft(!1,1029,2305),Ft.backCCW=new Ft(!0,1029,2305);var He=function(i){this.gl=i,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new C(this),this.clearDepth=new R(this),this.clearStencil=new q(this),this.colorMask=new fe(this),this.depthMask=new Ge(this),this.stencilMask=new Je(this),this.stencilFunc=new yt(this),this.stencilOp=new nt(this),this.stencilTest=new Nt(this),this.depthRange=new $(this),this.depthTest=new Ye(this),this.depthFunc=new ie(this),this.blend=new et(this),this.blendFunc=new Bt(this),this.blendColor=new lr(this),this.blendEquation=new dt(this),this.cullFace=new vt(this),this.cullFaceSide=new Ct(this),this.frontFace=new gt(this),this.program=new we(this),this.activeTexture=new ht(this),this.viewport=new Qe(this),this.bindFramebuffer=new Vt(this),this.bindRenderbuffer=new pr(this),this.bindTexture=new Zr(this),this.bindVertexBuffer=new cr(this),this.bindElementBuffer=new jn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Sn(this),this.pixelStoreUnpack=new ai(this),this.pixelStoreUnpackPremultiplyAlpha=new fi(this),this.pixelStoreUnpackFlipY=new Zn(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=i.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(i.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)};He.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},He.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},He.prototype.createIndexBuffer=function(u,i){return new Ve(this,u,i)},He.prototype.createVertexBuffer=function(u,i,n){return new Ie(this,u,i,n)},He.prototype.createRenderbuffer=function(u,i,n){var c=this.gl,x=c.createRenderbuffer();return this.bindRenderbuffer.set(x),c.renderbufferStorage(c.RENDERBUFFER,u,i,n),this.bindRenderbuffer.set(null),x},He.prototype.createFramebuffer=function(u,i,n){return new le(this,u,i,n)},He.prototype.clear=function(u){var i=u.color,n=u.depth,c=this.gl,x=0;i&&(x|=c.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(x|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),c.clear(x)},He.prototype.setCullFace=function(u){u.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))},He.prototype.setDepthMode=function(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)},He.prototype.setStencilMode=function(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)},He.prototype.setColorMode=function(u){a.deepEqual(u.blendFunction,At.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)},He.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Pt=function(u){function i(n,c,x){var P=this;u.call(this),this.id=n,this.dispatcher=x,this.on("data",function(O){O.dataType==="source"&&O.sourceDataType==="metadata"&&(P._sourceLoaded=!0),P._sourceLoaded&&!P._paused&&O.dataType==="source"&&O.sourceDataType==="content"&&(P.reload(),P.transform&&P.update(P.transform))}),this.on("error",function(){P._sourceErrored=!0}),this._source=function(O,F,ue,Ee){var Xe=new rt[F.type](O,F,ue,Ee);if(Xe.id!==O)throw new Error("Expected Source id to be "+O+" instead of "+Xe.id);return a.bindAll(["load","abort","unload","serialize","prepare"],Xe),Xe}(n,c,x,this),this._tiles={},this._cache=new ye(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.onAdd=function(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)},i.prototype.onRemove=function(n){this._source&&this._source.onRemove&&this._source.onRemove(n)},i.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var n in this._tiles){var c=this._tiles[n];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0},i.prototype.getSource=function(){return this._source},i.prototype.pause=function(){this._paused=!0},i.prototype.resume=function(){if(this._paused){var n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}},i.prototype._loadTile=function(n,c){return this._source.loadTile(n,c)},i.prototype._unloadTile=function(n){if(this._source.unloadTile)return this._source.unloadTile(n,function(){})},i.prototype._abortTile=function(n){if(this._source.abortTile)return this._source.abortTile(n,function(){})},i.prototype.serialize=function(){return this._source.serialize()},i.prototype.prepare=function(n){for(var c in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var x=this._tiles[c];x.upload(n),x.prepare(this.map.style.imageManager)}},i.prototype.getIds=function(){return a.values(this._tiles).map(function(n){return n.tileID}).sort(or).map(function(n){return n.key})},i.prototype.getRenderableIds=function(n){var c=this,x=[];for(var P in this._tiles)this._isIdRenderable(P,n)&&x.push(this._tiles[P]);return n?x.sort(function(O,F){var ue=O.tileID,Ee=F.tileID,Xe=new a.Point(ue.canonical.x,ue.canonical.y)._rotate(c.transform.angle),qe=new a.Point(Ee.canonical.x,Ee.canonical.y)._rotate(c.transform.angle);return ue.overscaledZ-Ee.overscaledZ||qe.y-Xe.y||qe.x-Xe.x}).map(function(O){return O.tileID.key}):x.map(function(O){return O.tileID}).sort(or).map(function(O){return O.key})},i.prototype.hasRenderableParent=function(n){var c=this.findLoadedParent(n,0);return!!c&&this._isIdRenderable(c.tileID.key)},i.prototype._isIdRenderable=function(n,c){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(c||!this._tiles[n].holdingForFade())},i.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var n in this._cache.reset(),this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")},i.prototype._reloadTile=function(n,c){var x=this._tiles[n];x&&(x.state!=="loading"&&(x.state=c),this._loadTile(x,this._tileLoaded.bind(this,x,n,c)))},i.prototype._tileLoaded=function(n,c,x,P){if(P)return n.state="errored",void(P.status!==404?this._source.fire(new a.ErrorEvent(P,{tile:n})):this.update(this.transform));n.timeAdded=a.browser.now(),x==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(c,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},i.prototype._backfillDEM=function(n){for(var c=this.getRenderableIds(),x=0;x<c.length;x++){var P=c[x];if(n.neighboringTiles&&n.neighboringTiles[P]){var O=this.getTileByID(P);F(n,O),F(O,n)}}function F(ue,Ee){ue.needsHillshadePrepare=!0;var Xe=Ee.tileID.canonical.x-ue.tileID.canonical.x,qe=Ee.tileID.canonical.y-ue.tileID.canonical.y,tt=Math.pow(2,ue.tileID.canonical.z),zt=Ee.tileID.key;Xe===0&&qe===0||Math.abs(qe)>1||(Math.abs(Xe)>1&&(Math.abs(Xe+tt)===1?Xe+=tt:Math.abs(Xe-tt)===1&&(Xe-=tt)),Ee.dem&&ue.dem&&(ue.dem.backfillBorder(Ee.dem,Xe,qe),ue.neighboringTiles&&ue.neighboringTiles[zt]&&(ue.neighboringTiles[zt].backfilled=!0)))}},i.prototype.getTile=function(n){return this.getTileByID(n.key)},i.prototype.getTileByID=function(n){return this._tiles[n]},i.prototype._retainLoadedChildren=function(n,c,x,P){for(var O in this._tiles){var F=this._tiles[O];if(!(P[O]||!F.hasData()||F.tileID.overscaledZ<=c||F.tileID.overscaledZ>x)){for(var ue=F.tileID;F&&F.tileID.overscaledZ>c+1;){var Ee=F.tileID.scaledTo(F.tileID.overscaledZ-1);(F=this._tiles[Ee.key])&&F.hasData()&&(ue=Ee)}for(var Xe=ue;Xe.overscaledZ>c;)if(n[(Xe=Xe.scaledTo(Xe.overscaledZ-1)).key]){P[ue.key]=ue;break}}}},i.prototype.findLoadedParent=function(n,c){if(n.key in this._loadedParentTiles){var x=this._loadedParentTiles[n.key];return x&&x.tileID.overscaledZ>=c?x:null}for(var P=n.overscaledZ-1;P>=c;P--){var O=n.scaledTo(P),F=this._getLoadedTile(O);if(F)return F}},i.prototype._getLoadedTile=function(n){var c=this._tiles[n.key];return c&&c.hasData()?c:this._cache.getByKey(n.wrapped().key)},i.prototype.updateCacheSize=function(n){var c=Math.ceil(n.width/this._source.tileSize)+1,x=Math.ceil(n.height/this._source.tileSize)+1,P=Math.floor(c*x*5),O=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,P):P;this._cache.setMaxSize(O)},i.prototype.handleWrapJump=function(n){var c=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,c){var x={};for(var P in this._tiles){var O=this._tiles[P];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+c),x[O.tileID.key]=O}for(var F in this._tiles=x,this._timers)clearTimeout(this._timers[F]),delete this._timers[F];for(var ue in this._tiles)this._setTileReloadTimer(ue,this._tiles[ue])}},i.prototype.update=function(n){var c=this;if(this.transform=n,this._sourceLoaded&&!this._paused){var x;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?x=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(_r){return new a.OverscaledTileID(_r.canonical.z,_r.wrap,_r.canonical.z,_r.canonical.x,_r.canonical.y)}):(x=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(x=x.filter(function(_r){return c._source.hasTile(_r)}))):x=[];var P=n.coveringZoomLevel(this._source),O=Math.max(P-i.maxOverzooming,this._source.minzoom),F=Math.max(P+i.maxUnderzooming,this._source.minzoom),ue=this._updateRetainedTiles(x,P);if(jr(this._source.type)){for(var Ee={},Xe={},qe=0,tt=Object.keys(ue);qe<tt.length;qe+=1){var zt=tt[qe],Lt=ue[zt],Xt=this._tiles[zt];if(Xt&&!(Xt.fadeEndTime&&Xt.fadeEndTime<=a.browser.now())){var Dt=this.findLoadedParent(Lt,O);Dt&&(this._addTile(Dt.tileID),Ee[Dt.tileID.key]=Dt.tileID),Xe[zt]=Lt}}for(var Ut in this._retainLoadedChildren(Xe,P,F,ue),Ee)ue[Ut]||(this._coveredTiles[Ut]=!0,ue[Ut]=Ee[Ut])}for(var er in ue)this._tiles[er].clearFadeHold();for(var qt=0,Ir=a.keysDifference(this._tiles,ue);qt<Ir.length;qt+=1){var hr=Ir[qt],Tr=this._tiles[hr];Tr.hasSymbolBuckets&&!Tr.holdingForFade()?Tr.setHoldDuration(this.map._fadeDuration):Tr.hasSymbolBuckets&&!Tr.symbolFadeFinished()||this._removeTile(hr)}this._updateLoadedParentTileCache()}},i.prototype.releaseSymbolFadeTiles=function(){for(var n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)},i.prototype._updateRetainedTiles=function(n,c){for(var x={},P={},O=Math.max(c-i.maxOverzooming,this._source.minzoom),F=Math.max(c+i.maxUnderzooming,this._source.minzoom),ue={},Ee=0,Xe=n;Ee<Xe.length;Ee+=1){var qe=Xe[Ee],tt=this._addTile(qe);x[qe.key]=qe,tt.hasData()||c<this._source.maxzoom&&(ue[qe.key]=qe)}this._retainLoadedChildren(ue,c,F,x);for(var zt=0,Lt=n;zt<Lt.length;zt+=1){var Xt=Lt[zt],Dt=this._tiles[Xt.key];if(!Dt.hasData()){if(c+1>this._source.maxzoom){var Ut=Xt.children(this._source.maxzoom)[0],er=this.getTile(Ut);if(er&&er.hasData()){x[Ut.key]=Ut;continue}}else{var qt=Xt.children(this._source.maxzoom);if(x[qt[0].key]&&x[qt[1].key]&&x[qt[2].key]&&x[qt[3].key])continue}for(var Ir=Dt.wasRequested(),hr=Xt.overscaledZ-1;hr>=O;--hr){var Tr=Xt.scaledTo(hr);if(P[Tr.key]||(P[Tr.key]=!0,!(Dt=this.getTile(Tr))&&Ir&&(Dt=this._addTile(Tr)),Dt&&(x[Tr.key]=Tr,Ir=Dt.wasRequested(),Dt.hasData())))break}}}return x},i.prototype._updateLoadedParentTileCache=function(){for(var n in this._loadedParentTiles={},this._tiles){for(var c=[],x=void 0,P=this._tiles[n].tileID;P.overscaledZ>0;){if(P.key in this._loadedParentTiles){x=this._loadedParentTiles[P.key];break}c.push(P.key);var O=P.scaledTo(P.overscaledZ-1);if(x=this._getLoadedTile(O))break;P=O}for(var F=0,ue=c;F<ue.length;F+=1)this._loadedParentTiles[ue[F]]=x}},i.prototype._addTile=function(n){var c=this._tiles[n.key];if(c)return c;(c=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,c),c.tileID=n,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,c)));var x=Boolean(c);return x||(c=new a.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(c,this._tileLoaded.bind(this,c,n.key,c.state))),c?(c.uses++,this._tiles[n.key]=c,x||this._source.fire(new a.Event("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null},i.prototype._setTileReloadTimer=function(n,c){var x=this;n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);var P=c.getExpiryTimeout();P&&(this._timers[n]=setTimeout(function(){x._reloadTile(n,"expired"),delete x._timers[n]},P))},i.prototype._removeTile=function(n){var c=this._tiles[n];c&&(c.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))},i.prototype.clearTiles=function(){for(var n in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(n);this._cache.reset()},i.prototype.tilesIn=function(n,c,x){var P=this,O=[],F=this.transform;if(!F)return O;for(var ue=x?F.getCameraQueryGeometry(n):n,Ee=n.map(function(hr){return F.pointCoordinate(hr)}),Xe=ue.map(function(hr){return F.pointCoordinate(hr)}),qe=this.getIds(),tt=1/0,zt=1/0,Lt=-1/0,Xt=-1/0,Dt=0,Ut=Xe;Dt<Ut.length;Dt+=1){var er=Ut[Dt];tt=Math.min(tt,er.x),zt=Math.min(zt,er.y),Lt=Math.max(Lt,er.x),Xt=Math.max(Xt,er.y)}for(var qt=function(Tr){var _r=P._tiles[qe[Tr]];if(!_r.holdingForFade()){var nn=_r.tileID,Yr=Math.pow(2,F.zoom-_r.tileID.overscaledZ),yn=c*_r.queryPadding*a.EXTENT/_r.tileSize/Yr,On=[nn.getTilePoint(new a.MercatorCoordinate(tt,zt)),nn.getTilePoint(new a.MercatorCoordinate(Lt,Xt))];if(On[0].x-yn<a.EXTENT&&On[0].y-yn<a.EXTENT&&On[1].x+yn>=0&&On[1].y+yn>=0){var Qn=Ee.map(function(yi){return nn.getTilePoint(yi)}),oi=Xe.map(function(yi){return nn.getTilePoint(yi)});O.push({tile:_r,tileID:nn,queryGeometry:Qn,cameraQueryGeometry:oi,scale:Yr})}}},Ir=0;Ir<qe.length;Ir++)qt(Ir);return O},i.prototype.getVisibleCoordinates=function(n){for(var c=this,x=this.getRenderableIds(n).map(function(ue){return c._tiles[ue].tileID}),P=0,O=x;P<O.length;P+=1){var F=O[P];F.posMatrix=this.transform.calculatePosMatrix(F.toUnwrapped())}return x},i.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(jr(this._source.type))for(var n in this._tiles){var c=this._tiles[n];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=a.browser.now())return!0}return!1},i.prototype.setFeatureState=function(n,c,x){this._state.updateState(n=n||"_geojsonTileLayer",c,x)},i.prototype.removeFeatureState=function(n,c,x){this._state.removeFeatureState(n=n||"_geojsonTileLayer",c,x)},i.prototype.getFeatureState=function(n,c){return this._state.getState(n=n||"_geojsonTileLayer",c)},i.prototype.setDependencies=function(n,c,x){var P=this._tiles[n];P&&P.setDependencies(c,x)},i.prototype.reloadTilesForDependencies=function(n,c){for(var x in this._tiles)this._tiles[x].hasDependency(n,c)&&this._reloadTile(x,"reloading");this._cache.filter(function(P){return!P.hasDependency(n,c)})},i}(a.Evented);function or(u,i){var n=Math.abs(2*u.wrap)-+(u.wrap<0),c=Math.abs(2*i.wrap)-+(i.wrap<0);return u.overscaledZ-i.overscaledZ||c-n||i.canonical.y-u.canonical.y||i.canonical.x-u.canonical.x}function jr(u){return u==="raster"||u==="image"||u==="video"}function Hr(){return new a.window.Worker(ic.workerUrl)}Pt.maxOverzooming=10,Pt.maxUnderzooming=3;var sr="mapboxgl_preloaded_worker_pool",Fr=function(){this.active={}};Fr.prototype.acquire=function(u){if(!this.workers)for(this.workers=[];this.workers.length<Fr.workerCount;)this.workers.push(new Hr);return this.active[u]=!0,this.workers.slice()},Fr.prototype.release=function(u){delete this.active[u],this.numActive()===0&&(this.workers.forEach(function(i){i.terminate()}),this.workers=null)},Fr.prototype.isPreloaded=function(){return!!this.active[sr]},Fr.prototype.numActive=function(){return Object.keys(this.active).length};var _n,dn=Math.floor(a.browser.hardwareConcurrency/2);function Er(){return _n||(_n=new Fr),_n}function Tn(u,i){var n={};for(var c in u)c!=="ref"&&(n[c]=u[c]);return a.refProperties.forEach(function(x){x in i&&(n[x]=i[x])}),n}function vn(u){u=u.slice();for(var i=Object.create(null),n=0;n<u.length;n++)i[u[n].id]=u[n];for(var c=0;c<u.length;c++)"ref"in u[c]&&(u[c]=Tn(u[c],i[u[c].ref]));return u}Fr.workerCount=Math.max(Math.min(dn,6),1);var gn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ar(u,i,n){n.push({command:gn.addSource,args:[u,i[u]]})}function $r(u,i,n){i.push({command:gn.removeSource,args:[u]}),n[u]=!0}function Mn(u,i,n,c){$r(u,n,c),Ar(u,i,n)}function Xi(u,i,n){var c;for(c in u[n])if(u[n].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(u[n][c],i[n][c]))return!1;for(c in i[n])if(i[n].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(u[n][c],i[n][c]))return!1;return!0}function vi(u,i,n,c,x,P){var O;for(O in i=i||{},u=u||{})u.hasOwnProperty(O)&&(a.deepEqual(u[O],i[O])||n.push({command:P,args:[c,O,i[O],x]}));for(O in i)i.hasOwnProperty(O)&&!u.hasOwnProperty(O)&&(a.deepEqual(u[O],i[O])||n.push({command:P,args:[c,O,i[O],x]}))}function wi(u){return u.id}function Di(u,i){return u[i.id]=i,u}var Ka=function(i,n){this.reset(i,n)};Ka.prototype.reset=function(u,i){this.points=u||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ka.prototype.lerp=function(u){if(this.points.length===1)return this.points[0];u=a.clamp(u,0,1);for(var i=1,n=this._distances[i],c=u*this.paddedLength+this.padding;n<c&&i<this._distances.length;)n=this._distances[++i];var x=i-1,P=this._distances[x],O=n-P,F=O>0?(c-P)/O:0;return this.points[x].mult(1-F).add(this.points[i].mult(F))};var hi=function(i,n,c){var x=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(i/c),this.yCellCount=Math.ceil(n/c);for(var O=0;O<this.xCellCount*this.yCellCount;O++)x.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=n,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0};function ga(u,i,n,c,x){var P=a.create();return i?(a.scale(P,P,[1/x,1/x,1]),n||a.rotateZ(P,P,c.angle)):a.multiply(P,c.labelPlaneMatrix,u),P}function Pi(u,i,n,c,x){if(i){var P=a.clone(u);return a.scale(P,P,[x,x,1]),n||a.rotateZ(P,P,-c.angle),P}return c.glCoordMatrix}function gi(u,i){var n=[u.x,u.y,0,1];Ja(n,n,i);var c=n[3];return{point:new a.Point(n[0]/c,n[1]/c),signedDistanceFromCamera:c}}function ci(u,i){return .5+u/i*.5}function Oa(u,i){var n=u[0]/u[3],c=u[1]/u[3];return n>=-i[0]&&n<=i[0]&&c>=-i[1]&&c<=i[1]}function mo(u,i,n,c,x,P,O,F){var ue=c?u.textSizeData:u.iconSizeData,Ee=a.evaluateSizeForZoom(ue,n.transform.zoom),Xe=[256/n.width*2+1,256/n.height*2+1],qe=c?u.text.dynamicLayoutVertexArray:u.icon.dynamicLayoutVertexArray;qe.clear();for(var tt=u.lineVertexArray,zt=c?u.text.placedSymbolArray:u.icon.placedSymbolArray,Lt=n.transform.width/n.transform.height,Xt=!1,Dt=0;Dt<zt.length;Dt++){var Ut=zt.get(Dt);if(Ut.hidden||Ut.writingMode===a.WritingMode.vertical&&!Xt)na(Ut.numGlyphs,qe);else{Xt=!1;var er=[Ut.anchorX,Ut.anchorY,0,1];if(a.transformMat4(er,er,i),Oa(er,Xe)){var qt=ci(n.transform.cameraToCenterDistance,er[3]),Ir=a.evaluateSizeForFeature(ue,Ee,Ut),hr=O?Ir/qt:Ir*qt,Tr=new a.Point(Ut.anchorX,Ut.anchorY),_r=gi(Tr,x).point,nn={},Yr=Uu(Ut,hr,!1,F,i,x,P,u.glyphOffsetArray,tt,qe,_r,Tr,nn,Lt);Xt=Yr.useVertical,(Yr.notEnoughRoom||Xt||Yr.needsFlipping&&Uu(Ut,hr,!0,F,i,x,P,u.glyphOffsetArray,tt,qe,_r,Tr,nn,Lt).notEnoughRoom)&&na(Ut.numGlyphs,qe)}else na(Ut.numGlyphs,qe)}}c?u.text.dynamicLayoutVertexBuffer.updateData(qe):u.icon.dynamicLayoutVertexBuffer.updateData(qe)}function $a(u,i,n,c,x,P,O,F,ue,Ee,Xe){var qe=F.glyphStartIndex+F.numGlyphs,tt=F.lineStartIndex,zt=F.lineStartIndex+F.lineLength,Lt=i.getoffsetX(F.glyphStartIndex),Xt=i.getoffsetX(qe-1),Dt=Ca(u*Lt,n,c,x,P,O,F.segment,tt,zt,ue,Ee,Xe);if(!Dt)return null;var Ut=Ca(u*Xt,n,c,x,P,O,F.segment,tt,zt,ue,Ee,Xe);return Ut?{first:Dt,last:Ut}:null}function Ko(u,i,n,c){return u===a.WritingMode.horizontal&&Math.abs(n.y-i.y)>Math.abs(n.x-i.x)*c?{useVertical:!0}:(u===a.WritingMode.vertical?i.y<n.y:i.x>n.x)?{needsFlipping:!0}:null}function Uu(u,i,n,c,x,P,O,F,ue,Ee,Xe,qe,tt,zt){var Lt,Xt=i/24,Dt=u.lineOffsetX*Xt,Ut=u.lineOffsetY*Xt;if(u.numGlyphs>1){var er=u.glyphStartIndex+u.numGlyphs,qt=u.lineStartIndex,Ir=u.lineStartIndex+u.lineLength,hr=$a(Xt,F,Dt,Ut,n,Xe,qe,u,ue,P,tt);if(!hr)return{notEnoughRoom:!0};var Tr=gi(hr.first.point,O).point,_r=gi(hr.last.point,O).point;if(c&&!n){var nn=Ko(u.writingMode,Tr,_r,zt);if(nn)return nn}Lt=[hr.first];for(var Yr=u.glyphStartIndex+1;Yr<er-1;Yr++)Lt.push(Ca(Xt*F.getoffsetX(Yr),Dt,Ut,n,Xe,qe,u.segment,qt,Ir,ue,P,tt));Lt.push(hr.last)}else{if(c&&!n){var yn=gi(qe,x).point,On=u.lineStartIndex+u.segment+1,Qn=new a.Point(ue.getx(On),ue.gety(On)),oi=gi(Qn,x),yi=oi.signedDistanceFromCamera>0?oi.point:Ui(qe,Qn,yn,1,x),Zi=Ko(u.writingMode,yn,yi,zt);if(Zi)return Zi}var An=Ca(Xt*F.getoffsetX(u.glyphStartIndex),Dt,Ut,n,Xe,qe,u.segment,u.lineStartIndex,u.lineStartIndex+u.lineLength,ue,P,tt);if(!An)return{notEnoughRoom:!0};Lt=[An]}for(var si=0,xi=Lt;si<xi.length;si+=1){var Wn=xi[si];a.addDynamicAttributes(Ee,Wn.point,Wn.angle)}return{}}function Ui(u,i,n,c,x){var P=gi(u.add(u.sub(i)._unit()),x).point,O=n.sub(P);return n.add(O._mult(c/O.mag()))}function Ca(u,i,n,c,x,P,O,F,ue,Ee,Xe,qe){var tt=c?u-i:u+i,zt=tt>0?1:-1,Lt=0;c&&(zt*=-1,Lt=Math.PI),zt<0&&(Lt+=Math.PI);for(var Xt=zt>0?F+O:F+O+1,Dt=x,Ut=x,er=0,qt=0,Ir=Math.abs(tt),hr=[];er+qt<=Ir;){if((Xt+=zt)<F||Xt>=ue)return null;if(Ut=Dt,hr.push(Dt),(Dt=qe[Xt])===void 0){var Tr=new a.Point(Ee.getx(Xt),Ee.gety(Xt)),_r=gi(Tr,Xe);if(_r.signedDistanceFromCamera>0)Dt=qe[Xt]=_r.point;else{var nn=Xt-zt;Dt=Ui(er===0?P:new a.Point(Ee.getx(nn),Ee.gety(nn)),Tr,Ut,Ir-er+1,Xe)}}er+=qt,qt=Ut.dist(Dt)}var Yr=(Ir-er)/qt,yn=Dt.sub(Ut),On=yn.mult(Yr)._add(Ut);On._add(yn._unit()._perp()._mult(n*zt));var Qn=Lt+Math.atan2(Dt.y-Ut.y,Dt.x-Ut.x);return hr.push(On),{point:On,angle:Qn,path:hr}}hi.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},hi.prototype.insert=function(u,i,n,c,x){this._forEachCell(i,n,c,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(c),this.bboxes.push(x)},hi.prototype.insertCircle=function(u,i,n,c){this._forEachCell(i-c,n-c,i+c,n+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(i),this.circles.push(n),this.circles.push(c)},hi.prototype._insertBoxCell=function(u,i,n,c,x,P){this.boxCells[x].push(P)},hi.prototype._insertCircleCell=function(u,i,n,c,x,P){this.circleCells[x].push(P)},hi.prototype._query=function(u,i,n,c,x,P){if(n<0||u>this.width||c<0||i>this.height)return!x&&[];var O=[];if(u<=0&&i<=0&&this.width<=n&&this.height<=c){if(x)return!0;for(var F=0;F<this.boxKeys.length;F++)O.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(var ue=0;ue<this.circleKeys.length;ue++){var Ee=this.circles[3*ue],Xe=this.circles[3*ue+1],qe=this.circles[3*ue+2];O.push({key:this.circleKeys[ue],x1:Ee-qe,y1:Xe-qe,x2:Ee+qe,y2:Xe+qe})}return P?O.filter(P):O}return this._forEachCell(u,i,n,c,this._queryCell,O,{hitTest:x,seenUids:{box:{},circle:{}}},P),x?O.length>0:O},hi.prototype._queryCircle=function(u,i,n,c,x){var P=u-n,O=u+n,F=i-n,ue=i+n;if(O<0||P>this.width||ue<0||F>this.height)return!c&&[];var Ee=[];return this._forEachCell(P,F,O,ue,this._queryCellCircle,Ee,{hitTest:c,circle:{x:u,y:i,radius:n},seenUids:{box:{},circle:{}}},x),c?Ee.length>0:Ee},hi.prototype.query=function(u,i,n,c,x){return this._query(u,i,n,c,!1,x)},hi.prototype.hitTest=function(u,i,n,c,x){return this._query(u,i,n,c,!0,x)},hi.prototype.hitTestCircle=function(u,i,n,c){return this._queryCircle(u,i,n,!0,c)},hi.prototype._queryCell=function(u,i,n,c,x,P,O,F){var ue=O.seenUids,Ee=this.boxCells[x];if(Ee!==null)for(var Xe=this.bboxes,qe=0,tt=Ee;qe<tt.length;qe+=1){var zt=tt[qe];if(!ue.box[zt]){ue.box[zt]=!0;var Lt=4*zt;if(u<=Xe[Lt+2]&&i<=Xe[Lt+3]&&n>=Xe[Lt+0]&&c>=Xe[Lt+1]&&(!F||F(this.boxKeys[zt]))){if(O.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[zt],x1:Xe[Lt],y1:Xe[Lt+1],x2:Xe[Lt+2],y2:Xe[Lt+3]})}}}var Xt=this.circleCells[x];if(Xt!==null)for(var Dt=this.circles,Ut=0,er=Xt;Ut<er.length;Ut+=1){var qt=er[Ut];if(!ue.circle[qt]){ue.circle[qt]=!0;var Ir=3*qt;if(this._circleAndRectCollide(Dt[Ir],Dt[Ir+1],Dt[Ir+2],u,i,n,c)&&(!F||F(this.circleKeys[qt]))){if(O.hitTest)return P.push(!0),!0;var hr=Dt[Ir],Tr=Dt[Ir+1],_r=Dt[Ir+2];P.push({key:this.circleKeys[qt],x1:hr-_r,y1:Tr-_r,x2:hr+_r,y2:Tr+_r})}}}},hi.prototype._queryCellCircle=function(u,i,n,c,x,P,O,F){var ue=O.circle,Ee=O.seenUids,Xe=this.boxCells[x];if(Xe!==null)for(var qe=this.bboxes,tt=0,zt=Xe;tt<zt.length;tt+=1){var Lt=zt[tt];if(!Ee.box[Lt]){Ee.box[Lt]=!0;var Xt=4*Lt;if(this._circleAndRectCollide(ue.x,ue.y,ue.radius,qe[Xt+0],qe[Xt+1],qe[Xt+2],qe[Xt+3])&&(!F||F(this.boxKeys[Lt])))return P.push(!0),!0}}var Dt=this.circleCells[x];if(Dt!==null)for(var Ut=this.circles,er=0,qt=Dt;er<qt.length;er+=1){var Ir=qt[er];if(!Ee.circle[Ir]){Ee.circle[Ir]=!0;var hr=3*Ir;if(this._circlesCollide(Ut[hr],Ut[hr+1],Ut[hr+2],ue.x,ue.y,ue.radius)&&(!F||F(this.circleKeys[Ir])))return P.push(!0),!0}}},hi.prototype._forEachCell=function(u,i,n,c,x,P,O,F){for(var ue=this._convertToXCellCoord(u),Ee=this._convertToYCellCoord(i),Xe=this._convertToXCellCoord(n),qe=this._convertToYCellCoord(c),tt=ue;tt<=Xe;tt++)for(var zt=Ee;zt<=qe;zt++)if(x.call(this,u,i,n,c,this.xCellCount*zt+tt,P,O,F))return},hi.prototype._convertToXCellCoord=function(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))},hi.prototype._convertToYCellCoord=function(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))},hi.prototype._circlesCollide=function(u,i,n,c,x,P){var O=c-u,F=x-i,ue=n+P;return ue*ue>O*O+F*F},hi.prototype._circleAndRectCollide=function(u,i,n,c,x,P,O){var F=(P-c)/2,ue=Math.abs(u-(c+F));if(ue>F+n)return!1;var Ee=(O-x)/2,Xe=Math.abs(i-(x+Ee));if(Xe>Ee+n)return!1;if(ue<=F||Xe<=Ee)return!0;var qe=ue-F,tt=Xe-Ee;return qe*qe+tt*tt<=n*n};var ns=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function na(u,i){for(var n=0;n<u;n++){var c=i.length;i.resize(c+4),i.float32.set(ns,3*c)}}function Ja(u,i,n){var c=i[0],x=i[1];return u[0]=n[0]*c+n[4]*x+n[12],u[1]=n[1]*c+n[5]*x+n[13],u[3]=n[3]*c+n[7]*x+n[15],u}var is=function(i,n,c){n===void 0&&(n=new hi(i.width+200,i.height+200,25)),c===void 0&&(c=new hi(i.width+200,i.height+200,25)),this.transform=i,this.grid=n,this.ignoredGrid=c,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+100,this.screenBottomBoundary=i.height+100,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200};function $i(u,i,n){return i*(a.EXTENT/(u.tileSize*Math.pow(2,n-u.tileID.overscaledZ)))}is.prototype.placeCollisionBox=function(u,i,n,c,x){var P=this.projectAndGetPerspectiveRatio(c,u.anchorPointX,u.anchorPointY),O=n*P.perspectiveRatio,F=u.x1*O+P.point.x,ue=u.y1*O+P.point.y,Ee=u.x2*O+P.point.x,Xe=u.y2*O+P.point.y;return!this.isInsideGrid(F,ue,Ee,Xe)||!i&&this.grid.hitTest(F,ue,Ee,Xe,x)?{box:[],offscreen:!1}:{box:[F,ue,Ee,Xe],offscreen:this.isOffscreen(F,ue,Ee,Xe)}},is.prototype.placeCollisionCircles=function(u,i,n,c,x,P,O,F,ue,Ee,Xe,qe,tt){var zt=[],Lt=new a.Point(i.anchorX,i.anchorY),Xt=gi(Lt,P),Dt=ci(this.transform.cameraToCenterDistance,Xt.signedDistanceFromCamera),Ut=(Ee?x/Dt:x*Dt)/a.ONE_EM,er=gi(Lt,O).point,qt=$a(Ut,c,i.lineOffsetX*Ut,i.lineOffsetY*Ut,!1,er,Lt,i,n,O,{}),Ir=!1,hr=!1,Tr=!0;if(qt){for(var _r=.5*qe*Dt+tt,nn=new a.Point(-100,-100),Yr=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),yn=new Ka,On=qt.first,Qn=qt.last,oi=[],yi=On.path.length-1;yi>=1;yi--)oi.push(On.path[yi]);for(var Zi=1;Zi<Qn.path.length;Zi++)oi.push(Qn.path[Zi]);var An=2.5*_r;if(F){var si=oi.map(function(Ts){return gi(Ts,F)});oi=si.some(function(Ts){return Ts.signedDistanceFromCamera<=0})?[]:si.map(function(Ts){return Ts.point})}var xi=[];if(oi.length>0){for(var Wn=oi[0].clone(),Ti=oi[0].clone(),ri=1;ri<oi.length;ri++)Wn.x=Math.min(Wn.x,oi[ri].x),Wn.y=Math.min(Wn.y,oi[ri].y),Ti.x=Math.max(Ti.x,oi[ri].x),Ti.y=Math.max(Ti.y,oi[ri].y);xi=Wn.x>=nn.x&&Ti.x<=Yr.x&&Wn.y>=nn.y&&Ti.y<=Yr.y?[oi]:Ti.x<nn.x||Wn.x>Yr.x||Ti.y<nn.y||Wn.y>Yr.y?[]:a.clipLine([oi],nn.x,nn.y,Yr.x,Yr.y)}for(var Ii=0,Bi=xi;Ii<Bi.length;Ii+=1){var qa;yn.reset(Bi[Ii],.25*_r),qa=yn.length<=.5*_r?1:Math.ceil(yn.paddedLength/An)+1;for(var Pa=0;Pa<qa;Pa++){var yo=Pa/Math.max(qa-1,1),Ea=yn.lerp(yo),Wa=Ea.x+100,Ds=Ea.y+100;zt.push(Wa,Ds,_r,0);var xo=Wa-_r,yu=Ds-_r,xu=Wa+_r,jo=Ds+_r;if(Tr=Tr&&this.isOffscreen(xo,yu,xu,jo),hr=hr||this.isInsideGrid(xo,yu,xu,jo),!u&&this.grid.hitTestCircle(Wa,Ds,_r,Xe)&&(Ir=!0,!ue))return{circles:[],offscreen:!1,collisionDetected:Ir}}}}return{circles:!ue&&Ir||!hr?[]:zt,offscreen:Tr,collisionDetected:Ir}},is.prototype.queryRenderedSymbols=function(u){if(u.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var i=[],n=1/0,c=1/0,x=-1/0,P=-1/0,O=0,F=u;O<F.length;O+=1){var ue=F[O],Ee=new a.Point(ue.x+100,ue.y+100);n=Math.min(n,Ee.x),c=Math.min(c,Ee.y),x=Math.max(x,Ee.x),P=Math.max(P,Ee.y),i.push(Ee)}for(var Xe={},qe={},tt=0,zt=this.grid.query(n,c,x,P).concat(this.ignoredGrid.query(n,c,x,P));tt<zt.length;tt+=1){var Lt=zt[tt],Xt=Lt.key;if(Xe[Xt.bucketInstanceId]===void 0&&(Xe[Xt.bucketInstanceId]={}),!Xe[Xt.bucketInstanceId][Xt.featureIndex]){var Dt=[new a.Point(Lt.x1,Lt.y1),new a.Point(Lt.x2,Lt.y1),new a.Point(Lt.x2,Lt.y2),new a.Point(Lt.x1,Lt.y2)];a.polygonIntersectsPolygon(i,Dt)&&(Xe[Xt.bucketInstanceId][Xt.featureIndex]=!0,qe[Xt.bucketInstanceId]===void 0&&(qe[Xt.bucketInstanceId]=[]),qe[Xt.bucketInstanceId].push(Xt.featureIndex))}}return qe},is.prototype.insertCollisionBox=function(u,i,n,c,x){(i?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:c,collisionGroupID:x},u[0],u[1],u[2],u[3])},is.prototype.insertCollisionCircles=function(u,i,n,c,x){for(var P=i?this.ignoredGrid:this.grid,O={bucketInstanceId:n,featureIndex:c,collisionGroupID:x},F=0;F<u.length;F+=4)P.insertCircle(O,u[F],u[F+1],u[F+2])},is.prototype.projectAndGetPerspectiveRatio=function(u,i,n){var c=[i,n,0,1];return Ja(c,c,u),{point:new a.Point((c[0]/c[3]+1)/2*this.transform.width+100,(-c[1]/c[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/c[3]*.5}},is.prototype.isOffscreen=function(u,i,n,c){return n<100||u>=this.screenRightBoundary||c<100||i>this.screenBottomBoundary},is.prototype.isInsideGrid=function(u,i,n,c){return n>=0&&u<this.gridRightBoundary&&c>=0&&i<this.gridBottomBoundary},is.prototype.getViewportMatrix=function(){var u=a.identity([]);return a.translate(u,u,[-100,-100,0]),u};var oo=function(i,n,c,x){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?n:-n))):x&&c?1:0,this.placed=c};oo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var so=function(i,n,c,x,P){this.text=new oo(i?i.text:null,n,c,P),this.icon=new oo(i?i.icon:null,n,x,P)};so.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ys=function(i,n,c){this.text=i,this.icon=n,this.skipFade=c},Ao=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},Zl=function(i,n,c,x,P){this.bucketInstanceId=i,this.featureIndex=n,this.sourceLayerIndex=c,this.bucketIndex=x,this.tileID=P},Ks=function(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}};function _o(u,i,n,c,x){var P=a.getAnchorAlignment(u),O=-(P.horizontalAlign-.5)*i,F=-(P.verticalAlign-.5)*n,ue=a.evaluateVariableOffset(u,c);return new a.Point(O+ue[0]*x,F+ue[1]*x)}function kt(u,i,n,c,x,P){var O=u.x1,F=u.x2,ue=u.y1,Ee=u.y2,Xe=u.anchorPointX,qe=u.anchorPointY,tt=new a.Point(i,n);return c&&tt._rotate(x?P:-P),{x1:O+tt.x,y1:ue+tt.y,x2:F+tt.x,y2:Ee+tt.y,anchorPointX:Xe,anchorPointY:qe}}Ks.prototype.get=function(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){var i=++this.maxGroupID;this.collisionGroups[u]={ID:i,predicate:function(c){return c.collisionGroupID===i}}}return this.collisionGroups[u]};var De=function(i,n,c,x){this.transform=i.clone(),this.collisionIndex=new is(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new Ks(c),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}};function It(u,i,n,c,x){u.emplaceBack(i?1:0,n?1:0,c||0,x||0),u.emplaceBack(i?1:0,n?1:0,c||0,x||0),u.emplaceBack(i?1:0,n?1:0,c||0,x||0),u.emplaceBack(i?1:0,n?1:0,c||0,x||0)}De.prototype.getBucketParts=function(u,i,n,c){var x=n.getBucket(i),P=n.latestFeatureIndex;if(x&&P&&i.id===x.layerIds[0]){var O=n.collisionBoxArray,F=x.layers[0].layout,ue=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),Ee=n.tileSize/a.EXTENT,Xe=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),qe=F.get("text-pitch-alignment")==="map",tt=F.get("text-rotation-alignment")==="map",zt=$i(n,1,this.transform.zoom),Lt=ga(Xe,qe,tt,this.transform,zt),Xt=null;if(qe){var Dt=Pi(Xe,qe,tt,this.transform,zt);Xt=a.multiply([],this.transform.labelPlaneMatrix,Dt)}this.retainedQueryData[x.bucketInstanceId]=new Zl(x.bucketInstanceId,P,x.sourceLayerIndex,x.index,n.tileID);var Ut={bucket:x,layout:F,posMatrix:Xe,textLabelPlaneMatrix:Lt,labelToScreenMatrix:Xt,scale:ue,textPixelRatio:Ee,holdingForFade:n.holdingForFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(c)for(var er=0,qt=x.sortKeyRanges;er<qt.length;er+=1){var Ir=qt[er];u.push({sortKey:Ir.sortKey,symbolInstanceStart:Ir.symbolInstanceStart,symbolInstanceEnd:Ir.symbolInstanceEnd,parameters:Ut})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:Ut})}},De.prototype.attemptAnchorPlacement=function(u,i,n,c,x,P,O,F,ue,Ee,Xe,qe,tt,zt,Lt){var Xt,Dt=[qe.textOffset0,qe.textOffset1],Ut=_o(u,n,c,Dt,x),er=this.collisionIndex.placeCollisionBox(kt(i,Ut.x,Ut.y,P,O,this.transform.angle),Xe,F,ue,Ee.predicate);if(!Lt||this.collisionIndex.placeCollisionBox(kt(Lt,Ut.x,Ut.y,P,O,this.transform.angle),Xe,F,ue,Ee.predicate).box.length!==0)return er.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[qe.crossTileID]&&this.prevPlacement.placements[qe.crossTileID]&&this.prevPlacement.placements[qe.crossTileID].text&&(Xt=this.prevPlacement.variableOffsets[qe.crossTileID].anchor),this.variableOffsets[qe.crossTileID]={textOffset:Dt,width:n,height:c,anchor:u,textBoxScale:x,prevAnchor:Xt},this.markUsedJustification(tt,u,qe,zt),tt.allowVerticalPlacement&&(this.markUsedOrientation(tt,zt,qe),this.placedOrientations[qe.crossTileID]=zt),{shift:Ut,placedGlyphBoxes:er}):void 0},De.prototype.placeLayerBucketPart=function(u,i,n){var c=this,x=u.parameters,P=x.bucket,O=x.layout,F=x.posMatrix,ue=x.textLabelPlaneMatrix,Ee=x.labelToScreenMatrix,Xe=x.textPixelRatio,qe=x.holdingForFade,tt=x.collisionBoxArray,zt=x.partiallyEvaluatedTextSize,Lt=x.collisionGroup,Xt=O.get("text-optional"),Dt=O.get("icon-optional"),Ut=O.get("text-allow-overlap"),er=O.get("icon-allow-overlap"),qt=O.get("text-rotation-alignment")==="map",Ir=O.get("text-pitch-alignment")==="map",hr=O.get("icon-text-fit")!=="none",Tr=O.get("symbol-z-order")==="viewport-y",_r=Ut&&(er||!P.hasIconData()||Dt),nn=er&&(Ut||!P.hasTextData()||Xt);!P.collisionArrays&&tt&&P.deserializeCollisionBoxes(tt);var Yr=function(An,si){if(!i[An.crossTileID])if(qe)c.placements[An.crossTileID]=new Ys(!1,!1,!1);else{var xi,Wn=!1,Ti=!1,ri=!0,Ii=null,Bi={box:null,offscreen:null},qa={box:null,offscreen:null},Pa=null,yo=null,Ea=0,Wa=0,Ds=0;si.textFeatureIndex?Ea=si.textFeatureIndex:An.useRuntimeCollisionCircles&&(Ea=An.featureIndex),si.verticalTextFeatureIndex&&(Wa=si.verticalTextFeatureIndex);var xo=si.textBox;if(xo){var yu=function(Jo){var bo=a.WritingMode.horizontal;if(P.allowVerticalPlacement&&!Jo&&c.prevPlacement){var Uo=c.prevPlacement.placedOrientations[An.crossTileID];Uo&&(c.placedOrientations[An.crossTileID]=Uo,c.markUsedOrientation(P,bo=Uo,An))}return bo},xu=function(Jo,bo){if(P.allowVerticalPlacement&&An.numVerticalGlyphVertices>0&&si.verticalTextBox)for(var Uo=0,Vs=P.writingModes;Uo<Vs.length&&(Vs[Uo]===a.WritingMode.vertical?(Bi=bo(),qa=Bi):Bi=Jo(),!(Bi&&Bi.box&&Bi.box.length));Uo+=1);else Bi=Jo()};if(O.get("text-variable-anchor")){var jo=O.get("text-variable-anchor");if(c.prevPlacement&&c.prevPlacement.variableOffsets[An.crossTileID]){var Ts=c.prevPlacement.variableOffsets[An.crossTileID];jo.indexOf(Ts.anchor)>0&&(jo=jo.filter(function(Oo){return Oo!==Ts.anchor})).unshift(Ts.anchor)}var Lu=function(Jo,bo,Uo){for(var Vs=Jo.x2-Jo.x1,wl=Jo.y2-Jo.y1,Uc=An.textBoxScale,Vl=hr&&!er?bo:null,Ju={box:[],offscreen:!1},zu=Ut?2*jo.length:jo.length,Nu=0;Nu<zu;++Nu){var Gs=c.attemptAnchorPlacement(jo[Nu%jo.length],Jo,Vs,wl,Uc,qt,Ir,Xe,F,Lt,Nu>=jo.length,An,P,Uo,Vl);if(Gs&&(Ju=Gs.placedGlyphBoxes)&&Ju.box&&Ju.box.length){Wn=!0,Ii=Gs.shift;break}}return Ju};xu(function(){return Lu(xo,si.iconBox,a.WritingMode.horizontal)},function(){var Oo=si.verticalTextBox;return P.allowVerticalPlacement&&!(Bi&&Bi.box&&Bi.box.length)&&An.numVerticalGlyphVertices>0&&Oo?Lu(Oo,si.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),Bi&&(Wn=Bi.box,ri=Bi.offscreen);var ac=yu(Bi&&Bi.box);if(!Wn&&c.prevPlacement){var $u=c.prevPlacement.variableOffsets[An.crossTileID];$u&&(c.variableOffsets[An.crossTileID]=$u,c.markUsedJustification(P,$u.anchor,An,ac))}}else{var oc=function(Jo,bo){var Uo=c.collisionIndex.placeCollisionBox(Jo,Ut,Xe,F,Lt.predicate);return Uo&&Uo.box&&Uo.box.length&&(c.markUsedOrientation(P,bo,An),c.placedOrientations[An.crossTileID]=bo),Uo};xu(function(){return oc(xo,a.WritingMode.horizontal)},function(){var Oo=si.verticalTextBox;return P.allowVerticalPlacement&&An.numVerticalGlyphVertices>0&&Oo?oc(Oo,a.WritingMode.vertical):{box:null,offscreen:null}}),yu(Bi&&Bi.box&&Bi.box.length)}}if(Wn=(xi=Bi)&&xi.box&&xi.box.length>0,ri=xi&&xi.offscreen,An.useRuntimeCollisionCircles){var sc=P.text.placedSymbolArray.get(An.centerJustifiedTextSymbolIndex),Ru=a.evaluateSizeForFeature(P.textSizeData,zt,sc),dl=O.get("text-padding");Pa=c.collisionIndex.placeCollisionCircles(Ut,sc,P.lineVertexArray,P.glyphOffsetArray,Ru,F,ue,Ee,n,Ir,Lt.predicate,An.collisionCircleDiameter,dl),Wn=Ut||Pa.circles.length>0&&!Pa.collisionDetected,ri=ri&&Pa.offscreen}if(si.iconFeatureIndex&&(Ds=si.iconFeatureIndex),si.iconBox){var As=function(Jo){var bo=hr&&Ii?kt(Jo,Ii.x,Ii.y,qt,Ir,c.transform.angle):Jo;return c.collisionIndex.placeCollisionBox(bo,er,Xe,F,Lt.predicate)};Ti=qa&&qa.box&&qa.box.length&&si.verticalIconBox?(yo=As(si.verticalIconBox)).box.length>0:(yo=As(si.iconBox)).box.length>0,ri=ri&&yo.offscreen}var co=Xt||An.numHorizontalGlyphVertices===0&&An.numVerticalGlyphVertices===0,Du=Dt||An.numIconVertices===0;if(co||Du?Du?co||(Ti=Ti&&Wn):Wn=Ti&&Wn:Ti=Wn=Ti&&Wn,Wn&&xi&&xi.box&&c.collisionIndex.insertCollisionBox(xi.box,O.get("text-ignore-placement"),P.bucketInstanceId,qa&&qa.box&&Wa?Wa:Ea,Lt.ID),Ti&&yo&&c.collisionIndex.insertCollisionBox(yo.box,O.get("icon-ignore-placement"),P.bucketInstanceId,Ds,Lt.ID),Pa&&(Wn&&c.collisionIndex.insertCollisionCircles(Pa.circles,O.get("text-ignore-placement"),P.bucketInstanceId,Ea,Lt.ID),n)){var bu=P.bucketInstanceId,Mo=c.collisionCircleArrays[bu];Mo===void 0&&(Mo=c.collisionCircleArrays[bu]=new Ao);for(var Io=0;Io<Pa.circles.length;Io+=4)Mo.circles.push(Pa.circles[Io+0]),Mo.circles.push(Pa.circles[Io+1]),Mo.circles.push(Pa.circles[Io+2]),Mo.circles.push(Pa.collisionDetected?1:0)}c.placements[An.crossTileID]=new Ys(Wn||_r,Ti||nn,ri||P.justReloaded),i[An.crossTileID]=!0}};if(Tr)for(var yn=P.getSortedSymbolIndexes(this.transform.angle),On=yn.length-1;On>=0;--On){var Qn=yn[On];Yr(P.symbolInstances.get(Qn),P.collisionArrays[Qn])}else for(var oi=u.symbolInstanceStart;oi<u.symbolInstanceEnd;oi++)Yr(P.symbolInstances.get(oi),P.collisionArrays[oi]);if(n&&P.bucketInstanceId in this.collisionCircleArrays){var yi=this.collisionCircleArrays[P.bucketInstanceId];a.invert(yi.invProjMatrix,F),yi.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1},De.prototype.markUsedJustification=function(u,i,n,c){var x;x=c===a.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(i)];for(var P=0,O=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];P<O.length;P+=1){var F=O[P];F>=0&&(u.text.placedSymbolArray.get(F).crossTileID=x>=0&&F!==x?0:n.crossTileID)}},De.prototype.markUsedOrientation=function(u,i,n){for(var c=i===a.WritingMode.horizontal||i===a.WritingMode.horizontalOnly?i:0,x=i===a.WritingMode.vertical?i:0,P=0,O=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];P<O.length;P+=1)u.text.placedSymbolArray.get(O[P]).placedOrientation=c;n.verticalPlacedTextSymbolIndex&&(u.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=x)},De.prototype.commit=function(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;var i=this.prevPlacement,n=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;var c=i?i.symbolFadeChange(u):1,x=i?i.opacities:{},P=i?i.variableOffsets:{},O=i?i.placedOrientations:{};for(var F in this.placements){var ue=this.placements[F],Ee=x[F];Ee?(this.opacities[F]=new so(Ee,c,ue.text,ue.icon),n=n||ue.text!==Ee.text.placed||ue.icon!==Ee.icon.placed):(this.opacities[F]=new so(null,c,ue.text,ue.icon,ue.skipFade),n=n||ue.text||ue.icon)}for(var Xe in x){var qe=x[Xe];if(!this.opacities[Xe]){var tt=new so(qe,c,!1,!1);tt.isHidden()||(this.opacities[Xe]=tt,n=n||qe.text.placed||qe.icon.placed)}}for(var zt in P)this.variableOffsets[zt]||!this.opacities[zt]||this.opacities[zt].isHidden()||(this.variableOffsets[zt]=P[zt]);for(var Lt in O)this.placedOrientations[Lt]||!this.opacities[Lt]||this.opacities[Lt].isHidden()||(this.placedOrientations[Lt]=O[Lt]);n?this.lastPlacementChangeTime=u:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:u)},De.prototype.updateLayerOpacities=function(u,i){for(var n={},c=0,x=i;c<x.length;c+=1){var P=x[c],O=P.getBucket(u);O&&P.latestFeatureIndex&&u.id===O.layerIds[0]&&this.updateBucketOpacities(O,n,P.collisionBoxArray)}},De.prototype.updateBucketOpacities=function(u,i,n){var c=this;u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();var x=u.layers[0].layout,P=new so(null,0,!1,!1,!0),O=x.get("text-allow-overlap"),F=x.get("icon-allow-overlap"),ue=x.get("text-variable-anchor"),Ee=x.get("text-rotation-alignment")==="map",Xe=x.get("text-pitch-alignment")==="map",qe=x.get("icon-text-fit")!=="none",tt=new so(null,0,O&&(F||!u.hasIconData()||x.get("icon-optional")),F&&(O||!u.hasTextData()||x.get("text-optional")),!0);!u.collisionArrays&&n&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(n);for(var zt=function(er,qt,Ir){for(var hr=0;hr<qt/4;hr++)er.opacityVertexArray.emplaceBack(Ir)},Lt=function(er){var qt=u.symbolInstances.get(er),Ir=qt.numHorizontalGlyphVertices,hr=qt.numVerticalGlyphVertices,Tr=qt.crossTileID,_r=c.opacities[Tr];i[Tr]?_r=P:_r||(c.opacities[Tr]=_r=tt),i[Tr]=!0;var nn=qt.numIconVertices>0,Yr=c.placedOrientations[qt.crossTileID],yn=Yr===a.WritingMode.vertical,On=Yr===a.WritingMode.horizontal||Yr===a.WritingMode.horizontalOnly;if(Ir>0||hr>0){var Qn=No(_r.text);zt(u.text,Ir,yn?Vu:Qn),zt(u.text,hr,On?Vu:Qn);var oi=_r.text.isHidden();[qt.rightJustifiedTextSymbolIndex,qt.centerJustifiedTextSymbolIndex,qt.leftJustifiedTextSymbolIndex].forEach(function(Bi){Bi>=0&&(u.text.placedSymbolArray.get(Bi).hidden=oi||yn?1:0)}),qt.verticalPlacedTextSymbolIndex>=0&&(u.text.placedSymbolArray.get(qt.verticalPlacedTextSymbolIndex).hidden=oi||On?1:0);var yi=c.variableOffsets[qt.crossTileID];yi&&c.markUsedJustification(u,yi.anchor,qt,Yr);var Zi=c.placedOrientations[qt.crossTileID];Zi&&(c.markUsedJustification(u,"left",qt,Zi),c.markUsedOrientation(u,Zi,qt))}if(nn){var An=No(_r.icon),si=!(qe&&qt.verticalPlacedIconSymbolIndex&&yn);qt.placedIconSymbolIndex>=0&&(zt(u.icon,qt.numIconVertices,si?An:Vu),u.icon.placedSymbolArray.get(qt.placedIconSymbolIndex).hidden=_r.icon.isHidden()),qt.verticalPlacedIconSymbolIndex>=0&&(zt(u.icon,qt.numVerticalIconVertices,si?Vu:An),u.icon.placedSymbolArray.get(qt.verticalPlacedIconSymbolIndex).hidden=_r.icon.isHidden())}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){var xi=u.collisionArrays[er];if(xi){var Wn=new a.Point(0,0);if(xi.textBox||xi.verticalTextBox){var Ti=!0;if(ue){var ri=c.variableOffsets[Tr];ri?(Wn=_o(ri.anchor,ri.width,ri.height,ri.textOffset,ri.textBoxScale),Ee&&Wn._rotate(Xe?c.transform.angle:-c.transform.angle)):Ti=!1}xi.textBox&&It(u.textCollisionBox.collisionVertexArray,_r.text.placed,!Ti||yn,Wn.x,Wn.y),xi.verticalTextBox&&It(u.textCollisionBox.collisionVertexArray,_r.text.placed,!Ti||On,Wn.x,Wn.y)}var Ii=Boolean(!On&&xi.verticalIconBox);xi.iconBox&&It(u.iconCollisionBox.collisionVertexArray,_r.icon.placed,Ii,qe?Wn.x:0,qe?Wn.y:0),xi.verticalIconBox&&It(u.iconCollisionBox.collisionVertexArray,_r.icon.placed,!Ii,qe?Wn.x:0,qe?Wn.y:0)}}},Xt=0;Xt<u.symbolInstances.length;Xt++)Lt(Xt);if(u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){var Dt=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=Dt.invProjMatrix,u.placementViewportMatrix=Dt.viewportMatrix,u.collisionCircleArray=Dt.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}},De.prototype.symbolFadeChange=function(u){return this.fadeDuration===0?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},De.prototype.zoomAdjustment=function(u){return Math.max(0,(this.transform.zoom-u)/1.5)},De.prototype.hasTransitions=function(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration},De.prototype.stillRecent=function(u,i){var n=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*n>u},De.prototype.setStale=function(){this.stale=!0};var fr=Math.pow(2,25),tn=Math.pow(2,24),En=Math.pow(2,17),Un=Math.pow(2,16),La=Math.pow(2,9),no=Math.pow(2,8),go=Math.pow(2,1);function No(u){if(u.opacity===0&&!u.placed)return 0;if(u.opacity===1&&u.placed)return 4294967295;var i=u.placed?1:0,n=Math.floor(127*u.opacity);return n*fr+i*tn+n*En+i*Un+n*La+i*no+n*go+i}var Vu=0,Wl=function(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&i.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Wl.prototype.continuePlacement=function(u,i,n,c,x){for(var P=this._bucketParts;this._currentTileIndex<u.length;)if(i.getBucketParts(P,c,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort(function(O,F){return O.sortKey-F.sortKey}));this._currentPartIndex<P.length;)if(i.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,x())return!0;return!1};var $s=function(i,n,c,x,P,O,F){this.placement=new De(i,P,O,F),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=x,this._done=!1};$s.prototype.isDone=function(){return this._done},$s.prototype.continuePlacement=function(u,i,n){for(var c=this,x=a.browser.now(),P=function(){var Ee=a.browser.now()-x;return!c._forceFullPlacement&&Ee>2};this._currentPlacementIndex>=0;){var O=i[u[this._currentPlacementIndex]],F=this.placement.collisionIndex.transform.zoom;if(O.type==="symbol"&&(!O.minzoom||O.minzoom<=F)&&(!O.maxzoom||O.maxzoom>F)){if(this._inProgressLayer||(this._inProgressLayer=new Wl(O)),this._inProgressLayer.continuePlacement(n[O.source],this.placement,this._showCollisionBoxes,O,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},$s.prototype.commit=function(u){return this.placement.commit(u),this.placement};var Ic=512/a.EXTENT/2,Il=function(i,n,c){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=c;for(var x=0;x<n.length;x++){var P=n.get(x),O=P.key;this.indexedSymbolInstances[O]||(this.indexedSymbolInstances[O]=[]),this.indexedSymbolInstances[O].push({crossTileID:P.crossTileID,coord:this.getScaledCoordinates(P,i)})}};Il.prototype.getScaledCoordinates=function(u,i){var n=Ic/Math.pow(2,i.canonical.z-this.tileID.canonical.z);return{x:Math.floor((i.canonical.x*a.EXTENT+u.anchorX)*n),y:Math.floor((i.canonical.y*a.EXTENT+u.anchorY)*n)}},Il.prototype.findMatches=function(u,i,n){for(var c=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z),x=0;x<u.length;x++){var P=u.get(x);if(!P.crossTileID){var O=this.indexedSymbolInstances[P.key];if(O)for(var F=this.getScaledCoordinates(P,i),ue=0,Ee=O;ue<Ee.length;ue+=1){var Xe=Ee[ue];if(Math.abs(Xe.coord.x-F.x)<=c&&Math.abs(Xe.coord.y-F.y)<=c&&!n[Xe.crossTileID]){n[Xe.crossTileID]=!0,P.crossTileID=Xe.crossTileID;break}}}}};var fs=function(){this.maxCrossTileID=0};fs.prototype.generate=function(){return++this.maxCrossTileID};var zs=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};zs.prototype.handleWrapJump=function(u){var i=Math.round((u-this.lng)/360);if(i!==0)for(var n in this.indexes){var c=this.indexes[n],x={};for(var P in c){var O=c[P];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+i),x[O.tileID.key]=O}this.indexes[n]=x}this.lng=u},zs.prototype.addBucket=function(u,i,n){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(var c=0;c<i.symbolInstances.length;c++)i.symbolInstances.get(c).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]={});var x=this.usedCrossTileIDs[u.overscaledZ];for(var P in this.indexes){var O=this.indexes[P];if(Number(P)>u.overscaledZ)for(var F in O){var ue=O[F];ue.tileID.isChildOf(u)&&ue.findMatches(i.symbolInstances,u,x)}else{var Ee=O[u.scaledTo(Number(P)).key];Ee&&Ee.findMatches(i.symbolInstances,u,x)}}for(var Xe=0;Xe<i.symbolInstances.length;Xe++){var qe=i.symbolInstances.get(Xe);qe.crossTileID||(qe.crossTileID=n.generate(),x[qe.crossTileID]=!0)}return this.indexes[u.overscaledZ]===void 0&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new Il(u,i.symbolInstances,i.bucketInstanceId),!0},zs.prototype.removeBucketCrossTileIDs=function(u,i){for(var n in i.indexedSymbolInstances)for(var c=0,x=i.indexedSymbolInstances[n];c<x.length;c+=1)delete this.usedCrossTileIDs[u][x[c].crossTileID]},zs.prototype.removeStaleBuckets=function(u){var i=!1;for(var n in this.indexes){var c=this.indexes[n];for(var x in c)u[c[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,c[x]),delete c[x],i=!0)}return i};var uo=function(){this.layerIndexes={},this.crossTileIDs=new fs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};uo.prototype.addLayer=function(u,i,n){var c=this.layerIndexes[u.id];c===void 0&&(c=this.layerIndexes[u.id]=new zs);var x=!1,P={};c.handleWrapJump(n);for(var O=0,F=i;O<F.length;O+=1){var ue=F[O],Ee=ue.getBucket(u);Ee&&u.id===Ee.layerIds[0]&&(Ee.bucketInstanceId||(Ee.bucketInstanceId=++this.maxBucketInstanceId),c.addBucket(ue.tileID,Ee,this.crossTileIDs)&&(x=!0),P[Ee.bucketInstanceId]=!0)}return c.removeStaleBuckets(P)&&(x=!0),x},uo.prototype.pruneUnusedLayers=function(u){var i={};for(var n in u.forEach(function(c){i[c]=!0}),this.layerIndexes)i[n]||delete this.layerIndexes[n]};var hs=function(i,n){return a.emitValidationErrors(i,n&&n.filter(function(c){return c.identifier!=="source.canvas"}))},Js=a.pick(gn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),lu=a.pick(gn,["setCenter","setZoom","setBearing","setPitch"]),Xl=function(){var u={},i=a.styleSpec.$version;for(var n in a.styleSpec.$root){var c,x=a.styleSpec.$root[n];x.required&&(c=n==="version"?i:x.type==="array"?[]:{})!=null&&(u[n]=c)}return u}(),ya=function(u){function i(n,c){var x=this;c===void 0&&(c={}),u.call(this),this.map=n,this.dispatcher=new ct(Er(),this),this.imageManager=new Le,this.imageManager.setEventedParent(this),this.glyphManager=new Ne(n._requestManager,c.localIdeographFontFamily),this.lineAtlas=new Me(256,512),this.crossTileSymbolIndex=new uo,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var P=this;this._rtlTextPluginCallback=i.registerForPluginStateChange(function(O){P.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:O.pluginStatus,pluginURL:O.pluginURL},function(F,ue){if(a.triggerPluginCompletionEvent(F),ue&&ue.every(function(Xe){return Xe}))for(var Ee in P.sourceCaches)P.sourceCaches[Ee].reload()})}),this.on("data",function(O){if(O.dataType==="source"&&O.sourceDataType==="metadata"){var F=x.sourceCaches[O.sourceId];if(F){var ue=F.getSource();if(ue&&ue.vectorLayerIds)for(var Ee in x._layers){var Xe=x._layers[Ee];Xe.source===ue.id&&x._validateLayer(Xe)}}}})}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.loadURL=function(n,c){var x=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var P=typeof c.validate=="boolean"?c.validate:!a.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,c.accessToken);var O=this.map._requestManager.transformRequest(n,a.ResourceType.Style);this._request=a.getJSON(O,function(F,ue){x._request=null,F?x.fire(new a.ErrorEvent(F)):ue&&x._load(ue,P)})},i.prototype.loadJSON=function(n,c){var x=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){x._request=null,x._load(n,c.validate!==!1)})},i.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Xl,!1)},i.prototype._load=function(n,c){if(!c||!hs(this,a.validateStyle(n))){for(var x in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(x,n.sources[x],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var P=vn(this.stylesheet.layers);this._order=P.map(function(Ee){return Ee.id}),this._layers={},this._serializedLayers={};for(var O=0,F=P;O<F.length;O+=1){var ue=F[O];(ue=a.createStyleLayer(ue)).setEventedParent(this,{layer:{id:ue.id}}),this._layers[ue.id]=ue,this._serializedLayers[ue.id]=ue.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new lt(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},i.prototype._loadSprite=function(n){var c=this;this._spriteRequest=function(x,P,O){var F,ue,Ee,Xe=a.browser.devicePixelRatio>1?"@2x":"",qe=a.getJSON(P.transformRequest(P.normalizeSpriteURL(x,Xe,".json"),a.ResourceType.SpriteJSON),function(Lt,Xt){qe=null,Ee||(Ee=Lt,F=Xt,zt())}),tt=a.getImage(P.transformRequest(P.normalizeSpriteURL(x,Xe,".png"),a.ResourceType.SpriteImage),function(Lt,Xt){tt=null,Ee||(Ee=Lt,ue=Xt,zt())});function zt(){if(Ee)O(Ee);else if(F&&ue){var Lt=a.browser.getImageData(ue),Xt={};for(var Dt in F){var Ut=F[Dt],er=Ut.width,qt=Ut.height,Ir=Ut.x,hr=Ut.y,Tr=Ut.sdf,_r=Ut.pixelRatio,nn=Ut.stretchX,Yr=Ut.stretchY,yn=Ut.content,On=new a.RGBAImage({width:er,height:qt});a.RGBAImage.copy(Lt,On,{x:Ir,y:hr},{x:0,y:0},{width:er,height:qt}),Xt[Dt]={data:On,pixelRatio:_r,sdf:Tr,stretchX:nn,stretchY:Yr,content:yn}}O(null,Xt)}}return{cancel:function(){qe&&(qe.cancel(),qe=null),tt&&(tt.cancel(),tt=null)}}}(n,this.map._requestManager,function(x,P){if(c._spriteRequest=null,x)c.fire(new a.ErrorEvent(x));else if(P)for(var O in P)c.imageManager.addImage(O,P[O]);c.imageManager.setLoaded(!0),c._availableImages=c.imageManager.listImages(),c.dispatcher.broadcast("setImages",c._availableImages),c.fire(new a.Event("data",{dataType:"style"}))})},i.prototype._validateLayer=function(n){var c=this.sourceCaches[n.source];if(c){var x=n.sourceLayer;if(x){var P=c.getSource();(P.type==="geojson"||P.vectorLayerIds&&P.vectorLayerIds.indexOf(x)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+x+'" does not exist on source "'+P.id+'" as specified by style layer "'+n.id+'"')))}}},i.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()},i.prototype._serializeLayers=function(n){for(var c=[],x=0,P=n;x<P.length;x+=1){var O=this._layers[P[x]];O.type!=="custom"&&c.push(O.serialize())}return c},i.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(var c in this._layers)if(this._layers[c].hasTransition())return!0;return!1},i.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},i.prototype.update=function(n){if(this._loaded){var c=this._changed;if(this._changed){var x=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);for(var O in(x.length||P.length)&&this._updateWorkerLayers(x,P),this._updatedSources){var F=this._updatedSources[O];F==="reload"?this._reloadSource(O):F==="clear"&&this._clearSource(O)}for(var ue in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[ue].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}var Ee={};for(var Xe in this.sourceCaches){var qe=this.sourceCaches[Xe];Ee[Xe]=qe.used,qe.used=!1}for(var tt=0,zt=this._order;tt<zt.length;tt+=1){var Lt=this._layers[zt[tt]];Lt.recalculate(n,this._availableImages),!Lt.isHidden(n.zoom)&&Lt.source&&(this.sourceCaches[Lt.source].used=!0)}for(var Xt in Ee){var Dt=this.sourceCaches[Xt];Ee[Xt]!==Dt.used&&Dt.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Xt}))}this.light.recalculate(n),this.z=n.zoom,c&&this.fire(new a.Event("data",{dataType:"style"}))}},i.prototype._updateTilesForChangedImages=function(){var n=Object.keys(this._changedImages);if(n.length){for(var c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}},i.prototype._updateWorkerLayers=function(n,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:c})},i.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},i.prototype.setState=function(n){var c=this;if(this._checkLoaded(),hs(this,a.validateStyle(n)))return!1;(n=a.clone$1(n)).layers=vn(n.layers);var x=function(O,F){if(!O)return[{command:gn.setStyle,args:[F]}];var ue=[];try{if(!a.deepEqual(O.version,F.version))return[{command:gn.setStyle,args:[F]}];a.deepEqual(O.center,F.center)||ue.push({command:gn.setCenter,args:[F.center]}),a.deepEqual(O.zoom,F.zoom)||ue.push({command:gn.setZoom,args:[F.zoom]}),a.deepEqual(O.bearing,F.bearing)||ue.push({command:gn.setBearing,args:[F.bearing]}),a.deepEqual(O.pitch,F.pitch)||ue.push({command:gn.setPitch,args:[F.pitch]}),a.deepEqual(O.sprite,F.sprite)||ue.push({command:gn.setSprite,args:[F.sprite]}),a.deepEqual(O.glyphs,F.glyphs)||ue.push({command:gn.setGlyphs,args:[F.glyphs]}),a.deepEqual(O.transition,F.transition)||ue.push({command:gn.setTransition,args:[F.transition]}),a.deepEqual(O.light,F.light)||ue.push({command:gn.setLight,args:[F.light]});var Ee={},Xe=[];(function(tt,zt,Lt,Xt){var Dt;for(Dt in zt=zt||{},tt=tt||{})tt.hasOwnProperty(Dt)&&(zt.hasOwnProperty(Dt)||$r(Dt,Lt,Xt));for(Dt in zt)zt.hasOwnProperty(Dt)&&(tt.hasOwnProperty(Dt)?a.deepEqual(tt[Dt],zt[Dt])||(tt[Dt].type==="geojson"&&zt[Dt].type==="geojson"&&Xi(tt,zt,Dt)?Lt.push({command:gn.setGeoJSONSourceData,args:[Dt,zt[Dt].data]}):Mn(Dt,zt,Lt,Xt)):Ar(Dt,zt,Lt))})(O.sources,F.sources,Xe,Ee);var qe=[];O.layers&&O.layers.forEach(function(tt){Ee[tt.source]?ue.push({command:gn.removeLayer,args:[tt.id]}):qe.push(tt)}),ue=ue.concat(Xe),function(tt,zt,Lt){zt=zt||[];var Xt,Dt,Ut,er,qt,Ir,hr,Tr=(tt=tt||[]).map(wi),_r=zt.map(wi),nn=tt.reduce(Di,{}),Yr=zt.reduce(Di,{}),yn=Tr.slice(),On=Object.create(null);for(Xt=0,Dt=0;Xt<Tr.length;Xt++)Yr.hasOwnProperty(Ut=Tr[Xt])?Dt++:(Lt.push({command:gn.removeLayer,args:[Ut]}),yn.splice(yn.indexOf(Ut,Dt),1));for(Xt=0,Dt=0;Xt<_r.length;Xt++)yn[yn.length-1-Xt]!==(Ut=_r[_r.length-1-Xt])&&(nn.hasOwnProperty(Ut)?(Lt.push({command:gn.removeLayer,args:[Ut]}),yn.splice(yn.lastIndexOf(Ut,yn.length-Dt),1)):Dt++,Lt.push({command:gn.addLayer,args:[Yr[Ut],Ir=yn[yn.length-Xt]]}),yn.splice(yn.length-Xt,0,Ut),On[Ut]=!0);for(Xt=0;Xt<_r.length;Xt++)if(er=nn[Ut=_r[Xt]],qt=Yr[Ut],!On[Ut]&&!a.deepEqual(er,qt))if(a.deepEqual(er.source,qt.source)&&a.deepEqual(er["source-layer"],qt["source-layer"])&&a.deepEqual(er.type,qt.type)){for(hr in vi(er.layout,qt.layout,Lt,Ut,null,gn.setLayoutProperty),vi(er.paint,qt.paint,Lt,Ut,null,gn.setPaintProperty),a.deepEqual(er.filter,qt.filter)||Lt.push({command:gn.setFilter,args:[Ut,qt.filter]}),a.deepEqual(er.minzoom,qt.minzoom)&&a.deepEqual(er.maxzoom,qt.maxzoom)||Lt.push({command:gn.setLayerZoomRange,args:[Ut,qt.minzoom,qt.maxzoom]}),er)er.hasOwnProperty(hr)&&hr!=="layout"&&hr!=="paint"&&hr!=="filter"&&hr!=="metadata"&&hr!=="minzoom"&&hr!=="maxzoom"&&(hr.indexOf("paint.")===0?vi(er[hr],qt[hr],Lt,Ut,hr.slice(6),gn.setPaintProperty):a.deepEqual(er[hr],qt[hr])||Lt.push({command:gn.setLayerProperty,args:[Ut,hr,qt[hr]]}));for(hr in qt)qt.hasOwnProperty(hr)&&!er.hasOwnProperty(hr)&&hr!=="layout"&&hr!=="paint"&&hr!=="filter"&&hr!=="metadata"&&hr!=="minzoom"&&hr!=="maxzoom"&&(hr.indexOf("paint.")===0?vi(er[hr],qt[hr],Lt,Ut,hr.slice(6),gn.setPaintProperty):a.deepEqual(er[hr],qt[hr])||Lt.push({command:gn.setLayerProperty,args:[Ut,hr,qt[hr]]}))}else Lt.push({command:gn.removeLayer,args:[Ut]}),Ir=yn[yn.lastIndexOf(Ut)+1],Lt.push({command:gn.addLayer,args:[qt,Ir]})}(qe,F.layers,ue)}catch(tt){console.warn("Unable to compute style diff:",tt),ue=[{command:gn.setStyle,args:[F]}]}return ue}(this.serialize(),n).filter(function(O){return!(O.command in lu)});if(x.length===0)return!1;var P=x.filter(function(O){return!(O.command in Js)});if(P.length>0)throw new Error("Unimplemented: "+P.map(function(O){return O.command}).join(", ")+".");return x.forEach(function(O){O.command!=="setTransition"&&c[O.command].apply(c,O.args)}),this.stylesheet=n,!0},i.prototype.addImage=function(n,c){if(this.getImage(n))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,c),this._afterImageUpdated(n)},i.prototype.updateImage=function(n,c){this.imageManager.updateImage(n,c)},i.prototype.getImage=function(n){return this.imageManager.getImage(n)},i.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)},i.prototype._afterImageUpdated=function(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},i.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},i.prototype.addSource=function(n,c,x){var P=this;if(x===void 0&&(x={}),this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(c).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(a.validateStyle.source,"sources."+n,c,null,x))){this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);var O=this.sourceCaches[n]=new Pt(n,c,this.dispatcher);O.style=this,O.setEventedParent(this,function(){return{isSourceLoaded:P.loaded(),source:O.serialize(),sourceId:n}}),O.onAdd(this.map),this._changed=!0}},i.prototype.removeSource=function(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(var c in this._layers)if(this._layers[c].source===n)return this.fire(new a.ErrorEvent(new Error('Source "'+n+'" cannot be removed while layer "'+c+'" is using it.')));var x=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],x.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),x.setEventedParent(null),x.clearTiles(),x.onRemove&&x.onRemove(this.map),this._changed=!0},i.prototype.setGeoJSONSourceData=function(n,c){this._checkLoaded(),this.sourceCaches[n].getSource().setData(c),this._changed=!0},i.prototype.getSource=function(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()},i.prototype.addLayer=function(n,c,x){x===void 0&&(x={}),this._checkLoaded();var P=n.id;if(this.getLayer(P))this.fire(new a.ErrorEvent(new Error('Layer with id "'+P+'" already exists on this map')));else{var O;if(n.type==="custom"){if(hs(this,a.validateCustomStyleLayer(n)))return;O=a.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(P,n.source),n=a.clone$1(n),n=a.extend(n,{source:P})),this._validate(a.validateStyle.layer,"layers."+P,n,{arrayIndex:-1},x))return;O=a.createStyleLayer(n),this._validateLayer(O),O.setEventedParent(this,{layer:{id:P}}),this._serializedLayers[O.id]=O.serialize()}var F=c?this._order.indexOf(c):this._order.length;if(c&&F===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.')));else{if(this._order.splice(F,0,P),this._layerOrderChanged=!0,this._layers[P]=O,this._removedLayers[P]&&O.source&&O.type!=="custom"){var ue=this._removedLayers[P];delete this._removedLayers[P],ue.type!==O.type?this._updatedSources[O.source]="clear":(this._updatedSources[O.source]="reload",this.sourceCaches[O.source].pause())}this._updateLayer(O),O.onAdd&&O.onAdd(this.map)}}},i.prototype.moveLayer=function(n,c){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==c){var x=this._order.indexOf(n);this._order.splice(x,1);var P=c?this._order.indexOf(c):this._order.length;c&&P===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.'))):(this._order.splice(P,0,n),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},i.prototype.removeLayer=function(n){this._checkLoaded();var c=this._layers[n];if(c){c.setEventedParent(null);var x=this._order.indexOf(n);this._order.splice(x,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=c,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],c.onRemove&&c.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},i.prototype.getLayer=function(n){return this._layers[n]},i.prototype.hasLayer=function(n){return n in this._layers},i.prototype.setLayerZoomRange=function(n,c,x){this._checkLoaded();var P=this.getLayer(n);P?P.minzoom===c&&P.maxzoom===x||(c!=null&&(P.minzoom=c),x!=null&&(P.maxzoom=x),this._updateLayer(P)):this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},i.prototype.setFilter=function(n,c,x){x===void 0&&(x={}),this._checkLoaded();var P=this.getLayer(n);if(P){if(!a.deepEqual(P.filter,c))return c==null?(P.filter=void 0,void this._updateLayer(P)):void(this._validate(a.validateStyle.filter,"layers."+P.id+".filter",c,null,x)||(P.filter=a.clone$1(c),this._updateLayer(P)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},i.prototype.getFilter=function(n){return a.clone$1(this.getLayer(n).filter)},i.prototype.setLayoutProperty=function(n,c,x,P){P===void 0&&(P={}),this._checkLoaded();var O=this.getLayer(n);O?a.deepEqual(O.getLayoutProperty(c),x)||(O.setLayoutProperty(c,x,P),this._updateLayer(O)):this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getLayoutProperty=function(n,c){var x=this.getLayer(n);if(x)return x.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style.")))},i.prototype.setPaintProperty=function(n,c,x,P){P===void 0&&(P={}),this._checkLoaded();var O=this.getLayer(n);O?a.deepEqual(O.getPaintProperty(c),x)||(O.setPaintProperty(c,x,P)&&this._updateLayer(O),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getPaintProperty=function(n,c){return this.getLayer(n).getPaintProperty(c)},i.prototype.setFeatureState=function(n,c){this._checkLoaded();var x=n.source,P=n.sourceLayer,O=this.sourceCaches[x];if(O!==void 0){var F=O.getSource().type;F==="geojson"&&P?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):F!=="vector"||P?(n.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),O.setFeatureState(P,n.id,c)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+x+"' does not exist in the map's style.")))},i.prototype.removeFeatureState=function(n,c){this._checkLoaded();var x=n.source,P=this.sourceCaches[x];if(P!==void 0){var O=P.getSource().type,F=O==="vector"?n.sourceLayer:void 0;O!=="vector"||F?c&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):P.removeFeatureState(F,n.id,c):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+x+"' does not exist in the map's style.")))},i.prototype.getFeatureState=function(n){this._checkLoaded();var c=n.source,x=n.sourceLayer,P=this.sourceCaches[c];if(P!==void 0){if(P.getSource().type!=="vector"||x)return n.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),P.getFeatureState(x,n.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+c+"' does not exist in the map's style.")))},i.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},i.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(n){return n.serialize()}),layers:this._serializeLayers(this._order)},function(n){return n!==void 0})},i.prototype._updateLayer=function(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0},i.prototype._flattenAndSortRenderedFeatures=function(n){for(var c=this,x=function(Yr){return c._layers[Yr].type==="fill-extrusion"},P={},O=[],F=this._order.length-1;F>=0;F--){var ue=this._order[F];if(x(ue)){P[ue]=F;for(var Ee=0,Xe=n;Ee<Xe.length;Ee+=1){var qe=Xe[Ee][ue];if(qe)for(var tt=0,zt=qe;tt<zt.length;tt+=1)O.push(zt[tt])}}}O.sort(function(nn,Yr){return Yr.intersectionZ-nn.intersectionZ});for(var Lt=[],Xt=this._order.length-1;Xt>=0;Xt--){var Dt=this._order[Xt];if(x(Dt))for(var Ut=O.length-1;Ut>=0;Ut--){var er=O[Ut].feature;if(P[er.layer.id]<Xt)break;Lt.push(er),O.pop()}else for(var qt=0,Ir=n;qt<Ir.length;qt+=1){var hr=Ir[qt][Dt];if(hr)for(var Tr=0,_r=hr;Tr<_r.length;Tr+=1)Lt.push(_r[Tr].feature)}}return Lt},i.prototype.queryRenderedFeatures=function(n,c,x){c&&c.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);var P={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var O=0,F=c.layers;O<F.length;O+=1){var ue=F[O],Ee=this._layers[ue];if(!Ee)return this.fire(new a.ErrorEvent(new Error("The layer '"+ue+"' does not exist in the map's style and cannot be queried for features."))),[];P[Ee.source]=!0}}var Xe=[];for(var qe in c.availableImages=this._availableImages,this.sourceCaches)c.layers&&!P[qe]||Xe.push(_t(this.sourceCaches[qe],this._layers,this._serializedLayers,n,c,x));return this.placement&&Xe.push(function(tt,zt,Lt,Xt,Dt,Ut,er){for(var qt={},Ir=Ut.queryRenderedSymbols(Xt),hr=[],Tr=0,_r=Object.keys(Ir).map(Number);Tr<_r.length;Tr+=1)hr.push(er[_r[Tr]]);hr.sort(ge);for(var nn=function(){var yi=yn[Yr],Zi=yi.featureIndex.lookupSymbolFeatures(Ir[yi.bucketInstanceId],zt,yi.bucketIndex,yi.sourceLayerIndex,Dt.filter,Dt.layers,Dt.availableImages,tt);for(var An in Zi){var si=qt[An]=qt[An]||[],xi=Zi[An];xi.sort(function(ri,Ii){var Bi=yi.featureSortOrder;if(Bi){var qa=Bi.indexOf(ri.featureIndex);return Bi.indexOf(Ii.featureIndex)-qa}return Ii.featureIndex-ri.featureIndex});for(var Wn=0,Ti=xi;Wn<Ti.length;Wn+=1)si.push(Ti[Wn])}},Yr=0,yn=hr;Yr<yn.length;Yr+=1)nn();var On=function(yi){qt[yi].forEach(function(Zi){var An=Zi.feature,si=Lt[tt[yi].source].getFeatureState(An.layer["source-layer"],An.id);An.source=An.layer.source,An.layer["source-layer"]&&(An.sourceLayer=An.layer["source-layer"]),An.state=si})};for(var Qn in qt)On(Qn);return qt}(this._layers,this._serializedLayers,this.sourceCaches,n,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Xe)},i.prototype.querySourceFeatures=function(n,c){c&&c.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);var x=this.sourceCaches[n];return x?function(P,O){for(var F=P.getRenderableIds().map(function(zt){return P.getTileByID(zt)}),ue=[],Ee={},Xe=0;Xe<F.length;Xe++){var qe=F[Xe],tt=qe.tileID.canonical.key;Ee[tt]||(Ee[tt]=!0,qe.querySourceFeatures(ue,O))}return ue}(x,c):[]},i.prototype.addSourceType=function(n,c,x){return i.getSourceType(n)?x(new Error('A source type called "'+n+'" already exists.')):(i.setSourceType(n,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:c.workerSourceURL},x):x(null,null))},i.prototype.getLight=function(){return this.light.getLight()},i.prototype.setLight=function(n,c){c===void 0&&(c={}),this._checkLoaded();var x=this.light.getLight(),P=!1;for(var O in n)if(!a.deepEqual(n[O],x[O])){P=!0;break}if(P){var F={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,c),this.light.updateTransitions(F)}},i.prototype._validate=function(n,c,x,P,O){return O===void 0&&(O={}),(!O||O.validate!==!1)&&hs(this,n.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:x,styleSpec:a.styleSpec},P)))},i.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var c in this.sourceCaches)this.sourceCaches[c].clearTiles(),this.sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},i.prototype._clearSource=function(n){this.sourceCaches[n].clearTiles()},i.prototype._reloadSource=function(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()},i.prototype._updateSources=function(n){for(var c in this.sourceCaches)this.sourceCaches[c].update(n)},i.prototype._generateCollisionBoxes=function(){for(var n in this.sourceCaches)this._reloadSource(n)},i.prototype._updatePlacement=function(n,c,x,P,O){O===void 0&&(O=!1);for(var F=!1,ue=!1,Ee={},Xe=0,qe=this._order;Xe<qe.length;Xe+=1){var tt=this._layers[qe[Xe]];if(tt.type==="symbol"){if(!Ee[tt.source]){var zt=this.sourceCaches[tt.source];Ee[tt.source]=zt.getRenderableIds(!0).map(function(er){return zt.getTileByID(er)}).sort(function(er,qt){return qt.tileID.overscaledZ-er.tileID.overscaledZ||(er.tileID.isLessThan(qt.tileID)?-1:1)})}var Lt=this.crossTileSymbolIndex.addLayer(tt,Ee[tt.source],n.center.lng);F=F||Lt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((O=O||this._layerOrderChanged||x===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),n.zoom))&&(this.pauseablePlacement=new $s(n,this._order,O,c,x,P,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ee),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),ue=!0),F&&this.pauseablePlacement.placement.setStale()),ue||F)for(var Xt=0,Dt=this._order;Xt<Dt.length;Xt+=1){var Ut=this._layers[Dt[Xt]];Ut.type==="symbol"&&this.placement.updateLayerOpacities(Ut,Ee[Ut.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},i.prototype._releaseSymbolFadeTiles=function(){for(var n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()},i.prototype.getImages=function(n,c,x){this.imageManager.getImages(c.icons,x),this._updateTilesForChangedImages();var P=this.sourceCaches[c.source];P&&P.setDependencies(c.tileID.key,c.type,c.icons)},i.prototype.getGlyphs=function(n,c,x){this.glyphManager.getGlyphs(c.stacks,x)},i.prototype.getResource=function(n,c,x){return a.makeRequest(c,x)},i}(a.Evented);ya.getSourceType=function(u){return rt[u]},ya.setSourceType=function(u,i){rt[u]=i},ya.registerForPluginStateChange=a.registerForPluginStateChange;var Na=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),ml=da(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Ns=da(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ds=da(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Mt=da(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),rr=da("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Pr=da(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Vn=da(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ji=da("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Ra=da("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Ha=da("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Qi=da(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),xa=da(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Co=da(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Fs=da(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),ha=da(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Yl=da(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),cu=da(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),ws=da(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),gl=da(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),fu=da(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Gu=da(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Qs=da(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),rl=da(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),hu=da(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),pc=da(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Pf=da(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function da(u,i){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=i.match(/attribute ([\w]+) ([\w]+)/g),x=u.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),O=P?P.concat(x):x,F={};return{fragmentSource:u=u.replace(n,function(ue,Ee,Xe,qe,tt){return F[tt]=!0,Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+tt+`
varying `+Xe+" "+qe+" "+tt+`;
#else
uniform `+Xe+" "+qe+" u_"+tt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+tt+`
    `+Xe+" "+qe+" "+tt+" = u_"+tt+`;
#endif
`}),vertexSource:i=i.replace(n,function(ue,Ee,Xe,qe,tt){var zt=qe==="float"?"vec2":"vec4",Lt=tt.match(/color/)?"color":zt;return F[tt]?Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+tt+`
uniform lowp float u_`+tt+`_t;
attribute `+Xe+" "+zt+" a_"+tt+`;
varying `+Xe+" "+qe+" "+tt+`;
#else
uniform `+Xe+" "+qe+" u_"+tt+`;
#endif
`:Lt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+tt+`
    `+tt+" = a_"+tt+`;
#else
    `+Xe+" "+qe+" "+tt+" = u_"+tt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+tt+`
    `+tt+" = unpack_mix_"+Lt+"(a_"+tt+", u_"+tt+`_t);
#else
    `+Xe+" "+qe+" "+tt+" = u_"+tt+`;
#endif
`:Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+tt+`
uniform lowp float u_`+tt+`_t;
attribute `+Xe+" "+zt+" a_"+tt+`;
#else
uniform `+Xe+" "+qe+" u_"+tt+`;
#endif
`:Lt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+tt+`
    `+Xe+" "+qe+" "+tt+" = a_"+tt+`;
#else
    `+Xe+" "+qe+" "+tt+" = u_"+tt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+tt+`
    `+Xe+" "+qe+" "+tt+" = unpack_mix_"+Lt+"(a_"+tt+", u_"+tt+`_t);
#else
    `+Xe+" "+qe+" "+tt+" = u_"+tt+`;
#endif
`}),staticAttributes:c,staticUniforms:O}}var Oc=Object.freeze({__proto__:null,prelude:ml,background:Ns,backgroundPattern:ds,circle:Mt,clippingMask:rr,heatmap:Pr,heatmapTexture:Vn,collisionBox:Ji,collisionCircle:Ra,debug:Ha,fill:Qi,fillOutline:xa,fillOutlinePattern:Co,fillPattern:Fs,fillExtrusion:ha,fillExtrusionPattern:Yl,hillshadePrepare:cu,hillshade:ws,line:gl,lineGradient:fu,linePattern:Gu,lineSDF:Qs,raster:rl,symbolIcon:hu,symbolSDF:pc,symbolTextAndIcon:Pf}),vc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function qc(u){for(var i=[],n=0;n<u.length;n++)if(u[n]!==null){var c=u[n].split(" ");i.push(c.pop())}return i}vc.prototype.bind=function(u,i,n,c,x,P,O,F){this.context=u;for(var ue=this.boundPaintVertexBuffers.length!==c.length,Ee=0;!ue&&Ee<c.length;Ee++)this.boundPaintVertexBuffers[Ee]!==c[Ee]&&(ue=!0);u.extVertexArrayObject&&this.vao&&this.boundProgram===i&&this.boundLayoutVertexBuffer===n&&!ue&&this.boundIndexBuffer===x&&this.boundVertexOffset===P&&this.boundDynamicVertexBuffer===O&&this.boundDynamicVertexBuffer2===F?(u.bindVertexArrayOES.set(this.vao),O&&O.bind(),x&&x.dynamicDraw&&x.bind(),F&&F.bind()):this.freshBind(i,n,c,x,P,O,F)},vc.prototype.freshBind=function(u,i,n,c,x,P,O){var F,ue=u.numAttributes,Ee=this.context,Xe=Ee.gl;if(Ee.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ee.extVertexArrayObject.createVertexArrayOES(),Ee.bindVertexArrayOES.set(this.vao),F=0,this.boundProgram=u,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=c,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=O;else{F=Ee.currentNumAttributes||0;for(var qe=ue;qe<F;qe++)Xe.disableVertexAttribArray(qe)}i.enableAttributes(Xe,u);for(var tt=0,zt=n;tt<zt.length;tt+=1)zt[tt].enableAttributes(Xe,u);P&&P.enableAttributes(Xe,u),O&&O.enableAttributes(Xe,u),i.bind(),i.setVertexAttribPointers(Xe,u,x);for(var Lt=0,Xt=n;Lt<Xt.length;Lt+=1){var Dt=Xt[Lt];Dt.bind(),Dt.setVertexAttribPointers(Xe,u,x)}P&&(P.bind(),P.setVertexAttribPointers(Xe,u,x)),c&&c.bind(),O&&(O.bind(),O.setVertexAttribPointers(Xe,u,x)),Ee.currentNumAttributes=ue},vc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var ef=function(i,n,c,x,P,O){var F=i.gl;this.program=F.createProgram();for(var ue=qc(c.staticAttributes),Ee=x?x.getBinderAttributes():[],Xe=ue.concat(Ee),qe=c.staticUniforms?qc(c.staticUniforms):[],tt=x?x.getBinderUniforms():[],zt=[],Lt=0,Xt=qe.concat(tt);Lt<Xt.length;Lt+=1){var Dt=Xt[Lt];zt.indexOf(Dt)<0&&zt.push(Dt)}var Ut=x?x.defines():[];O&&Ut.push("#define OVERDRAW_INSPECTOR;");var er=Ut.concat(ml.fragmentSource,c.fragmentSource).join(`
`),qt=Ut.concat(ml.vertexSource,c.vertexSource).join(`
`),Ir=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())this.failedToCreate=!0;else{F.shaderSource(Ir,er),F.compileShader(Ir),F.attachShader(this.program,Ir);var hr=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())this.failedToCreate=!0;else{F.shaderSource(hr,qt),F.compileShader(hr),F.attachShader(this.program,hr),this.attributes={};var Tr={};this.numAttributes=Xe.length;for(var _r=0;_r<this.numAttributes;_r++)Xe[_r]&&(F.bindAttribLocation(this.program,_r,Xe[_r]),this.attributes[Xe[_r]]=_r);F.linkProgram(this.program),F.deleteShader(hr),F.deleteShader(Ir);for(var nn=0;nn<zt.length;nn++){var Yr=zt[nn];if(Yr&&!Tr[Yr]){var yn=F.getUniformLocation(this.program,Yr);yn&&(Tr[Yr]=yn)}}this.fixedUniforms=P(i,Tr),this.binderUniforms=x?x.getUniforms(i,Tr):[]}}};function tf(u,i,n){var c=1/$i(n,1,i.transform.tileZoom),x=Math.pow(2,n.tileID.overscaledZ),P=n.tileSize*Math.pow(2,i.transform.tileZoom)/x,O=P*(n.tileID.canonical.x+n.tileID.wrap*x),F=P*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[c,u.fromScale,u.toScale],u_fade:u.t,u_pixel_coord_upper:[O>>16,F>>16],u_pixel_coord_lower:[65535&O,65535&F]}}ef.prototype.draw=function(u,i,n,c,x,P,O,F,ue,Ee,Xe,qe,tt,zt,Lt,Xt){var Dt,Ut=u.gl;if(!this.failedToCreate){for(var er in u.program.set(this.program),u.setDepthMode(n),u.setStencilMode(c),u.setColorMode(x),u.setCullFace(P),this.fixedUniforms)this.fixedUniforms[er].set(O[er]);zt&&zt.setUniforms(u,this.binderUniforms,qe,{zoom:tt});for(var qt=(Dt={},Dt[Ut.LINES]=2,Dt[Ut.TRIANGLES]=3,Dt[Ut.LINE_STRIP]=1,Dt)[i],Ir=0,hr=Xe.get();Ir<hr.length;Ir+=1){var Tr=hr[Ir],_r=Tr.vaos||(Tr.vaos={});(_r[F]||(_r[F]=new vc)).bind(u,this,ue,zt?zt.getPaintVertexBuffers():[],Ee,Tr.vertexOffset,Lt,Xt),Ut.drawElements(i,Tr.primitiveLength*qt,Ut.UNSIGNED_SHORT,Tr.primitiveOffset*qt*2)}}};var Qa=function(i,n,c,x){var P=n.style.light,O=P.properties.get("position"),F=[O.x,O.y,O.z],ue=a.create$1();P.properties.get("anchor")==="viewport"&&a.fromRotation(ue,-n.transform.angle),a.transformMat3(F,F,ue);var Ee=P.properties.get("color");return{u_matrix:i,u_lightpos:F,u_lightintensity:P.properties.get("intensity"),u_lightcolor:[Ee.r,Ee.g,Ee.b],u_vertical_gradient:+c,u_opacity:x}},Au=function(i,n,c,x,P,O,F){return a.extend(Qa(i,n,c,x),tf(O,n,F),{u_height_factor:-Math.pow(2,P.overscaledZ)/F.tileSize/8})},qs=function(i){return{u_matrix:i}},ps=function(i,n,c,x){return a.extend(qs(i),tf(c,n,x))},Lc=function(i,n){return{u_matrix:i,u_world:n}},mc=function(i,n,c,x,P){return a.extend(ps(i,n,c,x),{u_world:P})},yl=function(i,n,c,x){var P,O,F=i.transform;if(x.paint.get("circle-pitch-alignment")==="map"){var ue=$i(c,1,F.zoom);P=!0,O=[ue,ue]}else P=!1,O=F.pixelsToGLUnits;return{u_camera_to_center_distance:F.cameraToCenterDistance,u_scale_with_map:+(x.paint.get("circle-pitch-scale")==="map"),u_matrix:i.translatePosMatrix(n.posMatrix,c,x.paint.get("circle-translate"),x.paint.get("circle-translate-anchor")),u_pitch_with_map:+P,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:O}},nl=function(i,n,c){var x=$i(c,1,n.zoom),P=Math.pow(2,n.zoom-c.tileID.overscaledZ),O=c.tileID.overscaleFactor();return{u_matrix:i,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:x,u_extrude_scale:[n.pixelsToGLUnits[0]/(x*P),n.pixelsToGLUnits[1]/(x*P)],u_overscale_factor:O}},gc=function(i,n,c){return{u_matrix:i,u_inv_matrix:n,u_camera_to_center_distance:c.cameraToCenterDistance,u_viewport_size:[c.width,c.height]}},eu=function(i,n,c){return c===void 0&&(c=1),{u_matrix:i,u_color:n,u_overlay:0,u_overlay_scale:c}},Hu=function(i){return{u_matrix:i}},Rc=function(i,n,c,x){return{u_matrix:i,u_extrude_scale:$i(n,1,c),u_intensity:x}},Kl=function(i,n,c){var x=i.transform;return{u_matrix:zc(i,n,c),u_ratio:1/$i(n,1,x.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},wa=function(i,n,c,x){return a.extend(Kl(i,n,c),{u_image:0,u_image_height:x})},Dc=function(i,n,c,x){var P=i.transform,O=yc(n,P);return{u_matrix:zc(i,n,c),u_texsize:n.imageAtlasTexture.size,u_ratio:1/$i(n,1,P.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[O,x.fromScale,x.toScale],u_fade:x.t,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]]}},Mf=function(i,n,c,x,P){var O=i.lineAtlas,F=yc(n,i.transform),ue=c.layout.get("line-cap")==="round",Ee=O.getDash(x.from,ue),Xe=O.getDash(x.to,ue),qe=Ee.width*P.fromScale,tt=Xe.width*P.toScale;return a.extend(Kl(i,n,c),{u_patternscale_a:[F/qe,-Ee.height/2],u_patternscale_b:[F/tt,-Xe.height/2],u_sdfgamma:O.width/(256*Math.min(qe,tt)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ee.y,u_tex_y_b:Xe.y,u_mix:P.t})};function yc(u,i){return 1/$i(u,1,i.tileZoom)}function zc(u,i,n){return u.translatePosMatrix(i.tileID.posMatrix,i,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var $l=function(i,n,c,x,P){return{u_matrix:i,u_tl_parent:n,u_scale_parent:c,u_buffer_scale:1,u_fade_t:x.mix,u_opacity:x.opacity*P.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:P.paint.get("raster-brightness-min"),u_brightness_high:P.paint.get("raster-brightness-max"),u_saturation_factor:(F=P.paint.get("raster-saturation"),F>0?1-1/(1.001-F):-F),u_contrast_factor:(O=P.paint.get("raster-contrast"),O>0?1/(1-O):1+O),u_spin_weights:Zu(P.paint.get("raster-hue-rotate"))};var O,F};function Zu(u){u*=Math.PI/180;var i=Math.sin(u),n=Math.cos(u);return[(2*n+1)/3,(-Math.sqrt(3)*i-n+1)/3,(Math.sqrt(3)*i-n+1)/3]}var _u,Ol=function(i,n,c,x,P,O,F,ue,Ee,Xe){var qe=P.transform;return{u_is_size_zoom_constant:+(i==="constant"||i==="source"),u_is_size_feature_constant:+(i==="constant"||i==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:qe.cameraToCenterDistance,u_pitch:qe.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:qe.width/qe.height,u_fade_change:P.options.fadeDuration?P.symbolFadeChange:1,u_matrix:O,u_label_plane_matrix:F,u_coord_matrix:ue,u_is_text:+Ee,u_pitch_with_map:+x,u_texsize:Xe,u_texture:0}},Fo=function(i,n,c,x,P,O,F,ue,Ee,Xe,qe){var tt=P.transform;return a.extend(Ol(i,n,c,x,P,O,F,ue,Ee,Xe),{u_gamma_scale:x?Math.cos(tt._pitch)*tt.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+qe})},Jl=function(i,n,c,x,P,O,F,ue,Ee,Xe){return a.extend(Fo(i,n,c,x,P,O,F,ue,!0,Ee,!0),{u_texsize_icon:Xe,u_texture_icon:1})},Ll=function(i,n,c){return{u_matrix:i,u_opacity:n,u_color:c}},xl=function(i,n,c,x,P,O){return a.extend(function(F,ue,Ee,Xe){var qe=Ee.imageManager.getPattern(F.from.toString()),tt=Ee.imageManager.getPattern(F.to.toString()),zt=Ee.imageManager.getPixelSize(),Lt=zt.width,Xt=zt.height,Dt=Math.pow(2,Xe.tileID.overscaledZ),Ut=Xe.tileSize*Math.pow(2,Ee.transform.tileZoom)/Dt,er=Ut*(Xe.tileID.canonical.x+Xe.tileID.wrap*Dt),qt=Ut*Xe.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:qe.tl,u_pattern_br_a:qe.br,u_pattern_tl_b:tt.tl,u_pattern_br_b:tt.br,u_texsize:[Lt,Xt],u_mix:ue.t,u_pattern_size_a:qe.displaySize,u_pattern_size_b:tt.displaySize,u_scale_a:ue.fromScale,u_scale_b:ue.toScale,u_tile_units_to_pixels:1/$i(Xe,1,Ee.transform.tileZoom),u_pixel_coord_upper:[er>>16,qt>>16],u_pixel_coord_lower:[65535&er,65535&qt]}}(x,O,c,P),{u_matrix:i,u_opacity:n})},Nc={fillExtrusion:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_lightpos:new a.Uniform3f(i,n.u_lightpos),u_lightintensity:new a.Uniform1f(i,n.u_lightintensity),u_lightcolor:new a.Uniform3f(i,n.u_lightcolor),u_vertical_gradient:new a.Uniform1f(i,n.u_vertical_gradient),u_opacity:new a.Uniform1f(i,n.u_opacity)}},fillExtrusionPattern:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_lightpos:new a.Uniform3f(i,n.u_lightpos),u_lightintensity:new a.Uniform1f(i,n.u_lightintensity),u_lightcolor:new a.Uniform3f(i,n.u_lightcolor),u_vertical_gradient:new a.Uniform1f(i,n.u_vertical_gradient),u_height_factor:new a.Uniform1f(i,n.u_height_factor),u_image:new a.Uniform1i(i,n.u_image),u_texsize:new a.Uniform2f(i,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(i,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(i,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(i,n.u_scale),u_fade:new a.Uniform1f(i,n.u_fade),u_opacity:new a.Uniform1f(i,n.u_opacity)}},fill:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix)}},fillPattern:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_image:new a.Uniform1i(i,n.u_image),u_texsize:new a.Uniform2f(i,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(i,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(i,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(i,n.u_scale),u_fade:new a.Uniform1f(i,n.u_fade)}},fillOutline:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_world:new a.Uniform2f(i,n.u_world)}},fillOutlinePattern:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_world:new a.Uniform2f(i,n.u_world),u_image:new a.Uniform1i(i,n.u_image),u_texsize:new a.Uniform2f(i,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(i,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(i,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(i,n.u_scale),u_fade:new a.Uniform1f(i,n.u_fade)}},circle:function(i,n){return{u_camera_to_center_distance:new a.Uniform1f(i,n.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(i,n.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(i,n.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(i,n.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(i,n.u_matrix)}},collisionBox:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_camera_to_center_distance:new a.Uniform1f(i,n.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(i,n.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(i,n.u_extrude_scale),u_overscale_factor:new a.Uniform1f(i,n.u_overscale_factor)}},collisionCircle:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_inv_matrix:new a.UniformMatrix4f(i,n.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(i,n.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(i,n.u_viewport_size)}},debug:function(i,n){return{u_color:new a.UniformColor(i,n.u_color),u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_overlay:new a.Uniform1i(i,n.u_overlay),u_overlay_scale:new a.Uniform1f(i,n.u_overlay_scale)}},clippingMask:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix)}},heatmap:function(i,n){return{u_extrude_scale:new a.Uniform1f(i,n.u_extrude_scale),u_intensity:new a.Uniform1f(i,n.u_intensity),u_matrix:new a.UniformMatrix4f(i,n.u_matrix)}},heatmapTexture:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_world:new a.Uniform2f(i,n.u_world),u_image:new a.Uniform1i(i,n.u_image),u_color_ramp:new a.Uniform1i(i,n.u_color_ramp),u_opacity:new a.Uniform1f(i,n.u_opacity)}},hillshade:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_image:new a.Uniform1i(i,n.u_image),u_latrange:new a.Uniform2f(i,n.u_latrange),u_light:new a.Uniform2f(i,n.u_light),u_shadow:new a.UniformColor(i,n.u_shadow),u_highlight:new a.UniformColor(i,n.u_highlight),u_accent:new a.UniformColor(i,n.u_accent)}},hillshadePrepare:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_image:new a.Uniform1i(i,n.u_image),u_dimension:new a.Uniform2f(i,n.u_dimension),u_zoom:new a.Uniform1f(i,n.u_zoom),u_unpack:new a.Uniform4f(i,n.u_unpack)}},line:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_ratio:new a.Uniform1f(i,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(i,n.u_units_to_pixels)}},lineGradient:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_ratio:new a.Uniform1f(i,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(i,n.u_units_to_pixels),u_image:new a.Uniform1i(i,n.u_image),u_image_height:new a.Uniform1f(i,n.u_image_height)}},linePattern:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_texsize:new a.Uniform2f(i,n.u_texsize),u_ratio:new a.Uniform1f(i,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_image:new a.Uniform1i(i,n.u_image),u_units_to_pixels:new a.Uniform2f(i,n.u_units_to_pixels),u_scale:new a.Uniform3f(i,n.u_scale),u_fade:new a.Uniform1f(i,n.u_fade)}},lineSDF:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_ratio:new a.Uniform1f(i,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(i,n.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(i,n.u_patternscale_a),u_patternscale_b:new a.Uniform2f(i,n.u_patternscale_b),u_sdfgamma:new a.Uniform1f(i,n.u_sdfgamma),u_image:new a.Uniform1i(i,n.u_image),u_tex_y_a:new a.Uniform1f(i,n.u_tex_y_a),u_tex_y_b:new a.Uniform1f(i,n.u_tex_y_b),u_mix:new a.Uniform1f(i,n.u_mix)}},raster:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_tl_parent:new a.Uniform2f(i,n.u_tl_parent),u_scale_parent:new a.Uniform1f(i,n.u_scale_parent),u_buffer_scale:new a.Uniform1f(i,n.u_buffer_scale),u_fade_t:new a.Uniform1f(i,n.u_fade_t),u_opacity:new a.Uniform1f(i,n.u_opacity),u_image0:new a.Uniform1i(i,n.u_image0),u_image1:new a.Uniform1i(i,n.u_image1),u_brightness_low:new a.Uniform1f(i,n.u_brightness_low),u_brightness_high:new a.Uniform1f(i,n.u_brightness_high),u_saturation_factor:new a.Uniform1f(i,n.u_saturation_factor),u_contrast_factor:new a.Uniform1f(i,n.u_contrast_factor),u_spin_weights:new a.Uniform3f(i,n.u_spin_weights)}},symbolIcon:function(i,n){return{u_is_size_zoom_constant:new a.Uniform1i(i,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(i,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(i,n.u_size_t),u_size:new a.Uniform1f(i,n.u_size),u_camera_to_center_distance:new a.Uniform1f(i,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(i,n.u_pitch),u_rotate_symbol:new a.Uniform1i(i,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(i,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(i,n.u_fade_change),u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(i,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(i,n.u_coord_matrix),u_is_text:new a.Uniform1i(i,n.u_is_text),u_pitch_with_map:new a.Uniform1i(i,n.u_pitch_with_map),u_texsize:new a.Uniform2f(i,n.u_texsize),u_texture:new a.Uniform1i(i,n.u_texture)}},symbolSDF:function(i,n){return{u_is_size_zoom_constant:new a.Uniform1i(i,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(i,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(i,n.u_size_t),u_size:new a.Uniform1f(i,n.u_size),u_camera_to_center_distance:new a.Uniform1f(i,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(i,n.u_pitch),u_rotate_symbol:new a.Uniform1i(i,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(i,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(i,n.u_fade_change),u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(i,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(i,n.u_coord_matrix),u_is_text:new a.Uniform1i(i,n.u_is_text),u_pitch_with_map:new a.Uniform1i(i,n.u_pitch_with_map),u_texsize:new a.Uniform2f(i,n.u_texsize),u_texture:new a.Uniform1i(i,n.u_texture),u_gamma_scale:new a.Uniform1f(i,n.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(i,n.u_is_halo)}},symbolTextAndIcon:function(i,n){return{u_is_size_zoom_constant:new a.Uniform1i(i,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(i,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(i,n.u_size_t),u_size:new a.Uniform1f(i,n.u_size),u_camera_to_center_distance:new a.Uniform1f(i,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(i,n.u_pitch),u_rotate_symbol:new a.Uniform1i(i,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(i,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(i,n.u_fade_change),u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(i,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(i,n.u_coord_matrix),u_is_text:new a.Uniform1i(i,n.u_is_text),u_pitch_with_map:new a.Uniform1i(i,n.u_pitch_with_map),u_texsize:new a.Uniform2f(i,n.u_texsize),u_texsize_icon:new a.Uniform2f(i,n.u_texsize_icon),u_texture:new a.Uniform1i(i,n.u_texture),u_texture_icon:new a.Uniform1i(i,n.u_texture_icon),u_gamma_scale:new a.Uniform1f(i,n.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(i,n.u_is_halo)}},background:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_opacity:new a.Uniform1f(i,n.u_opacity),u_color:new a.UniformColor(i,n.u_color)}},backgroundPattern:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_opacity:new a.Uniform1f(i,n.u_opacity),u_image:new a.Uniform1i(i,n.u_image),u_pattern_tl_a:new a.Uniform2f(i,n.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(i,n.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(i,n.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(i,n.u_pattern_br_b),u_texsize:new a.Uniform2f(i,n.u_texsize),u_mix:new a.Uniform1f(i,n.u_mix),u_pattern_size_a:new a.Uniform2f(i,n.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(i,n.u_pattern_size_b),u_scale_a:new a.Uniform1f(i,n.u_scale_a),u_scale_b:new a.Uniform1f(i,n.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(i,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(i,n.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(i,n.u_tile_units_to_pixels)}}};function Rl(u,i,n,c,x,P,O){for(var F=u.context,ue=F.gl,Ee=u.useProgram("collisionBox"),Xe=[],qe=0,tt=0,zt=0;zt<c.length;zt++){var Lt=c[zt],Xt=i.getTile(Lt),Dt=Xt.getBucket(n);if(Dt){var Ut=Lt.posMatrix;x[0]===0&&x[1]===0||(Ut=u.translatePosMatrix(Lt.posMatrix,Xt,x,P));var er=O?Dt.textCollisionBox:Dt.iconCollisionBox,qt=Dt.collisionCircleArray;if(qt.length>0){var Ir=a.create(),hr=Ut;a.mul(Ir,Dt.placementInvProjMatrix,u.transform.glCoordMatrix),a.mul(Ir,Ir,Dt.placementViewportMatrix),Xe.push({circleArray:qt,circleOffset:tt,transform:hr,invTransform:Ir}),tt=qe+=qt.length/4}er&&Ee.draw(F,ue.LINES,de.disabled,at.disabled,u.colorModeForRenderPass(),Ft.disabled,nl(Ut,u.transform,Xt),n.id,er.layoutVertexBuffer,er.indexBuffer,er.segments,null,u.transform.zoom,null,null,er.collisionVertexBuffer)}}if(O&&Xe.length){var Tr=u.useProgram("collisionCircle"),_r=new a.StructArrayLayout2f1f2i16;_r.resize(4*qe),_r._trim();for(var nn=0,Yr=0,yn=Xe;Yr<yn.length;Yr+=1)for(var On=yn[Yr],Qn=0;Qn<On.circleArray.length/4;Qn++){var oi=4*Qn,yi=On.circleArray[oi+0],Zi=On.circleArray[oi+1],An=On.circleArray[oi+2],si=On.circleArray[oi+3];_r.emplace(nn++,yi,Zi,An,si,0),_r.emplace(nn++,yi,Zi,An,si,1),_r.emplace(nn++,yi,Zi,An,si,2),_r.emplace(nn++,yi,Zi,An,si,3)}(!_u||_u.length<2*qe)&&(_u=function(qa){var Pa=2*qa,yo=new a.StructArrayLayout3ui6;yo.resize(Pa),yo._trim();for(var Ea=0;Ea<Pa;Ea++){var Wa=6*Ea;yo.uint16[Wa+0]=4*Ea+0,yo.uint16[Wa+1]=4*Ea+1,yo.uint16[Wa+2]=4*Ea+2,yo.uint16[Wa+3]=4*Ea+2,yo.uint16[Wa+4]=4*Ea+3,yo.uint16[Wa+5]=4*Ea+0}return yo}(qe));for(var xi=F.createIndexBuffer(_u,!0),Wn=F.createVertexBuffer(_r,a.collisionCircleLayout.members,!0),Ti=0,ri=Xe;Ti<ri.length;Ti+=1){var Ii=ri[Ti],Bi=gc(Ii.transform,Ii.invTransform,u.transform);Tr.draw(F,ue.TRIANGLES,de.disabled,at.disabled,u.colorModeForRenderPass(),Ft.disabled,Bi,n.id,Wn,xi,a.SegmentVector.simpleSegment(0,2*Ii.circleOffset,Ii.circleArray.length,Ii.circleArray.length/2),null,u.transform.zoom,null,null,null)}Wn.destroy(),xi.destroy()}}var tu=a.identity(new Float32Array(16));function mf(u,i,n,c,x,P){var O=a.getAnchorAlignment(u),F=-(O.horizontalAlign-.5)*i,ue=-(O.verticalAlign-.5)*n,Ee=a.evaluateVariableOffset(u,c);return new a.Point((F/x+Ee[0])*P,(ue/x+Ee[1])*P)}function gf(u,i,n,c,x,P,O,F,ue,Ee,Xe){var qe=u.text.placedSymbolArray,tt=u.text.dynamicLayoutVertexArray,zt=u.icon.dynamicLayoutVertexArray,Lt={};tt.clear();for(var Xt=0;Xt<qe.length;Xt++){var Dt=qe.get(Xt),Ut=Dt.hidden||!Dt.crossTileID||u.allowVerticalPlacement&&!Dt.placedOrientation?null:c[Dt.crossTileID];if(Ut){var er=new a.Point(Dt.anchorX,Dt.anchorY),qt=gi(er,n?F:O),Ir=ci(P.cameraToCenterDistance,qt.signedDistanceFromCamera),hr=x.evaluateSizeForFeature(u.textSizeData,Ee,Dt)*Ir/a.ONE_EM;n&&(hr*=u.tilePixelRatio/ue);for(var Tr=mf(Ut.anchor,Ut.width,Ut.height,Ut.textOffset,Ut.textBoxScale,hr),_r=n?gi(er.add(Tr),O).point:qt.point.add(i?Tr.rotate(-P.angle):Tr),nn=u.allowVerticalPlacement&&Dt.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,Yr=0;Yr<Dt.numGlyphs;Yr++)a.addDynamicAttributes(tt,_r,nn);Xe&&Dt.associatedIconIndex>=0&&(Lt[Dt.associatedIconIndex]={shiftedAnchor:_r,angle:nn})}else na(Dt.numGlyphs,tt)}if(Xe){zt.clear();for(var yn=u.icon.placedSymbolArray,On=0;On<yn.length;On++){var Qn=yn.get(On);if(Qn.hidden)na(Qn.numGlyphs,zt);else{var oi=Lt[On];if(oi)for(var yi=0;yi<Qn.numGlyphs;yi++)a.addDynamicAttributes(zt,oi.shiftedAnchor,oi.angle);else na(Qn.numGlyphs,zt)}}u.icon.dynamicLayoutVertexBuffer.updateData(zt)}u.text.dynamicLayoutVertexBuffer.updateData(tt)}function rf(u,i,n){return n.iconsInText&&i?"symbolTextAndIcon":u?"symbolSDF":"symbolIcon"}function bl(u,i,n,c,x,P,O,F,ue,Ee,Xe,qe){for(var tt=u.context,zt=tt.gl,Lt=u.transform,Xt=F==="map",Dt=ue==="map",Ut=Xt&&n.layout.get("symbol-placement")!=="point",er=Xt&&!Dt&&!Ut,qt=n.layout.get("symbol-sort-key").constantOr(1)!==void 0,Ir=!1,hr=u.depthModeForSublayer(0,de.ReadOnly),Tr=n.layout.get("text-variable-anchor"),_r=[],nn=0,Yr=c;nn<Yr.length;nn+=1){var yn=Yr[nn],On=i.getTile(yn),Qn=On.getBucket(n);if(Qn){var oi=x?Qn.text:Qn.icon;if(oi&&oi.segments.get().length){var yi=oi.programConfigurations.get(n.id),Zi=x||Qn.sdfIcons,An=x?Qn.textSizeData:Qn.iconSizeData,si=Dt||Lt.pitch!==0,xi=u.useProgram(rf(Zi,x,Qn),yi),Wn=a.evaluateSizeForZoom(An,Lt.zoom),Ti=void 0,ri=[0,0],Ii=void 0,Bi=void 0,qa=null,Pa=void 0;if(x)Ii=On.glyphAtlasTexture,Bi=zt.LINEAR,Ti=On.glyphAtlasTexture.size,Qn.iconsInText&&(ri=On.imageAtlasTexture.size,qa=On.imageAtlasTexture,Pa=si||u.options.rotating||u.options.zooming||An.kind==="composite"||An.kind==="camera"?zt.LINEAR:zt.NEAREST);else{var yo=n.layout.get("icon-size").constantOr(0)!==1||Qn.iconsNeedLinear;Ii=On.imageAtlasTexture,Bi=Zi||u.options.rotating||u.options.zooming||yo||si?zt.LINEAR:zt.NEAREST,Ti=On.imageAtlasTexture.size}var Ea=$i(On,1,u.transform.zoom),Wa=ga(yn.posMatrix,Dt,Xt,u.transform,Ea),Ds=Pi(yn.posMatrix,Dt,Xt,u.transform,Ea),xo=Tr&&Qn.hasTextData(),yu=n.layout.get("icon-text-fit")!=="none"&&xo&&Qn.hasIconData();Ut&&mo(Qn,yn.posMatrix,u,x,Wa,Ds,Dt,Ee);var xu=u.translatePosMatrix(yn.posMatrix,On,P,O),jo=Ut||x&&Tr||yu?tu:Wa,Ts=u.translatePosMatrix(Ds,On,P,O,!0),Lu=Zi&&n.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1)!==0,ac={program:xi,buffers:oi,uniformValues:Zi?Qn.iconsInText?Jl(An.kind,Wn,er,Dt,u,xu,jo,Ts,Ti,ri):Fo(An.kind,Wn,er,Dt,u,xu,jo,Ts,x,Ti,!0):Ol(An.kind,Wn,er,Dt,u,xu,jo,Ts,x,Ti),atlasTexture:Ii,atlasTextureIcon:qa,atlasInterpolation:Bi,atlasInterpolationIcon:Pa,isSDF:Zi,hasHalo:Lu};if(qt&&Qn.canOverlap){Ir=!0;for(var $u=0,oc=oi.segments.get();$u<oc.length;$u+=1){var sc=oc[$u];_r.push({segments:new a.SegmentVector([sc]),sortKey:sc.sortKey,state:ac})}}else _r.push({segments:oi.segments,sortKey:0,state:ac})}}}Ir&&_r.sort(function(bu,Mo){return bu.sortKey-Mo.sortKey});for(var Ru=0,dl=_r;Ru<dl.length;Ru+=1){var As=dl[Ru],co=As.state;if(tt.activeTexture.set(zt.TEXTURE0),co.atlasTexture.bind(co.atlasInterpolation,zt.CLAMP_TO_EDGE),co.atlasTextureIcon&&(tt.activeTexture.set(zt.TEXTURE1),co.atlasTextureIcon&&co.atlasTextureIcon.bind(co.atlasInterpolationIcon,zt.CLAMP_TO_EDGE)),co.isSDF){var Du=co.uniformValues;co.hasHalo&&(Du.u_is_halo=1,Fa(co.buffers,As.segments,n,u,co.program,hr,Xe,qe,Du)),Du.u_is_halo=0}Fa(co.buffers,As.segments,n,u,co.program,hr,Xe,qe,co.uniformValues)}}function Fa(u,i,n,c,x,P,O,F,ue){var Ee=c.context;x.draw(Ee,Ee.gl.TRIANGLES,P,O,F,Ft.disabled,ue,n.id,u.layoutVertexBuffer,u.indexBuffer,i,n.paint,c.transform.zoom,u.programConfigurations.get(n.id),u.dynamicLayoutVertexBuffer,u.opacityVertexBuffer)}function il(u,i,n,c,x,P,O){var F,ue,Ee,Xe,qe,tt=u.context.gl,zt=n.paint.get("fill-pattern"),Lt=zt&&zt.constantOr(1),Xt=n.getCrossfadeParameters();O?(ue=Lt&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=tt.LINES):(ue=Lt?"fillPattern":"fill",F=tt.TRIANGLES);for(var Dt=0,Ut=c;Dt<Ut.length;Dt+=1){var er=Ut[Dt],qt=i.getTile(er);if(!Lt||qt.patternsLoaded()){var Ir=qt.getBucket(n);if(Ir){var hr=Ir.programConfigurations.get(n.id),Tr=u.useProgram(ue,hr);Lt&&(u.context.activeTexture.set(tt.TEXTURE0),qt.imageAtlasTexture.bind(tt.LINEAR,tt.CLAMP_TO_EDGE),hr.updatePaintBuffers(Xt));var _r=zt.constantOr(null);if(_r&&qt.imageAtlas){var nn=qt.imageAtlas,Yr=nn.patternPositions[_r.to.toString()],yn=nn.patternPositions[_r.from.toString()];Yr&&yn&&hr.setConstantPatternPositions(Yr,yn)}var On=u.translatePosMatrix(er.posMatrix,qt,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(O){Xe=Ir.indexBuffer2,qe=Ir.segments2;var Qn=[tt.drawingBufferWidth,tt.drawingBufferHeight];Ee=ue==="fillOutlinePattern"&&Lt?mc(On,u,Xt,qt,Qn):Lc(On,Qn)}else Xe=Ir.indexBuffer,qe=Ir.segments,Ee=Lt?ps(On,u,Xt,qt):qs(On);Tr.draw(u.context,F,x,u.stencilModeForClipping(er),P,Ft.disabled,Ee,n.id,Ir.layoutVertexBuffer,Xe,qe,n.paint,u.transform.zoom,hr)}}}}function Dl(u,i,n,c,x,P,O){for(var F=u.context,ue=F.gl,Ee=n.paint.get("fill-extrusion-pattern"),Xe=Ee.constantOr(1),qe=n.getCrossfadeParameters(),tt=n.paint.get("fill-extrusion-opacity"),zt=0,Lt=c;zt<Lt.length;zt+=1){var Xt=Lt[zt],Dt=i.getTile(Xt),Ut=Dt.getBucket(n);if(Ut){var er=Ut.programConfigurations.get(n.id),qt=u.useProgram(Xe?"fillExtrusionPattern":"fillExtrusion",er);Xe&&(u.context.activeTexture.set(ue.TEXTURE0),Dt.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),er.updatePaintBuffers(qe));var Ir=Ee.constantOr(null);if(Ir&&Dt.imageAtlas){var hr=Dt.imageAtlas,Tr=hr.patternPositions[Ir.to.toString()],_r=hr.patternPositions[Ir.from.toString()];Tr&&_r&&er.setConstantPatternPositions(Tr,_r)}var nn=u.translatePosMatrix(Xt.posMatrix,Dt,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Yr=n.paint.get("fill-extrusion-vertical-gradient"),yn=Xe?Au(nn,u,Yr,tt,Xt,qe,Dt):Qa(nn,u,Yr,tt);qt.draw(F,F.gl.TRIANGLES,x,P,O,Ft.backCCW,yn,n.id,Ut.layoutVertexBuffer,Ut.indexBuffer,Ut.segments,n.paint,u.transform.zoom,er)}}}function xc(u,i,n,c,x,P){var O=u.context,F=O.gl,ue=i.fbo;if(ue){var Ee=u.useProgram("hillshade");O.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,ue.colorAttachment.get());var Xe=function(qe,tt,zt){var Lt=zt.paint.get("hillshade-shadow-color"),Xt=zt.paint.get("hillshade-highlight-color"),Dt=zt.paint.get("hillshade-accent-color"),Ut=zt.paint.get("hillshade-illumination-direction")*(Math.PI/180);zt.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ut-=qe.transform.angle);var er,qt,Ir,hr=!qe.options.moving;return{u_matrix:qe.transform.calculatePosMatrix(tt.tileID.toUnwrapped(),hr),u_image:0,u_latrange:(er=tt.tileID,qt=Math.pow(2,er.canonical.z),Ir=er.canonical.y,[new a.MercatorCoordinate(0,Ir/qt).toLngLat().lat,new a.MercatorCoordinate(0,(Ir+1)/qt).toLngLat().lat]),u_light:[zt.paint.get("hillshade-exaggeration"),Ut],u_shadow:Lt,u_highlight:Xt,u_accent:Dt}}(u,i,n);Ee.draw(O,F.TRIANGLES,c,x,P,Ft.disabled,Xe,n.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments)}}function Fc(u,i,n,c,x,P){var O=u.context,F=O.gl,ue=i.dem;if(ue&&ue.data){var Ee=ue.dim,Xe=ue.stride,qe=ue.getPixels();if(O.activeTexture.set(F.TEXTURE1),O.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||u.getTileTexture(Xe),i.demTexture){var tt=i.demTexture;tt.update(qe,{premultiply:!1}),tt.bind(F.NEAREST,F.CLAMP_TO_EDGE)}else i.demTexture=new a.Texture(O,qe,F.RGBA,{premultiply:!1}),i.demTexture.bind(F.NEAREST,F.CLAMP_TO_EDGE);O.activeTexture.set(F.TEXTURE0);var zt=i.fbo;if(!zt){var Lt=new a.Texture(O,{width:Ee,height:Ee,data:null},F.RGBA);Lt.bind(F.LINEAR,F.CLAMP_TO_EDGE),(zt=i.fbo=O.createFramebuffer(Ee,Ee,!0)).colorAttachment.set(Lt.texture)}O.bindFramebuffer.set(zt.framebuffer),O.viewport.set([0,0,Ee,Ee]),u.useProgram("hillshadePrepare").draw(O,F.TRIANGLES,c,x,P,Ft.disabled,function(Xt,Dt){var Ut=Dt.stride,er=a.create();return a.ortho(er,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(er,er,[0,-a.EXTENT,0]),{u_matrix:er,u_image:1,u_dimension:[Ut,Ut],u_zoom:Xt.overscaledZ,u_unpack:Dt.getUnpackVector()}}(i.tileID,ue),n.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function zl(u,i,n,c,x){var P=c.paint.get("raster-fade-duration");if(P>0){var O=a.browser.now(),F=(O-u.timeAdded)/P,ue=i?(O-i.timeAdded)/P:-1,Ee=n.getSource(),Xe=x.coveringZoomLevel({tileSize:Ee.tileSize,roundZoom:Ee.roundZoom}),qe=!i||Math.abs(i.tileID.overscaledZ-Xe)>Math.abs(u.tileID.overscaledZ-Xe),tt=qe&&u.refreshedUponExpiration?1:a.clamp(qe?F:1-ue,0,1);return u.refreshedUponExpiration&&F>=1&&(u.refreshedUponExpiration=!1),i?{opacity:1,mix:1-tt}:{opacity:tt,mix:0}}return{opacity:1,mix:0}}var If=new a.Color(1,0,0,1),Of=new a.Color(0,1,0,1),nf=new a.Color(0,0,1,1),Sl=new a.Color(1,0,1,1),Ql=new a.Color(0,1,1,1);function Cu(u,i,n,c){al(u,0,i+n/2,u.transform.width,n,c)}function Bs(u,i,n,c){al(u,i-n/2,0,n,u.transform.height,c)}function al(u,i,n,c,x,P){var O=u.context,F=O.gl;F.enable(F.SCISSOR_TEST),F.scissor(i*a.browser.devicePixelRatio,n*a.browser.devicePixelRatio,c*a.browser.devicePixelRatio,x*a.browser.devicePixelRatio),O.clear({color:P}),F.disable(F.SCISSOR_TEST)}function Bc(u,i,n){var c=u.context,x=c.gl,P=n.posMatrix,O=u.useProgram("debug"),F=de.disabled,ue=at.disabled,Ee=u.colorModeForRenderPass();c.activeTexture.set(x.TEXTURE0),u.emptyTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE),O.draw(c,x.LINE_STRIP,F,ue,Ee,Ft.disabled,eu(P,a.Color.red),"$debug",u.debugBuffer,u.tileBorderIndexBuffer,u.debugSegments);var Xe=i.getTileByID(n.key).latestRawTileData,qe=Math.floor((Xe&&Xe.byteLength||0)/1024),tt=i.getTile(n).tileSize,zt=512/Math.min(tt,512)*(n.overscaledZ/u.transform.zoom)*.5,Lt=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(Lt+=" => "+n.overscaledZ),function(Xt,Dt){Xt.initDebugOverlayCanvas();var Ut=Xt.debugOverlayCanvas,er=Xt.context.gl,qt=Xt.debugOverlayCanvas.getContext("2d");qt.clearRect(0,0,Ut.width,Ut.height),qt.shadowColor="white",qt.shadowBlur=2,qt.lineWidth=1.5,qt.strokeStyle="white",qt.textBaseline="top",qt.font="bold 36px Open Sans, sans-serif",qt.fillText(Dt,5,5),qt.strokeText(Dt,5,5),Xt.debugOverlayTexture.update(Ut),Xt.debugOverlayTexture.bind(er.LINEAR,er.CLAMP_TO_EDGE)}(u,Lt+" "+qe+"kb"),O.draw(c,x.TRIANGLES,F,ue,At.alphaBlended,Ft.disabled,eu(P,a.Color.transparent,zt),"$debug",u.debugBuffer,u.quadTriangleIndexBuffer,u.debugSegments)}var Wu={symbol:function(i,n,c,x,P){if(i.renderPass==="translucent"){var O=at.disabled,F=i.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(ue,Ee,Xe,qe,tt,zt,Lt){for(var Xt=Ee.transform,Dt=tt==="map",Ut=zt==="map",er=0,qt=ue;er<qt.length;er+=1){var Ir=qt[er],hr=qe.getTile(Ir),Tr=hr.getBucket(Xe);if(Tr&&Tr.text&&Tr.text.segments.get().length){var _r=a.evaluateSizeForZoom(Tr.textSizeData,Xt.zoom),nn=$i(hr,1,Ee.transform.zoom),Yr=ga(Ir.posMatrix,Ut,Dt,Ee.transform,nn),yn=Xe.layout.get("icon-text-fit")!=="none"&&Tr.hasIconData();if(_r){var On=Math.pow(2,Xt.zoom-hr.tileID.overscaledZ);gf(Tr,Dt,Ut,Lt,a.symbolSize,Xt,Yr,Ir.posMatrix,On,_r,yn)}}}}(x,i,c,n,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),P),c.paint.get("icon-opacity").constantOr(1)!==0&&bl(i,n,c,x,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),O,F),c.paint.get("text-opacity").constantOr(1)!==0&&bl(i,n,c,x,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),O,F),n.map.showCollisionBoxes&&(Rl(i,n,c,x,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Rl(i,n,c,x,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))}},circle:function(i,n,c,x){if(i.renderPass==="translucent"){var P=c.paint.get("circle-opacity"),O=c.paint.get("circle-stroke-width"),F=c.paint.get("circle-stroke-opacity"),ue=c.layout.get("circle-sort-key").constantOr(1)!==void 0;if(P.constantOr(1)!==0||O.constantOr(1)!==0&&F.constantOr(1)!==0){for(var Ee=i.context,Xe=Ee.gl,qe=i.depthModeForSublayer(0,de.ReadOnly),tt=at.disabled,zt=i.colorModeForRenderPass(),Lt=[],Xt=0;Xt<x.length;Xt++){var Dt=x[Xt],Ut=n.getTile(Dt),er=Ut.getBucket(c);if(er){var qt=er.programConfigurations.get(c.id),Ir={programConfiguration:qt,program:i.useProgram("circle",qt),layoutVertexBuffer:er.layoutVertexBuffer,indexBuffer:er.indexBuffer,uniformValues:yl(i,Dt,Ut,c)};if(ue)for(var hr=0,Tr=er.segments.get();hr<Tr.length;hr+=1){var _r=Tr[hr];Lt.push({segments:new a.SegmentVector([_r]),sortKey:_r.sortKey,state:Ir})}else Lt.push({segments:er.segments,sortKey:0,state:Ir})}}ue&&Lt.sort(function(Qn,oi){return Qn.sortKey-oi.sortKey});for(var nn=0,Yr=Lt;nn<Yr.length;nn+=1){var yn=Yr[nn],On=yn.state;On.program.draw(Ee,Xe.TRIANGLES,qe,tt,zt,Ft.disabled,On.uniformValues,c.id,On.layoutVertexBuffer,On.indexBuffer,yn.segments,c.paint,i.transform.zoom,On.programConfiguration)}}}},heatmap:function(i,n,c,x){if(c.paint.get("heatmap-opacity")!==0)if(i.renderPass==="offscreen"){var P=i.context,O=P.gl,F=at.disabled,ue=new At([O.ONE,O.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(Lt,Xt,Dt){var Ut=Lt.gl;Lt.activeTexture.set(Ut.TEXTURE1),Lt.viewport.set([0,0,Xt.width/4,Xt.height/4]);var er=Dt.heatmapFbo;if(er)Ut.bindTexture(Ut.TEXTURE_2D,er.colorAttachment.get()),Lt.bindFramebuffer.set(er.framebuffer);else{var qt=Ut.createTexture();Ut.bindTexture(Ut.TEXTURE_2D,qt),Ut.texParameteri(Ut.TEXTURE_2D,Ut.TEXTURE_WRAP_S,Ut.CLAMP_TO_EDGE),Ut.texParameteri(Ut.TEXTURE_2D,Ut.TEXTURE_WRAP_T,Ut.CLAMP_TO_EDGE),Ut.texParameteri(Ut.TEXTURE_2D,Ut.TEXTURE_MIN_FILTER,Ut.LINEAR),Ut.texParameteri(Ut.TEXTURE_2D,Ut.TEXTURE_MAG_FILTER,Ut.LINEAR),er=Dt.heatmapFbo=Lt.createFramebuffer(Xt.width/4,Xt.height/4,!1),function(Ir,hr,Tr,_r){var nn=Ir.gl;nn.texImage2D(nn.TEXTURE_2D,0,nn.RGBA,hr.width/4,hr.height/4,0,nn.RGBA,Ir.extRenderToTextureHalfFloat?Ir.extTextureHalfFloat.HALF_FLOAT_OES:nn.UNSIGNED_BYTE,null),_r.colorAttachment.set(Tr)}(Lt,Xt,qt,er)}})(P,i,c),P.clear({color:a.Color.transparent});for(var Ee=0;Ee<x.length;Ee++){var Xe=x[Ee];if(!n.hasRenderableParent(Xe)){var qe=n.getTile(Xe),tt=qe.getBucket(c);if(tt){var zt=tt.programConfigurations.get(c.id);i.useProgram("heatmap",zt).draw(P,O.TRIANGLES,de.disabled,F,ue,Ft.disabled,Rc(Xe.posMatrix,qe,i.transform.zoom,c.paint.get("heatmap-intensity")),c.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,c.paint,i.transform.zoom,zt)}}}P.viewport.set([0,0,i.width,i.height])}else i.renderPass==="translucent"&&(i.context.setColorMode(i.colorModeForRenderPass()),function(Lt,Xt){var Dt=Lt.context,Ut=Dt.gl,er=Xt.heatmapFbo;if(er){Dt.activeTexture.set(Ut.TEXTURE0),Ut.bindTexture(Ut.TEXTURE_2D,er.colorAttachment.get()),Dt.activeTexture.set(Ut.TEXTURE1);var qt=Xt.colorRampTexture;qt||(qt=Xt.colorRampTexture=new a.Texture(Dt,Xt.colorRamp,Ut.RGBA)),qt.bind(Ut.LINEAR,Ut.CLAMP_TO_EDGE),Lt.useProgram("heatmapTexture").draw(Dt,Ut.TRIANGLES,de.disabled,at.disabled,Lt.colorModeForRenderPass(),Ft.disabled,function(Ir,hr,Tr,_r){var nn=a.create();a.ortho(nn,0,Ir.width,Ir.height,0,0,1);var Yr=Ir.context.gl;return{u_matrix:nn,u_world:[Yr.drawingBufferWidth,Yr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:hr.paint.get("heatmap-opacity")}}(Lt,Xt),Xt.id,Lt.viewportBuffer,Lt.quadTriangleIndexBuffer,Lt.viewportSegments,Xt.paint,Lt.transform.zoom)}}(i,c))},line:function(i,n,c,x){if(i.renderPass==="translucent"){var P=c.paint.get("line-opacity"),O=c.paint.get("line-width");if(P.constantOr(1)!==0&&O.constantOr(1)!==0)for(var F=i.depthModeForSublayer(0,de.ReadOnly),ue=i.colorModeForRenderPass(),Ee=c.paint.get("line-dasharray"),Xe=c.paint.get("line-pattern"),qe=Xe.constantOr(1),tt=c.paint.get("line-gradient"),zt=c.getCrossfadeParameters(),Lt=qe?"linePattern":Ee?"lineSDF":tt?"lineGradient":"line",Xt=i.context,Dt=Xt.gl,Ut=!0,er=0,qt=x;er<qt.length;er+=1){var Ir=qt[er],hr=n.getTile(Ir);if(!qe||hr.patternsLoaded()){var Tr=hr.getBucket(c);if(Tr){var _r=Tr.programConfigurations.get(c.id),nn=i.context.program.get(),Yr=i.useProgram(Lt,_r),yn=Ut||Yr.program!==nn,On=Xe.constantOr(null);if(On&&hr.imageAtlas){var Qn=hr.imageAtlas,oi=Qn.patternPositions[On.to.toString()],yi=Qn.patternPositions[On.from.toString()];oi&&yi&&_r.setConstantPatternPositions(oi,yi)}var Zi=qe?Dc(i,hr,c,zt):Ee?Mf(i,hr,c,Ee,zt):tt?wa(i,hr,c,Tr.lineClipsArray.length):Kl(i,hr,c);if(qe)Xt.activeTexture.set(Dt.TEXTURE0),hr.imageAtlasTexture.bind(Dt.LINEAR,Dt.CLAMP_TO_EDGE),_r.updatePaintBuffers(zt);else if(Ee&&(yn||i.lineAtlas.dirty))Xt.activeTexture.set(Dt.TEXTURE0),i.lineAtlas.bind(Xt);else if(tt){var An=Tr.gradients[c.id],si=An.texture;if(c.gradientVersion!==An.version){var xi=256;if(c.stepInterpolant){var Wn=n.getSource().maxzoom,Ti=Ir.canonical.z===Wn?Math.ceil(1<<i.transform.maxZoom-Ir.canonical.z):1;xi=a.clamp(a.nextPowerOfTwo(Tr.maxLineLength/a.EXTENT*1024*Ti),256,Xt.maxTextureSize)}An.gradient=a.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:xi,image:An.gradient||void 0,clips:Tr.lineClipsArray}),An.texture?An.texture.update(An.gradient):An.texture=new a.Texture(Xt,An.gradient,Dt.RGBA),An.version=c.gradientVersion,si=An.texture}Xt.activeTexture.set(Dt.TEXTURE0),si.bind(c.stepInterpolant?Dt.NEAREST:Dt.LINEAR,Dt.CLAMP_TO_EDGE)}Yr.draw(Xt,Dt.TRIANGLES,F,i.stencilModeForClipping(Ir),ue,Ft.disabled,Zi,c.id,Tr.layoutVertexBuffer,Tr.indexBuffer,Tr.segments,c.paint,i.transform.zoom,_r,Tr.layoutVertexBuffer2),Ut=!1}}}}},fill:function(i,n,c,x){var P=c.paint.get("fill-color"),O=c.paint.get("fill-opacity");if(O.constantOr(1)!==0){var F=i.colorModeForRenderPass(),ue=c.paint.get("fill-pattern"),Ee=i.opaquePassEnabledForLayer()&&!ue.constantOr(1)&&P.constantOr(a.Color.transparent).a===1&&O.constantOr(0)===1?"opaque":"translucent";if(i.renderPass===Ee){var Xe=i.depthModeForSublayer(1,i.renderPass==="opaque"?de.ReadWrite:de.ReadOnly);il(i,n,c,x,Xe,F,!1)}if(i.renderPass==="translucent"&&c.paint.get("fill-antialias")){var qe=i.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,de.ReadOnly);il(i,n,c,x,qe,F,!0)}}},"fill-extrusion":function(i,n,c,x){var P=c.paint.get("fill-extrusion-opacity");if(P!==0&&i.renderPass==="translucent"){var O=new de(i.context.gl.LEQUAL,de.ReadWrite,i.depthRangeFor3D);if(P!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))Dl(i,n,c,x,O,at.disabled,At.disabled),Dl(i,n,c,x,O,i.stencilModeFor3D(),i.colorModeForRenderPass());else{var F=i.colorModeForRenderPass();Dl(i,n,c,x,O,at.disabled,F)}}},hillshade:function(i,n,c,x){if(i.renderPass==="offscreen"||i.renderPass==="translucent"){for(var P=i.context,O=i.depthModeForSublayer(0,de.ReadOnly),F=i.colorModeForRenderPass(),ue=i.renderPass==="translucent"?i.stencilConfigForOverlap(x):[{},x],Ee=ue[0],Xe=0,qe=ue[1];Xe<qe.length;Xe+=1){var tt=qe[Xe],zt=n.getTile(tt);zt.needsHillshadePrepare&&i.renderPass==="offscreen"?Fc(i,zt,c,O,at.disabled,F):i.renderPass==="translucent"&&xc(i,zt,c,O,Ee[tt.overscaledZ],F)}P.viewport.set([0,0,i.width,i.height])}},raster:function(i,n,c,x){if(i.renderPass==="translucent"&&c.paint.get("raster-opacity")!==0&&x.length)for(var P=i.context,O=P.gl,F=n.getSource(),ue=i.useProgram("raster"),Ee=i.colorModeForRenderPass(),Xe=F instanceof be?[{},x]:i.stencilConfigForOverlap(x),qe=Xe[0],tt=Xe[1],zt=tt[tt.length-1].overscaledZ,Lt=!i.options.moving,Xt=0,Dt=tt;Xt<Dt.length;Xt+=1){var Ut=Dt[Xt],er=i.depthModeForSublayer(Ut.overscaledZ-zt,c.paint.get("raster-opacity")===1?de.ReadWrite:de.ReadOnly,O.LESS),qt=n.getTile(Ut),Ir=i.transform.calculatePosMatrix(Ut.toUnwrapped(),Lt);qt.registerFadeDuration(c.paint.get("raster-fade-duration"));var hr=n.findLoadedParent(Ut,0),Tr=zl(qt,hr,n,c,i.transform),_r=void 0,nn=void 0,Yr=c.paint.get("raster-resampling")==="nearest"?O.NEAREST:O.LINEAR;P.activeTexture.set(O.TEXTURE0),qt.texture.bind(Yr,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),P.activeTexture.set(O.TEXTURE1),hr?(hr.texture.bind(Yr,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),_r=Math.pow(2,hr.tileID.overscaledZ-qt.tileID.overscaledZ),nn=[qt.tileID.canonical.x*_r%1,qt.tileID.canonical.y*_r%1]):qt.texture.bind(Yr,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST);var yn=$l(Ir,nn||[0,0],_r||1,Tr,c);F instanceof be?ue.draw(P,O.TRIANGLES,er,at.disabled,Ee,Ft.disabled,yn,c.id,F.boundsBuffer,i.quadTriangleIndexBuffer,F.boundsSegments):ue.draw(P,O.TRIANGLES,er,qe[Ut.overscaledZ],Ee,Ft.disabled,yn,c.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments)}},background:function(i,n,c){var x=c.paint.get("background-color"),P=c.paint.get("background-opacity");if(P!==0){var O=i.context,F=O.gl,ue=i.transform,Ee=ue.tileSize,Xe=c.paint.get("background-pattern");if(!i.isPatternMissing(Xe)){var qe=!Xe&&x.a===1&&P===1&&i.opaquePassEnabledForLayer()?"opaque":"translucent";if(i.renderPass===qe){var tt=at.disabled,zt=i.depthModeForSublayer(0,qe==="opaque"?de.ReadWrite:de.ReadOnly),Lt=i.colorModeForRenderPass(),Xt=i.useProgram(Xe?"backgroundPattern":"background"),Dt=ue.coveringTiles({tileSize:Ee});Xe&&(O.activeTexture.set(F.TEXTURE0),i.imageManager.bind(i.context));for(var Ut=c.getCrossfadeParameters(),er=0,qt=Dt;er<qt.length;er+=1){var Ir=qt[er],hr=i.transform.calculatePosMatrix(Ir.toUnwrapped()),Tr=Xe?xl(hr,P,i,Xe,{tileID:Ir,tileSize:Ee},Ut):Ll(hr,P,x);Xt.draw(O,F.TRIANGLES,zt,tt,Lt,Ft.disabled,Tr,c.id,i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}}}},debug:function(i,n,c){for(var x=0;x<c.length;x++)Bc(i,n,c[x])},custom:function(i,n,c){var x=i.context,P=c.implementation;if(i.renderPass==="offscreen"){var O=P.prerender;O&&(i.setCustomLayerDefaults(),x.setColorMode(i.colorModeForRenderPass()),O.call(P,x.gl,i.transform.customLayerMatrix()),x.setDirty(),i.setBaseState())}else if(i.renderPass==="translucent"){i.setCustomLayerDefaults(),x.setColorMode(i.colorModeForRenderPass()),x.setStencilMode(at.disabled);var F=P.renderingMode==="3d"?new de(i.context.gl.LEQUAL,de.ReadWrite,i.depthRangeFor3D):i.depthModeForSublayer(0,de.ReadOnly);x.setDepthMode(F),P.render(x.gl,i.transform.customLayerMatrix()),x.setDirty(),i.setBaseState(),x.bindFramebuffer.set(null)}}},Ba=function(i,n){this.context=new He(i),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=Pt.maxUnderzooming+Pt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new uo,this.gpuTimers={}};Ba.prototype.resize=function(u,i){if(this.width=u*a.browser.devicePixelRatio,this.height=i*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,c=this.style._order;n<c.length;n+=1)this.style._layers[c[n]].resize()},Ba.prototype.setup=function(){var u=this.context,i=new a.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(a.EXTENT,0),i.emplaceBack(0,a.EXTENT),i.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=u.createVertexBuffer(i,Na.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var n=new a.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(a.EXTENT,0),n.emplaceBack(0,a.EXTENT),n.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=u.createVertexBuffer(n,Na.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var c=new a.StructArrayLayout4i8;c.emplaceBack(0,0,0,0),c.emplaceBack(a.EXTENT,0,a.EXTENT,0),c.emplaceBack(0,a.EXTENT,0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=u.createVertexBuffer(c,Ce.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var x=new a.StructArrayLayout2i4;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(x,Na.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var P=new a.StructArrayLayout1ui2;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=u.createIndexBuffer(P);var O=new a.StructArrayLayout3ui6;O.emplaceBack(0,1,2),O.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(O),this.emptyTexture=new a.Texture(u,{width:1,height:1,data:new Uint8Array([0,0,0,0])},u.gl.RGBA);var F=this.context.gl;this.stencilClearMode=new at({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO)},Ba.prototype.clearStencil=function(){var u=this.context,i=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=a.create();a.ortho(n,0,this.width,this.height,0,0,1),a.scale(n,n,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(u,i.TRIANGLES,de.disabled,this.stencilClearMode,At.disabled,Ft.disabled,Hu(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Ba.prototype._renderTileClippingMasks=function(u,i){if(this.currentStencilSource!==u.source&&u.isTileClipped()&&i&&i.length){this.currentStencilSource=u.source;var n=this.context,c=n.gl;this.nextStencilID+i.length>256&&this.clearStencil(),n.setColorMode(At.disabled),n.setDepthMode(de.disabled);var x=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var P=0,O=i;P<O.length;P+=1){var F=O[P],ue=this._tileClippingMaskIDs[F.key]=this.nextStencilID++;x.draw(n,c.TRIANGLES,de.disabled,new at({func:c.ALWAYS,mask:0},ue,255,c.KEEP,c.KEEP,c.REPLACE),At.disabled,Ft.disabled,Hu(F.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Ba.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var u=this.nextStencilID++,i=this.context.gl;return new at({func:i.NOTEQUAL,mask:255},u,255,i.KEEP,i.KEEP,i.REPLACE)},Ba.prototype.stencilModeForClipping=function(u){var i=this.context.gl;return new at({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,i.KEEP,i.KEEP,i.REPLACE)},Ba.prototype.stencilConfigForOverlap=function(u){var i,n=this.context.gl,c=u.sort(function(ue,Ee){return Ee.overscaledZ-ue.overscaledZ}),x=c[c.length-1].overscaledZ,P=c[0].overscaledZ-x+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();for(var O={},F=0;F<P;F++)O[F+x]=new at({func:n.GEQUAL,mask:255},F+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=P,[O,c]}return[(i={},i[x]=at.disabled,i),c]},Ba.prototype.colorModeForRenderPass=function(){var u=this.context.gl;return this._showOverdrawInspector?new At([u.CONSTANT_COLOR,u.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?At.unblended:At.alphaBlended},Ba.prototype.depthModeForSublayer=function(u,i,n){if(!this.opaquePassEnabledForLayer())return de.disabled;var c=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new de(n||this.context.gl.LEQUAL,i,[c,c])},Ba.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Ba.prototype.render=function(u,i){var n=this;this.style=u,this.options=i,this.lineAtlas=u.lineAtlas,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var c=this.style._order,x=this.style.sourceCaches;for(var P in x){var O=x[P];O.used&&O.prepare(this.context)}var F,ue,Ee={},Xe={},qe={};for(var tt in x){var zt=x[tt];Ee[tt]=zt.getVisibleCoordinates(),Xe[tt]=Ee[tt].slice().reverse(),qe[tt]=zt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Lt=0;Lt<c.length;Lt++)if(this.style._layers[c[Lt]].is3D()){this.opaquePassCutoff=Lt;break}this.renderPass="offscreen";for(var Xt=0,Dt=c;Xt<Dt.length;Xt+=1){var Ut=this.style._layers[Dt[Xt]];if(Ut.hasOffscreenPass()&&!Ut.isHidden(this.transform.zoom)){var er=Xe[Ut.source];(Ut.type==="custom"||er.length)&&this.renderLayer(this,x[Ut.source],Ut,er)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(u._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){var qt=this.style._layers[c[this.currentLayer]],Ir=x[qt.source],hr=Ee[qt.source];this._renderTileClippingMasks(qt,hr),this.renderLayer(this,Ir,qt,hr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){var Tr=this.style._layers[c[this.currentLayer]],_r=x[Tr.source],nn=(Tr.type==="symbol"?qe:Xe)[Tr.source];this._renderTileClippingMasks(Tr,Ee[Tr.source]),this.renderLayer(this,_r,Tr,nn)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(Yr){Yr.source&&!Yr.isHidden(n.transform.zoom)&&(Yr.source!==(ue&&ue.id)&&(ue=n.style.sourceCaches[Yr.source]),(!F||F.getSource().maxzoom<ue.getSource().maxzoom)&&(F=ue))}),F&&Wu.debug(this,F,F.getVisibleCoordinates())),this.options.showPadding&&function(Yr){var yn=Yr.transform.padding;Cu(Yr,Yr.transform.height-(yn.top||0),3,If),Cu(Yr,yn.bottom||0,3,Of),Bs(Yr,yn.left||0,3,nf),Bs(Yr,Yr.transform.width-(yn.right||0),3,Sl);var On=Yr.transform.centerPoint;(function(Qn,oi,yi,Zi){al(Qn,oi-1,yi-10,2,20,Zi),al(Qn,oi-10,yi-1,20,2,Zi)})(Yr,On.x,Yr.transform.height-On.y,Ql)}(this),this.context.setDefault()},Ba.prototype.renderLayer=function(u,i,n,c){n.isHidden(this.transform.zoom)||(n.type==="background"||n.type==="custom"||c.length)&&(this.id=n.id,this.gpuTimingStart(n),Wu[n.type](u,i,n,c,this.style.placement.variableOffsets),this.gpuTimingEnd())},Ba.prototype.gpuTimingStart=function(u){if(this.options.gpuTiming){var i=this.context.extTimerQuery,n=this.gpuTimers[u.id];n||(n=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:i.createQueryEXT()}),n.calls++,i.beginQueryEXT(i.TIME_ELAPSED_EXT,n.query)}},Ba.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}},Ba.prototype.collectGpuTimers=function(){var u=this.gpuTimers;return this.gpuTimers={},u},Ba.prototype.queryGpuTimers=function(u){var i={};for(var n in u){var c=u[n],x=this.context.extTimerQuery,P=x.getQueryObjectEXT(c.query,x.QUERY_RESULT_EXT)/1e6;x.deleteQueryEXT(c.query),i[n]=P}return i},Ba.prototype.translatePosMatrix=function(u,i,n,c,x){if(!n[0]&&!n[1])return u;var P=x?c==="map"?this.transform.angle:0:c==="viewport"?-this.transform.angle:0;if(P){var O=Math.sin(P),F=Math.cos(P);n=[n[0]*F-n[1]*O,n[0]*O+n[1]*F]}var ue=[x?n[0]:$i(i,n[0],this.transform.zoom),x?n[1]:$i(i,n[1],this.transform.zoom),0],Ee=new Float32Array(16);return a.translate(Ee,u,ue),Ee},Ba.prototype.saveTileTexture=function(u){var i=this._tileTextures[u.size[0]];i?i.push(u):this._tileTextures[u.size[0]]=[u]},Ba.prototype.getTileTexture=function(u){var i=this._tileTextures[u];return i&&i.length>0?i.pop():null},Ba.prototype.isPatternMissing=function(u){if(!u)return!1;if(!u.from||!u.to)return!0;var i=this.imageManager.getPattern(u.from.toString()),n=this.imageManager.getPattern(u.to.toString());return!i||!n},Ba.prototype.useProgram=function(u,i){this.cache=this.cache||{};var n=""+u+(i?i.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new ef(this.context,u,Oc[u],i,Nc[u],this._showOverdrawInspector)),this.cache[n]},Ba.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Ba.prototype.setBaseState=function(){var u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)},Ba.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Ba.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var du=function(i,n){this.points=i,this.planes=n};du.fromInvProjectionMatrix=function(u,i,n){var c=Math.pow(2,n),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(O){return a.transformMat4([],O,u)}).map(function(O){return a.scale$1([],O,1/O[3]/i*c)}),P=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(O){var F=a.sub([],x[O[0]],x[O[1]]),ue=a.sub([],x[O[2]],x[O[1]]),Ee=a.normalize([],a.cross([],F,ue)),Xe=-a.dot(Ee,x[O[1]]);return Ee.concat(Xe)});return new du(x,P)};var ol=function(i,n){this.min=i,this.max=n,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};ol.prototype.quadrant=function(u){for(var i=[u%2==0,u<2],n=a.clone$2(this.min),c=a.clone$2(this.max),x=0;x<i.length;x++)n[x]=i[x]?this.min[x]:this.center[x],c[x]=i[x]?this.center[x]:this.max[x];return c[2]=this.max[2],new ol(n,c)},ol.prototype.distanceX=function(u){return Math.max(Math.min(this.max[0],u[0]),this.min[0])-u[0]},ol.prototype.distanceY=function(u){return Math.max(Math.min(this.max[1],u[1]),this.min[1])-u[1]},ol.prototype.intersects=function(u){for(var i=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,c=0;c<u.planes.length;c++){for(var x=u.planes[c],P=0,O=0;O<i.length;O++)P+=a.dot$1(x,i[O])>=0;if(P===0)return 0;P!==i.length&&(n=!1)}if(n)return 2;for(var F=0;F<3;F++){for(var ue=Number.MAX_VALUE,Ee=-Number.MAX_VALUE,Xe=0;Xe<u.points.length;Xe++){var qe=u.points[Xe][F]-this.min[F];ue=Math.min(ue,qe),Ee=Math.max(Ee,qe)}if(Ee<0||ue>this.max[F]-this.min[F])return 0}return 1};var sl=function(i,n,c,x){if(i===void 0&&(i=0),n===void 0&&(n=0),c===void 0&&(c=0),x===void 0&&(x=0),isNaN(i)||i<0||isNaN(n)||n<0||isNaN(c)||c<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=n,this.left=c,this.right=x};sl.prototype.interpolate=function(u,i,n){return i.top!=null&&u.top!=null&&(this.top=a.number(u.top,i.top,n)),i.bottom!=null&&u.bottom!=null&&(this.bottom=a.number(u.bottom,i.bottom,n)),i.left!=null&&u.left!=null&&(this.left=a.number(u.left,i.left,n)),i.right!=null&&u.right!=null&&(this.right=a.number(u.right,i.right,n)),this},sl.prototype.getCenter=function(u,i){var n=a.clamp((this.left+u-this.right)/2,0,u),c=a.clamp((this.top+i-this.bottom)/2,0,i);return new a.Point(n,c)},sl.prototype.equals=function(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right},sl.prototype.clone=function(){return new sl(this.top,this.bottom,this.left,this.right)},sl.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var zi=function(i,n,c,x,P){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=P===void 0||P,this._minZoom=i||0,this._maxZoom=n||22,this._minPitch=c==null?0:c,this._maxPitch=x==null?60:x,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new sl,this._posMatrixCache={},this._alignedPosMatrixCache={}},pa={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};zi.prototype.clone=function(){var u=new zi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return u.tileSize=this.tileSize,u.latRange=this.latRange,u.width=this.width,u.height=this.height,u._center=this._center,u.zoom=this.zoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._calcMatrices(),u},pa.minZoom.get=function(){return this._minZoom},pa.minZoom.set=function(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))},pa.maxZoom.get=function(){return this._maxZoom},pa.maxZoom.set=function(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))},pa.minPitch.get=function(){return this._minPitch},pa.minPitch.set=function(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))},pa.maxPitch.get=function(){return this._maxPitch},pa.maxPitch.set=function(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))},pa.renderWorldCopies.get=function(){return this._renderWorldCopies},pa.renderWorldCopies.set=function(u){u===void 0?u=!0:u===null&&(u=!1),this._renderWorldCopies=u},pa.worldSize.get=function(){return this.tileSize*this.scale},pa.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},pa.size.get=function(){return new a.Point(this.width,this.height)},pa.bearing.get=function(){return-this.angle/Math.PI*180},pa.bearing.set=function(u){var i=-a.wrap(u,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},pa.pitch.get=function(){return this._pitch/Math.PI*180},pa.pitch.set=function(u){var i=a.clamp(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())},pa.fov.get=function(){return this._fov/Math.PI*180},pa.fov.set=function(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=u/180*Math.PI,this._calcMatrices())},pa.zoom.get=function(){return this._zoom},pa.zoom.set=function(u){var i=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==i&&(this._unmodified=!1,this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom,this._constrain(),this._calcMatrices())},pa.center.get=function(){return this._center},pa.center.set=function(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._constrain(),this._calcMatrices())},pa.padding.get=function(){return this._edgeInsets.toJSON()},pa.padding.set=function(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())},pa.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},zi.prototype.isPaddingEqual=function(u){return this._edgeInsets.equals(u)},zi.prototype.interpolatePadding=function(u,i,n){this._unmodified=!1,this._edgeInsets.interpolate(u,i,n),this._constrain(),this._calcMatrices()},zi.prototype.coveringZoomLevel=function(u){var i=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,i)},zi.prototype.getVisibleUnwrappedCoordinates=function(u){var i=[new a.UnwrappedTileID(0,u)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new a.Point(0,0)),c=this.pointCoordinate(new a.Point(this.width,0)),x=this.pointCoordinate(new a.Point(this.width,this.height)),P=this.pointCoordinate(new a.Point(0,this.height)),O=Math.floor(Math.min(n.x,c.x,x.x,P.x)),F=Math.floor(Math.max(n.x,c.x,x.x,P.x)),ue=O-1;ue<=F+1;ue++)ue!==0&&i.push(new a.UnwrappedTileID(ue,u));return i},zi.prototype.coveringTiles=function(u){var i=this.coveringZoomLevel(u),n=i;if(u.minzoom!==void 0&&i<u.minzoom)return[];u.maxzoom!==void 0&&i>u.maxzoom&&(i=u.maxzoom);var c=a.MercatorCoordinate.fromLngLat(this.center),x=Math.pow(2,i),P=[x*c.x,x*c.y,0],O=du.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i),F=u.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(F=i);var ue=function(yn){return{aabb:new ol([yn*x,0,0],[(yn+1)*x,x,0]),zoom:0,x:0,y:0,wrap:yn,fullyVisible:!1}},Ee=[],Xe=[],qe=i,tt=u.reparseOverscaled?n:i;if(this._renderWorldCopies)for(var zt=1;zt<=3;zt++)Ee.push(ue(-zt)),Ee.push(ue(zt));for(Ee.push(ue(0));Ee.length>0;){var Lt=Ee.pop(),Xt=Lt.x,Dt=Lt.y,Ut=Lt.fullyVisible;if(!Ut){var er=Lt.aabb.intersects(O);if(er===0)continue;Ut=er===2}var qt=Lt.aabb.distanceX(P),Ir=Lt.aabb.distanceY(P),hr=Math.max(Math.abs(qt),Math.abs(Ir));if(Lt.zoom===qe||hr>3+(1<<qe-Lt.zoom)-2&&Lt.zoom>=F)Xe.push({tileID:new a.OverscaledTileID(Lt.zoom===qe?tt:Lt.zoom,Lt.wrap,Lt.zoom,Xt,Dt),distanceSq:a.sqrLen([P[0]-.5-Xt,P[1]-.5-Dt])});else for(var Tr=0;Tr<4;Tr++){var _r=(Xt<<1)+Tr%2,nn=(Dt<<1)+(Tr>>1);Ee.push({aabb:Lt.aabb.quadrant(Tr),zoom:Lt.zoom+1,x:_r,y:nn,wrap:Lt.wrap,fullyVisible:Ut})}}return Xe.sort(function(Yr,yn){return Yr.distanceSq-yn.distanceSq}).map(function(Yr){return Yr.tileID})},zi.prototype.resize=function(u,i){this.width=u,this.height=i,this.pixelsToGLUnits=[2/u,-2/i],this._constrain(),this._calcMatrices()},pa.unmodified.get=function(){return this._unmodified},zi.prototype.zoomScale=function(u){return Math.pow(2,u)},zi.prototype.scaleZoom=function(u){return Math.log(u)/Math.LN2},zi.prototype.project=function(u){var i=a.clamp(u.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(u.lng)*this.worldSize,a.mercatorYfromLat(i)*this.worldSize)},zi.prototype.unproject=function(u){return new a.MercatorCoordinate(u.x/this.worldSize,u.y/this.worldSize).toLngLat()},pa.point.get=function(){return this.project(this.center)},zi.prototype.setLocationAtPoint=function(u,i){var n=this.pointCoordinate(i),c=this.pointCoordinate(this.centerPoint),x=this.locationCoordinate(u),P=new a.MercatorCoordinate(x.x-(n.x-c.x),x.y-(n.y-c.y));this.center=this.coordinateLocation(P),this._renderWorldCopies&&(this.center=this.center.wrap())},zi.prototype.locationPoint=function(u){return this.coordinatePoint(this.locationCoordinate(u))},zi.prototype.pointLocation=function(u){return this.coordinateLocation(this.pointCoordinate(u))},zi.prototype.locationCoordinate=function(u){return a.MercatorCoordinate.fromLngLat(u)},zi.prototype.coordinateLocation=function(u){return u.toLngLat()},zi.prototype.pointCoordinate=function(u){var i=[u.x,u.y,0,1],n=[u.x,u.y,1,1];a.transformMat4(i,i,this.pixelMatrixInverse),a.transformMat4(n,n,this.pixelMatrixInverse);var c=i[3],x=n[3],P=i[1]/c,O=n[1]/x,F=i[2]/c,ue=n[2]/x,Ee=F===ue?0:(0-F)/(ue-F);return new a.MercatorCoordinate(a.number(i[0]/c,n[0]/x,Ee)/this.worldSize,a.number(P,O,Ee)/this.worldSize)},zi.prototype.coordinatePoint=function(u){var i=[u.x*this.worldSize,u.y*this.worldSize,0,1];return a.transformMat4(i,i,this.pixelMatrix),new a.Point(i[0]/i[3],i[1]/i[3])},zi.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},zi.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},zi.prototype.setMaxBounds=function(u){u?(this.lngRange=[u.getWest(),u.getEast()],this.latRange=[u.getSouth(),u.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},zi.prototype.calculatePosMatrix=function(u,i){i===void 0&&(i=!1);var n=u.key,c=i?this._alignedPosMatrixCache:this._posMatrixCache;if(c[n])return c[n];var x=u.canonical,P=this.worldSize/this.zoomScale(x.z),O=x.x+Math.pow(2,x.z)*u.wrap,F=a.identity(new Float64Array(16));return a.translate(F,F,[O*P,x.y*P,0]),a.scale(F,F,[P/a.EXTENT,P/a.EXTENT,1]),a.multiply(F,i?this.alignedProjMatrix:this.projMatrix,F),c[n]=new Float32Array(F),c[n]},zi.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},zi.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var u,i,n,c,x=-90,P=90,O=-180,F=180,ue=this.size,Ee=this._unmodified;if(this.latRange){var Xe=this.latRange;x=a.mercatorYfromLat(Xe[1])*this.worldSize,u=(P=a.mercatorYfromLat(Xe[0])*this.worldSize)-x<ue.y?ue.y/(P-x):0}if(this.lngRange){var qe=this.lngRange;O=a.mercatorXfromLng(qe[0])*this.worldSize,i=(F=a.mercatorXfromLng(qe[1])*this.worldSize)-O<ue.x?ue.x/(F-O):0}var tt=this.point,zt=Math.max(i||0,u||0);if(zt)return this.center=this.unproject(new a.Point(i?(F+O)/2:tt.x,u?(P+x)/2:tt.y)),this.zoom+=this.scaleZoom(zt),this._unmodified=Ee,void(this._constraining=!1);if(this.latRange){var Lt=tt.y,Xt=ue.y/2;Lt-Xt<x&&(c=x+Xt),Lt+Xt>P&&(c=P-Xt)}if(this.lngRange){var Dt=tt.x,Ut=ue.x/2;Dt-Ut<O&&(n=O+Ut),Dt+Ut>F&&(n=F-Ut)}n===void 0&&c===void 0||(this.center=this.unproject(new a.Point(n!==void 0?n:tt.x,c!==void 0?c:tt.y))),this._unmodified=Ee,this._constraining=!1}},zi.prototype._calcMatrices=function(){if(this.height){var u=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var i=Math.PI/2+this._pitch,n=this._fov*(.5+u.y/this.height),c=Math.sin(n)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-i-n,.01,Math.PI-.01)),x=this.point,P=x.x,O=x.y,F=1.01*(Math.cos(Math.PI/2-this._pitch)*c+this.cameraToCenterDistance),ue=this.height/50,Ee=new Float64Array(16);a.perspective(Ee,this._fov,this.width/this.height,ue,F),Ee[8]=2*-u.x/this.width,Ee[9]=2*u.y/this.height,a.scale(Ee,Ee,[1,-1,1]),a.translate(Ee,Ee,[0,0,-this.cameraToCenterDistance]),a.rotateX(Ee,Ee,this._pitch),a.rotateZ(Ee,Ee,this.angle),a.translate(Ee,Ee,[-P,-O,0]),this.mercatorMatrix=a.scale([],Ee,[this.worldSize,this.worldSize,this.worldSize]),a.scale(Ee,Ee,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Ee,this.invProjMatrix=a.invert([],this.projMatrix);var Xe=this.width%2/2,qe=this.height%2/2,tt=Math.cos(this.angle),zt=Math.sin(this.angle),Lt=P-Math.round(P)+tt*Xe+zt*qe,Xt=O-Math.round(O)+tt*qe+zt*Xe,Dt=new Float64Array(Ee);if(a.translate(Dt,Dt,[Lt>.5?Lt-1:Lt,Xt>.5?Xt-1:Xt,0]),this.alignedProjMatrix=Dt,Ee=a.create(),a.scale(Ee,Ee,[this.width/2,-this.height/2,1]),a.translate(Ee,Ee,[1,-1,0]),this.labelPlaneMatrix=Ee,Ee=a.create(),a.scale(Ee,Ee,[1,-1,1]),a.translate(Ee,Ee,[-1,-1,0]),a.scale(Ee,Ee,[2/this.width,2/this.height,1]),this.glCoordMatrix=Ee,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Ee=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Ee,this._posMatrixCache={},this._alignedPosMatrixCache={}}},zi.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var u=this.pointCoordinate(new a.Point(0,0)),i=[u.x*this.worldSize,u.y*this.worldSize,0,1];return a.transformMat4(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance},zi.prototype.getCameraPoint=function(){var u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,u))},zi.prototype.getCameraQueryGeometry=function(u){var i=this.getCameraPoint();if(u.length===1)return[u[0],i];for(var n=i.x,c=i.y,x=i.x,P=i.y,O=0,F=u;O<F.length;O+=1){var ue=F[O];n=Math.min(n,ue.x),c=Math.min(c,ue.y),x=Math.max(x,ue.x),P=Math.max(P,ue.y)}return[new a.Point(n,c),new a.Point(x,c),new a.Point(x,P),new a.Point(n,P),new a.Point(n,c)]},Object.defineProperties(zi.prototype,pa);var Ps=function(i){var n,c,x,P;this._hashName=i&&encodeURIComponent(i),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),c=!1,x=null,P=function(){x=null,c&&(n(),x=setTimeout(P,300),c=!1)},function(){return c=!0,x||P(),x})};Ps.prototype.addTo=function(u){return this._map=u,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ps.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ps.prototype.getHashString=function(u){var i=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,c=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,c),P=Math.round(i.lng*x)/x,O=Math.round(i.lat*x)/x,F=this._map.getBearing(),ue=this._map.getPitch(),Ee="";if(Ee+=u?"/"+P+"/"+O+"/"+n:n+"/"+O+"/"+P,(F||ue)&&(Ee+="/"+Math.round(10*F)/10),ue&&(Ee+="/"+Math.round(ue)),this._hashName){var Xe=this._hashName,qe=!1,tt=a.window.location.hash.slice(1).split("&").map(function(zt){var Lt=zt.split("=")[0];return Lt===Xe?(qe=!0,Lt+"="+Ee):zt}).filter(function(zt){return zt});return qe||tt.push(Xe+"="+Ee),"#"+tt.join("&")}return"#"+Ee},Ps.prototype._getCurrentHash=function(){var u,i=this,n=a.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(c){return c.split("=")}).forEach(function(c){c[0]===i._hashName&&(u=c)}),(u&&u[1]||"").split("/")):n.split("/")},Ps.prototype._onHashChange=function(){var u=this._getCurrentHash();if(u.length>=3&&!u.some(function(n){return isNaN(n)})){var i=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:i,pitch:+(u[4]||0)}),!0}return!1},Ps.prototype._updateHashUnthrottled=function(){var u=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,u)}catch(i){}};var Sa={linearity:.3,easing:a.bezier(0,0,.3,1)},Gi=a.extend({deceleration:2500,maxSpeed:1400},Sa),ql=a.extend({deceleration:20,maxSpeed:1400},Sa),yf=a.extend({deceleration:1e3,maxSpeed:360},Sa),as=a.extend({deceleration:1e3,maxSpeed:90},Sa),ul=function(i){this._map=i,this.clear()};function pu(u,i){(!u.duration||u.duration<i.duration)&&(u.duration=i.duration,u.easing=i.easing)}function Xu(u,i,n){var c=n.maxSpeed,x=n.linearity,P=n.deceleration,O=a.clamp(u*x/(i/1e3),-c,c),F=Math.abs(O)/(P*x);return{easing:n.easing,duration:1e3*F,amount:O*(F/2)}}ul.prototype.clear=function(){this._inertiaBuffer=[]},ul.prototype.record=function(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:u})},ul.prototype._drainInertiaBuffer=function(){for(var u=this._inertiaBuffer,i=a.browser.now();u.length>0&&i-u[0].time>160;)u.shift()},ul.prototype._onMoveEnd=function(u){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var i={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},n=0,c=this._inertiaBuffer;n<c.length;n+=1){var x=c[n].settings;i.zoom+=x.zoomDelta||0,i.bearing+=x.bearingDelta||0,i.pitch+=x.pitchDelta||0,x.panDelta&&i.pan._add(x.panDelta),x.around&&(i.around=x.around),x.pinchAround&&(i.pinchAround=x.pinchAround)}var P=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,O={};if(i.pan.mag()){var F=Xu(i.pan.mag(),P,a.extend({},Gi,u||{}));O.offset=i.pan.mult(F.amount/i.pan.mag()),O.center=this._map.transform.center,pu(O,F)}if(i.zoom){var ue=Xu(i.zoom,P,ql);O.zoom=this._map.transform.zoom+ue.amount,pu(O,ue)}if(i.bearing){var Ee=Xu(i.bearing,P,yf);O.bearing=this._map.transform.bearing+a.clamp(Ee.amount,-179,179),pu(O,Ee)}if(i.pitch){var Xe=Xu(i.pitch,P,as);O.pitch=this._map.transform.pitch+Xe.amount,pu(O,Xe)}if(O.zoom||O.bearing){var qe=i.pinchAround===void 0?i.around:i.pinchAround;O.around=qe?this._map.unproject(qe):this._map.getCenter()}return this.clear(),a.extend(O,{noMoveStart:!0})}};var io=function(u){function i(c,x,P,O){O===void 0&&(O={});var F=D.mousePos(x.getCanvasContainer(),P),ue=x.unproject(F);u.call(this,c,a.extend({point:F,lngLat:ue,originalEvent:P},O)),this._defaultPrevented=!1,this.target=x}u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i;var n={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,n),i}(a.Event),os=function(u){function i(c,x,P){var O=c==="touchend"?P.changedTouches:P.touches,F=D.touchPos(x.getCanvasContainer(),O),ue=F.map(function(qe){return x.unproject(qe)}),Ee=F.reduce(function(qe,tt,zt,Lt){return qe.add(tt.div(Lt.length))},new a.Point(0,0)),Xe=x.unproject(Ee);u.call(this,c,{points:F,point:Ee,lngLats:ue,lngLat:Xe,originalEvent:P}),this._defaultPrevented=!1}u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i;var n={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,n),i}(a.Event),Nl=function(u){function i(c,x,P){u.call(this,c,{originalEvent:P}),this._defaultPrevented=!1}u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i;var n={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,n),i}(a.Event),lo=function(i,n){this._map=i,this._clickTolerance=n.clickTolerance};lo.prototype.reset=function(){delete this._mousedownPos},lo.prototype.wheel=function(u){return this._firePreventable(new Nl(u.type,this._map,u))},lo.prototype.mousedown=function(u,i){return this._mousedownPos=i,this._firePreventable(new io(u.type,this._map,u))},lo.prototype.mouseup=function(u){this._map.fire(new io(u.type,this._map,u))},lo.prototype.click=function(u,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||this._map.fire(new io(u.type,this._map,u))},lo.prototype.dblclick=function(u){return this._firePreventable(new io(u.type,this._map,u))},lo.prototype.mouseover=function(u){this._map.fire(new io(u.type,this._map,u))},lo.prototype.mouseout=function(u){this._map.fire(new io(u.type,this._map,u))},lo.prototype.touchstart=function(u){return this._firePreventable(new os(u.type,this._map,u))},lo.prototype.touchmove=function(u){this._map.fire(new os(u.type,this._map,u))},lo.prototype.touchend=function(u){this._map.fire(new os(u.type,this._map,u))},lo.prototype.touchcancel=function(u){this._map.fire(new os(u.type,this._map,u))},lo.prototype._firePreventable=function(u){if(this._map.fire(u),u.defaultPrevented)return{}},lo.prototype.isEnabled=function(){return!0},lo.prototype.isActive=function(){return!1},lo.prototype.enable=function(){},lo.prototype.disable=function(){};var In=function(i){this._map=i};In.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},In.prototype.mousemove=function(u){this._map.fire(new io(u.type,this._map,u))},In.prototype.mousedown=function(){this._delayContextMenu=!0},In.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new io("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},In.prototype.contextmenu=function(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new io(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()},In.prototype.isEnabled=function(){return!0},In.prototype.isActive=function(){return!1},In.prototype.enable=function(){},In.prototype.disable=function(){};var ks=function(i,n){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=n.clickTolerance||1};function bc(u,i){for(var n={},c=0;c<u.length;c++)n[u[c].identifier]=i[c];return n}ks.prototype.isEnabled=function(){return!!this._enabled},ks.prototype.isActive=function(){return!!this._active},ks.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},ks.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ks.prototype.mousedown=function(u,i){this.isEnabled()&&u.shiftKey&&u.button===0&&(D.disableDrag(),this._startPos=this._lastPos=i,this._active=!0)},ks.prototype.mousemoveWindow=function(u,i){if(this._active){var n=i;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var c=this._startPos;this._lastPos=n,this._box||(this._box=D.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));var x=Math.min(c.x,n.x),P=Math.max(c.x,n.x),O=Math.min(c.y,n.y),F=Math.max(c.y,n.y);D.setTransform(this._box,"translate("+x+"px,"+O+"px)"),this._box.style.width=P-x+"px",this._box.style.height=F-O+"px"}}},ks.prototype.mouseupWindow=function(u,i){var n=this;if(this._active&&u.button===0){var c=this._startPos,x=i;if(this.reset(),D.suppressClick(),c.x!==x.x||c.y!==x.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:u})),{cameraAnimation:function(O){return O.fitScreenCoordinates(c,x,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",u)}},ks.prototype.keydown=function(u){this._active&&u.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",u))},ks.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos},ks.prototype._fireEvent=function(u,i){return this._map.fire(new a.Event(u,{originalEvent:i}))};var El=function(i){this.reset(),this.numTouches=i.numTouches};El.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},El.prototype.touchstart=function(u,i,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=u.timeStamp),n.length===this.numTouches&&(this.centroid=function(c){for(var x=new a.Point(0,0),P=0,O=c;P<O.length;P+=1)x._add(O[P]);return x.div(c.length)}(i),this.touches=bc(n,i)))},El.prototype.touchmove=function(u,i,n){if(!this.aborted&&this.centroid){var c=bc(n,i);for(var x in this.touches){var P=c[x];(!P||P.dist(this.touches[x])>30)&&(this.aborted=!0)}}},El.prototype.touchend=function(u,i,n){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),n.length===0){var c=!this.aborted&&this.centroid;if(this.reset(),c)return c}};var wu=function(i){this.singleTap=new El(i),this.numTaps=i.numTaps,this.reset()};wu.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},wu.prototype.touchstart=function(u,i,n){this.singleTap.touchstart(u,i,n)},wu.prototype.touchmove=function(u,i,n){this.singleTap.touchmove(u,i,n)},wu.prototype.touchend=function(u,i,n){var c=this.singleTap.touchend(u,i,n);if(c){var x=u.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(c)<30;if(x&&P||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}};var js=function(){this._zoomIn=new wu({numTouches:1,numTaps:2}),this._zoomOut=new wu({numTouches:2,numTaps:1}),this.reset()};js.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},js.prototype.touchstart=function(u,i,n){this._zoomIn.touchstart(u,i,n),this._zoomOut.touchstart(u,i,n)},js.prototype.touchmove=function(u,i,n){this._zoomIn.touchmove(u,i,n),this._zoomOut.touchmove(u,i,n)},js.prototype.touchend=function(u,i,n){var c=this,x=this._zoomIn.touchend(u,i,n),P=this._zoomOut.touchend(u,i,n);return x?(this._active=!0,u.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(F){return F.easeTo({duration:300,zoom:F.getZoom()+1,around:F.unproject(x)},{originalEvent:u})}}):P?(this._active=!0,u.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(F){return F.easeTo({duration:300,zoom:F.getZoom()-1,around:F.unproject(P)},{originalEvent:u})}}):void 0},js.prototype.touchcancel=function(){this.reset()},js.prototype.enable=function(){this._enabled=!0},js.prototype.disable=function(){this._enabled=!1,this.reset()},js.prototype.isEnabled=function(){return this._enabled},js.prototype.isActive=function(){return this._active};var qi={0:1,2:2},qr=function(i){this.reset(),this._clickTolerance=i.clickTolerance||1};qr.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},qr.prototype._correctButton=function(u,i){return!1},qr.prototype._move=function(u,i){return{}},qr.prototype.mousedown=function(u,i){if(!this._lastPoint){var n=D.mouseButton(u);this._correctButton(u,n)&&(this._lastPoint=i,this._eventButton=n)}},qr.prototype.mousemoveWindow=function(u,i){var n=this._lastPoint;if(n){if(u.preventDefault(),function(c,x){var P=qi[x];return c.buttons===void 0||(c.buttons&P)!==P}(u,this._eventButton))this.reset();else if(this._moved||!(i.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=i,this._move(n,i)}},qr.prototype.mouseupWindow=function(u){this._lastPoint&&D.mouseButton(u)===this._eventButton&&(this._moved&&D.suppressClick(),this.reset())},qr.prototype.enable=function(){this._enabled=!0},qr.prototype.disable=function(){this._enabled=!1,this.reset()},qr.prototype.isEnabled=function(){return this._enabled},qr.prototype.isActive=function(){return this._active};var kc=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.mousedown=function(n,c){u.prototype.mousedown.call(this,n,c),this._lastPoint&&(this._active=!0)},i.prototype._correctButton=function(n,c){return c===0&&!n.ctrlKey},i.prototype._move=function(n,c){return{around:c,panDelta:c.sub(n)}},i}(qr),Sc=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype._correctButton=function(n,c){return c===0&&n.ctrlKey||c===2},i.prototype._move=function(n,c){var x=.8*(c.x-n.x);if(x)return this._active=!0,{bearingDelta:x}},i.prototype.contextmenu=function(n){n.preventDefault()},i}(qr),ll=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype._correctButton=function(n,c){return c===0&&n.ctrlKey||c===2},i.prototype._move=function(n,c){var x=-.5*(c.y-n.y);if(x)return this._active=!0,{pitchDelta:x}},i.prototype.contextmenu=function(n){n.preventDefault()},i}(qr),vu=function(i){this._minTouches=1,this._clickTolerance=i.clickTolerance||1,this.reset()};vu.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},vu.prototype.touchstart=function(u,i,n){return this._calculateTransform(u,i,n)},vu.prototype.touchmove=function(u,i,n){if(this._active&&!(n.length<this._minTouches))return u.preventDefault(),this._calculateTransform(u,i,n)},vu.prototype.touchend=function(u,i,n){this._calculateTransform(u,i,n),this._active&&n.length<this._minTouches&&this.reset()},vu.prototype.touchcancel=function(){this.reset()},vu.prototype._calculateTransform=function(u,i,n){n.length>0&&(this._active=!0);var c=bc(n,i),x=new a.Point(0,0),P=new a.Point(0,0),O=0;for(var F in c){var ue=c[F],Ee=this._touches[F];Ee&&(x._add(ue),P._add(ue.sub(Ee)),O++,c[F]=ue)}if(this._touches=c,!(O<this._minTouches)&&P.mag()){var Xe=P.div(O);if(this._sum._add(Xe),!(this._sum.mag()<this._clickTolerance))return{around:x.div(O),panDelta:Xe}}},vu.prototype.enable=function(){this._enabled=!0},vu.prototype.disable=function(){this._enabled=!1,this.reset()},vu.prototype.isEnabled=function(){return this._enabled},vu.prototype.isActive=function(){return this._active};var Ms=function(){this.reset()};function Is(u,i,n){for(var c=0;c<u.length;c++)if(u[c].identifier===n)return i[c]}function $o(u,i){return Math.log(u/i)/Math.LN2}Ms.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ms.prototype._start=function(u){},Ms.prototype._move=function(u,i,n){return{}},Ms.prototype.touchstart=function(u,i,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([i[0],i[1]]))},Ms.prototype.touchmove=function(u,i,n){if(this._firstTwoTouches){u.preventDefault();var c=this._firstTwoTouches,x=c[1],P=Is(n,i,c[0]),O=Is(n,i,x);if(P&&O){var F=this._aroundCenter?null:P.add(O).div(2);return this._move([P,O],F,u)}}},Ms.prototype.touchend=function(u,i,n){if(this._firstTwoTouches){var c=this._firstTwoTouches,x=c[1],P=Is(n,i,c[0]),O=Is(n,i,x);P&&O||(this._active&&D.suppressClick(),this.reset())}},Ms.prototype.touchcancel=function(){this.reset()},Ms.prototype.enable=function(u){this._enabled=!0,this._aroundCenter=!!u&&u.around==="center"},Ms.prototype.disable=function(){this._enabled=!1,this.reset()},Ms.prototype.isEnabled=function(){return this._enabled},Ms.prototype.isActive=function(){return this._active};var Bo=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.reset=function(){u.prototype.reset.call(this),delete this._distance,delete this._startDistance},i.prototype._start=function(n){this._startDistance=this._distance=n[0].dist(n[1])},i.prototype._move=function(n,c){var x=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs($o(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:$o(this._distance,x),pinchAround:c}},i}(Ms);function cl(u,i){return 180*u.angleWith(i)/Math.PI}var Tl=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.reset=function(){u.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},i.prototype._start=function(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])},i.prototype._move=function(n,c){var x=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:cl(this._vector,x),pinchAround:c}},i.prototype._isBelowThreshold=function(n){this._minDiameter=Math.min(this._minDiameter,n.mag());var c=25/(Math.PI*this._minDiameter)*360,x=cl(n,this._startVector);return Math.abs(x)<c},i}(Ms);function Fl(u){return Math.abs(u.y)>Math.abs(u.x)}var af=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.reset=function(){u.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},i.prototype._start=function(n){this._lastPoints=n,Fl(n[0].sub(n[1]))&&(this._valid=!1)},i.prototype._move=function(n,c,x){var P=n[0].sub(this._lastPoints[0]),O=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(P,O,x.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(P.y+O.y)/2*-.5}},i.prototype.gestureBeginsVertically=function(n,c,x){if(this._valid!==void 0)return this._valid;var P=n.mag()>=2,O=c.mag()>=2;if(P||O){if(!P||!O)return this._firstMove===void 0&&(this._firstMove=x),x-this._firstMove<100&&void 0;var F=n.y>0==c.y>0;return Fl(n)&&Fl(c)&&F}},i}(Ms),Bl={panStep:100,bearingStep:15,pitchStep:10},Os=function(){var i=Bl;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1};function ss(u){return u*(2-u)}Os.prototype.reset=function(){this._active=!1},Os.prototype.keydown=function(u){var i=this;if(!(u.altKey||u.ctrlKey||u.metaKey)){var n=0,c=0,x=0,P=0,O=0;switch(u.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:u.shiftKey?c=-1:(u.preventDefault(),P=-1);break;case 39:u.shiftKey?c=1:(u.preventDefault(),P=1);break;case 38:u.shiftKey?x=1:(u.preventDefault(),O=-1);break;case 40:u.shiftKey?x=-1:(u.preventDefault(),O=1);break;default:return}return this._rotationDisabled&&(c=0,x=0),{cameraAnimation:function(ue){var Ee=ue.getZoom();ue.easeTo({duration:300,easeId:"keyboardHandler",easing:ss,zoom:n?Math.round(Ee)+n*(u.shiftKey?2:1):Ee,bearing:ue.getBearing()+c*i._bearingStep,pitch:ue.getPitch()+x*i._pitchStep,offset:[-P*i._panStep,-O*i._panStep],center:ue.getCenter()},{originalEvent:u})}}}},Os.prototype.enable=function(){this._enabled=!0},Os.prototype.disable=function(){this._enabled=!1,this.reset()},Os.prototype.isEnabled=function(){return this._enabled},Os.prototype.isActive=function(){return this._active},Os.prototype.disableRotation=function(){this._rotationDisabled=!0},Os.prototype.enableRotation=function(){this._rotationDisabled=!1};var Mi=function(i,n){this._map=i,this._el=i.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};Mi.prototype.setZoomRate=function(u){this._defaultZoomRate=u},Mi.prototype.setWheelZoomRate=function(u){this._wheelZoomRate=u},Mi.prototype.isEnabled=function(){return!!this._enabled},Mi.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Mi.prototype.isZooming=function(){return!!this._zooming},Mi.prototype.enable=function(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=u&&u.around==="center")},Mi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Mi.prototype.wheel=function(u){if(this.isEnabled()){var i=u.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY,n=a.browser.now(),c=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,i!==0&&i%4.000244140625==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(c*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),u.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=u,this._delta-=i,this._active||this._start(u)),u.preventDefault()}},Mi.prototype._onTimeout=function(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},Mi.prototype._start=function(u){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var i=D.mousePos(this._el,u);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(i)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Mi.prototype.renderFrame=function(){var u=this;if(this._frameId&&(this._frameId=null,this.isActive())){var i=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,c=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&c!==0&&(c=1/c);var x=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(x*c))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var P,O=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,F=this._startZoom,ue=this._easing,Ee=!1;if(this._type==="wheel"&&F&&ue){var Xe=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),qe=ue(Xe);P=a.number(F,O,qe),Xe<1?this._frameId||(this._frameId=!0):Ee=!0}else P=O,Ee=!0;return this._active=!0,Ee&&(this._active=!1,this._finishTimeout=setTimeout(function(){u._zooming=!1,u._handler._triggerRenderFrame(),delete u._targetZoom,delete u._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ee,zoomDelta:P-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Mi.prototype._smoothOutEasing=function(u){var i=a.ease;if(this._prevEase){var n=this._prevEase,c=(a.browser.now()-n.start)/n.duration,x=n.easing(c+.01)-n.easing(c),P=.27/Math.sqrt(x*x+1e-4)*.01,O=Math.sqrt(.0729-P*P);i=a.bezier(P,O,.25,1)}return this._prevEase={start:a.browser.now(),duration:u,easing:i},i},Mi.prototype.reset=function(){this._active=!1};var Yu=function(i,n){this._clickZoom=i,this._tapZoom=n};Yu.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Yu.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Yu.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Yu.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ka=function(){this.reset()};ka.prototype.reset=function(){this._active=!1},ka.prototype.dblclick=function(u,i){return u.preventDefault(),{cameraAnimation:function(c){c.easeTo({duration:300,zoom:c.getZoom()+(u.shiftKey?-1:1),around:c.unproject(i)},{originalEvent:u})}}},ka.prototype.enable=function(){this._enabled=!0},ka.prototype.disable=function(){this._enabled=!1,this.reset()},ka.prototype.isEnabled=function(){return this._enabled},ka.prototype.isActive=function(){return this._active};var wo=function(){this._tap=new wu({numTouches:1,numTaps:1}),this.reset()};wo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},wo.prototype.touchstart=function(u,i,n){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=i[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(u,i,n))},wo.prototype.touchmove=function(u,i,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var c=i[0],x=c.y-this._swipePoint.y;return this._swipePoint=c,u.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(u,i,n)},wo.prototype.touchend=function(u,i,n){this._tapTime?this._swipePoint&&n.length===0&&this.reset():this._tap.touchend(u,i,n)&&(this._tapTime=u.timeStamp)},wo.prototype.touchcancel=function(){this.reset()},wo.prototype.enable=function(){this._enabled=!0},wo.prototype.disable=function(){this._enabled=!1,this.reset()},wo.prototype.isEnabled=function(){return this._enabled},wo.prototype.isActive=function(){return this._active};var Al=function(i,n,c){this._el=i,this._mousePan=n,this._touchPan=c};Al.prototype.enable=function(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Al.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Al.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Al.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var mu=function(i,n,c){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=n,this._mousePitch=c};mu.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},mu.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},mu.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},mu.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var gu=function(i,n,c,x){this._el=i,this._touchZoom=n,this._touchRotate=c,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0};gu.prototype.enable=function(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},gu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},gu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},gu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},gu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},gu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Es=function(i){return i.zoom||i.drag||i.pitch||i.rotate},Ec=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i}(a.Event);function $n(u){return u.panDelta&&u.panDelta.mag()||u.zoomDelta||u.bearingDelta||u.pitchDelta}var Fn=function(i,n){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ul(i),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),a.bindAll(["handleEvent","handleWindowEvent"],this);var c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[a.window,"blur",void 0]];for(var x=0,P=this._listeners;x<P.length;x+=1){var O=P[x],F=O[0];D.addEventListener(F,O[1],F===a.window.document?this.handleWindowEvent:this.handleEvent,O[2])}};Fn.prototype.destroy=function(){for(var u=0,i=this._listeners;u<i.length;u+=1){var n=i[u],c=n[0];D.removeEventListener(c,n[1],c===a.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},Fn.prototype._addDefaultHandlers=function(u){var i=this._map,n=i.getCanvasContainer();this._add("mapEvent",new lo(i,u));var c=i.boxZoom=new ks(i,u);this._add("boxZoom",c);var x=new js,P=new ka;i.doubleClickZoom=new Yu(P,x),this._add("tapZoom",x),this._add("clickZoom",P);var O=new wo;this._add("tapDragZoom",O);var F=i.touchPitch=new af;this._add("touchPitch",F);var ue=new Sc(u),Ee=new ll(u);i.dragRotate=new mu(u,ue,Ee),this._add("mouseRotate",ue,["mousePitch"]),this._add("mousePitch",Ee,["mouseRotate"]);var Xe=new kc(u),qe=new vu(u);i.dragPan=new Al(n,Xe,qe),this._add("mousePan",Xe),this._add("touchPan",qe,["touchZoom","touchRotate"]);var tt=new Tl,zt=new Bo;i.touchZoomRotate=new gu(n,zt,tt,O),this._add("touchRotate",tt,["touchPan","touchZoom"]),this._add("touchZoom",zt,["touchPan","touchRotate"]);var Lt=i.scrollZoom=new Mi(i,this);this._add("scrollZoom",Lt,["mousePan"]);var Xt=i.keyboard=new Os;this._add("keyboard",Xt),this._add("blockableMapEvent",new In(i));for(var Dt=0,Ut=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Dt<Ut.length;Dt+=1){var er=Ut[Dt];u.interactive&&u[er]&&i[er].enable(u[er])}},Fn.prototype._add=function(u,i,n){this._handlers.push({handlerName:u,handler:i,allowed:n}),this._handlersById[u]=i},Fn.prototype.stop=function(u){if(!this._updatingCamera){for(var i=0,n=this._handlers;i<n.length;i+=1)n[i].handler.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}},Fn.prototype.isActive=function(){for(var u=0,i=this._handlers;u<i.length;u+=1)if(i[u].handler.isActive())return!0;return!1},Fn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Fn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Fn.prototype.isMoving=function(){return Boolean(Es(this._eventsInProgress))||this.isZooming()},Fn.prototype._blockedByActive=function(u,i,n){for(var c in u)if(c!==n&&(!i||i.indexOf(c)<0))return!0;return!1},Fn.prototype.handleWindowEvent=function(u){this.handleEvent(u,u.type+"Window")},Fn.prototype._getMapTouches=function(u){for(var i=[],n=0,c=u;n<c.length;n+=1){var x=c[n];this._el.contains(x.target)&&i.push(x)}return i},Fn.prototype.handleEvent=function(u,i){if(u.type!=="blur"){this._updatingCamera=!0;for(var n=u.type==="renderFrame"?void 0:u,c={needsRenderFrame:!1},x={},P={},O=u.touches?this._getMapTouches(u.touches):void 0,F=O?D.touchPos(this._el,O):D.mousePos(this._el,u),ue=0,Ee=this._handlers;ue<Ee.length;ue+=1){var Xe=Ee[ue],qe=Xe.handlerName,tt=Xe.handler,zt=Xe.allowed;if(tt.isEnabled()){var Lt=void 0;this._blockedByActive(P,zt,qe)?tt.reset():tt[i||u.type]&&(Lt=tt[i||u.type](u,F,O),this.mergeHandlerResult(c,x,Lt,qe,n),Lt&&Lt.needsRenderFrame&&this._triggerRenderFrame()),(Lt||tt.isActive())&&(P[qe]=tt)}}var Xt={};for(var Dt in this._previousActiveHandlers)P[Dt]||(Xt[Dt]=n);this._previousActiveHandlers=P,(Object.keys(Xt).length||$n(c))&&(this._changes.push([c,x,Xt]),this._triggerRenderFrame()),(Object.keys(P).length||$n(c))&&this._map._stop(!0),this._updatingCamera=!1;var Ut=c.cameraAnimation;Ut&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Ut(this._map))}else this.stop(!0)},Fn.prototype.mergeHandlerResult=function(u,i,n,c,x){if(n){a.extend(u,n);var P={handlerName:c,originalEvent:n.originalEvent||x};n.zoomDelta!==void 0&&(i.zoom=P),n.panDelta!==void 0&&(i.drag=P),n.pitchDelta!==void 0&&(i.pitch=P),n.bearingDelta!==void 0&&(i.rotate=P)}},Fn.prototype._applyChanges=function(){for(var u={},i={},n={},c=0,x=this._changes;c<x.length;c+=1){var P=x[c],O=P[0],F=P[1],ue=P[2];O.panDelta&&(u.panDelta=(u.panDelta||new a.Point(0,0))._add(O.panDelta)),O.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+O.zoomDelta),O.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+O.bearingDelta),O.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+O.pitchDelta),O.around!==void 0&&(u.around=O.around),O.pinchAround!==void 0&&(u.pinchAround=O.pinchAround),O.noInertia&&(u.noInertia=O.noInertia),a.extend(i,F),a.extend(n,ue)}this._updateMapTransform(u,i,n),this._changes=[]},Fn.prototype._updateMapTransform=function(u,i,n){var c=this._map,x=c.transform;if(!$n(u))return this._fireEvents(i,n,!0);var P=u.panDelta,O=u.zoomDelta,F=u.bearingDelta,ue=u.pitchDelta,Ee=u.around,Xe=u.pinchAround;Xe!==void 0&&(Ee=Xe),c._stop(!0),Ee=Ee||c.transform.centerPoint;var qe=x.pointLocation(P?Ee.sub(P):Ee);F&&(x.bearing+=F),ue&&(x.pitch+=ue),O&&(x.zoom+=O),x.setLocationAtPoint(qe,Ee),this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(i,n,!0)},Fn.prototype._fireEvents=function(u,i,n){var c=this,x=Es(this._eventsInProgress),P=Es(u),O={};for(var F in u)this._eventsInProgress[F]||(O[F+"start"]=u[F].originalEvent),this._eventsInProgress[F]=u[F];for(var ue in!x&&P&&this._fireEvent("movestart",P.originalEvent),O)this._fireEvent(ue,O[ue]);for(var Ee in P&&this._fireEvent("move",P.originalEvent),u)this._fireEvent(Ee,u[Ee].originalEvent);var Xe,qe={};for(var tt in this._eventsInProgress){var zt=this._eventsInProgress[tt],Lt=zt.handlerName,Xt=zt.originalEvent;this._handlersById[Lt].isActive()||(delete this._eventsInProgress[tt],qe[tt+"end"]=Xe=i[Lt]||Xt)}for(var Dt in qe)this._fireEvent(Dt,qe[Dt]);var Ut=Es(this._eventsInProgress);if(n&&(x||P)&&!Ut){this._updatingCamera=!0;var er=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),qt=function(hr){return hr!==0&&-c._bearingSnap<hr&&hr<c._bearingSnap};er?(qt(er.bearing||this._map.getBearing())&&(er.bearing=0),this._map.easeTo(er,{originalEvent:Xe})):(this._map.fire(new a.Event("moveend",{originalEvent:Xe})),qt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Fn.prototype._fireEvent=function(u,i){this._map.fire(new a.Event(u,i?{originalEvent:i}:{}))},Fn.prototype._requestFrame=function(){var u=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(i){delete u._frameId,u.handleEvent(new Ec("renderFrame",{timeStamp:i})),u._applyChanges()})},Fn.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Tc=function(u){function i(n,c){u.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=c.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},i.prototype.setCenter=function(n,c){return this.jumpTo({center:n},c)},i.prototype.panBy=function(n,c,x){return n=a.Point.convert(n).mult(-1),this.panTo(this.transform.center,a.extend({offset:n},c),x)},i.prototype.panTo=function(n,c,x){return this.easeTo(a.extend({center:n},c),x)},i.prototype.getZoom=function(){return this.transform.zoom},i.prototype.setZoom=function(n,c){return this.jumpTo({zoom:n},c),this},i.prototype.zoomTo=function(n,c,x){return this.easeTo(a.extend({zoom:n},c),x)},i.prototype.zoomIn=function(n,c){return this.zoomTo(this.getZoom()+1,n,c),this},i.prototype.zoomOut=function(n,c){return this.zoomTo(this.getZoom()-1,n,c),this},i.prototype.getBearing=function(){return this.transform.bearing},i.prototype.setBearing=function(n,c){return this.jumpTo({bearing:n},c),this},i.prototype.getPadding=function(){return this.transform.padding},i.prototype.setPadding=function(n,c){return this.jumpTo({padding:n},c),this},i.prototype.rotateTo=function(n,c,x){return this.easeTo(a.extend({bearing:n},c),x)},i.prototype.resetNorth=function(n,c){return this.rotateTo(0,a.extend({duration:1e3},n),c),this},i.prototype.resetNorthPitch=function(n,c){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},n),c),this},i.prototype.snapToNorth=function(n,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,c):this},i.prototype.getPitch=function(){return this.transform.pitch},i.prototype.setPitch=function(n,c){return this.jumpTo({pitch:n},c),this},i.prototype.cameraForBounds=function(n,c){n=a.LngLatBounds.convert(n);var x=c&&c.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),x,c)},i.prototype._cameraForBoxAndBearing=function(n,c,x,P){var O={top:0,bottom:0,right:0,left:0};if(typeof(P=a.extend({padding:O,offset:[0,0],maxZoom:this.transform.maxZoom},P)).padding=="number"){var F=P.padding;P.padding={top:F,bottom:F,right:F,left:F}}P.padding=a.extend(O,P.padding);var ue=this.transform,Ee=ue.padding,Xe=ue.project(a.LngLat.convert(n)),qe=ue.project(a.LngLat.convert(c)),tt=Xe.rotate(-x*Math.PI/180),zt=qe.rotate(-x*Math.PI/180),Lt=new a.Point(Math.max(tt.x,zt.x),Math.max(tt.y,zt.y)),Xt=new a.Point(Math.min(tt.x,zt.x),Math.min(tt.y,zt.y)),Dt=Lt.sub(Xt),Ut=(ue.width-(Ee.left+Ee.right+P.padding.left+P.padding.right))/Dt.x,er=(ue.height-(Ee.top+Ee.bottom+P.padding.top+P.padding.bottom))/Dt.y;if(!(er<0||Ut<0)){var qt=Math.min(ue.scaleZoom(ue.scale*Math.min(Ut,er)),P.maxZoom),Ir=typeof P.offset.x=="number"?new a.Point(P.offset.x,P.offset.y):a.Point.convert(P.offset),hr=new a.Point((P.padding.left-P.padding.right)/2,(P.padding.top-P.padding.bottom)/2).rotate(x*Math.PI/180),Tr=Ir.add(hr).mult(ue.scale/ue.zoomScale(qt));return{center:ue.unproject(Xe.add(qe).div(2).sub(Tr)),zoom:qt,bearing:x}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},i.prototype.fitBounds=function(n,c,x){return this._fitInternal(this.cameraForBounds(n,c),c,x)},i.prototype.fitScreenCoordinates=function(n,c,x,P,O){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(n)),this.transform.pointLocation(a.Point.convert(c)),x,P),P,O)},i.prototype._fitInternal=function(n,c,x){return n?(delete(c=a.extend(n,c)).padding,c.linear?this.easeTo(c,x):this.flyTo(c,x)):this},i.prototype.jumpTo=function(n,c){this.stop();var x=this.transform,P=!1,O=!1,F=!1;return"zoom"in n&&x.zoom!==+n.zoom&&(P=!0,x.zoom=+n.zoom),n.center!==void 0&&(x.center=a.LngLat.convert(n.center)),"bearing"in n&&x.bearing!==+n.bearing&&(O=!0,x.bearing=+n.bearing),"pitch"in n&&x.pitch!==+n.pitch&&(F=!0,x.pitch=+n.pitch),n.padding==null||x.isPaddingEqual(n.padding)||(x.padding=n.padding),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),P&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),O&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),F&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))},i.prototype.easeTo=function(n,c){var x=this;this._stop(!1,n.easeId),((n=a.extend({offset:[0,0],duration:500,easing:a.ease},n)).animate===!1||!n.essential&&a.browser.prefersReducedMotion)&&(n.duration=0);var P=this.transform,O=this.getZoom(),F=this.getBearing(),ue=this.getPitch(),Ee=this.getPadding(),Xe="zoom"in n?+n.zoom:O,qe="bearing"in n?this._normalizeBearing(n.bearing,F):F,tt="pitch"in n?+n.pitch:ue,zt="padding"in n?n.padding:P.padding,Lt=a.Point.convert(n.offset),Xt=P.centerPoint.add(Lt),Dt=P.pointLocation(Xt),Ut=a.LngLat.convert(n.center||Dt);this._normalizeCenter(Ut);var er,qt,Ir=P.project(Dt),hr=P.project(Ut).sub(Ir),Tr=P.zoomScale(Xe-O);n.around&&(er=a.LngLat.convert(n.around),qt=P.locationPoint(er));var _r={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Xe!==O,this._rotating=this._rotating||F!==qe,this._pitching=this._pitching||tt!==ue,this._padding=!P.isPaddingEqual(zt),this._easeId=n.easeId,this._prepareEase(c,n.noMoveStart,_r),this._ease(function(nn){if(x._zooming&&(P.zoom=a.number(O,Xe,nn)),x._rotating&&(P.bearing=a.number(F,qe,nn)),x._pitching&&(P.pitch=a.number(ue,tt,nn)),x._padding&&(P.interpolatePadding(Ee,zt,nn),Xt=P.centerPoint.add(Lt)),er)P.setLocationAtPoint(er,qt);else{var Yr=P.zoomScale(P.zoom-O),yn=Xe>O?Math.min(2,Tr):Math.max(.5,Tr),On=Math.pow(yn,1-nn),Qn=P.unproject(Ir.add(hr.mult(nn*On)).mult(Yr));P.setLocationAtPoint(P.renderWorldCopies?Qn.wrap():Qn,Xt)}x._fireMoveEvents(c)},function(nn){x._afterEase(c,nn)},n),this},i.prototype._prepareEase=function(n,c,x){x===void 0&&(x={}),this._moving=!0,c||x.moving||this.fire(new a.Event("movestart",n)),this._zooming&&!x.zooming&&this.fire(new a.Event("zoomstart",n)),this._rotating&&!x.rotating&&this.fire(new a.Event("rotatestart",n)),this._pitching&&!x.pitching&&this.fire(new a.Event("pitchstart",n))},i.prototype._fireMoveEvents=function(n){this.fire(new a.Event("move",n)),this._zooming&&this.fire(new a.Event("zoom",n)),this._rotating&&this.fire(new a.Event("rotate",n)),this._pitching&&this.fire(new a.Event("pitch",n))},i.prototype._afterEase=function(n,c){if(!this._easeId||!c||this._easeId!==c){delete this._easeId;var x=this._zooming,P=this._rotating,O=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,x&&this.fire(new a.Event("zoomend",n)),P&&this.fire(new a.Event("rotateend",n)),O&&this.fire(new a.Event("pitchend",n)),this.fire(new a.Event("moveend",n))}},i.prototype.flyTo=function(n,c){var x=this;if(!n.essential&&a.browser.prefersReducedMotion){var P=a.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(P,c)}this.stop(),n=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},n);var O=this.transform,F=this.getZoom(),ue=this.getBearing(),Ee=this.getPitch(),Xe=this.getPadding(),qe="zoom"in n?a.clamp(+n.zoom,O.minZoom,O.maxZoom):F,tt="bearing"in n?this._normalizeBearing(n.bearing,ue):ue,zt="pitch"in n?+n.pitch:Ee,Lt="padding"in n?n.padding:O.padding,Xt=O.zoomScale(qe-F),Dt=a.Point.convert(n.offset),Ut=O.centerPoint.add(Dt),er=O.pointLocation(Ut),qt=a.LngLat.convert(n.center||er);this._normalizeCenter(qt);var Ir=O.project(er),hr=O.project(qt).sub(Ir),Tr=n.curve,_r=Math.max(O.width,O.height),nn=_r/Xt,Yr=hr.mag();if("minZoom"in n){var yn=a.clamp(Math.min(n.minZoom,F,qe),O.minZoom,O.maxZoom),On=_r/O.zoomScale(yn-F);Tr=Math.sqrt(On/Yr*2)}var Qn=Tr*Tr;function oi(ri){var Ii=(nn*nn-_r*_r+(ri?-1:1)*Qn*Qn*Yr*Yr)/(2*(ri?nn:_r)*Qn*Yr);return Math.log(Math.sqrt(Ii*Ii+1)-Ii)}function yi(ri){return(Math.exp(ri)-Math.exp(-ri))/2}function Zi(ri){return(Math.exp(ri)+Math.exp(-ri))/2}var An=oi(0),si=function(Ii){return Zi(An)/Zi(An+Tr*Ii)},xi=function(Ii){return _r*((Zi(An)*(yi(Bi=An+Tr*Ii)/Zi(Bi))-yi(An))/Qn)/Yr;var Bi},Wn=(oi(1)-An)/Tr;if(Math.abs(Yr)<1e-6||!isFinite(Wn)){if(Math.abs(_r-nn)<1e-6)return this.easeTo(n,c);var Ti=nn<_r?-1:1;Wn=Math.abs(Math.log(nn/_r))/Tr,xi=function(){return 0},si=function(Ii){return Math.exp(Ti*Tr*Ii)}}return n.duration="duration"in n?+n.duration:1e3*Wn/("screenSpeed"in n?+n.screenSpeed/Tr:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=ue!==tt,this._pitching=zt!==Ee,this._padding=!O.isPaddingEqual(Lt),this._prepareEase(c,!1),this._ease(function(ri){var Ii=ri*Wn,Bi=1/si(Ii);O.zoom=ri===1?qe:F+O.scaleZoom(Bi),x._rotating&&(O.bearing=a.number(ue,tt,ri)),x._pitching&&(O.pitch=a.number(Ee,zt,ri)),x._padding&&(O.interpolatePadding(Xe,Lt,ri),Ut=O.centerPoint.add(Dt));var qa=ri===1?qt:O.unproject(Ir.add(hr.mult(xi(Ii))).mult(Bi));O.setLocationAtPoint(O.renderWorldCopies?qa.wrap():qa,Ut),x._fireMoveEvents(c)},function(){return x._afterEase(c)},n),this},i.prototype.isEasing=function(){return!!this._easeFrameId},i.prototype.stop=function(){return this._stop()},i.prototype._stop=function(n,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var x=this._onEaseEnd;delete this._onEaseEnd,x.call(this,c)}if(!n){var P=this.handlers;P&&P.stop(!1)}return this},i.prototype._ease=function(n,c,x){x.animate===!1||x.duration===0?(n(1),c()):(this._easeStart=a.browser.now(),this._easeOptions=x,this._onEaseFrame=n,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},i.prototype._renderFrameCallback=function(){var n=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},i.prototype._normalizeBearing=function(n,c){n=a.wrap(n,-180,180);var x=Math.abs(n-c);return Math.abs(n-360-c)<x&&(n-=360),Math.abs(n+360-c)<x&&(n+=360),n},i.prototype._normalizeCenter=function(n){var c=this.transform;if(c.renderWorldCopies&&!c.lngRange){var x=n.lng-c.center.lng;n.lng+=x>180?-360:x<-180?360:0}},i}(a.Evented),vs=function(i){i===void 0&&(i={}),this.options=i,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};vs.prototype.getDefaultPosition=function(){return"bottom-right"},vs.prototype.onAdd=function(u){var i=this.options&&this.options.compact;return this._map=u,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),i&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),i===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},vs.prototype.onRemove=function(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},vs.prototype._setElementTitle=function(u,i){var n=this._map._getUIString("AttributionControl."+i);u.title=n,u.setAttribute("aria-label",n)},vs.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},vs.prototype._updateEditLink=function(){var u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));var i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(u){var n=i.reduce(function(c,x,P){return x.value&&(c+=x.key+"="+x.value+(P<i.length-1?"&":"")),c},"?");u.href=a.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),u.rel="noopener nofollow",this._setElementTitle(u,"MapFeedback")}},vs.prototype._updateData=function(u){!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},vs.prototype._updateAttributions=function(){if(this._map.style){var u=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=u.concat(this.options.customAttribution.map(function(F){return typeof F!="string"?"":F})):typeof this.options.customAttribution=="string"&&u.push(this.options.customAttribution)),this._map.style.stylesheet){var i=this._map.style.stylesheet;this.styleOwner=i.owner,this.styleId=i.id}var n=this._map.style.sourceCaches;for(var c in n){var x=n[c];if(x.used){var P=x.getSource();P.attribution&&u.indexOf(P.attribution)<0&&u.push(P.attribution)}}u.sort(function(F,ue){return F.length-ue.length});var O=(u=u.filter(function(F,ue){for(var Ee=ue+1;Ee<u.length;Ee++)if(u[Ee].indexOf(F)>=0)return!1;return!0})).join(" | ");O!==this._attribHTML&&(this._attribHTML=O,u.length?(this._innerContainer.innerHTML=O,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},vs.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var ko=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};ko.prototype.onAdd=function(u){this._map=u,this._container=D.create("div","mapboxgl-ctrl");var i=D.create("a","mapboxgl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://www.mapbox.com/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ko.prototype.onRemove=function(){D.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ko.prototype.getDefaultPosition=function(){return"bottom-left"},ko.prototype._updateLogo=function(u){u&&u.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ko.prototype._logoRequired=function(){if(this._map.style){var u=this._map.style.sourceCaches;for(var i in u)if(u[i].getSource().mapbox_logo)return!0;return!1}},ko.prototype._updateCompact=function(){var u=this._container.children;if(u.length){var i=u[0];this._map.getCanvasContainer().offsetWidth<250?i.classList.add("mapboxgl-compact"):i.classList.remove("mapboxgl-compact")}};var Po=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Po.prototype.add=function(u){var i=++this._id;return this._queue.push({callback:u,id:i,cancelled:!1}),i},Po.prototype.remove=function(u){for(var i=this._currentlyRunning,n=0,c=i?this._queue.concat(i):this._queue;n<c.length;n+=1){var x=c[n];if(x.id===u)return void(x.cancelled=!0)}},Po.prototype.run=function(u){u===void 0&&(u=0);var i=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,c=i;n<c.length;n+=1){var x=c[n];if(!x.cancelled&&(x.callback(u),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Po.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ru={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Pu=a.window.HTMLImageElement,ec=a.window.HTMLElement,Hi=a.window.ImageBitmap,Za={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},fl=function(u){function i(c){var x=this;if((c=a.extend({},Za,c)).minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var P=new zi(c.minZoom,c.maxZoom,c.minPitch,c.maxPitch,c.renderWorldCopies);if(u.call(this,P,c),this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._failIfMajorPerformanceCaveat=c.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=c.preserveDrawingBuffer,this._antialias=c.antialias,this._trackResize=c.trackResize,this._bearingSnap=c.bearingSnap,this._refreshExpiredTiles=c.refreshExpiredTiles,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=c.collectResourceTiming,this._renderTaskQueue=new Po,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},ru,c.locale),this._clickTolerance=c.clickTolerance,this._requestManager=new a.RequestManager(c.transformRequest,c.accessToken),typeof c.container=="string"){if(this._container=a.window.document.getElementById(c.container),!this._container)throw new Error("Container '"+c.container+"' not found.")}else{if(!(c.container instanceof ec))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return x._update(!1)}),this.on("moveend",function(){return x._update(!1)}),this.on("zoom",function(){return x._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Fn(this,c),this._hash=c.hash&&new Ps(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,a.extend({},c.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=c.localIdeographFontFamily,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new vs({customAttribution:c.customAttribution})),this.addControl(new ko,c.logoPosition),this.on("style.load",function(){x.transform.unmodified&&x.jumpTo(x.style.stylesheet)}),this.on("data",function(O){x._update(O.dataType==="style"),x.fire(new a.Event(O.dataType+"data",O))}),this.on("dataloading",function(O){x.fire(new a.Event(O.dataType+"dataloading",O))})}u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i;var n={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return i.prototype._getMapId=function(){return this._mapId},i.prototype.addControl=function(c,x){if(x===void 0&&(x=c.getDefaultPosition?c.getDefaultPosition():"top-right"),!c||!c.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var P=c.onAdd(this);this._controls.push(c);var O=this._controlPositions[x];return x.indexOf("bottom")!==-1?O.insertBefore(P,O.firstChild):O.appendChild(P),this},i.prototype.removeControl=function(c){if(!c||!c.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var x=this._controls.indexOf(c);return x>-1&&this._controls.splice(x,1),c.onRemove(this),this},i.prototype.hasControl=function(c){return this._controls.indexOf(c)>-1},i.prototype.resize=function(c){var x=this._containerDimensions(),P=x[0],O=x[1];this._resizeCanvas(P,O),this.transform.resize(P,O),this.painter.resize(P,O);var F=!this._moving;return F&&(this.stop(),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c))),this.fire(new a.Event("resize",c)),F&&this.fire(new a.Event("moveend",c)),this},i.prototype.getBounds=function(){return this.transform.getBounds()},i.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},i.prototype.setMaxBounds=function(c){return this.transform.setMaxBounds(a.LngLatBounds.convert(c)),this._update()},i.prototype.setMinZoom=function(c){if((c=c==null?-2:c)>=-2&&c<=this.transform.maxZoom)return this.transform.minZoom=c,this._update(),this.getZoom()<c&&this.setZoom(c),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},i.prototype.getMinZoom=function(){return this.transform.minZoom},i.prototype.setMaxZoom=function(c){if((c=c==null?22:c)>=this.transform.minZoom)return this.transform.maxZoom=c,this._update(),this.getZoom()>c&&this.setZoom(c),this;throw new Error("maxZoom must be greater than the current minZoom")},i.prototype.getMaxZoom=function(){return this.transform.maxZoom},i.prototype.setMinPitch=function(c){if((c=c==null?0:c)<0)throw new Error("minPitch must be greater than or equal to 0");if(c>=0&&c<=this.transform.maxPitch)return this.transform.minPitch=c,this._update(),this.getPitch()<c&&this.setPitch(c),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},i.prototype.getMinPitch=function(){return this.transform.minPitch},i.prototype.setMaxPitch=function(c){if((c=c==null?60:c)>60)throw new Error("maxPitch must be less than or equal to 60");if(c>=this.transform.minPitch)return this.transform.maxPitch=c,this._update(),this.getPitch()>c&&this.setPitch(c),this;throw new Error("maxPitch must be greater than the current minPitch")},i.prototype.getMaxPitch=function(){return this.transform.maxPitch},i.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},i.prototype.setRenderWorldCopies=function(c){return this.transform.renderWorldCopies=c,this._update()},i.prototype.project=function(c){return this.transform.locationPoint(a.LngLat.convert(c))},i.prototype.unproject=function(c){return this.transform.pointLocation(a.Point.convert(c))},i.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},i.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},i.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},i.prototype._createDelegatedListener=function(c,x,P){var O,F=this;if(c==="mouseenter"||c==="mouseover"){var ue=!1;return{layer:x,listener:P,delegates:{mousemove:function(qe){var tt=F.getLayer(x)?F.queryRenderedFeatures(qe.point,{layers:[x]}):[];tt.length?ue||(ue=!0,P.call(F,new io(c,F,qe.originalEvent,{features:tt}))):ue=!1},mouseout:function(){ue=!1}}}}if(c==="mouseleave"||c==="mouseout"){var Ee=!1;return{layer:x,listener:P,delegates:{mousemove:function(qe){(F.getLayer(x)?F.queryRenderedFeatures(qe.point,{layers:[x]}):[]).length?Ee=!0:Ee&&(Ee=!1,P.call(F,new io(c,F,qe.originalEvent)))},mouseout:function(qe){Ee&&(Ee=!1,P.call(F,new io(c,F,qe.originalEvent)))}}}}return{layer:x,listener:P,delegates:(O={},O[c]=function(Xe){var qe=F.getLayer(x)?F.queryRenderedFeatures(Xe.point,{layers:[x]}):[];qe.length&&(Xe.features=qe,P.call(F,Xe),delete Xe.features)},O)}},i.prototype.on=function(c,x,P){if(P===void 0)return u.prototype.on.call(this,c,x);var O=this._createDelegatedListener(c,x,P);for(var F in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[c]=this._delegatedListeners[c]||[],this._delegatedListeners[c].push(O),O.delegates)this.on(F,O.delegates[F]);return this},i.prototype.once=function(c,x,P){if(P===void 0)return u.prototype.once.call(this,c,x);var O=this._createDelegatedListener(c,x,P);for(var F in O.delegates)this.once(F,O.delegates[F]);return this},i.prototype.off=function(c,x,P){var O=this;return P===void 0?u.prototype.off.call(this,c,x):(this._delegatedListeners&&this._delegatedListeners[c]&&function(F){for(var ue=F[c],Ee=0;Ee<ue.length;Ee++){var Xe=ue[Ee];if(Xe.layer===x&&Xe.listener===P){for(var qe in Xe.delegates)O.off(qe,Xe.delegates[qe]);return ue.splice(Ee,1),O}}}(this._delegatedListeners),this)},i.prototype.queryRenderedFeatures=function(c,x){if(!this.style)return[];var P;if(x!==void 0||c===void 0||c instanceof a.Point||Array.isArray(c)||(x=c,c=void 0),x=x||{},(c=c||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof c[0]=="number")P=[a.Point.convert(c)];else{var O=a.Point.convert(c[0]),F=a.Point.convert(c[1]);P=[O,new a.Point(F.x,O.y),F,new a.Point(O.x,F.y),O]}return this.style.queryRenderedFeatures(P,x,this.transform)},i.prototype.querySourceFeatures=function(c,x){return this.style.querySourceFeatures(c,x)},i.prototype.setStyle=function(c,x){return(x=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},x)).diff!==!1&&x.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&c?(this._diffStyle(c,x),this):(this._localIdeographFontFamily=x.localIdeographFontFamily,this._updateStyle(c,x))},i.prototype._getUIString=function(c){var x=this._locale[c];if(x==null)throw new Error("Missing UI string '"+c+"'");return x},i.prototype._updateStyle=function(c,x){return this.style&&(this.style.setEventedParent(null),this.style._remove()),c?(this.style=new ya(this,x||{}),this.style.setEventedParent(this,{style:this.style}),typeof c=="string"?this.style.loadURL(c):this.style.loadJSON(c),this):(delete this.style,this)},i.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new ya(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},i.prototype._diffStyle=function(c,x){var P=this;if(typeof c=="string"){var O=this._requestManager.normalizeStyleURL(c),F=this._requestManager.transformRequest(O,a.ResourceType.Style);a.getJSON(F,function(ue,Ee){ue?P.fire(new a.ErrorEvent(ue)):Ee&&P._updateDiff(Ee,x)})}else typeof c=="object"&&this._updateDiff(c,x)},i.prototype._updateDiff=function(c,x){try{this.style.setState(c)&&this._update(!0)}catch(P){a.warnOnce("Unable to perform style diff: "+(P.message||P.error||P)+".  Rebuilding the style from scratch."),this._updateStyle(c,x)}},i.prototype.getStyle=function(){if(this.style)return this.style.serialize()},i.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},i.prototype.addSource=function(c,x){return this._lazyInitEmptyStyle(),this.style.addSource(c,x),this._update(!0)},i.prototype.isSourceLoaded=function(c){var x=this.style&&this.style.sourceCaches[c];if(x!==void 0)return x.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+c+"'")))},i.prototype.areTilesLoaded=function(){var c=this.style&&this.style.sourceCaches;for(var x in c){var P=c[x]._tiles;for(var O in P){var F=P[O];if(F.state!=="loaded"&&F.state!=="errored")return!1}}return!0},i.prototype.addSourceType=function(c,x,P){return this._lazyInitEmptyStyle(),this.style.addSourceType(c,x,P)},i.prototype.removeSource=function(c){return this.style.removeSource(c),this._update(!0)},i.prototype.getSource=function(c){return this.style.getSource(c)},i.prototype.addImage=function(c,x,P){P===void 0&&(P={});var O=P.pixelRatio;O===void 0&&(O=1);var F=P.sdf;F===void 0&&(F=!1);var ue=P.stretchX,Ee=P.stretchY,Xe=P.content;if(this._lazyInitEmptyStyle(),x instanceof Pu||Hi&&x instanceof Hi){var qe=a.browser.getImageData(x);this.style.addImage(c,{data:new a.RGBAImage({width:qe.width,height:qe.height},qe.data),pixelRatio:O,stretchX:ue,stretchY:Ee,content:Xe,sdf:F,version:0})}else{if(x.width===void 0||x.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var tt=x;this.style.addImage(c,{data:new a.RGBAImage({width:x.width,height:x.height},new Uint8Array(x.data)),pixelRatio:O,stretchX:ue,stretchY:Ee,content:Xe,sdf:F,version:0,userImage:tt}),tt.onAdd&&tt.onAdd(this,c)}},i.prototype.updateImage=function(c,x){var P=this.style.getImage(c);if(!P)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var O=x instanceof Pu||Hi&&x instanceof Hi?a.browser.getImageData(x):x,F=O.width,ue=O.height,Ee=O.data;return F===void 0||ue===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):F!==P.data.width||ue!==P.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(P.data.replace(Ee,!(x instanceof Pu||Hi&&x instanceof Hi)),void this.style.updateImage(c,P))},i.prototype.hasImage=function(c){return c?!!this.style.getImage(c):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},i.prototype.removeImage=function(c){this.style.removeImage(c)},i.prototype.loadImage=function(c,x){a.getImage(this._requestManager.transformRequest(c,a.ResourceType.Image),x)},i.prototype.listImages=function(){return this.style.listImages()},i.prototype.addLayer=function(c,x){return this._lazyInitEmptyStyle(),this.style.addLayer(c,x),this._update(!0)},i.prototype.moveLayer=function(c,x){return this.style.moveLayer(c,x),this._update(!0)},i.prototype.removeLayer=function(c){return this.style.removeLayer(c),this._update(!0)},i.prototype.getLayer=function(c){return this.style.getLayer(c)},i.prototype.setLayerZoomRange=function(c,x,P){return this.style.setLayerZoomRange(c,x,P),this._update(!0)},i.prototype.setFilter=function(c,x,P){return P===void 0&&(P={}),this.style.setFilter(c,x,P),this._update(!0)},i.prototype.getFilter=function(c){return this.style.getFilter(c)},i.prototype.setPaintProperty=function(c,x,P,O){return O===void 0&&(O={}),this.style.setPaintProperty(c,x,P,O),this._update(!0)},i.prototype.getPaintProperty=function(c,x){return this.style.getPaintProperty(c,x)},i.prototype.setLayoutProperty=function(c,x,P,O){return O===void 0&&(O={}),this.style.setLayoutProperty(c,x,P,O),this._update(!0)},i.prototype.getLayoutProperty=function(c,x){return this.style.getLayoutProperty(c,x)},i.prototype.setLight=function(c,x){return x===void 0&&(x={}),this._lazyInitEmptyStyle(),this.style.setLight(c,x),this._update(!0)},i.prototype.getLight=function(){return this.style.getLight()},i.prototype.setFeatureState=function(c,x){return this.style.setFeatureState(c,x),this._update()},i.prototype.removeFeatureState=function(c,x){return this.style.removeFeatureState(c,x),this._update()},i.prototype.getFeatureState=function(c){return this.style.getFeatureState(c)},i.prototype.getContainer=function(){return this._container},i.prototype.getCanvasContainer=function(){return this._canvasContainer},i.prototype.getCanvas=function(){return this._canvas},i.prototype._containerDimensions=function(){var c=0,x=0;return this._container&&(c=this._container.clientWidth||400,x=this._container.clientHeight||300),[c,x]},i.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},i.prototype._setupContainer=function(){var c=this._container;c.classList.add("mapboxgl-map"),(this._missingCSSCanary=D.create("div","mapboxgl-canary",c)).style.visibility="hidden",this._detectMissingCSS();var x=this._canvasContainer=D.create("div","mapboxgl-canvas-container",c);this._interactive&&x.classList.add("mapboxgl-interactive"),this._canvas=D.create("canvas","mapboxgl-canvas",x),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var P=this._containerDimensions();this._resizeCanvas(P[0],P[1]);var O=this._controlContainer=D.create("div","mapboxgl-control-container",c),F=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(ue){F[ue]=D.create("div","mapboxgl-ctrl-"+ue,O)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},i.prototype._resizeCanvas=function(c,x){var P=a.browser.devicePixelRatio||1;this._canvas.width=P*c,this._canvas.height=P*x,this._canvas.style.width=c+"px",this._canvas.style.height=x+"px"},i.prototype._setupPainter=function(){var c=a.extend({},W.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),x=this._canvas.getContext("webgl",c)||this._canvas.getContext("experimental-webgl",c);x?(this.painter=new Ba(x,this.transform),a.webpSupported.testSupport(x)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},i.prototype._contextLost=function(c){c.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:c}))},i.prototype._contextRestored=function(c){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:c}))},i.prototype._onMapScroll=function(c){if(c.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},i.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},i.prototype._update=function(c){return this.style?(this._styleDirty=this._styleDirty||c,this._sourcesDirty=!0,this.triggerRepaint(),this):this},i.prototype._requestRenderFrame=function(c){return this._update(),this._renderTaskQueue.add(c)},i.prototype._cancelRenderFrame=function(c){this._renderTaskQueue.remove(c)},i.prototype._render=function(c){var x,P=this,O=0,F=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(x=F.createQueryEXT(),F.beginQueryEXT(F.TIME_ELAPSED_EXT,x),O=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(c),!this._removed){var ue=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ee=this.transform.zoom,Xe=a.browser.now();this.style.zoomHistory.update(Ee,Xe);var qe=new a.EvaluationParameters(Ee,{now:Xe,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),tt=qe.crossFadingFactor();tt===1&&tt===this._crossFadingFactor||(ue=!0,this._crossFadingFactor=tt),this.style.update(qe)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||ue)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var zt=a.browser.now()-O;F.endQueryEXT(F.TIME_ELAPSED_EXT,x),setTimeout(function(){var Dt=F.getQueryObjectEXT(x,F.QUERY_RESULT_EXT)/1e6;F.deleteQueryEXT(x),P.fire(new a.Event("gpu-timing-frame",{cpuTime:zt,gpuTime:Dt}))},50)}if(this.listens("gpu-timing-layer")){var Lt=this.painter.collectGpuTimers();setTimeout(function(){var Dt=P.painter.queryGpuTimers(Lt);P.fire(new a.Event("gpu-timing-layer",{layerTimes:Dt}))},50)}var Xt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Xt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||Xt||(this._fullyLoaded=!0),this}},i.prototype.remove=function(){this._hash&&this._hash.remove();for(var c=0,x=this._controls;c<x.length;c+=1)x[c].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var P=this.painter.context.gl.getExtension("WEBGL_lose_context");P&&P.loseContext(),hl(this._canvasContainer),hl(this._controlContainer),hl(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},i.prototype.triggerRepaint=function(){var c=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(x){c._frame=null,c._render(x)}))},i.prototype._onWindowOnline=function(){this._update()},i.prototype._onWindowResize=function(c){this._trackResize&&this.resize({originalEvent:c})._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(c){this._showTileBoundaries!==c&&(this._showTileBoundaries=c,this._update())},n.showPadding.get=function(){return!!this._showPadding},n.showPadding.set=function(c){this._showPadding!==c&&(this._showPadding=c,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(c){this._showCollisionBoxes!==c&&(this._showCollisionBoxes=c,c?this.style._generateCollisionBoxes():this._update())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(c){this._showOverdrawInspector!==c&&(this._showOverdrawInspector=c,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(c){this._repaint!==c&&(this._repaint=c,this.triggerRepaint())},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(c){this._vertices=c,this._update()},i.prototype._setCacheLimits=function(c,x){a.setCacheLimits(c,x)},n.version.get=function(){return a.version},Object.defineProperties(i.prototype,n),i}(Tc);function hl(u){u.parentNode&&u.parentNode.removeChild(u)}var tc={showCompass:!0,showZoom:!0,visualizePitch:!1},Mu=function(i){var n=this;this.options=a.extend({},tc,i),this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(c){return c.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(c){return n._map.zoomIn({},{originalEvent:c})}),D.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(c){return n._map.zoomOut({},{originalEvent:c})}),D.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(c){n.options.visualizePitch?n._map.resetNorthPitch({},{originalEvent:c}):n._map.resetNorth({},{originalEvent:c})}),this._compassIcon=D.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Mu.prototype._updateZoomButtons=function(){var u=this._map.getZoom(),i=u===this._map.getMaxZoom(),n=u===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},Mu.prototype._rotateCompassArrow=function(){var u=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=u},Mu.prototype.onAdd=function(u){return this._map=u,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ls(this._map,this._compass,this.options.visualizePitch)),this._container},Mu.prototype.onRemove=function(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Mu.prototype._createButton=function(u,i){var n=D.create("button",u,this._container);return n.type="button",n.addEventListener("click",i),n},Mu.prototype._setButtonTitle=function(u,i){var n=this._map._getUIString("NavigationControl."+i);u.title=n,u.setAttribute("aria-label",n)};var Ls=function(i,n,c){c===void 0&&(c=!1),this._clickTolerance=10,this.element=n,this.mouseRotate=new Sc({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,c&&(this.mousePitch=new ll({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),D.addEventListener(n,"mousedown",this.mousedown),D.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(n,"touchmove",this.touchmove),D.addEventListener(n,"touchend",this.touchend),D.addEventListener(n,"touchcancel",this.reset)};function kl(u,i,n){if(u=new a.LngLat(u.lng,u.lat),i){var c=new a.LngLat(u.lng-360,u.lat),x=new a.LngLat(u.lng+360,u.lat),P=n.locationPoint(u).distSqr(i);n.locationPoint(c).distSqr(i)<P?u=c:n.locationPoint(x).distSqr(i)<P&&(u=x)}for(;Math.abs(u.lng-n.center.lng)>180;){var O=n.locationPoint(u);if(O.x>=0&&O.y>=0&&O.x<=n.width&&O.y<=n.height)break;u.lng>n.center.lng?u.lng-=360:u.lng+=360}return u}Ls.prototype.down=function(u,i){this.mouseRotate.mousedown(u,i),this.mousePitch&&this.mousePitch.mousedown(u,i),D.disableDrag()},Ls.prototype.move=function(u,i){var n=this.map,c=this.mouseRotate.mousemoveWindow(u,i);if(c&&c.bearingDelta&&n.setBearing(n.getBearing()+c.bearingDelta),this.mousePitch){var x=this.mousePitch.mousemoveWindow(u,i);x&&x.pitchDelta&&n.setPitch(n.getPitch()+x.pitchDelta)}},Ls.prototype.off=function(){var u=this.element;D.removeEventListener(u,"mousedown",this.mousedown),D.removeEventListener(u,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(u,"touchmove",this.touchmove),D.removeEventListener(u,"touchend",this.touchend),D.removeEventListener(u,"touchcancel",this.reset),this.offTemp()},Ls.prototype.offTemp=function(){D.enableDrag(),D.removeEventListener(a.window,"mousemove",this.mousemove),D.removeEventListener(a.window,"mouseup",this.mouseup)},Ls.prototype.mousedown=function(u){this.down(a.extend({},u,{ctrlKey:!0,preventDefault:function(){return u.preventDefault()}}),D.mousePos(this.element,u)),D.addEventListener(a.window,"mousemove",this.mousemove),D.addEventListener(a.window,"mouseup",this.mouseup)},Ls.prototype.mousemove=function(u){this.move(u,D.mousePos(this.element,u))},Ls.prototype.mouseup=function(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()},Ls.prototype.touchstart=function(u){u.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return u.preventDefault()}},this._startPos))},Ls.prototype.touchmove=function(u){u.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,u.targetTouches)[0],this.move({preventDefault:function(){return u.preventDefault()}},this._lastPos))},Ls.prototype.touchend=function(u){u.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Ls.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ms={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xf(u,i,n){var c=u.classList;for(var x in ms)c.remove("mapboxgl-"+n+"-anchor-"+x);c.add("mapboxgl-"+n+"-anchor-"+i)}var jl,jc=function(u){function i(n,c){if(u.call(this),(n instanceof a.window.HTMLElement||c)&&(n=a.extend({element:n},c)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=a.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");var x=D.createNS("http://www.w3.org/2000/svg","svg");x.setAttributeNS(null,"display","block"),x.setAttributeNS(null,"height","41px"),x.setAttributeNS(null,"width","27px"),x.setAttributeNS(null,"viewBox","0 0 27 41");var P=D.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"stroke","none"),P.setAttributeNS(null,"stroke-width","1"),P.setAttributeNS(null,"fill","none"),P.setAttributeNS(null,"fill-rule","evenodd");var O=D.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill-rule","nonzero");var F=D.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"transform","translate(3.0, 29.0)"),F.setAttributeNS(null,"fill","#000000");for(var ue=0,Ee=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];ue<Ee.length;ue+=1){var Xe=Ee[ue],qe=D.createNS("http://www.w3.org/2000/svg","ellipse");qe.setAttributeNS(null,"opacity","0.04"),qe.setAttributeNS(null,"cx","10.5"),qe.setAttributeNS(null,"cy","5.80029008"),qe.setAttributeNS(null,"rx",Xe.rx),qe.setAttributeNS(null,"ry",Xe.ry),F.appendChild(qe)}var tt=D.createNS("http://www.w3.org/2000/svg","g");tt.setAttributeNS(null,"fill",this._color);var zt=D.createNS("http://www.w3.org/2000/svg","path");zt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),tt.appendChild(zt);var Lt=D.createNS("http://www.w3.org/2000/svg","g");Lt.setAttributeNS(null,"opacity","0.25"),Lt.setAttributeNS(null,"fill","#000000");var Xt=D.createNS("http://www.w3.org/2000/svg","path");Xt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Lt.appendChild(Xt);var Dt=D.createNS("http://www.w3.org/2000/svg","g");Dt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Dt.setAttributeNS(null,"fill","#FFFFFF");var Ut=D.createNS("http://www.w3.org/2000/svg","g");Ut.setAttributeNS(null,"transform","translate(8.0, 8.0)");var er=D.createNS("http://www.w3.org/2000/svg","circle");er.setAttributeNS(null,"fill","#000000"),er.setAttributeNS(null,"opacity","0.25"),er.setAttributeNS(null,"cx","5.5"),er.setAttributeNS(null,"cy","5.5"),er.setAttributeNS(null,"r","5.4999962");var qt=D.createNS("http://www.w3.org/2000/svg","circle");qt.setAttributeNS(null,"fill","#FFFFFF"),qt.setAttributeNS(null,"cx","5.5"),qt.setAttributeNS(null,"cy","5.5"),qt.setAttributeNS(null,"r","5.4999962"),Ut.appendChild(er),Ut.appendChild(qt),O.appendChild(F),O.appendChild(tt),O.appendChild(Lt),O.appendChild(Dt),O.appendChild(Ut),x.appendChild(O),x.setAttributeNS(null,"height",41*this._scale+"px"),x.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(x),this._offset=a.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ir){Ir.preventDefault()}),this._element.addEventListener("mousedown",function(Ir){Ir.preventDefault()}),xf(this._element,this._anchor,"marker"),this._popup=null}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.addTo=function(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},i.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this},i.prototype.getLngLat=function(){return this._lngLat},i.prototype.setLngLat=function(n){return this._lngLat=a.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},i.prototype.getElement=function(){return this._element},i.prototype.setPopup=function(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){var c=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(24.6+c)],"bottom-right":[-c,-1*(24.6+c)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},i.prototype._onKeyPress=function(n){var c=n.code,x=n.charCode||n.keyCode;c!=="Space"&&c!=="Enter"&&x!==32&&x!==13||this.togglePopup()},i.prototype._onMapClick=function(n){var c=n.originalEvent.target,x=this._element;this._popup&&(c===x||x.contains(c))&&this.togglePopup()},i.prototype.getPopup=function(){return this._popup},i.prototype.togglePopup=function(){var n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this},i.prototype._update=function(n){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=kl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var c="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?c="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(c="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var x="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?x="rotateX(0deg)":this._pitchAlignment==="map"&&(x="rotateX("+this._map.getPitch()+"deg)"),n&&n.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,ms[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+x+" "+c)}},i.prototype.getOffset=function(){return this._offset},i.prototype.setOffset=function(n){return this._offset=a.Point.convert(n),this._update(),this},i.prototype._onMove=function(n){if(!this._isDragging){var c=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},i.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},i.prototype._addDragHandler=function(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},i.prototype.setDraggable=function(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},i.prototype.isDraggable=function(){return this._draggable},i.prototype.setRotation=function(n){return this._rotation=n||0,this._update(),this},i.prototype.getRotation=function(){return this._rotation},i.prototype.setRotationAlignment=function(n){return this._rotationAlignment=n||"auto",this._update(),this},i.prototype.getRotationAlignment=function(){return this._rotationAlignment},i.prototype.setPitchAlignment=function(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this},i.prototype.getPitchAlignment=function(){return this._pitchAlignment},i}(a.Evented),bf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Us=0,_l=!1,Ul=function(u){function i(n){u.call(this),this.options=a.extend({},bf,n),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.onAdd=function(n){var c;return this._map=n,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,jl!==void 0?c(jl):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(x){c(jl=x.state!=="denied")}):c(jl=!!a.window.navigator.geolocation),this._container},i.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Us=0,_l=!1},i.prototype._isOutOfMapMaxBounds=function(n){var c=this._map.getMaxBounds(),x=n.coords;return c&&(x.longitude<c.getWest()||x.longitude>c.getEast()||x.latitude<c.getSouth()||x.latitude>c.getNorth())},i.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},i.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",n)),this._finish()}},i.prototype._updateCamera=function(n){var c=new a.LngLat(n.coords.longitude,n.coords.latitude),x=n.coords.accuracy,P=this._map.getBearing(),O=a.extend({bearing:P},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(x),O,{geolocateSource:!0})},i.prototype._updateMarker=function(n){if(n){var c=new a.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},i.prototype._updateCircleRadius=function(){var n=this._map._container.clientHeight/2,c=this._map.unproject([0,n]),x=this._map.unproject([1,n]),P=c.distanceTo(x),O=Math.ceil(2*this._accuracy/P);this._circleElement.style.width=O+"px",this._circleElement.style.height=O+"px"},i.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},i.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&_l)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",n)),this._finish()}},i.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},i.prototype._setupUI=function(n){var c=this;if(this._container.addEventListener("contextmenu",function(O){return O.preventDefault()}),this._geolocateButton=D.create("button","mapboxgl-ctrl-geolocate",this._container),D.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",n===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var x=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=x,this._geolocateButton.setAttribute("aria-label",x)}else{var P=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=P,this._geolocateButton.setAttribute("aria-label",P)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new jc(this._dotElement),this._circleElement=D.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new jc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(O){O.geolocateSource||c._watchState!=="ACTIVE_LOCK"||O.originalEvent&&O.originalEvent.type==="resize"||(c._watchState="BACKGROUND",c._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),c._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),c.fire(new a.Event("trackuserlocationend")))})},i.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Us--,_l=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Us>1?(n={maximumAge:6e5,timeout:0},_l=!0):(n=this.options.positionOptions,_l=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},i.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},i}(a.Evented),Iu={maxWidth:100,unit:"metric"},Ou=function(i){this.options=a.extend({},Iu,i),a.bindAll(["_onMove","setUnit"],this)};function Cl(u,i,n){var c=n&&n.maxWidth||100,x=u._container.clientHeight/2,P=u.unproject([0,x]),O=u.unproject([c,x]),F=P.distanceTo(O);if(n&&n.unit==="imperial"){var ue=3.2808*F;ue>5280?Ku(i,c,ue/5280,u._getUIString("ScaleControl.Miles")):Ku(i,c,ue,u._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Ku(i,c,F/1852,u._getUIString("ScaleControl.NauticalMiles")):F>=1e3?Ku(i,c,F/1e3,u._getUIString("ScaleControl.Kilometers")):Ku(i,c,F,u._getUIString("ScaleControl.Meters"))}function Ku(u,i,n,c){var x,P,O,F=(x=n,(P=Math.pow(10,(""+Math.floor(x)).length-1))*(O=(O=x/P)>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:function(ue){var Ee=Math.pow(10,Math.ceil(-Math.log(ue)/Math.LN10));return Math.round(ue*Ee)/Ee}(O)));u.style.width=i*(F/n)+"px",u.innerHTML=F+"&nbsp;"+c}Ou.prototype.getDefaultPosition=function(){return"bottom-left"},Ou.prototype._onMove=function(){Cl(this._map,this._container,this.options)},Ou.prototype.onAdd=function(u){return this._map=u,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",u.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ou.prototype.onRemove=function(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ou.prototype.setUnit=function(u){this.options.unit=u,Cl(this._map,this._container,this.options)};var Rs=function(i){this._fullscreen=!1,i&&i.container&&(i.container instanceof a.window.HTMLElement?this._container=i.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};Rs.prototype.onAdd=function(u){return this._map=u,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Rs.prototype.onRemove=function(){D.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Rs.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},Rs.prototype._setupUI=function(){var u=this._fullscreenButton=D.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D.create("span","mapboxgl-ctrl-icon",u).setAttribute("aria-hidden",!0),u.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Rs.prototype._updateTitle=function(){var u=this._getTitle();this._fullscreenButton.setAttribute("aria-label",u),this._fullscreenButton.title=u},Rs.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Rs.prototype._isFullscreen=function(){return this._fullscreen},Rs.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Rs.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Ac={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},rc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),nc=function(u){function i(n){u.call(this),this.options=a.extend(Object.create(Ac),n),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},i.prototype.isOpen=function(){return!!this._map},i.prototype.remove=function(){return this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},i.prototype.getLngLat=function(){return this._lngLat},i.prototype.setLngLat=function(n){return this._lngLat=a.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},i.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},i.prototype.getElement=function(){return this._container},i.prototype.setText=function(n){return this.setDOMContent(a.window.document.createTextNode(n))},i.prototype.setHTML=function(n){var c,x=a.window.document.createDocumentFragment(),P=a.window.document.createElement("body");for(P.innerHTML=n;c=P.firstChild;)x.appendChild(c);return this.setDOMContent(x)},i.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},i.prototype.setMaxWidth=function(n){return this.options.maxWidth=n,this._update(),this},i.prototype.setDOMContent=function(n){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(n),this._createCloseButton(),this._update(),this._focusFirstElement(),this},i.prototype.addClassName=function(n){this._container&&this._container.classList.add(n)},i.prototype.removeClassName=function(n){this._container&&this._container.classList.remove(n)},i.prototype.setOffset=function(n){return this.options.offset=n,this._update(),this},i.prototype.toggleClassName=function(n){if(this._container)return this._container.classList.toggle(n)},i.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=D.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},i.prototype._onMouseUp=function(n){this._update(n.point)},i.prototype._onMouseMove=function(n){this._update(n.point)},i.prototype._onDrag=function(n){this._update(n.point)},i.prototype._update=function(n){var c=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=D.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=D.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(qe){return c._container.classList.add(qe)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=kl(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var x=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),P=this.options.anchor,O=function qe(tt){if(tt){if(typeof tt=="number"){var zt=Math.round(Math.sqrt(.5*Math.pow(tt,2)));return{center:new a.Point(0,0),top:new a.Point(0,tt),"top-left":new a.Point(zt,zt),"top-right":new a.Point(-zt,zt),bottom:new a.Point(0,-tt),"bottom-left":new a.Point(zt,-zt),"bottom-right":new a.Point(-zt,-zt),left:new a.Point(tt,0),right:new a.Point(-tt,0)}}if(tt instanceof a.Point||Array.isArray(tt)){var Lt=a.Point.convert(tt);return{center:Lt,top:Lt,"top-left":Lt,"top-right":Lt,bottom:Lt,"bottom-left":Lt,"bottom-right":Lt,left:Lt,right:Lt}}return{center:a.Point.convert(tt.center||[0,0]),top:a.Point.convert(tt.top||[0,0]),"top-left":a.Point.convert(tt["top-left"]||[0,0]),"top-right":a.Point.convert(tt["top-right"]||[0,0]),bottom:a.Point.convert(tt.bottom||[0,0]),"bottom-left":a.Point.convert(tt["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(tt["bottom-right"]||[0,0]),left:a.Point.convert(tt.left||[0,0]),right:a.Point.convert(tt.right||[0,0])}}return qe(new a.Point(0,0))}(this.options.offset);if(!P){var F,ue=this._container.offsetWidth,Ee=this._container.offsetHeight;F=x.y+O.bottom.y<Ee?["top"]:x.y>this._map.transform.height-Ee?["bottom"]:[],x.x<ue/2?F.push("left"):x.x>this._map.transform.width-ue/2&&F.push("right"),P=F.length===0?"bottom":F.join("-")}var Xe=x.add(O[P]).round();D.setTransform(this._container,ms[P]+" translate("+Xe.x+"px,"+Xe.y+"px)"),xf(this._container,P,"popup")}},i.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var n=this._container.querySelector(rc);n&&n.focus()}},i.prototype._onClose=function(){this.remove()},i}(a.Evented),ic={version:a.version,supported:W,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:fl,NavigationControl:Mu,GeolocateControl:Ul,AttributionControl:vs,ScaleControl:Ou,FullscreenControl:Rs,Popup:nc,Marker:jc,Style:ya,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){Er().acquire(sr)},clearPrewarmedResources:function(){var i=_n;i&&(i.isPreloaded()&&i.numActive()===1?(i.release(sr),_n=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(u){a.config.ACCESS_TOKEN=u},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(u){a.config.API_URL=u},get workerCount(){return Fr.workerCount},set workerCount(u){Fr.workerCount=u},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(u){a.config.MAX_PARALLEL_IMAGE_REQUESTS=u},clearStorage:function(i){a.clearTileCache(i)},workerUrl:""};return ic}),X})},"4cb6":function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.METADATA_KEY=void 0;var S=o("xfSm");y.METADATA_KEY=S;var v=o("9Fde");Object.defineProperty(y,"Container",{enumerable:!0,get:function(){return v.Container}});var X=o("FV85");Object.defineProperty(y,"BindingScopeEnum",{enumerable:!0,get:function(){return X.BindingScopeEnum}}),Object.defineProperty(y,"BindingTypeEnum",{enumerable:!0,get:function(){return X.BindingTypeEnum}}),Object.defineProperty(y,"TargetTypeEnum",{enumerable:!0,get:function(){return X.TargetTypeEnum}});var B=o("dxzI");Object.defineProperty(y,"AsyncContainerModule",{enumerable:!0,get:function(){return B.AsyncContainerModule}}),Object.defineProperty(y,"ContainerModule",{enumerable:!0,get:function(){return B.ContainerModule}});var a=o("cZ5Q");Object.defineProperty(y,"injectable",{enumerable:!0,get:function(){return a.injectable}});var W=o("0gSV");Object.defineProperty(y,"tagged",{enumerable:!0,get:function(){return W.tagged}});var D=o("ZzCi");Object.defineProperty(y,"named",{enumerable:!0,get:function(){return D.named}});var J=o("Yk9n");Object.defineProperty(y,"inject",{enumerable:!0,get:function(){return J.inject}}),Object.defineProperty(y,"LazyServiceIdentifer",{enumerable:!0,get:function(){return J.LazyServiceIdentifer}});var te=o("jYx5");Object.defineProperty(y,"optional",{enumerable:!0,get:function(){return te.optional}});var ce=o("n2J3");Object.defineProperty(y,"unmanaged",{enumerable:!0,get:function(){return ce.unmanaged}});var Y=o("jIg/");Object.defineProperty(y,"multiInject",{enumerable:!0,get:function(){return Y.multiInject}});var ke=o("oaX6");Object.defineProperty(y,"targetName",{enumerable:!0,get:function(){return ke.targetName}});var Ke=o("Sk89");Object.defineProperty(y,"postConstruct",{enumerable:!0,get:function(){return Ke.postConstruct}});var We=o("wnjb");Object.defineProperty(y,"MetadataReader",{enumerable:!0,get:function(){return We.MetadataReader}});var Oe=o("d9O0");Object.defineProperty(y,"id",{enumerable:!0,get:function(){return Oe.id}});var st=o("Ztfv");Object.defineProperty(y,"decorate",{enumerable:!0,get:function(){return st.decorate}});var Le=o("RR/i");Object.defineProperty(y,"traverseAncerstors",{enumerable:!0,get:function(){return Le.traverseAncerstors}}),Object.defineProperty(y,"taggedConstraint",{enumerable:!0,get:function(){return Le.taggedConstraint}}),Object.defineProperty(y,"namedConstraint",{enumerable:!0,get:function(){return Le.namedConstraint}}),Object.defineProperty(y,"typeConstraint",{enumerable:!0,get:function(){return Le.typeConstraint}});var xt=o("ujMp");Object.defineProperty(y,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return xt.getServiceIdentifierAsString}});var it=o("78VC");Object.defineProperty(y,"multiBindToService",{enumerable:!0,get:function(){return it.multiBindToService}})},"4qC0":function(Re,y,o){var S=o("NykK"),v=o("Z0cm"),X=o("ExA7"),B="[object String]";function a(W){return typeof W=="string"||!v(W)&&X(W)&&S(W)==B}Re.exports=a},"5Tg0":function(Re,y,o){(function(S){var v=o("Kz5y"),X=y&&!y.nodeType&&y,B=X&&typeof S=="object"&&S&&!S.nodeType&&S,a=B&&B.exports===X,W=a?v.Buffer:void 0,D=W?W.allocUnsafe:void 0;function J(te,ce){if(ce)return te.slice();var Y=te.length,ke=D?D(Y):new te.constructor(Y);return te.copy(ke),ke}S.exports=J}).call(this,o("YuTi")(Re))},"5gLl":function(Re,y,o){"use strict";o.d(y,"a",function(){return Y});var S=o("lSNA"),v=o.n(S),X=o("LvWW"),B=o.n(X),a=o("AKIq"),W=o.n(a),D=o("cWyK"),J=o.n(D);function te(ke,Ke){var We=Object.keys(ke);if(Object.getOwnPropertySymbols){var Oe=Object.getOwnPropertySymbols(ke);Ke&&(Oe=Oe.filter(function(st){return Object.getOwnPropertyDescriptor(ke,st).enumerable})),We.push.apply(We,Oe)}return We}function ce(ke){for(var Ke=1;Ke<arguments.length;Ke++){var We=arguments[Ke]!=null?arguments[Ke]:{};Ke%2?te(Object(We),!0).forEach(function(Oe){v()(ke,Oe,We[Oe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ke,Object.getOwnPropertyDescriptors(We)):te(Object(We)).forEach(function(Oe){Object.defineProperty(ke,Oe,Object.getOwnPropertyDescriptor(We,Oe))})}return ke}function Y(ke,Ke){var We=[],Oe={};if(ke.features=ke.features.filter(function(Le){var xt=Le.geometry;return Le!=null&&xt&&xt.type&&xt.coordinates&&xt.coordinates.length>0}),B()(ke,!0),ke.features.length===0)return{dataArray:[],featureKeys:Oe};var st=0;return D.flattenEach(ke,function(Le,xt){var it=Object(a.getCoords)(Le),$e=xt,Ze=ce(ce({},Le.properties),{},{coordinates:it,_id:$e});We.push(Ze)}),{dataArray:We,featureKeys:Oe}}},"5ku3":function(Re,y,o){"use strict";(function(S){o.d(y,"a",function(){return B});var v=o("U8pU"),X=o("I0ug");function B(){var W=(typeof S=="undefined"?"undefined":Object(v.a)(S))==="object"&&String(S)==="[object process]"&&!S.browser;return!W||Object(X.a)()}function a(){return B()&&typeof document!="undefined"}}).call(this,o("Q2Ig"))},"5zYK":function(Re,y,o){"use strict";o.d(y,"a",function(){return te});var S=o("lSNA"),v=o.n(S),X=o("RIqP"),B=o.n(X),a=o("LvWW"),W=o.n(a);function D(ce,Y){var ke=Object.keys(ce);if(Object.getOwnPropertySymbols){var Ke=Object.getOwnPropertySymbols(ce);Y&&(Ke=Ke.filter(function(We){return Object.getOwnPropertyDescriptor(ce,We).enumerable})),ke.push.apply(ke,Ke)}return ke}function J(ce){for(var Y=1;Y<arguments.length;Y++){var ke=arguments[Y]!=null?arguments[Y]:{};Y%2?D(Object(ke),!0).forEach(function(Ke){v()(ce,Ke,ke[Ke])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ce,Object.getOwnPropertyDescriptors(ke)):D(Object(ke)).forEach(function(Ke){Object.defineProperty(ce,Ke,Object.getOwnPropertyDescriptor(ke,Ke))})}return ce}function te(ce,Y){var ke=Y.x,Ke=Y.y,We=Y.x1,Oe=Y.y1,st=Y.coordinates,Le=[];return ce.forEach(function(xt,it){var $e=[];if(ke&&Ke&&($e=[parseFloat(xt[ke]),parseFloat(xt[Ke])]),ke&&Ke&&We&&Oe){var Ze=[parseFloat(xt[ke]),parseFloat(xt[Ke])],St=[parseFloat(xt[We]),parseFloat(xt[Oe])];$e=[Ze,St]}if(st){var bt="Polygon";Array.isArray(st[0])||(bt="Point"),Array.isArray(st[0])&&!Array.isArray(st[0][0])&&(bt="LineString");var Ne={type:bt,coordinates:B()(xt[st])};W()(Ne,!0),$e=Ne.coordinates}var ze=J(J({},xt),{},{_id:it,coordinates:$e});Le.push(ze)}),{dataArray:Le}}},"6AGu":function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingInSyntax=void 0;var S=o("FV85"),v=o("LKzl"),X=function(){function B(a){this._binding=a}return B.prototype.inRequestScope=function(){return this._binding.scope=S.BindingScopeEnum.Request,new v.BindingWhenOnSyntax(this._binding)},B.prototype.inSingletonScope=function(){return this._binding.scope=S.BindingScopeEnum.Singleton,new v.BindingWhenOnSyntax(this._binding)},B.prototype.inTransientScope=function(){return this._binding.scope=S.BindingScopeEnum.Transient,new v.BindingWhenOnSyntax(this._binding)},B}();y.BindingInSyntax=X},"6D9b":function(Re,y,o){Re.exports={"ant-statistic":"ant-statistic","ant-statistic-title":"ant-statistic-title","ant-statistic-content":"ant-statistic-content","ant-statistic-content-value":"ant-statistic-content-value","ant-statistic-content-prefix":"ant-statistic-content-prefix","ant-statistic-content-suffix":"ant-statistic-content-suffix","ant-statistic-rtl":"ant-statistic-rtl"}},"6NqC":function(Re,y){},"6acW":function(Re,y,o){var S=o("dt0z"),v=o("gQMU");function X(B){return v(S(B).toLowerCase())}Re.exports=X},"6nK8":function(Re,y,o){var S=o("dVn5"),v=o("fo6e"),X=o("dt0z"),B=o("9NmV");function a(W,D,J){return W=X(W),D=J?void 0:D,D===void 0?v(W)?B(W):S(W):W.match(D)||[]}Re.exports=a},"711d":function(Re,y){function o(S){return function(v){return v==null?void 0:v[S]}}Re.exports=o},"78VC":function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.multiBindToService=void 0,y.multiBindToService=function(S){return function(v){return function(){for(var X=[],B=0;B<arguments.length;B++)X[B]=arguments[B];return X.forEach(function(a){return S.bind(a).toService(v)})}}}},"7Ix3":function(Re,y){function o(S){var v=[];if(S!=null)for(var X in Object(S))v.push(X);return v}Re.exports=o},"7tbW":function(Re,y,o){var S=o("LGYb");function v(X){return X&&X.length?S(X):[]}Re.exports=v},"8/Fi":function(Re,y,o){"use strict";var S=o("J4zp"),v=o.n(S),X=o("9nhX"),B=o.n(X),a=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function W(ct){return a.indexOf(ct)}var D=2,J=4,te=64,ce=128,Y=256,ke=512,Ke=8192,We=16384,Oe=32768,st=32768*2,Le=131072,xt=262144,it=524288,$e=1048576,Ze=2097152,St=4194304,bt=8388608,Ne=16777216,ze=16777216*2;function Ue(ct,Gt){return ct=B()(Math.floor(ct),0,255),Gt=B()(Math.floor(Gt),0,255),256*ct+Gt}function lt(ct){var Gt=ct.color,$t=ct.radius,ar=ct.tileX,oe=ct.tileY,Q=ct.shape,G=ct.opacity,Ce=ct.stroke,be=ct.strokeWidth,Te=ct.strokeOpacity,me=[],rt=[],Kt=[],_t=[Ue(Gt[0],Gt[1]),Ue(Gt[2],Gt[3])],ge=[Ue(Ce[0],Ce[1]),Ue(Ce[2],Ce[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(ye){var Ve=v()(ye,2),ft=Ve[0],Ie=Ve[1];me.push([].concat(_t,[(ft+1)*bt+(Ie+1)*Ze+W(Q)*Le+$t,(ar+512)*it+(oe+512)*te])),rt.push([].concat(ge,[be,Te])),Kt.push([G,0,0,0])}),{packedBuffer:me,packedBuffer2:rt,packedBuffer3:Kt}}function Me(ct,Gt){if(ct===0&&!Gt)return 0;if(ct===1&&Gt)return 4294967295;var $t=Gt?1:0,ar=Math.floor(ct*127);return ar*ze+$t*Ne+ar*Le+$t*st+ar*ke+$t*Y+ar*D+$t}},"88Gu":function(Re,y){var o=800,S=16,v=Date.now;function X(B){var a=0,W=0;return function(){var D=v(),J=S-(D-W);if(W=D,J>0){if(++a>=o)return arguments[0]}else a=0;return B.apply(void 0,arguments)}}Re.exports=X},"8ml+":function(Re,y,o){"use strict";var S=o("h1nZ");o.o(S,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return S.CityBuildingLayer}),o.o(S,"Control")&&o.d(y,"Control",function(){return S.Control}),o.o(S,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return S.HeatmapLayer}),o.o(S,"ImageLayer")&&o.d(y,"ImageLayer",function(){return S.ImageLayer}),o.o(S,"LineLayer")&&o.d(y,"LineLayer",function(){return S.LineLayer}),o.o(S,"Logo")&&o.d(y,"Logo",function(){return S.Logo}),o.o(S,"Marker")&&o.d(y,"Marker",function(){return S.Marker}),o.o(S,"PointLayer")&&o.d(y,"PointLayer",function(){return S.PointLayer}),o.o(S,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return S.PolygonLayer}),o.o(S,"Popup")&&o.d(y,"Popup",function(){return S.Popup}),o.o(S,"RasterLayer")&&o.d(y,"RasterLayer",function(){return S.RasterLayer}),o.o(S,"Scale")&&o.d(y,"Scale",function(){return S.Scale}),o.o(S,"Scene")&&o.d(y,"Scene",function(){return S.Scene}),o.o(S,"Zoom")&&o.d(y,"Zoom",function(){return S.Zoom});var v=o("kQ+U");o.d(y,"Scene",function(){return v.a});var X=o("sxDa");o.d(y,"CityBuildingLayer",function(){return X.a}),o.d(y,"HeatmapLayer",function(){return X.b}),o.d(y,"ImageLayer",function(){return X.c}),o.d(y,"LineLayer",function(){return X.d}),o.d(y,"PointLayer",function(){return X.e}),o.d(y,"PolygonLayer",function(){return X.f}),o.d(y,"RasterLayer",function(){return X.g});var B=o("k5/I");o.d(y,"Control",function(){return B.a}),o.d(y,"Logo",function(){return B.b}),o.d(y,"Marker",function(){return B.c}),o.d(y,"Popup",function(){return B.d}),o.d(y,"Scale",function(){return B.e}),o.d(y,"Zoom",function(){return B.f});var a=o("Hel2"),W=o("RL2/")},"8uyu":function(Re,y){},"9Fde":function(Re,y,o){"use strict";var S=this&&this.__awaiter||function(st,Le,xt,it){function $e(Ze){return Ze instanceof xt?Ze:new xt(function(St){St(Ze)})}return new(xt||(xt=Promise))(function(Ze,St){function bt(Ue){try{ze(it.next(Ue))}catch(lt){St(lt)}}function Ne(Ue){try{ze(it.throw(Ue))}catch(lt){St(lt)}}function ze(Ue){Ue.done?Ze(Ue.value):$e(Ue.value).then(bt,Ne)}ze((it=it.apply(st,Le||[])).next())})},v=this&&this.__generator||function(st,Le){var xt={label:0,sent:function(){if(Ze[0]&1)throw Ze[1];return Ze[1]},trys:[],ops:[]},it,$e,Ze,St;return St={next:bt(0),throw:bt(1),return:bt(2)},typeof Symbol=="function"&&(St[Symbol.iterator]=function(){return this}),St;function bt(ze){return function(Ue){return Ne([ze,Ue])}}function Ne(ze){if(it)throw new TypeError("Generator is already executing.");for(;xt;)try{if(it=1,$e&&(Ze=ze[0]&2?$e.return:ze[0]?$e.throw||((Ze=$e.return)&&Ze.call($e),0):$e.next)&&!(Ze=Ze.call($e,ze[1])).done)return Ze;switch($e=0,Ze&&(ze=[ze[0]&2,Ze.value]),ze[0]){case 0:case 1:Ze=ze;break;case 4:return xt.label++,{value:ze[1],done:!1};case 5:xt.label++,$e=ze[1],ze=[0];continue;case 7:ze=xt.ops.pop(),xt.trys.pop();continue;default:if(Ze=xt.trys,!(Ze=Ze.length>0&&Ze[Ze.length-1])&&(ze[0]===6||ze[0]===2)){xt=0;continue}if(ze[0]===3&&(!Ze||ze[1]>Ze[0]&&ze[1]<Ze[3])){xt.label=ze[1];break}if(ze[0]===6&&xt.label<Ze[1]){xt.label=Ze[1],Ze=ze;break}if(Ze&&xt.label<Ze[2]){xt.label=Ze[2],xt.ops.push(ze);break}Ze[2]&&xt.ops.pop(),xt.trys.pop();continue}ze=Le.call(st,xt)}catch(Ue){ze=[6,Ue],$e=0}finally{it=Ze=0}if(ze[0]&5)throw ze[1];return{value:ze[0]?ze[1]:void 0,done:!0}}};Object.defineProperty(y,"__esModule",{value:!0}),y.Container=void 0;var X=o("LgvC"),B=o("MON2"),a=o("FV85"),W=o("xfSm"),D=o("wnjb"),J=o("h7MG"),te=o("aPG5"),ce=o("gzZq"),Y=o("d9O0"),ke=o("ujMp"),Ke=o("HpQ9"),We=o("AwBQ"),Oe=function(){function st(Le){var xt=Le||{};if(typeof xt!="object")throw new Error(""+B.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(xt.defaultScope===void 0)xt.defaultScope=a.BindingScopeEnum.Transient;else if(xt.defaultScope!==a.BindingScopeEnum.Singleton&&xt.defaultScope!==a.BindingScopeEnum.Transient&&xt.defaultScope!==a.BindingScopeEnum.Request)throw new Error(""+B.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(xt.autoBindInjectable===void 0)xt.autoBindInjectable=!1;else if(typeof xt.autoBindInjectable!="boolean")throw new Error(""+B.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(xt.skipBaseClassChecks===void 0)xt.skipBaseClassChecks=!1;else if(typeof xt.skipBaseClassChecks!="boolean")throw new Error(""+B.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:xt.autoBindInjectable,defaultScope:xt.defaultScope,skipBaseClassChecks:xt.skipBaseClassChecks},this.id=Y.id(),this._bindingDictionary=new We.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new D.MetadataReader}return st.merge=function(Le,xt){var it=new st,$e=J.getBindingDictionary(it),Ze=J.getBindingDictionary(Le),St=J.getBindingDictionary(xt);function bt(Ne,ze){Ne.traverse(function(Ue,lt){lt.forEach(function(Me){ze.add(Me.serviceIdentifier,Me.clone())})})}return bt(Ze,$e),bt(St,$e),it},st.prototype.load=function(){for(var Le=[],xt=0;xt<arguments.length;xt++)Le[xt]=arguments[xt];for(var it=this._getContainerModuleHelpersFactory(),$e=0,Ze=Le;$e<Ze.length;$e++){var St=Ze[$e],bt=it(St.id);St.registry(bt.bindFunction,bt.unbindFunction,bt.isboundFunction,bt.rebindFunction)}},st.prototype.loadAsync=function(){for(var Le=[],xt=0;xt<arguments.length;xt++)Le[xt]=arguments[xt];return S(this,void 0,void 0,function(){var it,$e,Ze,St,bt;return v(this,function(Ne){switch(Ne.label){case 0:it=this._getContainerModuleHelpersFactory(),$e=0,Ze=Le,Ne.label=1;case 1:return $e<Ze.length?(St=Ze[$e],bt=it(St.id),[4,St.registry(bt.bindFunction,bt.unbindFunction,bt.isboundFunction,bt.rebindFunction)]):[3,4];case 2:Ne.sent(),Ne.label=3;case 3:return $e++,[3,1];case 4:return[2]}})})},st.prototype.unload=function(){for(var Le=this,xt=[],it=0;it<arguments.length;it++)xt[it]=arguments[it];var $e=function(St){return function(bt){return bt.moduleId===St}};xt.forEach(function(Ze){var St=$e(Ze.id);Le._bindingDictionary.removeByCondition(St)})},st.prototype.bind=function(Le){var xt=this.options.defaultScope||a.BindingScopeEnum.Transient,it=new X.Binding(Le,xt);return this._bindingDictionary.add(Le,it),new ce.BindingToSyntax(it)},st.prototype.rebind=function(Le){return this.unbind(Le),this.bind(Le)},st.prototype.unbind=function(Le){try{this._bindingDictionary.remove(Le)}catch(xt){throw new Error(B.CANNOT_UNBIND+" "+ke.getServiceIdentifierAsString(Le))}},st.prototype.unbindAll=function(){this._bindingDictionary=new We.Lookup},st.prototype.isBound=function(Le){var xt=this._bindingDictionary.hasKey(Le);return!xt&&this.parent&&(xt=this.parent.isBound(Le)),xt},st.prototype.isBoundNamed=function(Le,xt){return this.isBoundTagged(Le,W.NAMED_TAG,xt)},st.prototype.isBoundTagged=function(Le,xt,it){var $e=!1;if(this._bindingDictionary.hasKey(Le)){var Ze=this._bindingDictionary.get(Le),St=J.createMockRequest(this,Le,xt,it);$e=Ze.some(function(bt){return bt.constraint(St)})}return!$e&&this.parent&&($e=this.parent.isBoundTagged(Le,xt,it)),$e},st.prototype.snapshot=function(){this._snapshots.push(Ke.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},st.prototype.restore=function(){var Le=this._snapshots.pop();if(Le===void 0)throw new Error(B.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Le.bindings,this._middleware=Le.middleware},st.prototype.createChild=function(Le){var xt=new st(Le||this.options);return xt.parent=this,xt},st.prototype.applyMiddleware=function(){for(var Le=[],xt=0;xt<arguments.length;xt++)Le[xt]=arguments[xt];var it=this._middleware?this._middleware:this._planAndResolve();this._middleware=Le.reduce(function($e,Ze){return Ze($e)},it)},st.prototype.applyCustomMetadataReader=function(Le){this._metadataReader=Le},st.prototype.get=function(Le){return this._get(!1,!1,a.TargetTypeEnum.Variable,Le)},st.prototype.getTagged=function(Le,xt,it){return this._get(!1,!1,a.TargetTypeEnum.Variable,Le,xt,it)},st.prototype.getNamed=function(Le,xt){return this.getTagged(Le,W.NAMED_TAG,xt)},st.prototype.getAll=function(Le){return this._get(!0,!0,a.TargetTypeEnum.Variable,Le)},st.prototype.getAllTagged=function(Le,xt,it){return this._get(!1,!0,a.TargetTypeEnum.Variable,Le,xt,it)},st.prototype.getAllNamed=function(Le,xt){return this.getAllTagged(Le,W.NAMED_TAG,xt)},st.prototype.resolve=function(Le){var xt=this.createChild();return xt.bind(Le).toSelf(),xt.get(Le)},st.prototype._getContainerModuleHelpersFactory=function(){var Le=this,xt=function(Ne,ze){Ne._binding.moduleId=ze},it=function(Ne){return function(ze){var Ue=Le.bind.bind(Le),lt=Ue(ze);return xt(lt,Ne),lt}},$e=function(Ne){return function(ze){var Ue=Le.unbind.bind(Le);Ue(ze)}},Ze=function(Ne){return function(ze){var Ue=Le.isBound.bind(Le);return Ue(ze)}},St=function(Ne){return function(ze){var Ue=Le.rebind.bind(Le),lt=Ue(ze);return xt(lt,Ne),lt}};return function(bt){return{bindFunction:it(bt),isboundFunction:Ze(bt),rebindFunction:St(bt),unbindFunction:$e(bt)}}},st.prototype._get=function(Le,xt,it,$e,Ze,St){var bt=null,Ne={avoidConstraints:Le,contextInterceptor:function(Ue){return Ue},isMultiInject:xt,key:Ze,serviceIdentifier:$e,targetType:it,value:St};if(this._middleware){if(bt=this._middleware(Ne),bt==null)throw new Error(B.INVALID_MIDDLEWARE_RETURN)}else bt=this._planAndResolve()(Ne);return bt},st.prototype._planAndResolve=function(){var Le=this;return function(xt){var it=J.plan(Le._metadataReader,Le,xt.isMultiInject,xt.targetType,xt.serviceIdentifier,xt.key,xt.value,xt.avoidConstraints);it=xt.contextInterceptor(it);var $e=te.resolve(it);return $e}},st}();y.Container=Oe},"9NmV":function(Re,y){var o="\\ud800-\\udfff",S="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",B=S+v+X,a="\\u2700-\\u27bf",W="a-z\\xdf-\\xf6\\xf8-\\xff",D="\\xac\\xb1\\xd7\\xf7",J="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",te="\\u2000-\\u206f",ce=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Y="A-Z\\xc0-\\xd6\\xd8-\\xde",ke="\\ufe0e\\ufe0f",Ke=D+J+te+ce,We="['\u2019]",Oe="["+Ke+"]",st="["+B+"]",Le="\\d+",xt="["+a+"]",it="["+W+"]",$e="[^"+o+Ke+Le+a+W+Y+"]",Ze="\\ud83c[\\udffb-\\udfff]",St="(?:"+st+"|"+Ze+")",bt="[^"+o+"]",Ne="(?:\\ud83c[\\udde6-\\uddff]){2}",ze="[\\ud800-\\udbff][\\udc00-\\udfff]",Ue="["+Y+"]",lt="\\u200d",Me="(?:"+it+"|"+$e+")",ct="(?:"+Ue+"|"+$e+")",Gt="(?:"+We+"(?:d|ll|m|re|s|t|ve))?",$t="(?:"+We+"(?:D|LL|M|RE|S|T|VE))?",ar=St+"?",oe="["+ke+"]?",Q="(?:"+lt+"(?:"+[bt,Ne,ze].join("|")+")"+oe+ar+")*",G="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ce="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",be=oe+ar+Q,Te="(?:"+[xt,Ne,ze].join("|")+")"+be,me=RegExp([Ue+"?"+it+"+"+Gt+"(?="+[Oe,Ue,"$"].join("|")+")",ct+"+"+$t+"(?="+[Oe,Ue+Me,"$"].join("|")+")",Ue+"?"+Me+"+"+Gt,Ue+"+"+$t,Ce,G,Le,Te].join("|"),"g");function rt(Kt){return Kt.match(me)||[]}Re.exports=rt},"9lTW":function(Re,y,o){"use strict";(function(S){var v=o("MgzW");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function X(Me,ct){if(Me===ct)return 0;for(var Gt=Me.length,$t=ct.length,ar=0,oe=Math.min(Gt,$t);ar<oe;++ar)if(Me[ar]!==ct[ar]){Gt=Me[ar],$t=ct[ar];break}return Gt<$t?-1:$t<Gt?1:0}function B(Me){return S.Buffer&&typeof S.Buffer.isBuffer=="function"?S.Buffer.isBuffer(Me):!!(Me!=null&&Me._isBuffer)}var a=o("MCLT"),W=Object.prototype.hasOwnProperty,D=Array.prototype.slice,J=function(){return function(){}.name==="foo"}();function te(Me){return Object.prototype.toString.call(Me)}function ce(Me){return B(Me)||typeof S.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(Me):Me?!!(Me instanceof DataView||Me.buffer&&Me.buffer instanceof ArrayBuffer):!1}var Y=Re.exports=xt,ke=/\s*function\s+([^\(\s]*)\s*/;function Ke(Me){if(!!a.isFunction(Me)){if(J)return Me.name;var ct=Me.toString(),Gt=ct.match(ke);return Gt&&Gt[1]}}Y.AssertionError=function(ct){this.name="AssertionError",this.actual=ct.actual,this.expected=ct.expected,this.operator=ct.operator,ct.message?(this.message=ct.message,this.generatedMessage=!1):(this.message=st(this),this.generatedMessage=!0);var Gt=ct.stackStartFunction||Le;if(Error.captureStackTrace)Error.captureStackTrace(this,Gt);else{var $t=new Error;if($t.stack){var ar=$t.stack,oe=Ke(Gt),Q=ar.indexOf(`
`+oe);if(Q>=0){var G=ar.indexOf(`
`,Q+1);ar=ar.substring(G+1)}this.stack=ar}}},a.inherits(Y.AssertionError,Error);function We(Me,ct){return typeof Me=="string"?Me.length<ct?Me:Me.slice(0,ct):Me}function Oe(Me){if(J||!a.isFunction(Me))return a.inspect(Me);var ct=Ke(Me),Gt=ct?": "+ct:"";return"[Function"+Gt+"]"}function st(Me){return We(Oe(Me.actual),128)+" "+Me.operator+" "+We(Oe(Me.expected),128)}function Le(Me,ct,Gt,$t,ar){throw new Y.AssertionError({message:Gt,actual:Me,expected:ct,operator:$t,stackStartFunction:ar})}Y.fail=Le;function xt(Me,ct){Me||Le(Me,!0,ct,"==",Y.ok)}Y.ok=xt,Y.equal=function(ct,Gt,$t){ct!=Gt&&Le(ct,Gt,$t,"==",Y.equal)},Y.notEqual=function(ct,Gt,$t){ct==Gt&&Le(ct,Gt,$t,"!=",Y.notEqual)},Y.deepEqual=function(ct,Gt,$t){it(ct,Gt,!1)||Le(ct,Gt,$t,"deepEqual",Y.deepEqual)},Y.deepStrictEqual=function(ct,Gt,$t){it(ct,Gt,!0)||Le(ct,Gt,$t,"deepStrictEqual",Y.deepStrictEqual)};function it(Me,ct,Gt,$t){if(Me===ct)return!0;if(B(Me)&&B(ct))return X(Me,ct)===0;if(a.isDate(Me)&&a.isDate(ct))return Me.getTime()===ct.getTime();if(a.isRegExp(Me)&&a.isRegExp(ct))return Me.source===ct.source&&Me.global===ct.global&&Me.multiline===ct.multiline&&Me.lastIndex===ct.lastIndex&&Me.ignoreCase===ct.ignoreCase;if((Me===null||typeof Me!="object")&&(ct===null||typeof ct!="object"))return Gt?Me===ct:Me==ct;if(ce(Me)&&ce(ct)&&te(Me)===te(ct)&&!(Me instanceof Float32Array||Me instanceof Float64Array))return X(new Uint8Array(Me.buffer),new Uint8Array(ct.buffer))===0;if(B(Me)!==B(ct))return!1;$t=$t||{actual:[],expected:[]};var ar=$t.actual.indexOf(Me);return ar!==-1&&ar===$t.expected.indexOf(ct)?!0:($t.actual.push(Me),$t.expected.push(ct),Ze(Me,ct,Gt,$t))}function $e(Me){return Object.prototype.toString.call(Me)=="[object Arguments]"}function Ze(Me,ct,Gt,$t){if(Me==null||ct===null||ct===void 0)return!1;if(a.isPrimitive(Me)||a.isPrimitive(ct))return Me===ct;if(Gt&&Object.getPrototypeOf(Me)!==Object.getPrototypeOf(ct))return!1;var ar=$e(Me),oe=$e(ct);if(ar&&!oe||!ar&&oe)return!1;if(ar)return Me=D.call(Me),ct=D.call(ct),it(Me,ct,Gt);var Q=lt(Me),G=lt(ct),Ce,be;if(Q.length!==G.length)return!1;for(Q.sort(),G.sort(),be=Q.length-1;be>=0;be--)if(Q[be]!==G[be])return!1;for(be=Q.length-1;be>=0;be--)if(Ce=Q[be],!it(Me[Ce],ct[Ce],Gt,$t))return!1;return!0}Y.notDeepEqual=function(ct,Gt,$t){it(ct,Gt,!1)&&Le(ct,Gt,$t,"notDeepEqual",Y.notDeepEqual)},Y.notDeepStrictEqual=St;function St(Me,ct,Gt){it(Me,ct,!0)&&Le(Me,ct,Gt,"notDeepStrictEqual",St)}Y.strictEqual=function(ct,Gt,$t){ct!==Gt&&Le(ct,Gt,$t,"===",Y.strictEqual)},Y.notStrictEqual=function(ct,Gt,$t){ct===Gt&&Le(ct,Gt,$t,"!==",Y.notStrictEqual)};function bt(Me,ct){if(!Me||!ct)return!1;if(Object.prototype.toString.call(ct)=="[object RegExp]")return ct.test(Me);try{if(Me instanceof ct)return!0}catch(Gt){}return Error.isPrototypeOf(ct)?!1:ct.call({},Me)===!0}function Ne(Me){var ct;try{Me()}catch(Gt){ct=Gt}return ct}function ze(Me,ct,Gt,$t){var ar;if(typeof ct!="function")throw new TypeError('"block" argument must be a function');typeof Gt=="string"&&($t=Gt,Gt=null),ar=Ne(ct),$t=(Gt&&Gt.name?" ("+Gt.name+").":".")+($t?" "+$t:"."),Me&&!ar&&Le(ar,Gt,"Missing expected exception"+$t);var oe=typeof $t=="string",Q=!Me&&a.isError(ar),G=!Me&&ar&&!Gt;if((Q&&oe&&bt(ar,Gt)||G)&&Le(ar,Gt,"Got unwanted exception"+$t),Me&&ar&&Gt&&!bt(ar,Gt)||!Me&&ar)throw ar}Y.throws=function(Me,ct,Gt){ze(!0,Me,ct,Gt)},Y.doesNotThrow=function(Me,ct,Gt){ze(!1,Me,ct,Gt)},Y.ifError=function(Me){if(Me)throw Me};function Ue(Me,ct){Me||Le(Me,!0,ct,"==",Ue)}Y.strict=v(Ue,Y,{equal:Y.strictEqual,deepEqual:Y.deepStrictEqual,notEqual:Y.notStrictEqual,notDeepEqual:Y.notDeepStrictEqual}),Y.strict.strict=Y.strict;var lt=Object.keys||function(Me){var ct=[];for(var Gt in Me)W.call(Me,Gt)&&ct.push(Gt);return ct}}).call(this,o("yLpj"))},"9nhX":function(Re,y,o){var S=o("g4R6"),v=o("tLB3");function X(B,a,W){return W===void 0&&(W=a,a=void 0),W!==void 0&&(W=v(W),W=W===W?W:0),a!==void 0&&(a=v(a),a=a===a?a:0),S(v(B),a,W)}Re.exports=X},AFH1:function(Re,y,o){"use strict";o.d(y,"a",function(){return S});var S;(function(v){v.TOPRIGHT="topright",v.TOPLEFT="topleft",v.BOTTOMRIGHT="bottomright",v.BOTTOMLEFT="bottomleft"})(S||(S={}))},AKIq:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var S=o("/rf6");function v(ce){if(!ce)throw new Error("coord is required");if(!Array.isArray(ce)){if(ce.type==="Feature"&&ce.geometry!==null&&ce.geometry.type==="Point")return ce.geometry.coordinates;if(ce.type==="Point")return ce.coordinates}if(Array.isArray(ce)&&ce.length>=2&&!Array.isArray(ce[0])&&!Array.isArray(ce[1]))return ce;throw new Error("coord must be GeoJSON Point or an Array of numbers")}y.getCoord=v;function X(ce){if(Array.isArray(ce))return ce;if(ce.type==="Feature"){if(ce.geometry!==null)return ce.geometry.coordinates}else if(ce.coordinates)return ce.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}y.getCoords=X;function B(ce){if(ce.length>1&&S.isNumber(ce[0])&&S.isNumber(ce[1]))return!0;if(Array.isArray(ce[0])&&ce[0].length)return B(ce[0]);throw new Error("coordinates must only contain numbers")}y.containsNumber=B;function a(ce,Y,ke){if(!Y||!ke)throw new Error("type and name required");if(!ce||ce.type!==Y)throw new Error("Invalid input to "+ke+": must be a "+Y+", given "+ce.type)}y.geojsonType=a;function W(ce,Y,ke){if(!ce)throw new Error("No feature passed");if(!ke)throw new Error(".featureOf() requires a name");if(!ce||ce.type!=="Feature"||!ce.geometry)throw new Error("Invalid input to "+ke+", Feature with geometry required");if(!ce.geometry||ce.geometry.type!==Y)throw new Error("Invalid input to "+ke+": must be a "+Y+", given "+ce.geometry.type)}y.featureOf=W;function D(ce,Y,ke){if(!ce)throw new Error("No featureCollection passed");if(!ke)throw new Error(".collectionOf() requires a name");if(!ce||ce.type!=="FeatureCollection")throw new Error("Invalid input to "+ke+", FeatureCollection required");for(var Ke=0,We=ce.features;Ke<We.length;Ke++){var Oe=We[Ke];if(!Oe||Oe.type!=="Feature"||!Oe.geometry)throw new Error("Invalid input to "+ke+", Feature with geometry required");if(!Oe.geometry||Oe.geometry.type!==Y)throw new Error("Invalid input to "+ke+": must be a "+Y+", given "+Oe.geometry.type)}}y.collectionOf=D;function J(ce){return ce.type==="Feature"?ce.geometry:ce}y.getGeom=J;function te(ce,Y){return ce.type==="FeatureCollection"?"FeatureCollection":ce.type==="GeometryCollection"?"GeometryCollection":ce.type==="Feature"&&ce.geometry!==null?ce.geometry.type:ce.type}y.getType=te},APxj:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var S=o("Ucsi");function v(X,B){B===void 0&&(B=!0);var a=S.makePropertyInjectDecorator(X,B),W=S.makePropertyInjectNamedDecorator(X,B),D=S.makePropertyInjectTaggedDecorator(X,B),J=S.makePropertyMultiInjectDecorator(X,B);return{lazyInject:a,lazyInjectNamed:W,lazyInjectTagged:D,lazyMultiInject:J}}y.default=v},AwBQ:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Lookup=void 0;var S=o("MON2"),v=function(){function X(){this._map=new Map}return X.prototype.getMap=function(){return this._map},X.prototype.add=function(B,a){if(B==null)throw new Error(S.NULL_ARGUMENT);if(a==null)throw new Error(S.NULL_ARGUMENT);var W=this._map.get(B);W!==void 0?(W.push(a),this._map.set(B,W)):this._map.set(B,[a])},X.prototype.get=function(B){if(B==null)throw new Error(S.NULL_ARGUMENT);var a=this._map.get(B);if(a!==void 0)return a;throw new Error(S.KEY_NOT_FOUND)},X.prototype.remove=function(B){if(B==null)throw new Error(S.NULL_ARGUMENT);if(!this._map.delete(B))throw new Error(S.KEY_NOT_FOUND)},X.prototype.removeByCondition=function(B){var a=this;this._map.forEach(function(W,D){var J=W.filter(function(te){return!B(te)});J.length>0?a._map.set(D,J):a._map.delete(D)})},X.prototype.hasKey=function(B){if(B==null)throw new Error(S.NULL_ARGUMENT);return this._map.has(B)},X.prototype.clone=function(){var B=new X;return this._map.forEach(function(a,W){a.forEach(function(D){return B.add(W,D.clone())})}),B},X.prototype.traverse=function(B){this._map.forEach(function(a,W){B(W,a)})},X}();y.Lookup=v},"B6l+":function(Re,y,o){var S=o("Sq3C"),v=o("Z1HP"),X=o("Sxd8"),B=o("dt0z");function a(W,D,J){W=B(W),D=X(D);var te=D?v(W):0;return D&&te<D?W+S(D-te,J):W}Re.exports=a},BGjm:function(Re,y){Re.exports=o;function o(S,v){v||(v=document);var X=v.head||v.getElementsByTagName("head")[0];if(!X){X=v.createElement("head");var B=v.body||v.getElementsByTagName("body")[0];B?B.parentNode.insertBefore(X,B):v.documentElement.appendChild(X)}var a=v.createElement("style");return a.type="text/css",a.styleSheet?a.styleSheet.cssText=S:a.appendChild(v.createTextNode(S)),X.appendChild(a),a}},BMrR:function(Re,y,o){"use strict";var S=o("qrJ5");y.a=S.a},BkRI:function(Re,y,o){var S=o("OBhP"),v=1,X=4;function B(a){return S(a,v|X)}Re.exports=B},BpBL:function(Re,y,o){"use strict";o.d(y,"a",function(){return v});var S=o("Hel2");function v(B,a){var W=a.extent,D=new Promise(function(te){X(B,function(ce){te(ce)})}),J={images:D,_id:1,dataArray:[{_id:0,coordinates:[[W[0],W[1]],[W[2],W[3]]]}]};return J}function X(B,a){var W=B,D=[];if(typeof W=="string")Object(S.o)({url:W},function(ce,Y){D.push(Y),a(D)});else{var J=W.length,te=0;W.forEach(function(ce){Object(S.o)({url:ce},function(Y,ke){te++,D.push(ke),te===J&&a(D)})})}return v}},CIdX:function(Re,y,o){Re.exports={waterWave:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWave",text:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-text",waterWaveCanvasWrapper:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWaveCanvasWrapper"}},CZoQ:function(Re,y){function o(S,v,X){for(var B=X-1,a=S.length;++B<a;)if(S[B]===v)return B;return-1}Re.exports=o},"D+ow":function(Re,y){},D9lx:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingInWhenOnSyntax=void 0;var S=o("6AGu"),v=o("406g"),X=o("z4Hk"),B=function(){function a(W){this._binding=W,this._bindingWhenSyntax=new X.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new v.BindingOnSyntax(this._binding),this._bindingInSyntax=new S.BindingInSyntax(W)}return a.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},a.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},a.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},a.prototype.when=function(W){return this._bindingWhenSyntax.when(W)},a.prototype.whenTargetNamed=function(W){return this._bindingWhenSyntax.whenTargetNamed(W)},a.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},a.prototype.whenTargetTagged=function(W,D){return this._bindingWhenSyntax.whenTargetTagged(W,D)},a.prototype.whenInjectedInto=function(W){return this._bindingWhenSyntax.whenInjectedInto(W)},a.prototype.whenParentNamed=function(W){return this._bindingWhenSyntax.whenParentNamed(W)},a.prototype.whenParentTagged=function(W,D){return this._bindingWhenSyntax.whenParentTagged(W,D)},a.prototype.whenAnyAncestorIs=function(W){return this._bindingWhenSyntax.whenAnyAncestorIs(W)},a.prototype.whenNoAncestorIs=function(W){return this._bindingWhenSyntax.whenNoAncestorIs(W)},a.prototype.whenAnyAncestorNamed=function(W){return this._bindingWhenSyntax.whenAnyAncestorNamed(W)},a.prototype.whenAnyAncestorTagged=function(W,D){return this._bindingWhenSyntax.whenAnyAncestorTagged(W,D)},a.prototype.whenNoAncestorNamed=function(W){return this._bindingWhenSyntax.whenNoAncestorNamed(W)},a.prototype.whenNoAncestorTagged=function(W,D){return this._bindingWhenSyntax.whenNoAncestorTagged(W,D)},a.prototype.whenAnyAncestorMatches=function(W){return this._bindingWhenSyntax.whenAnyAncestorMatches(W)},a.prototype.whenNoAncestorMatches=function(W){return this._bindingWhenSyntax.whenNoAncestorMatches(W)},a.prototype.onActivation=function(W){return this._bindingOnSyntax.onActivation(W)},a}();y.BindingInWhenOnSyntax=B},DnfT:function(Re,y,o){Re.exports={"ant-pro-grid-content":"ant-pro-grid-content",wide:"wide"}},"Dw+G":function(Re,y,o){var S=o("juv8"),v=o("mTTR");function X(B,a){return B&&S(a,v(a),B)}Re.exports=X},DzJC:function(Re,y,o){var S=o("sEfC"),v=o("GoyQ"),X="Expected a function";function B(a,W,D){var J=!0,te=!0;if(typeof a!="function")throw new TypeError(X);return v(D)&&(J="leading"in D?!!D.leading:J,te="trailing"in D?!!D.trailing:te),S(a,W,{leading:J,maxWait:W,trailing:te})}Re.exports=B},EA7m:function(Re,y,o){var S=o("zZ0H"),v=o("Ioao"),X=o("wclG");function B(a,W){return X(v(a,W,S),a+"")}Re.exports=B},EEGq:function(Re,y,o){var S=o("juv8"),v=o("oCl/");function X(B,a){return S(B,v(B),a)}Re.exports=X},EfZ0:function(Re,y,o){"use strict";o.d(y,"a",function(){return S});var S={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},Em2t:function(Re,y,o){var S=o("bahg"),v=o("quyA"),X=o("0JQy");function B(a){return v(a)?X(a):S(a)}Re.exports=B},FI6e:function(Re,y){},FRQA:function(Re,y,o){"use strict";var S=o("GNNt"),v=o("wEI+"),X=o("DnfT"),B=o.n(X),a=o("q1tI"),W=o.n(a),D=o("TSYQ"),J=o.n(D),te=o("jYQm"),ce=function(ke){var Ke=Object(a.useContext)(te.a),We=ke.children,Oe=ke.contentWidth,st=ke.className,Le=ke.style,xt=Object(a.useContext)(v.b.ConfigContext),it=xt.getPrefixCls,$e=ke.prefixCls||it("pro"),Ze=Oe||Ke.contentWidth,St="".concat($e,"-grid-content");return W.a.createElement("div",{className:J()(St,st,{wide:Ze==="Fixed"}),style:Le},W.a.createElement("div",{className:"".concat($e,"-grid-content-children")},We))};y.a=ce},FV85:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.TargetTypeEnum=y.BindingTypeEnum=y.BindingScopeEnum=void 0;var S={Request:"Request",Singleton:"Singleton",Transient:"Transient"};y.BindingScopeEnum=S;var v={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};y.BindingTypeEnum=v;var X={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};y.TargetTypeEnum=X},FmoU:function(Re,y,o){"use strict";o.d(y,"a",function(){return $e}),o.d(y,"b",function(){return Ne});var S=function(Q,G,Ce){Q.prototype=G.prototype=Ce,Ce.constructor=Q};function v(Q,G){var Ce=Object.create(Q.prototype);for(var be in G)Ce[be]=G[be];return Ce}function X(){}var B=.7,a=1/B,W="\\s*([+-]?\\d+)\\s*",D="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",J="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",te=/^#([0-9a-f]{3,8})$/,ce=new RegExp("^rgb\\("+[W,W,W]+"\\)$"),Y=new RegExp("^rgb\\("+[J,J,J]+"\\)$"),ke=new RegExp("^rgba\\("+[W,W,W,D]+"\\)$"),Ke=new RegExp("^rgba\\("+[J,J,J,D]+"\\)$"),We=new RegExp("^hsl\\("+[D,J,J]+"\\)$"),Oe=new RegExp("^hsla\\("+[D,J,J,D]+"\\)$"),st={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};S(X,$e,{copy:function(G){return Object.assign(new this.constructor,this,G)},displayable:function(){return this.rgb().displayable()},hex:Le,formatHex:Le,formatHsl:xt,formatRgb:it,toString:it});function Le(){return this.rgb().formatHex()}function xt(){return Gt(this).formatHsl()}function it(){return this.rgb().formatRgb()}function $e(Q){var G,Ce;return Q=(Q+"").trim().toLowerCase(),(G=te.exec(Q))?(Ce=G[1].length,G=parseInt(G[1],16),Ce===6?Ze(G):Ce===3?new ze(G>>8&15|G>>4&240,G>>4&15|G&240,(G&15)<<4|G&15,1):Ce===8?St(G>>24&255,G>>16&255,G>>8&255,(G&255)/255):Ce===4?St(G>>12&15|G>>8&240,G>>8&15|G>>4&240,G>>4&15|G&240,((G&15)<<4|G&15)/255):null):(G=ce.exec(Q))?new ze(G[1],G[2],G[3],1):(G=Y.exec(Q))?new ze(G[1]*255/100,G[2]*255/100,G[3]*255/100,1):(G=ke.exec(Q))?St(G[1],G[2],G[3],G[4]):(G=Ke.exec(Q))?St(G[1]*255/100,G[2]*255/100,G[3]*255/100,G[4]):(G=We.exec(Q))?ct(G[1],G[2]/100,G[3]/100,1):(G=Oe.exec(Q))?ct(G[1],G[2]/100,G[3]/100,G[4]):st.hasOwnProperty(Q)?Ze(st[Q]):Q==="transparent"?new ze(NaN,NaN,NaN,0):null}function Ze(Q){return new ze(Q>>16&255,Q>>8&255,Q&255,1)}function St(Q,G,Ce,be){return be<=0&&(Q=G=Ce=NaN),new ze(Q,G,Ce,be)}function bt(Q){return Q instanceof X||(Q=$e(Q)),Q?(Q=Q.rgb(),new ze(Q.r,Q.g,Q.b,Q.opacity)):new ze}function Ne(Q,G,Ce,be){return arguments.length===1?bt(Q):new ze(Q,G,Ce,be==null?1:be)}function ze(Q,G,Ce,be){this.r=+Q,this.g=+G,this.b=+Ce,this.opacity=+be}S(ze,Ne,v(X,{brighter:function(G){return G=G==null?a:Math.pow(a,G),new ze(this.r*G,this.g*G,this.b*G,this.opacity)},darker:function(G){return G=G==null?B:Math.pow(B,G),new ze(this.r*G,this.g*G,this.b*G,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ue,formatHex:Ue,formatRgb:lt,toString:lt}));function Ue(){return"#"+Me(this.r)+Me(this.g)+Me(this.b)}function lt(){var Q=this.opacity;return Q=isNaN(Q)?1:Math.max(0,Math.min(1,Q)),(Q===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(Q===1?")":", "+Q+")")}function Me(Q){return Q=Math.max(0,Math.min(255,Math.round(Q)||0)),(Q<16?"0":"")+Q.toString(16)}function ct(Q,G,Ce,be){return be<=0?Q=G=Ce=NaN:Ce<=0||Ce>=1?Q=G=NaN:G<=0&&(Q=NaN),new ar(Q,G,Ce,be)}function Gt(Q){if(Q instanceof ar)return new ar(Q.h,Q.s,Q.l,Q.opacity);if(Q instanceof X||(Q=$e(Q)),!Q)return new ar;if(Q instanceof ar)return Q;Q=Q.rgb();var G=Q.r/255,Ce=Q.g/255,be=Q.b/255,Te=Math.min(G,Ce,be),me=Math.max(G,Ce,be),rt=NaN,Kt=me-Te,_t=(me+Te)/2;return Kt?(G===me?rt=(Ce-be)/Kt+(Ce<be)*6:Ce===me?rt=(be-G)/Kt+2:rt=(G-Ce)/Kt+4,Kt/=_t<.5?me+Te:2-me-Te,rt*=60):Kt=_t>0&&_t<1?0:rt,new ar(rt,Kt,_t,Q.opacity)}function $t(Q,G,Ce,be){return arguments.length===1?Gt(Q):new ar(Q,G,Ce,be==null?1:be)}function ar(Q,G,Ce,be){this.h=+Q,this.s=+G,this.l=+Ce,this.opacity=+be}S(ar,$t,v(X,{brighter:function(G){return G=G==null?a:Math.pow(a,G),new ar(this.h,this.s,this.l*G,this.opacity)},darker:function(G){return G=G==null?B:Math.pow(B,G),new ar(this.h,this.s,this.l*G,this.opacity)},rgb:function(){var G=this.h%360+(this.h<0)*360,Ce=isNaN(G)||isNaN(this.s)?0:this.s,be=this.l,Te=be+(be<.5?be:1-be)*Ce,me=2*be-Te;return new ze(oe(G>=240?G-240:G+120,me,Te),oe(G,me,Te),oe(G<120?G+240:G-120,me,Te),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var G=this.opacity;return G=isNaN(G)?1:Math.max(0,Math.min(1,G)),(G===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(G===1?")":", "+G+")")}}));function oe(Q,G,Ce){return(Q<60?G+(Ce-G)*Q/60:Q<180?Ce:Q<240?G+(Ce-G)*(240-Q)/60:G)*255}},G6z8:function(Re,y,o){var S=o("fR/l"),v=o("oCl/"),X=o("mTTR");function B(a){return S(a,X,v)}Re.exports=B},GXnB:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Metadata=void 0;var S=o("xfSm"),v=function(){function X(B,a){this.key=B,this.value=a}return X.prototype.toString=function(){return this.key===S.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},X}();y.Metadata=v},Gi0A:function(Re,y,o){var S=o("QqLw"),v=o("ExA7"),X="[object Map]";function B(a){return v(a)&&S(a)==X}Re.exports=B},"H+7v":function(Re,y,o){Re.exports={activeChart:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChart",activeChartGrid:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartGrid",activeChartLegend:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartLegend",dashedLine:"antd-pro-pages-dashboard-monitor-components-active-chart-index-dashedLine",line:"antd-pro-pages-dashboard-monitor-components-active-chart-index-line"}},Hel2:function(Re,y,o){"use strict";o.d(y,"o",function(){return _t}),o.d(y,"m",function(){return Ie}),o.d(y,"p",function(){return q}),o.d(y,"d",function(){return nt}),o.d(y,"q",function(){return $}),o.d(y,"r",function(){return ie}),o.d(y,"j",function(){return et}),o.d(y,"h",function(){return Bt}),o.d(y,"b",function(){return lr}),o.d(y,"i",function(){return dt}),o.d(y,"s",function(){return Ct}),o.d(y,"k",function(){return gt}),o.d(y,"l",function(){return we}),o.d(y,"n",function(){return ht}),o.d(y,"f",function(){return Qe}),o.d(y,"e",function(){return Vt}),o.d(y,"g",function(){return pr}),o.d(y,"a",function(){return S}),o.d(y,"c",function(){return v});var S={};o.r(S),o.d(S,"getContainer",function(){return W}),o.d(S,"trim",function(){return D}),o.d(S,"splitWords",function(){return J}),o.d(S,"create",function(){return ce}),o.d(S,"remove",function(){return Y}),o.d(S,"addClass",function(){return ke}),o.d(S,"removeClass",function(){return Ke}),o.d(S,"hasClass",function(){return We}),o.d(S,"setClass",function(){return Oe}),o.d(S,"getClass",function(){return st}),o.d(S,"empty",function(){return Le}),o.d(S,"setTransform",function(){return it}),o.d(S,"triggerResize",function(){return $e}),o.d(S,"printCanvas",function(){return Ze});var v={};o.r(v),o.d(v,"sum",function(){return jn}),o.d(v,"max",function(){return Zr}),o.d(v,"min",function(){return cr}),o.d(v,"mean",function(){return Sn}),o.d(v,"mode",function(){return ai}),o.d(v,"statMap",function(){return fi}),o.d(v,"getColumn",function(){return Zn}),o.d(v,"getSatByColumn",function(){return Hn});function X(k){var H=131,le=137,de=0;k+="x";for(var at=Math.floor(9007199254740991/le),At=0;At<k.length;At++)de>at&&(de=Math.floor(de/le)),de=de*H+k.charCodeAt(At);return de}function B(k){k=k.toString();for(var H=5381,le=k.length;le;)H=H*33^k.charCodeAt(--le);return H>>>0}var a=window.document.documentElement.style;function W(k){var H=k;return typeof k=="string"&&(H=document.getElementById(k)),H}function D(k){return k.trim?k.trim():k.replace(/^\s+|\s+$/g,"")}function J(k){return D(k).split(/\s+/)}function te(k){if(!a)return k[0];for(var H in k)if(k[H]&&k[H]in a)return k[H];return k[0]}function ce(k,H,le){var de=document.createElement(k);return de.className=H||"",le&&le.appendChild(de),de}function Y(k){var H=k.parentNode;H&&H.removeChild(k)}function ke(k,H){if(k.classList!==void 0)for(var le=J(H),de=0,at=le.length;de<at;de++)k.classList.add(le[de]);else if(!We(k,H)){var At=st(k);Oe(k,(At?At+" ":"")+H)}}function Ke(k,H){k.classList!==void 0?k.classList.remove(H):Oe(k,D((" "+st(k)+" ").replace(" "+H+" "," ")))}function We(k,H){if(k.classList!==void 0)return k.classList.contains(H);var le=st(k);return le.length>0&&new RegExp("(^|\\s)"+H+"(\\s|$)").test(le)}function Oe(k,H){k instanceof HTMLElement?k.className=H:k.className.baseVal=H}function st(k){return k instanceof SVGElement&&(k=k.correspondingElement),k.className.baseVal===void 0?k.className:k.className.baseVal}function Le(k){for(;k&&k.firstChild;)k.removeChild(k.firstChild)}var xt=te(["transform","WebkitTransform"]);function it(k,H){k.style[xt]=H}function $e(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var k=window.document.createEvent("UIEvents");k.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(k)}}function Ze(k){var H=["padding: "+(k.height/2-8)+"px "+k.width/2+"px;","line-height: "+k.height+"px;","background-image: url("+k.toDataURL()+");"];console.log(`%c
`,H.join(""))}var St=o("lwsE"),bt=o.n(St),Ne=o("W8MJ"),ze=o.n(Ne),Ue=o("7W2i"),lt=o.n(Ue),Me=o("a1gu"),ct=o.n(Me),Gt=o("Nsbk"),$t=o.n(Gt),ar=o("oShl"),oe=o.n(ar);function Q(k){var H=G();return function(){var de=$t()(k),at;if(H){var At=$t()(this).constructor;at=Reflect.construct(de,arguments,At)}else at=de.apply(this,arguments);return ct()(this,at)}}function G(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}var Ce=function(k){lt()(le,k);var H=Q(le);function le(de,at,At){var Ft;return bt()(this,le),Ft=H.call(this,de),Ft.status=void 0,Ft.url=void 0,Ft.status=at,Ft.url=At,Ft.name=Ft.constructor.name,Ft.message=de,Ft}return ze()(le,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),le}(oe()(Error));function be(k){var H=new XMLHttpRequest;H.open("GET",k.url,!0);for(var le in k.headers)k.headers.hasOwnProperty(le)&&H.setRequestHeader(le,k.headers[le]);return H.withCredentials=k.credentials==="include",H}var Te=function(H,le){var de=be(H);return de.setRequestHeader("Accept","application/json"),de.onerror=function(){le(new Error(de.statusText))},de.onload=function(){if(de.status>=200&&de.status<300&&de.response){var at;try{at=JSON.parse(de.response)}catch(At){return le(At)}le(null,at)}else de.status===401?le(new Ce("".concat(de.statusText),de.status,H.url)):le(new Ce(de.statusText,de.status,H.url))},de.send(),de},me=function(H,le){var de=be(H);return de.responseType="arraybuffer",de.onerror=function(){le(new Error(de.statusText))},de.onload=function(){var at=de.response;if(at.byteLength===0&&de.status===200)return le(new Error("http status 200 returned without content."));de.status>=200&&de.status<300&&de.response?le(null,{data:at,cacheControl:de.getResponseHeader("Cache-Control"),expires:de.getResponseHeader("Expires")}):le(new Ce(de.statusText,de.status,H.url))},de.send(),de};function rt(k){var H=window.document.createElement("a");return H.href=k,H.protocol===window.document.location.protocol&&H.host===window.document.location.host}var Kt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",_t=function(H,le){return me(H,function(de,at){if(de)le(de);else if(at){var At=new window.Image;At.crossOrigin="anonymous";var Ft=window.URL||window.webkitURL;At.onload=function(){le(null,At),Ft.revokeObjectURL(At.src)};var He=new window.Blob([new Uint8Array(at.data)],{type:"image/png"});At.src=at.data.byteLength?Ft.createObjectURL(He):Kt}})},ge=o("J4zp"),ye=o.n(ge),Ve=o("/rf6"),ft=2*Math.PI*6378137/2;function Ie(k){var H=[Infinity,Infinity,-Infinity,-Infinity];return k.forEach(function(le){var de=le.coordinates;pt(H,de)}),H}function pt(k,H){return Array.isArray(H[0])?H.forEach(function(le){pt(k,le)}):(k[0]>H[0]&&(k[0]=H[0]),k[1]>H[1]&&(k[1]=H[1]),k[2]<H[0]&&(k[2]=H[0]),k[3]<H[1]&&(k[3]=H[1])),k}function C(k,H){return R(k,H)}function R(k,H){return Array.isArray(k[0])?k.map(function(le){return R(le,H)}):H(k)}function q(k){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};k=yt(k,H);var de=k[0],at=k[1],At=de*ft/180,Ft=Math.log(Math.tan((90+at)*Math.PI/360))/(Math.PI/180);return Ft=Ft*ft/180,le.enable&&(At=Number(At.toFixed(le.decimal)),Ft=Number(Ft.toFixed(le.decimal))),k.length===3?[At,Ft,k[2]]:[At,Ft]}function fe(k){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,le=k[0],de=k[1],at=le/ft*180,At=de/ft*180;return At=180/Math.PI*(2*Math.atan(Math.exp(At*Math.PI/180))-Math.PI/2),H!=null&&(at=Number(at.toFixed(H)),At=Number(At.toFixed(H))),k.length===3?[at,At,k[2]]:[at,At]}function Ge(k){if(k==null)throw new Error("lng is required");return(k>180||k<-180)&&(k=k%360,k>180&&(k=-360+k),k<-180&&(k=360+k),k===0&&(k=0)),k}function Je(k){if(k==null)throw new Error("lat is required");return(k>90||k<-90)&&(k=k%180,k>90&&(k=-180+k),k<-90&&(k=180+k),k===0&&(k=0)),k}function yt(k,H){if(H===!1)return k;var le=Ge(k[0]),de=Je(k[1]);return de>85&&(de=85),de<-85&&(de=-85),k.length===3?[le,de,k[2]]:[le,de]}function nt(k){var H=85.0511287798,le=Math.max(Math.min(H,k[1]),-H),de=256<<20,at=Math.PI/180,At=k[0]*at,Ft=le*at;Ft=Math.log(Math.tan(Math.PI/4+Ft/2));var He=.5/Math.PI,Pt=.5,or=-.5/Math.PI;return at=.5,At=de*(He*At+Pt),Ft=de*(or*Ft+at),[Math.floor(At),Math.floor(Ft)]}function Nt(k){var H=.5/Math.PI,le=.5,de=-.5/Math.PI,at=.5,At=256<<20,Ft=ye()(k,2),He=Ft[0],Pt=Ft[1];He=(He/At-le)/H,Pt=(Pt/At-at)/de,Pt=(Math.atan(Math.pow(Math.E,Pt))-Math.PI/4)*2,at=Math.PI/180;var or=Pt/at,jr=He/at;return[jr,or]}function $(k,H,le){var de=Object(Ve.degreesToRadians)(H[1]-k[1]),at=Object(Ve.degreesToRadians)(H[0]-k[0]),At=Object(Ve.degreesToRadians)(k[1]),Ft=Object(Ve.degreesToRadians)(H[1]),He=Math.pow(Math.sin(de/2),2)+Math.pow(Math.sin(at/2),2)*Math.cos(At)*Math.cos(Ft);return Object(Ve.radiansToLength)(2*Math.atan2(Math.sqrt(He),Math.sqrt(1-He)),le="meters")}function Ye(k){var H=Math.PI/180,le=85.0511287798,de=6378137,at=Math.max(Math.min(le,k[1]),-le),At=Math.sin(at*H),Ft=de*k[0]*H,He=de*Math.log((1+At)/(1-At))/2;return[Ft,He]}function ie(k,H){var le=Math.abs(k[1][1]-k[0][1])*H,de=Math.abs(k[1][0]-k[0][0])*H;return[[k[0][0]-de,k[0][1]-le],[k[1][0]+de,k[1][1]+le]]}function et(k,H){return k[0][0]<=H[0][0]&&k[0][1]<=H[0][1]&&k[1][0]>=H[1][0]&&k[1][1]>=H[1][1]}function Bt(k){return[[k[0],k[1]],[k[2],k[3]]]}var lr=function(){function k(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,le=arguments.length>1?arguments[1]:void 0;bt()(this,k),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=H,this.destroy=le||this.defaultDestroy,this.order=[],this.clear()}return ze()(k,[{key:"clear",value:function(){var le=this;this.order.forEach(function(de){le.delete(de)}),this.cache={},this.order=[]}},{key:"get",value:function(le){var de=this.cache[le];return de&&(this.deleteOrder(le),this.appendOrder(le)),de}},{key:"set",value:function(le,de){this.cache[le]?(this.delete(le),this.cache[le]=de,this.appendOrder(le)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[le]=de,this.appendOrder(le))}},{key:"delete",value:function(le){var de=this.cache[le];de&&(this.deleteCache(le),this.deleteOrder(le),this.destroy(de,le))}},{key:"deleteCache",value:function(le){delete this.cache[le]}},{key:"deleteOrder",value:function(le){var de=this.order.findIndex(function(at){return at===le});de>=0&&this.order.splice(de,1)}},{key:"appendOrder",value:function(le){this.order.push(le)}},{key:"defaultDestroy",value:function(le,de){return null}}]),k}();function dt(k,H){k.forEach(function(le){!H[le]||(H[le]=H[le].bind(H))})}var vt=o("FmoU");function Ct(k){var H=vt.a(k),le=[0,0,0,0];return H!=null&&(le[0]=H.r/255,le[1]=H.g/255,le[2]=H.b/255,le[3]=H.opacity),le}function gt(k){var H=k&&k[0],le=k&&k[1],de=k&&k[2],at=H+le*256+de*65536-1;return at}function we(k){return[k+1&255,k+1>>8&255,k+1>>8>>8&255]}function ht(k){var H=document.createElement("canvas"),le=H.getContext("2d");H.width=256,H.height=1;for(var de=le.createLinearGradient(0,0,256,1),at=null,At=k.positions[0],Ft=k.positions[k.positions.length-1],He=0;He<k.colors.length;++He){var Pt=(k.positions[He]-At)/(Ft-At);de.addColorStop(Pt,k.colors[He])}return le.fillStyle=de,le.fillRect(0,0,256,1),at=new Uint8ClampedArray(le.getImageData(0,0,256,1).data),new ImageData(at,256,1)}var Qe;(function(k){k.CENTER="center",k.TOP="top",k["TOP-LEFT"]="top-left",k["TOP-RIGHT"]="top-right",k.BOTTOM="bottom",k["BOTTOM-LEFT"]="bottom-left",k.LEFT="left",k.RIGHT="right"})(Qe||(Qe={}));var Vt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function pr(k,H,le){var de=k.classList;for(var at in Vt)Vt.hasOwnProperty(at)&&de.remove("l7-".concat(le,"-anchor-").concat(at));de.add("l7-".concat(le,"-anchor-").concat(H))}function Zr(k){if(k.length===0)throw new Error("max requires at least one data point");for(var H=k[0],le=1;le<k.length;le++)k[le]>H&&(H=k[le]);return H*1}function cr(k){if(k.length===0)throw new Error("min requires at least one data point");for(var H=k[0],le=1;le<k.length;le++)k[le]<H&&(H=k[le]);return H*1}function jn(k){if(k.length===0)return 0;for(var H=k[0]*1,le=1;le<k.length;le++)H+=k[le]*1;return H}function Sn(k){if(k.length===0)throw new Error("mean requires at least one data point");return jn(k)/k.length}function ai(k){if(k.length===0)throw new Error("mean requires at least one data point");if(k.length<3)return k[0];k.sort();for(var H=k[0],le=NaN,de=0,at=1,At=1;At<k.length+1;At++)k[At]!==H?(at>de&&(de=at,le=H),at=1,H=k[At]):at++;return le*1}var fi={min:cr,max:Zr,mean:Sn,sum:jn,mode:ai};function Zn(k,H){return k.map(function(le){return le[H]})}function Hn(k,H){return fi[k](H)}},HpQ9:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.ContainerSnapshot=void 0;var S=function(){function v(){}return v.of=function(X,B){var a=new v;return a.bindings=X,a.middleware=B,a},v}();y.ContainerSnapshot=S},HthE:function(Re,y,o){"use strict";o.d(y,"a",function(){return S}),o.d(y,"b",function(){return v});var S;(function(X){X[X.LNGLAT=1]="LNGLAT",X[X.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",X[X.VECTOR_TILE=3]="VECTOR_TILE",X[X.IDENTITY=4]="IDENTITY",X[X.P20=5]="P20",X[X.P20_OFFSET=6]="P20_OFFSET",X[X.METER_OFFSET=7]="METER_OFFSET"})(S||(S={}));var v={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"}},I0ug:function(Re,y,o){"use strict";(function(S){o.d(y,"a",function(){return X});var v=o("U8pU");function X(B){if(typeof window!="undefined"&&Object(v.a)(window.process)==="object"&&window.process.type==="renderer"||typeof S!="undefined"&&Object(v.a)(S.versions)==="object"&&Boolean(S.versions.electron))return!0;var a=(typeof navigator=="undefined"?"undefined":Object(v.a)(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,W=B||a;return!!(W&&W.indexOf("Electron")>=0)}}).call(this,o("Q2Ig"))},IOcx:function(Re,y,o){"use strict";o.d(y,"a",function(){return S}),o.d(y,"b",function(){return ct}),o.d(y,"c",function(){return Gt}),o.d(y,"d",function(){return $t}),o.d(y,"e",function(){return ar});var S={};o.r(S),o.d(S,"create",function(){return X}),o.d(S,"clone",function(){return B}),o.d(S,"copy",function(){return a}),o.d(S,"identity",function(){return W}),o.d(S,"fromValues",function(){return D}),o.d(S,"set",function(){return J}),o.d(S,"transpose",function(){return te}),o.d(S,"invert",function(){return ce}),o.d(S,"adjoint",function(){return Y}),o.d(S,"determinant",function(){return ke}),o.d(S,"multiply",function(){return Ke}),o.d(S,"rotate",function(){return We}),o.d(S,"scale",function(){return Oe}),o.d(S,"fromRotation",function(){return st}),o.d(S,"fromScaling",function(){return Le}),o.d(S,"str",function(){return xt}),o.d(S,"frob",function(){return it}),o.d(S,"LDU",function(){return $e}),o.d(S,"add",function(){return Ze}),o.d(S,"subtract",function(){return St}),o.d(S,"exactEquals",function(){return bt}),o.d(S,"equals",function(){return Ne}),o.d(S,"multiplyScalar",function(){return ze}),o.d(S,"multiplyScalarAndAdd",function(){return Ue}),o.d(S,"mul",function(){return lt}),o.d(S,"sub",function(){return Me});var v=o("yU0y");function X(){var oe=new v.a(4);return v.a!=Float32Array&&(oe[1]=0,oe[2]=0),oe[0]=1,oe[3]=1,oe}function B(oe){var Q=new v.a(4);return Q[0]=oe[0],Q[1]=oe[1],Q[2]=oe[2],Q[3]=oe[3],Q}function a(oe,Q){return oe[0]=Q[0],oe[1]=Q[1],oe[2]=Q[2],oe[3]=Q[3],oe}function W(oe){return oe[0]=1,oe[1]=0,oe[2]=0,oe[3]=1,oe}function D(oe,Q,G,Ce){var be=new v.a(4);return be[0]=oe,be[1]=Q,be[2]=G,be[3]=Ce,be}function J(oe,Q,G,Ce,be){return oe[0]=Q,oe[1]=G,oe[2]=Ce,oe[3]=be,oe}function te(oe,Q){if(oe===Q){var G=Q[1];oe[1]=Q[2],oe[2]=G}else oe[0]=Q[0],oe[1]=Q[2],oe[2]=Q[1],oe[3]=Q[3];return oe}function ce(oe,Q){var G=Q[0],Ce=Q[1],be=Q[2],Te=Q[3],me=G*Te-be*Ce;return me?(me=1/me,oe[0]=Te*me,oe[1]=-Ce*me,oe[2]=-be*me,oe[3]=G*me,oe):null}function Y(oe,Q){var G=Q[0];return oe[0]=Q[3],oe[1]=-Q[1],oe[2]=-Q[2],oe[3]=G,oe}function ke(oe){return oe[0]*oe[3]-oe[2]*oe[1]}function Ke(oe,Q,G){var Ce=Q[0],be=Q[1],Te=Q[2],me=Q[3],rt=G[0],Kt=G[1],_t=G[2],ge=G[3];return oe[0]=Ce*rt+Te*Kt,oe[1]=be*rt+me*Kt,oe[2]=Ce*_t+Te*ge,oe[3]=be*_t+me*ge,oe}function We(oe,Q,G){var Ce=Q[0],be=Q[1],Te=Q[2],me=Q[3],rt=Math.sin(G),Kt=Math.cos(G);return oe[0]=Ce*Kt+Te*rt,oe[1]=be*Kt+me*rt,oe[2]=Ce*-rt+Te*Kt,oe[3]=be*-rt+me*Kt,oe}function Oe(oe,Q,G){var Ce=Q[0],be=Q[1],Te=Q[2],me=Q[3],rt=G[0],Kt=G[1];return oe[0]=Ce*rt,oe[1]=be*rt,oe[2]=Te*Kt,oe[3]=me*Kt,oe}function st(oe,Q){var G=Math.sin(Q),Ce=Math.cos(Q);return oe[0]=Ce,oe[1]=G,oe[2]=-G,oe[3]=Ce,oe}function Le(oe,Q){return oe[0]=Q[0],oe[1]=0,oe[2]=0,oe[3]=Q[1],oe}function xt(oe){return"mat2("+oe[0]+", "+oe[1]+", "+oe[2]+", "+oe[3]+")"}function it(oe){return Math.hypot(oe[0],oe[1],oe[2],oe[3])}function $e(oe,Q,G,Ce){return oe[2]=Ce[2]/Ce[0],G[0]=Ce[0],G[1]=Ce[1],G[3]=Ce[3]-oe[2]*G[1],[oe,Q,G]}function Ze(oe,Q,G){return oe[0]=Q[0]+G[0],oe[1]=Q[1]+G[1],oe[2]=Q[2]+G[2],oe[3]=Q[3]+G[3],oe}function St(oe,Q,G){return oe[0]=Q[0]-G[0],oe[1]=Q[1]-G[1],oe[2]=Q[2]-G[2],oe[3]=Q[3]-G[3],oe}function bt(oe,Q){return oe[0]===Q[0]&&oe[1]===Q[1]&&oe[2]===Q[2]&&oe[3]===Q[3]}function Ne(oe,Q){var G=oe[0],Ce=oe[1],be=oe[2],Te=oe[3],me=Q[0],rt=Q[1],Kt=Q[2],_t=Q[3];return Math.abs(G-me)<=v.b*Math.max(1,Math.abs(G),Math.abs(me))&&Math.abs(Ce-rt)<=v.b*Math.max(1,Math.abs(Ce),Math.abs(rt))&&Math.abs(be-Kt)<=v.b*Math.max(1,Math.abs(be),Math.abs(Kt))&&Math.abs(Te-_t)<=v.b*Math.max(1,Math.abs(Te),Math.abs(_t))}function ze(oe,Q,G){return oe[0]=Q[0]*G,oe[1]=Q[1]*G,oe[2]=Q[2]*G,oe[3]=Q[3]*G,oe}function Ue(oe,Q,G,Ce){return oe[0]=Q[0]+G[0]*Ce,oe[1]=Q[1]+G[1]*Ce,oe[2]=Q[2]+G[2]*Ce,oe[3]=Q[3]+G[3]*Ce,oe}var lt=Ke,Me=St,ct=o("ZaHm"),Gt=o("ZxFD"),$t=o("n+fv"),ar=o("bl9R")},ISu3:function(Re,y,o){"use strict";o.d(y,"a",function(){return X}),o.d(y,"c",function(){return B}),o.d(y,"b",function(){return a}),o.d(y,"d",function(){return W});var S={},v={},X=function(J){return v[J]},B=function(J,te){v[J]=te},a=function(J){return S[J]},W=function(J,te){S[J]=te}},Ioao:function(Re,y,o){var S=o("heNW"),v=Math.max;function X(B,a,W){return a=v(a===void 0?B.length-1:a,0),function(){for(var D=arguments,J=-1,te=v(D.length-a,0),ce=Array(te);++J<te;)ce[J]=D[a+J];J=-1;for(var Y=Array(a+1);++J<a;)Y[J]=D[J];return Y[a]=W(ce),S(B,this,Y)}}Re.exports=X},J2iB:function(Re,y){function o(S){return S==null}Re.exports=o},J7lC:function(Re,y){},K9nA:function(Re,y,o){"use strict";(function(S,v){o.d(y,"b",function(){return W}),o.d(y,"a",function(){return te});var X=o("U8pU"),B={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,global:typeof S!="undefined"&&S,document:typeof document!="undefined"&&document,process:(typeof v=="undefined"?"undefined":Object(X.a)(v))==="object"&&v},a=B.self||B.window||B.global,W=B.window||B.self||B.global,D=B.global||B.self||B.window,J=B.document||{},te=B.process||{},ce=console}).call(this,o("yLpj"),o("Q2Ig"))},KKCa:function(Re,y){typeof Object.create=="function"?Re.exports=function(S,v){S.super_=v,S.prototype=Object.create(v.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}})}:Re.exports=function(S,v){S.super_=v;var X=function(){};X.prototype=v.prototype,S.prototype=new X,S.prototype.constructor=S}},KwMD:function(Re,y){function o(S,v,X,B){for(var a=S.length,W=X+(B?1:-1);B?W--:++W<a;)if(v(S[W],W,S))return W;return-1}Re.exports=o},KxBF:function(Re,y){function o(S,v,X){var B=-1,a=S.length;v<0&&(v=-v>a?0:a+v),X=X>a?a:X,X<0&&(X+=a),a=v>X?0:X-v>>>0,v>>>=0;for(var W=Array(a);++B<a;)W[B]=S[B+v];return W}Re.exports=o},L56e:function(Re,y,o){"use strict";o.d(y,"a",function(){return S});var S=["mapload"]},LGYb:function(Re,y,o){var S=o("1hJj"),v=o("jbM+"),X=o("Xt/L"),B=o("xYSL"),a=o("dQpi"),W=o("rEGp"),D=200;function J(te,ce,Y){var ke=-1,Ke=v,We=te.length,Oe=!0,st=[],Le=st;if(Y)Oe=!1,Ke=X;else if(We>=D){var xt=ce?null:a(te);if(xt)return W(xt);Oe=!1,Ke=B,Le=new S}else Le=ce?[]:st;e:for(;++ke<We;){var it=te[ke],$e=ce?ce(it):it;if(it=Y||it!==0?it:0,Oe&&$e===$e){for(var Ze=Le.length;Ze--;)if(Le[Ze]===$e)continue e;ce&&Le.push($e),st.push(it)}else Ke(Le,$e,Y)||(Le!==st&&Le.push($e),st.push(it))}return st}Re.exports=J},LKzl:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingWhenOnSyntax=void 0;var S=o("406g"),v=o("z4Hk"),X=function(){function B(a){this._binding=a,this._bindingWhenSyntax=new v.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new S.BindingOnSyntax(this._binding)}return B.prototype.when=function(a){return this._bindingWhenSyntax.when(a)},B.prototype.whenTargetNamed=function(a){return this._bindingWhenSyntax.whenTargetNamed(a)},B.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},B.prototype.whenTargetTagged=function(a,W){return this._bindingWhenSyntax.whenTargetTagged(a,W)},B.prototype.whenInjectedInto=function(a){return this._bindingWhenSyntax.whenInjectedInto(a)},B.prototype.whenParentNamed=function(a){return this._bindingWhenSyntax.whenParentNamed(a)},B.prototype.whenParentTagged=function(a,W){return this._bindingWhenSyntax.whenParentTagged(a,W)},B.prototype.whenAnyAncestorIs=function(a){return this._bindingWhenSyntax.whenAnyAncestorIs(a)},B.prototype.whenNoAncestorIs=function(a){return this._bindingWhenSyntax.whenNoAncestorIs(a)},B.prototype.whenAnyAncestorNamed=function(a){return this._bindingWhenSyntax.whenAnyAncestorNamed(a)},B.prototype.whenAnyAncestorTagged=function(a,W){return this._bindingWhenSyntax.whenAnyAncestorTagged(a,W)},B.prototype.whenNoAncestorNamed=function(a){return this._bindingWhenSyntax.whenNoAncestorNamed(a)},B.prototype.whenNoAncestorTagged=function(a,W){return this._bindingWhenSyntax.whenNoAncestorTagged(a,W)},B.prototype.whenAnyAncestorMatches=function(a){return this._bindingWhenSyntax.whenAnyAncestorMatches(a)},B.prototype.whenNoAncestorMatches=function(a){return this._bindingWhenSyntax.whenNoAncestorMatches(a)},B.prototype.onActivation=function(a){return this._bindingOnSyntax.onActivation(a)},B}();y.BindingWhenOnSyntax=X},LcsW:function(Re,y,o){var S=o("kekF"),v=S(Object.getPrototypeOf,Object);Re.exports=v},LgvC:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Binding=void 0;var S=o("FV85"),v=o("d9O0"),X=function(){function B(a,W){this.id=v.id(),this.activated=!1,this.serviceIdentifier=a,this.scope=W,this.type=S.BindingTypeEnum.Invalid,this.constraint=function(D){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return B.prototype.clone=function(){var a=new B(this.serviceIdentifier,this.scope);return a.activated=!1,a.implementationType=this.implementationType,a.dynamicValue=this.dynamicValue,a.scope=this.scope,a.type=this.type,a.factory=this.factory,a.provider=this.provider,a.constraint=this.constraint,a.onActivation=this.onActivation,a.cache=this.cache,a},B}();y.Binding=X},LsHQ:function(Re,y,o){var S=o("EA7m"),v=o("mv/X");function X(B){return S(function(a,W){var D=-1,J=W.length,te=J>1?W[J-1]:void 0,ce=J>2?W[2]:void 0;for(te=B.length>3&&typeof te=="function"?(J--,te):void 0,ce&&v(W[0],W[1],ce)&&(te=J<3?void 0:te,J=1),a=Object(a);++D<J;){var Y=W[D];Y&&B(a,Y,D,te)}return a})}Re.exports=X},LvWW:function(Re,y,o){var S=o("mhV4");Re.exports=v;function v(J,te){switch(J&&J.type||null){case"FeatureCollection":return J.features=J.features.map(X(v,te)),J;case"GeometryCollection":return J.geometries=J.geometries.map(X(v,te)),J;case"Feature":return J.geometry=v(J.geometry,te),J;case"Polygon":case"MultiPolygon":return B(J,te);default:return J}}function X(J,te){return function(ce){return J(ce,te)}}function B(J,te){return J.type==="Polygon"?J.coordinates=a(J.coordinates,te):J.type==="MultiPolygon"&&(J.coordinates=J.coordinates.map(X(a,te))),J}function a(J,te){te=!!te,J[0]=W(J[0],te);for(var ce=1;ce<J.length;ce++)J[ce]=W(J[ce],!te);return J}function W(J,te){return D(J)===te?J:J.reverse()}function D(J){return S.ring(J)>=0}},MCLT:function(Re,y,o){(function(S){var v=Object.getOwnPropertyDescriptors||function(me){for(var rt=Object.keys(me),Kt={},_t=0;_t<rt.length;_t++)Kt[rt[_t]]=Object.getOwnPropertyDescriptor(me,rt[_t]);return Kt},X=/%[sdj%]/g;y.format=function(Te){if(!Ze(Te)){for(var me=[],rt=0;rt<arguments.length;rt++)me.push(W(arguments[rt]));return me.join(" ")}for(var rt=1,Kt=arguments,_t=Kt.length,ge=String(Te).replace(X,function(Ve){if(Ve==="%%")return"%";if(rt>=_t)return Ve;switch(Ve){case"%s":return String(Kt[rt++]);case"%d":return Number(Kt[rt++]);case"%j":try{return JSON.stringify(Kt[rt++])}catch(ft){return"[Circular]"}default:return Ve}}),ye=Kt[rt];rt<_t;ye=Kt[++rt])xt(ye)||!ze(ye)?ge+=" "+ye:ge+=" "+W(ye);return ge},y.deprecate=function(Te,me){if(typeof S!="undefined"&&S.noDeprecation===!0)return Te;if(typeof S=="undefined")return function(){return y.deprecate(Te,me).apply(this,arguments)};var rt=!1;function Kt(){if(!rt){if(S.throwDeprecation)throw new Error(me);S.traceDeprecation?console.trace(me):console.error(me),rt=!0}return Te.apply(this,arguments)}return Kt};var B={},a;y.debuglog=function(Te){if(bt(a)&&(a=Object({NODE_ENV:"production"}).NODE_DEBUG||""),Te=Te.toUpperCase(),!B[Te])if(new RegExp("\\b"+Te+"\\b","i").test(a)){var me=S.pid;B[Te]=function(){var rt=y.format.apply(y,arguments);console.error("%s %d: %s",Te,me,rt)}}else B[Te]=function(){};return B[Te]};function W(Te,me){var rt={seen:[],stylize:J};return arguments.length>=3&&(rt.depth=arguments[2]),arguments.length>=4&&(rt.colors=arguments[3]),Le(me)?rt.showHidden=me:me&&y._extend(rt,me),bt(rt.showHidden)&&(rt.showHidden=!1),bt(rt.depth)&&(rt.depth=2),bt(rt.colors)&&(rt.colors=!1),bt(rt.customInspect)&&(rt.customInspect=!0),rt.colors&&(rt.stylize=D),ce(rt,Te,rt.depth)}y.inspect=W,W.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},W.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function D(Te,me){var rt=W.styles[me];return rt?"["+W.colors[rt][0]+"m"+Te+"["+W.colors[rt][1]+"m":Te}function J(Te,me){return Te}function te(Te){var me={};return Te.forEach(function(rt,Kt){me[rt]=!0}),me}function ce(Te,me,rt){if(Te.customInspect&&me&&Me(me.inspect)&&me.inspect!==y.inspect&&!(me.constructor&&me.constructor.prototype===me)){var Kt=me.inspect(rt,Te);return Ze(Kt)||(Kt=ce(Te,Kt,rt)),Kt}var _t=Y(Te,me);if(_t)return _t;var ge=Object.keys(me),ye=te(ge);if(Te.showHidden&&(ge=Object.getOwnPropertyNames(me)),lt(me)&&(ge.indexOf("message")>=0||ge.indexOf("description")>=0))return ke(me);if(ge.length===0){if(Me(me)){var Ve=me.name?": "+me.name:"";return Te.stylize("[Function"+Ve+"]","special")}if(Ne(me))return Te.stylize(RegExp.prototype.toString.call(me),"regexp");if(Ue(me))return Te.stylize(Date.prototype.toString.call(me),"date");if(lt(me))return ke(me)}var ft="",Ie=!1,pt=["{","}"];if(st(me)&&(Ie=!0,pt=["[","]"]),Me(me)){var C=me.name?": "+me.name:"";ft=" [Function"+C+"]"}if(Ne(me)&&(ft=" "+RegExp.prototype.toString.call(me)),Ue(me)&&(ft=" "+Date.prototype.toUTCString.call(me)),lt(me)&&(ft=" "+ke(me)),ge.length===0&&(!Ie||me.length==0))return pt[0]+ft+pt[1];if(rt<0)return Ne(me)?Te.stylize(RegExp.prototype.toString.call(me),"regexp"):Te.stylize("[Object]","special");Te.seen.push(me);var R;return Ie?R=Ke(Te,me,rt,ye,ge):R=ge.map(function(q){return We(Te,me,rt,ye,q,Ie)}),Te.seen.pop(),Oe(R,ft,pt)}function Y(Te,me){if(bt(me))return Te.stylize("undefined","undefined");if(Ze(me)){var rt="'"+JSON.stringify(me).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Te.stylize(rt,"string")}if($e(me))return Te.stylize(""+me,"number");if(Le(me))return Te.stylize(""+me,"boolean");if(xt(me))return Te.stylize("null","null")}function ke(Te){return"["+Error.prototype.toString.call(Te)+"]"}function Ke(Te,me,rt,Kt,_t){for(var ge=[],ye=0,Ve=me.length;ye<Ve;++ye)Q(me,String(ye))?ge.push(We(Te,me,rt,Kt,String(ye),!0)):ge.push("");return _t.forEach(function(ft){ft.match(/^\d+$/)||ge.push(We(Te,me,rt,Kt,ft,!0))}),ge}function We(Te,me,rt,Kt,_t,ge){var ye,Ve,ft;if(ft=Object.getOwnPropertyDescriptor(me,_t)||{value:me[_t]},ft.get?ft.set?Ve=Te.stylize("[Getter/Setter]","special"):Ve=Te.stylize("[Getter]","special"):ft.set&&(Ve=Te.stylize("[Setter]","special")),Q(Kt,_t)||(ye="["+_t+"]"),Ve||(Te.seen.indexOf(ft.value)<0?(xt(rt)?Ve=ce(Te,ft.value,null):Ve=ce(Te,ft.value,rt-1),Ve.indexOf(`
`)>-1&&(ge?Ve=Ve.split(`
`).map(function(Ie){return"  "+Ie}).join(`
`).substr(2):Ve=`
`+Ve.split(`
`).map(function(Ie){return"   "+Ie}).join(`
`))):Ve=Te.stylize("[Circular]","special")),bt(ye)){if(ge&&_t.match(/^\d+$/))return Ve;ye=JSON.stringify(""+_t),ye.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(ye=ye.substr(1,ye.length-2),ye=Te.stylize(ye,"name")):(ye=ye.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),ye=Te.stylize(ye,"string"))}return ye+": "+Ve}function Oe(Te,me,rt){var Kt=0,_t=Te.reduce(function(ge,ye){return Kt++,ye.indexOf(`
`)>=0&&Kt++,ge+ye.replace(/\u001b\[\d\d?m/g,"").length+1},0);return _t>60?rt[0]+(me===""?"":me+`
 `)+" "+Te.join(`,
  `)+" "+rt[1]:rt[0]+me+" "+Te.join(", ")+" "+rt[1]}function st(Te){return Array.isArray(Te)}y.isArray=st;function Le(Te){return typeof Te=="boolean"}y.isBoolean=Le;function xt(Te){return Te===null}y.isNull=xt;function it(Te){return Te==null}y.isNullOrUndefined=it;function $e(Te){return typeof Te=="number"}y.isNumber=$e;function Ze(Te){return typeof Te=="string"}y.isString=Ze;function St(Te){return typeof Te=="symbol"}y.isSymbol=St;function bt(Te){return Te===void 0}y.isUndefined=bt;function Ne(Te){return ze(Te)&&Gt(Te)==="[object RegExp]"}y.isRegExp=Ne;function ze(Te){return typeof Te=="object"&&Te!==null}y.isObject=ze;function Ue(Te){return ze(Te)&&Gt(Te)==="[object Date]"}y.isDate=Ue;function lt(Te){return ze(Te)&&(Gt(Te)==="[object Error]"||Te instanceof Error)}y.isError=lt;function Me(Te){return typeof Te=="function"}y.isFunction=Me;function ct(Te){return Te===null||typeof Te=="boolean"||typeof Te=="number"||typeof Te=="string"||typeof Te=="symbol"||typeof Te=="undefined"}y.isPrimitive=ct,y.isBuffer=o("1gqn");function Gt(Te){return Object.prototype.toString.call(Te)}function $t(Te){return Te<10?"0"+Te.toString(10):Te.toString(10)}var ar=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function oe(){var Te=new Date,me=[$t(Te.getHours()),$t(Te.getMinutes()),$t(Te.getSeconds())].join(":");return[Te.getDate(),ar[Te.getMonth()],me].join(" ")}y.log=function(){console.log("%s - %s",oe(),y.format.apply(y,arguments))},y.inherits=o("KKCa"),y._extend=function(Te,me){if(!me||!ze(me))return Te;for(var rt=Object.keys(me),Kt=rt.length;Kt--;)Te[rt[Kt]]=me[rt[Kt]];return Te};function Q(Te,me){return Object.prototype.hasOwnProperty.call(Te,me)}var G=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;y.promisify=function(me){if(typeof me!="function")throw new TypeError('The "original" argument must be of type Function');if(G&&me[G]){var rt=me[G];if(typeof rt!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(rt,G,{value:rt,enumerable:!1,writable:!1,configurable:!0}),rt}function rt(){for(var Kt,_t,ge=new Promise(function(ft,Ie){Kt=ft,_t=Ie}),ye=[],Ve=0;Ve<arguments.length;Ve++)ye.push(arguments[Ve]);ye.push(function(ft,Ie){ft?_t(ft):Kt(Ie)});try{me.apply(this,ye)}catch(ft){_t(ft)}return ge}return Object.setPrototypeOf(rt,Object.getPrototypeOf(me)),G&&Object.defineProperty(rt,G,{value:rt,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(rt,v(me))},y.promisify.custom=G;function Ce(Te,me){if(!Te){var rt=new Error("Promise was rejected with a falsy value");rt.reason=Te,Te=rt}return me(Te)}function be(Te){if(typeof Te!="function")throw new TypeError('The "original" argument must be of type Function');function me(){for(var rt=[],Kt=0;Kt<arguments.length;Kt++)rt.push(arguments[Kt]);var _t=rt.pop();if(typeof _t!="function")throw new TypeError("The last argument must be of type Function");var ge=this,ye=function(){return _t.apply(ge,arguments)};Te.apply(this,rt).then(function(Ve){S.nextTick(ye,null,Ve)},function(Ve){S.nextTick(Ce,Ve,ye)})}return Object.setPrototypeOf(me,Object.getPrototypeOf(Te)),Object.defineProperties(me,v(Te)),me}y.callbackify=be}).call(this,o("Q2Ig"))},MON2:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.STACK_OVERFLOW=y.CIRCULAR_DEPENDENCY_IN_FACTORY=y.POST_CONSTRUCT_ERROR=y.MULTIPLE_POST_CONSTRUCT_METHODS=y.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=y.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=y.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=y.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=y.ARGUMENTS_LENGTH_MISMATCH=y.INVALID_DECORATOR_OPERATION=y.INVALID_TO_SELF_VALUE=y.INVALID_FUNCTION_BINDING=y.INVALID_MIDDLEWARE_RETURN=y.NO_MORE_SNAPSHOTS_AVAILABLE=y.INVALID_BINDING_TYPE=y.NOT_IMPLEMENTED=y.CIRCULAR_DEPENDENCY=y.UNDEFINED_INJECT_ANNOTATION=y.MISSING_INJECT_ANNOTATION=y.MISSING_INJECTABLE_ANNOTATION=y.NOT_REGISTERED=y.CANNOT_UNBIND=y.AMBIGUOUS_MATCH=y.KEY_NOT_FOUND=y.NULL_ARGUMENT=y.DUPLICATED_METADATA=y.DUPLICATED_INJECTABLE_DECORATOR=void 0,y.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",y.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",y.NULL_ARGUMENT="NULL argument",y.KEY_NOT_FOUND="Key Not Found",y.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",y.CANNOT_UNBIND="Could not unbind serviceIdentifier:",y.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",y.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",y.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",y.UNDEFINED_INJECT_ANNOTATION=function(S){return"@inject called with undefined this could mean that the class "+S+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},y.CIRCULAR_DEPENDENCY="Circular dependency found:",y.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",y.INVALID_BINDING_TYPE="Invalid binding type:",y.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",y.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",y.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",y.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",y.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",y.ARGUMENTS_LENGTH_MISMATCH=function(){for(var S=[],v=0;v<arguments.length;v++)S[v]=arguments[v];return"The number of constructor arguments in the derived class "+(S[0]+" must be >= than the number of constructor arguments of its base class.")},y.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",y.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",y.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",y.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",y.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",y.POST_CONSTRUCT_ERROR=function(){for(var S=[],v=0;v<arguments.length;v++)S[v]=arguments[v];return"@postConstruct error in class "+S[0]+": "+S[1]},y.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var S=[],v=0;v<arguments.length;v++)S[v]=arguments[v];return"It looks like there is a circular dependency "+("in one of the '"+S[0]+"' bindings. Please investigate bindings with")+("service identifier '"+S[1]+"'.")},y.STACK_OVERFLOW="Maximum call stack size exceeded"},MrPd:function(Re,y,o){var S=o("hypo"),v=o("ljhN"),X=Object.prototype,B=X.hasOwnProperty;function a(W,D,J){var te=W[D];(!(B.call(W,D)&&v(te,J))||J===void 0&&!(D in W))&&S(W,D,J)}Re.exports=a},O0oS:function(Re,y,o){var S=o("Cwc5"),v=function(){try{var X=S(Object,"defineProperty");return X({},"",{}),X}catch(B){}}();Re.exports=v},O1je:function(Re,y){},OBhP:function(Re,y,o){var S=o("fmRc"),v=o("gFfm"),X=o("MrPd"),B=o("WwFo"),a=o("Dw+G"),W=o("5Tg0"),D=o("Q1l4"),J=o("VOtZ"),te=o("EEGq"),ce=o("qZTm"),Y=o("G6z8"),ke=o("QqLw"),Ke=o("yHx3"),We=o("wrZu"),Oe=o("+iFO"),st=o("Z0cm"),Le=o("DSRE"),xt=o("zEVN"),it=o("GoyQ"),$e=o("1+5i"),Ze=o("7GkX"),St=o("mTTR"),bt=1,Ne=2,ze=4,Ue="[object Arguments]",lt="[object Array]",Me="[object Boolean]",ct="[object Date]",Gt="[object Error]",$t="[object Function]",ar="[object GeneratorFunction]",oe="[object Map]",Q="[object Number]",G="[object Object]",Ce="[object RegExp]",be="[object Set]",Te="[object String]",me="[object Symbol]",rt="[object WeakMap]",Kt="[object ArrayBuffer]",_t="[object DataView]",ge="[object Float32Array]",ye="[object Float64Array]",Ve="[object Int8Array]",ft="[object Int16Array]",Ie="[object Int32Array]",pt="[object Uint8Array]",C="[object Uint8ClampedArray]",R="[object Uint16Array]",q="[object Uint32Array]",fe={};fe[Ue]=fe[lt]=fe[Kt]=fe[_t]=fe[Me]=fe[ct]=fe[ge]=fe[ye]=fe[Ve]=fe[ft]=fe[Ie]=fe[oe]=fe[Q]=fe[G]=fe[Ce]=fe[be]=fe[Te]=fe[me]=fe[pt]=fe[C]=fe[R]=fe[q]=!0,fe[Gt]=fe[$t]=fe[rt]=!1;function Ge(Je,yt,nt,Nt,$,Ye){var ie,et=yt&bt,Bt=yt&Ne,lr=yt&ze;if(nt&&(ie=$?nt(Je,Nt,$,Ye):nt(Je)),ie!==void 0)return ie;if(!it(Je))return Je;var dt=st(Je);if(dt){if(ie=Ke(Je),!et)return D(Je,ie)}else{var vt=ke(Je),Ct=vt==$t||vt==ar;if(Le(Je))return W(Je,et);if(vt==G||vt==Ue||Ct&&!$){if(ie=Bt||Ct?{}:Oe(Je),!et)return Bt?te(Je,a(ie,Je)):J(Je,B(ie,Je))}else{if(!fe[vt])return $?Je:{};ie=We(Je,vt,et)}}Ye||(Ye=new S);var gt=Ye.get(Je);if(gt)return gt;Ye.set(Je,ie),$e(Je)?Je.forEach(function(Qe){ie.add(Ge(Qe,yt,nt,Qe,Je,Ye))}):xt(Je)&&Je.forEach(function(Qe,Vt){ie.set(Vt,Ge(Qe,yt,nt,Vt,Je,Ye))});var we=lr?Bt?Y:ce:Bt?St:Ze,ht=dt?void 0:we(Je);return v(ht||Je,function(Qe,Vt){ht&&(Vt=Qe,Qe=Je[Vt]),X(ie,Vt,Ge(Qe,yt,nt,Vt,Je,Ye))}),ie}Re.exports=Ge},PSsN:function(Re,y){},PUg6:function(Re,y,o){"use strict";o.d(y,"a",function(){return S});var S;(function(v){v.normal="normal",v.additive="additive",v.subtractive="subtractive",v.min="min",v.max="max",v.none="none"})(S||(S={}))},Q1l4:function(Re,y){function o(S,v){var X=-1,B=S.length;for(v||(v=Array(B));++X<B;)v[X]=S[X];return v}Re.exports=o},QGbF:function(Re,y){},"QQZ/":function(Re,y,o){var S=o("Sq3C"),v=o("Z1HP"),X=o("Sxd8"),B=o("dt0z");function a(W,D,J){W=B(W),D=X(D);var te=D?v(W):0;return D&&te<D?S(D-te,J)+W:W}Re.exports=a},QcOe:function(Re,y,o){var S=o("GoyQ"),v=o("6sVZ"),X=o("7Ix3"),B=Object.prototype,a=B.hasOwnProperty;function W(D){if(!S(D))return X(D);var J=v(D),te=[];for(var ce in D)ce=="constructor"&&(J||!a.call(D,ce))||te.push(ce);return te}Re.exports=W},QkVN:function(Re,y,o){var S=o("+Qka"),v=o("LsHQ"),X=v(function(B,a,W){S(B,a,W)});Re.exports=X},"R/W3":function(Re,y,o){var S=o("KwMD"),v=o("2ajD"),X=o("CZoQ");function B(a,W,D){return W===W?X(a,W,D):S(a,v,D)}Re.exports=B},"RL2/":function(Re,y,o){"use strict";var S="2.3.3"},RMtq:function(Re,y){},"RR/i":function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.typeConstraint=y.namedConstraint=y.taggedConstraint=y.traverseAncerstors=void 0;var S=o("xfSm"),v=o("GXnB"),X=function D(J,te){var ce=J.parentRequest;return ce!==null?te(ce)?!0:D(ce,te):!1};y.traverseAncerstors=X;var B=function(J){return function(te){var ce=function(ke){return ke!==null&&ke.target!==null&&ke.target.matchesTag(J)(te)};return ce.metaData=new v.Metadata(J,te),ce}};y.taggedConstraint=B;var a=B(S.NAMED_TAG);y.namedConstraint=a;var W=function(J){return function(te){var ce=null;if(te!==null)if(ce=te.bindings[0],typeof J=="string"){var Y=ce.serviceIdentifier;return Y===J}else{var ke=te.bindings[0].implementationType;return J===ke}return!1}};y.typeConstraint=W},Sk89:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.postConstruct=void 0;var S=o("MON2"),v=o("xfSm"),X=o("GXnB");function B(){return function(a,W,D){var J=new X.Metadata(v.POST_CONSTRUCT,W);if(Reflect.hasOwnMetadata(v.POST_CONSTRUCT,a.constructor))throw new Error(S.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(v.POST_CONSTRUCT,J,a.constructor)}}y.postConstruct=B},Sq3C:function(Re,y,o){var S=o("sKgW"),v=o("zoYe"),X=o("wy8a"),B=o("quyA"),a=o("Z1HP"),W=o("Em2t"),D=Math.ceil;function J(te,ce){ce=ce===void 0?" ":v(ce);var Y=ce.length;if(Y<2)return Y?S(ce,te):ce;var ke=S(ce,D(te/a(ce)));return B(ce)?X(W(ke),0,te).join(""):ke.slice(0,te)}Re.exports=J},Sxd8:function(Re,y,o){var S=o("ZCgT");function v(X){var B=S(X),a=B%1;return B===B?a?B-a:B:0}Re.exports=v},T1AV:function(Re,y,o){var S=o("t2Dn"),v=o("5Tg0"),X=o("yP5f"),B=o("Q1l4"),a=o("+iFO"),W=o("03A+"),D=o("Z0cm"),J=o("3L66"),te=o("DSRE"),ce=o("lSCD"),Y=o("GoyQ"),ke=o("YO3V"),Ke=o("c6wG"),We=o("itsj"),Oe=o("jeLo");function st(Le,xt,it,$e,Ze,St,bt){var Ne=We(Le,it),ze=We(xt,it),Ue=bt.get(ze);if(Ue){S(Le,it,Ue);return}var lt=St?St(Ne,ze,it+"",Le,xt,bt):void 0,Me=lt===void 0;if(Me){var ct=D(ze),Gt=!ct&&te(ze),$t=!ct&&!Gt&&Ke(ze);lt=ze,ct||Gt||$t?D(Ne)?lt=Ne:J(Ne)?lt=B(Ne):Gt?(Me=!1,lt=v(ze,!0)):$t?(Me=!1,lt=X(ze,!0)):lt=[]:ke(ze)||W(ze)?(lt=Ne,W(Ne)?lt=Oe(Ne):(!Y(Ne)||ce(Ne))&&(lt=a(ze))):Me=!1}Me&&(bt.set(ze,lt),Ze(lt,ze,$e,St,bt),bt.delete(ze)),S(Le,it,lt)}Re.exports=st},TKrE:function(Re,y,o){var S=o("qRkn"),v=o("dt0z"),X=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,B="\\u0300-\\u036f",a="\\ufe20-\\ufe2f",W="\\u20d0-\\u20ff",D=B+a+W,J="["+D+"]",te=RegExp(J,"g");function ce(Y){return Y=v(Y),Y&&Y.replace(X,S).replace(te,"")}Re.exports=ce},"U+yc":function(Re,y){function o(S,v,X,B,a){var W={};return Object.keys(B).forEach(function(D){W[D]=B[D]}),W.enumerable=!!W.enumerable,W.configurable=!!W.configurable,("value"in W||W.initializer)&&(W.writable=!0),W=X.slice().reverse().reduce(function(D,J){return J(S,v,D)||D},W),a&&W.initializer!==void 0&&(W.value=W.initializer?W.initializer.call(a):void 0,W.initializer=void 0),W.initializer===void 0&&(Object.defineProperty(S,v,W),W=null),W}Re.exports=o},U1ZX:function(Re,y){},UB5X:function(Re,y,o){var S=o("NykK"),v=o("ExA7"),X="[object Number]";function B(a){return typeof a=="number"||v(a)&&S(a)==X}Re.exports=B},Ucsi:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var S=Symbol.for("INJECTION");function v(D,J,te,ce){function Y(){return ce&&!Reflect.hasMetadata(S,this,J)&&Reflect.defineMetadata(S,te(),this,J),Reflect.hasMetadata(S,this,J)?Reflect.getMetadata(S,this,J):te()}function ke(Ke){Reflect.defineMetadata(S,Ke,this,J)}Object.defineProperty(D,J,{configurable:!0,enumerable:!0,get:Y,set:ke})}function X(D,J){return function(te){return function(ce,Y){var ke=function(){return D.get(te)};v(ce,Y,ke,J)}}}y.makePropertyInjectDecorator=X;function B(D,J){return function(te,ce){return function(Y,ke){var Ke=function(){return D.getNamed(te,ce)};v(Y,ke,Ke,J)}}}y.makePropertyInjectNamedDecorator=B;function a(D,J){return function(te,ce,Y){return function(ke,Ke){var We=function(){return D.getTagged(te,ce,Y)};v(ke,Ke,We,J)}}}y.makePropertyInjectTaggedDecorator=a;function W(D,J){return function(te){return function(ce,Y){var ke=function(){return D.getAll(te)};v(ce,Y,ke,J)}}}y.makePropertyMultiInjectDecorator=W},V1cb:function(Re,y,o){"use strict";o.d(y,"a",function(){return S});var S;(function(v){v.Hover="hover",v.Click="click",v.Select="select",v.Active="active",v.Drag="drag"})(S||(S={}))},VIsB:function(Re,y,o){"use strict";o.d(y,"a",function(){return W});var S=o("Hel2");function v(ke,Ke){var We;if(typeof Symbol=="undefined"||ke[Symbol.iterator]==null){if(Array.isArray(ke)||(We=X(ke))||Ke&&ke&&typeof ke.length=="number"){We&&(ke=We);var Oe=0,st=function(){};return{s:st,n:function(){return Oe>=ke.length?{done:!0}:{done:!1,value:ke[Oe++]}},e:function(Ze){throw Ze},f:st}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Le=!0,xt=!1,it;return{s:function(){We=ke[Symbol.iterator]()},n:function(){var Ze=We.next();return Le=Ze.done,Ze},e:function(Ze){xt=!0,it=Ze},f:function(){try{!Le&&We.return!=null&&We.return()}finally{if(xt)throw it}}}}function X(ke,Ke){if(!!ke){if(typeof ke=="string")return B(ke,Ke);var We=Object.prototype.toString.call(ke).slice(8,-1);if(We==="Object"&&ke.constructor&&(We=ke.constructor.name),We==="Map"||We==="Set")return Array.from(ke);if(We==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(We))return B(ke,Ke)}}function B(ke,Ke){(Ke==null||Ke>ke.length)&&(Ke=ke.length);for(var We=0,Oe=new Array(Ke);We<Ke;We++)Oe[We]=ke[We];return Oe}var a=6378e3;function W(ke,Ke){var We=ke.dataArray,Oe=Ke.size,st=Oe===void 0?10:Oe,Le=st/(2*Math.PI*a)*(256<<20)/2,xt=D(We,st),it=xt.gridHash,$e=xt.gridOffset,Ze=Y(it,$e,Ke);return{yOffset:Le,xOffset:Le,radius:Le,type:"grid",dataArray:Ze}}function D(ke,Ke){var We=Infinity,Oe=-Infinity,st,Le=v(ke),xt;try{for(Le.s();!(xt=Le.n()).done;){var it=xt.value;st=it.coordinates[1],Number.isFinite(st)&&(We=st<We?st:We,Oe=st>Oe?st:Oe)}}catch($t){Le.e($t)}finally{Le.f()}var $e=(We+Oe)/2,Ze=J(Ke,$e);if(Ze.xOffset<=0||Ze.yOffset<=0)return{gridHash:{},gridOffset:Ze};var St={},bt=v(ke),Ne;try{for(bt.s();!(Ne=bt.n()).done;){var ze=Ne.value,Ue=ze.coordinates[1],lt=ze.coordinates[0];if(Number.isFinite(Ue)&&Number.isFinite(lt)){var Me=Math.floor((Ue+90)/Ze.yOffset),ct=Math.floor((lt+180)/Ze.xOffset),Gt="".concat(Me,"-").concat(ct);St[Gt]=St[Gt]||{count:0,points:[]},St[Gt].count+=1,St[Gt].points.push(ze)}}}catch($t){bt.e($t)}finally{bt.f()}return{gridHash:St,gridOffset:Ze}}function J(ke,Ke){var We=te(ke),Oe=ce(Ke,ke);return{yOffset:We,xOffset:Oe}}function te(ke){return ke/a*(180/Math.PI)}function ce(ke,Ke){return Ke/a*(180/Math.PI)/Math.cos(ke*Math.PI/180)}function Y(ke,Ke,We){return Object.keys(ke).reduce(function(Oe,st,Le){var xt=st.split("-"),it=parseInt(xt[0],10),$e=parseInt(xt[1],10),Ze={};if(We.field&&We.method){var St=S.c.getColumn(ke[st].points,We.field);Ze[We.method]=S.c.statMap[We.method](St)}return Object.assign(Ze,{_id:Le,coordinates:Object(S.d)([-180+Ke.xOffset*($e+.5),-90+Ke.yOffset*(it+.5)]),rawData:ke[st].points,count:ke[st].count}),Oe.push(Ze),Oe},[])}},VOtZ:function(Re,y,o){var S=o("juv8"),v=o("MvSz");function X(B,a){return S(B,v(B),a)}Re.exports=X},VmRL:function(Re,y,o){"use strict";Re.exports=S,Re.exports.default=S;function S(oe,Q,G){G=G||2;var Ce=Q&&Q.length,be=Ce?Q[0]*G:oe.length,Te=v(oe,0,be,G,!0),me=[];if(!Te||Te.next===Te.prev)return me;var rt,Kt,_t,ge,ye,Ve,ft;if(Ce&&(Te=te(oe,Q,Te,G)),oe.length>80*G){rt=_t=oe[0],Kt=ge=oe[1];for(var Ie=G;Ie<be;Ie+=G)ye=oe[Ie],Ve=oe[Ie+1],ye<rt&&(rt=ye),Ve<Kt&&(Kt=Ve),ye>_t&&(_t=ye),Ve>ge&&(ge=Ve);ft=Math.max(_t-rt,ge-Kt),ft=ft!==0?1/ft:0}return B(Te,me,G,rt,Kt,ft),me}function v(oe,Q,G,Ce,be){var Te,me;if(be===ar(oe,Q,G,Ce)>0)for(Te=Q;Te<G;Te+=Ce)me=ct(Te,oe[Te],oe[Te+1],me);else for(Te=G-Ce;Te>=Q;Te-=Ce)me=ct(Te,oe[Te],oe[Te+1],me);return me&&Ze(me,me.next)&&(Gt(me),me=me.next),me}function X(oe,Q){if(!oe)return oe;Q||(Q=oe);var G=oe,Ce;do if(Ce=!1,!G.steiner&&(Ze(G,G.next)||$e(G.prev,G,G.next)===0)){if(Gt(G),G=Q=G.prev,G===G.next)break;Ce=!0}else G=G.next;while(Ce||G!==Q);return Q}function B(oe,Q,G,Ce,be,Te,me){if(!!oe){!me&&Te&&We(oe,Ce,be,Te);for(var rt=oe,Kt,_t;oe.prev!==oe.next;){if(Kt=oe.prev,_t=oe.next,Te?W(oe,Ce,be,Te):a(oe)){Q.push(Kt.i/G),Q.push(oe.i/G),Q.push(_t.i/G),Gt(oe),oe=_t.next,rt=_t.next;continue}if(oe=_t,oe===rt){me?me===1?(oe=D(X(oe),Q,G),B(oe,Q,G,Ce,be,Te,2)):me===2&&J(oe,Q,G,Ce,be,Te):B(X(oe),Q,G,Ce,be,Te,1);break}}}}function a(oe){var Q=oe.prev,G=oe,Ce=oe.next;if($e(Q,G,Ce)>=0)return!1;for(var be=oe.next.next;be!==oe.prev;){if(xt(Q.x,Q.y,G.x,G.y,Ce.x,Ce.y,be.x,be.y)&&$e(be.prev,be,be.next)>=0)return!1;be=be.next}return!0}function W(oe,Q,G,Ce){var be=oe.prev,Te=oe,me=oe.next;if($e(be,Te,me)>=0)return!1;for(var rt=be.x<Te.x?be.x<me.x?be.x:me.x:Te.x<me.x?Te.x:me.x,Kt=be.y<Te.y?be.y<me.y?be.y:me.y:Te.y<me.y?Te.y:me.y,_t=be.x>Te.x?be.x>me.x?be.x:me.x:Te.x>me.x?Te.x:me.x,ge=be.y>Te.y?be.y>me.y?be.y:me.y:Te.y>me.y?Te.y:me.y,ye=st(rt,Kt,Q,G,Ce),Ve=st(_t,ge,Q,G,Ce),ft=oe.prevZ,Ie=oe.nextZ;ft&&ft.z>=ye&&Ie&&Ie.z<=Ve;){if(ft!==oe.prev&&ft!==oe.next&&xt(be.x,be.y,Te.x,Te.y,me.x,me.y,ft.x,ft.y)&&$e(ft.prev,ft,ft.next)>=0||(ft=ft.prevZ,Ie!==oe.prev&&Ie!==oe.next&&xt(be.x,be.y,Te.x,Te.y,me.x,me.y,Ie.x,Ie.y)&&$e(Ie.prev,Ie,Ie.next)>=0))return!1;Ie=Ie.nextZ}for(;ft&&ft.z>=ye;){if(ft!==oe.prev&&ft!==oe.next&&xt(be.x,be.y,Te.x,Te.y,me.x,me.y,ft.x,ft.y)&&$e(ft.prev,ft,ft.next)>=0)return!1;ft=ft.prevZ}for(;Ie&&Ie.z<=Ve;){if(Ie!==oe.prev&&Ie!==oe.next&&xt(be.x,be.y,Te.x,Te.y,me.x,me.y,Ie.x,Ie.y)&&$e(Ie.prev,Ie,Ie.next)>=0)return!1;Ie=Ie.nextZ}return!0}function D(oe,Q,G){var Ce=oe;do{var be=Ce.prev,Te=Ce.next.next;!Ze(be,Te)&&St(be,Ce,Ce.next,Te)&&Ue(be,Te)&&Ue(Te,be)&&(Q.push(be.i/G),Q.push(Ce.i/G),Q.push(Te.i/G),Gt(Ce),Gt(Ce.next),Ce=oe=Te),Ce=Ce.next}while(Ce!==oe);return X(Ce)}function J(oe,Q,G,Ce,be,Te){var me=oe;do{for(var rt=me.next.next;rt!==me.prev;){if(me.i!==rt.i&&it(me,rt)){var Kt=Me(me,rt);me=X(me,me.next),Kt=X(Kt,Kt.next),B(me,Q,G,Ce,be,Te),B(Kt,Q,G,Ce,be,Te);return}rt=rt.next}me=me.next}while(me!==oe)}function te(oe,Q,G,Ce){var be=[],Te,me,rt,Kt,_t;for(Te=0,me=Q.length;Te<me;Te++)rt=Q[Te]*Ce,Kt=Te<me-1?Q[Te+1]*Ce:oe.length,_t=v(oe,rt,Kt,Ce,!1),_t===_t.next&&(_t.steiner=!0),be.push(Le(_t));for(be.sort(ce),Te=0;Te<be.length;Te++)Y(be[Te],G),G=X(G,G.next);return G}function ce(oe,Q){return oe.x-Q.x}function Y(oe,Q){if(Q=ke(oe,Q),Q){var G=Me(Q,oe);X(Q,Q.next),X(G,G.next)}}function ke(oe,Q){var G=Q,Ce=oe.x,be=oe.y,Te=-Infinity,me;do{if(be<=G.y&&be>=G.next.y&&G.next.y!==G.y){var rt=G.x+(be-G.y)*(G.next.x-G.x)/(G.next.y-G.y);if(rt<=Ce&&rt>Te){if(Te=rt,rt===Ce){if(be===G.y)return G;if(be===G.next.y)return G.next}me=G.x<G.next.x?G:G.next}}G=G.next}while(G!==Q);if(!me)return null;if(Ce===Te)return me;var Kt=me,_t=me.x,ge=me.y,ye=Infinity,Ve;G=me;do Ce>=G.x&&G.x>=_t&&Ce!==G.x&&xt(be<ge?Ce:Te,be,_t,ge,be<ge?Te:Ce,be,G.x,G.y)&&(Ve=Math.abs(be-G.y)/(Ce-G.x),Ue(G,oe)&&(Ve<ye||Ve===ye&&(G.x>me.x||G.x===me.x&&Ke(me,G)))&&(me=G,ye=Ve)),G=G.next;while(G!==Kt);return me}function Ke(oe,Q){return $e(oe.prev,oe,Q.prev)<0&&$e(Q.next,oe,oe.next)<0}function We(oe,Q,G,Ce){var be=oe;do be.z===null&&(be.z=st(be.x,be.y,Q,G,Ce)),be.prevZ=be.prev,be.nextZ=be.next,be=be.next;while(be!==oe);be.prevZ.nextZ=null,be.prevZ=null,Oe(be)}function Oe(oe){var Q,G,Ce,be,Te,me,rt,Kt,_t=1;do{for(G=oe,oe=null,Te=null,me=0;G;){for(me++,Ce=G,rt=0,Q=0;Q<_t&&(rt++,Ce=Ce.nextZ,!!Ce);Q++);for(Kt=_t;rt>0||Kt>0&&Ce;)rt!==0&&(Kt===0||!Ce||G.z<=Ce.z)?(be=G,G=G.nextZ,rt--):(be=Ce,Ce=Ce.nextZ,Kt--),Te?Te.nextZ=be:oe=be,be.prevZ=Te,Te=be;G=Ce}Te.nextZ=null,_t*=2}while(me>1);return oe}function st(oe,Q,G,Ce,be){return oe=32767*(oe-G)*be,Q=32767*(Q-Ce)*be,oe=(oe|oe<<8)&16711935,oe=(oe|oe<<4)&252645135,oe=(oe|oe<<2)&858993459,oe=(oe|oe<<1)&1431655765,Q=(Q|Q<<8)&16711935,Q=(Q|Q<<4)&252645135,Q=(Q|Q<<2)&858993459,Q=(Q|Q<<1)&1431655765,oe|Q<<1}function Le(oe){var Q=oe,G=oe;do(Q.x<G.x||Q.x===G.x&&Q.y<G.y)&&(G=Q),Q=Q.next;while(Q!==oe);return G}function xt(oe,Q,G,Ce,be,Te,me,rt){return(be-me)*(Q-rt)-(oe-me)*(Te-rt)>=0&&(oe-me)*(Ce-rt)-(G-me)*(Q-rt)>=0&&(G-me)*(Te-rt)-(be-me)*(Ce-rt)>=0}function it(oe,Q){return oe.next.i!==Q.i&&oe.prev.i!==Q.i&&!ze(oe,Q)&&(Ue(oe,Q)&&Ue(Q,oe)&&lt(oe,Q)&&($e(oe.prev,oe,Q.prev)||$e(oe,Q.prev,Q))||Ze(oe,Q)&&$e(oe.prev,oe,oe.next)>0&&$e(Q.prev,Q,Q.next)>0)}function $e(oe,Q,G){return(Q.y-oe.y)*(G.x-Q.x)-(Q.x-oe.x)*(G.y-Q.y)}function Ze(oe,Q){return oe.x===Q.x&&oe.y===Q.y}function St(oe,Q,G,Ce){var be=Ne($e(oe,Q,G)),Te=Ne($e(oe,Q,Ce)),me=Ne($e(G,Ce,oe)),rt=Ne($e(G,Ce,Q));return!!(be!==Te&&me!==rt||be===0&&bt(oe,G,Q)||Te===0&&bt(oe,Ce,Q)||me===0&&bt(G,oe,Ce)||rt===0&&bt(G,Q,Ce))}function bt(oe,Q,G){return Q.x<=Math.max(oe.x,G.x)&&Q.x>=Math.min(oe.x,G.x)&&Q.y<=Math.max(oe.y,G.y)&&Q.y>=Math.min(oe.y,G.y)}function Ne(oe){return oe>0?1:oe<0?-1:0}function ze(oe,Q){var G=oe;do{if(G.i!==oe.i&&G.next.i!==oe.i&&G.i!==Q.i&&G.next.i!==Q.i&&St(G,G.next,oe,Q))return!0;G=G.next}while(G!==oe);return!1}function Ue(oe,Q){return $e(oe.prev,oe,oe.next)<0?$e(oe,Q,oe.next)>=0&&$e(oe,oe.prev,Q)>=0:$e(oe,Q,oe.prev)<0||$e(oe,oe.next,Q)<0}function lt(oe,Q){var G=oe,Ce=!1,be=(oe.x+Q.x)/2,Te=(oe.y+Q.y)/2;do G.y>Te!=G.next.y>Te&&G.next.y!==G.y&&be<(G.next.x-G.x)*(Te-G.y)/(G.next.y-G.y)+G.x&&(Ce=!Ce),G=G.next;while(G!==oe);return Ce}function Me(oe,Q){var G=new $t(oe.i,oe.x,oe.y),Ce=new $t(Q.i,Q.x,Q.y),be=oe.next,Te=Q.prev;return oe.next=Q,Q.prev=oe,G.next=be,be.prev=G,Ce.next=G,G.prev=Ce,Te.next=Ce,Ce.prev=Te,Ce}function ct(oe,Q,G,Ce){var be=new $t(oe,Q,G);return Ce?(be.next=Ce.next,be.prev=Ce,Ce.next.prev=be,Ce.next=be):(be.prev=be,be.next=be),be}function Gt(oe){oe.next.prev=oe.prev,oe.prev.next=oe.next,oe.prevZ&&(oe.prevZ.nextZ=oe.nextZ),oe.nextZ&&(oe.nextZ.prevZ=oe.prevZ)}function $t(oe,Q,G){this.i=oe,this.x=Q,this.y=G,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}S.deviation=function(oe,Q,G,Ce){var be=Q&&Q.length,Te=be?Q[0]*G:oe.length,me=Math.abs(ar(oe,0,Te,G));if(be)for(var rt=0,Kt=Q.length;rt<Kt;rt++){var _t=Q[rt]*G,ge=rt<Kt-1?Q[rt+1]*G:oe.length;me-=Math.abs(ar(oe,_t,ge,G))}var ye=0;for(rt=0;rt<Ce.length;rt+=3){var Ve=Ce[rt]*G,ft=Ce[rt+1]*G,Ie=Ce[rt+2]*G;ye+=Math.abs((oe[Ve]-oe[Ie])*(oe[ft+1]-oe[Ve+1])-(oe[Ve]-oe[ft])*(oe[Ie+1]-oe[Ve+1]))}return me===0&&ye===0?0:Math.abs((ye-me)/me)};function ar(oe,Q,G,Ce){for(var be=0,Te=Q,me=G-Ce;Te<G;Te+=Ce)be+=(oe[me]-oe[Te])*(oe[Te+1]+oe[me+1]),me=Te;return be}S.flatten=function(oe){for(var Q=oe[0][0].length,G={vertices:[],holes:[],dimensions:Q},Ce=0,be=0;be<oe.length;be++){for(var Te=0;Te<oe[be].length;Te++)for(var me=0;me<Q;me++)G.vertices.push(oe[be][Te][me]);be>0&&(Ce+=oe[be-1].length,G.holes.push(Ce))}return G}},WFAs:function(Re,y){var o=Array.isArray;Re.exports=o},Wnft:function(Re,y,o){Re.exports={mapChart:"antd-pro-pages-dashboard-monitor-style-mapChart",pieCard:"antd-pro-pages-dashboard-monitor-style-pieCard"}},WwFo:function(Re,y,o){var S=o("juv8"),v=o("7GkX");function X(B,a){return B&&S(a,v(a),B)}Re.exports=X},XYm9:function(Re,y,o){var S=o("+K+b");function v(X,B){var a=B?S(X.buffer):X.buffer;return new X.constructor(a,X.byteOffset,X.byteLength)}Re.exports=v},"Xt/L":function(Re,y){function o(S,v,X){for(var B=-1,a=S==null?0:S.length;++B<a;)if(X(v,S[B]))return!0;return!1}Re.exports=o},Y8BV:function(Re,y,o){"use strict";o.d(y,"a",function(){return S});function S(v,X){var B=X.callback;return B&&(v.dataArray=v.dataArray.filter(B)),v}},YO3V:function(Re,y,o){var S=o("NykK"),v=o("LcsW"),X=o("ExA7"),B="[object Object]",a=Function.prototype,W=Object.prototype,D=a.toString,J=W.hasOwnProperty,te=D.call(Object);function ce(Y){if(!X(Y)||S(Y)!=B)return!1;var ke=v(Y);if(ke===null)return!0;var Ke=J.call(ke,"constructor")&&ke.constructor;return typeof Ke=="function"&&Ke instanceof Ke&&D.call(Ke)==te}Re.exports=ce},Yk9n:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.inject=y.LazyServiceIdentifer=void 0;var S=o("MON2"),v=o("xfSm"),X=o("GXnB"),B=o("Ztfv"),a=function(){function D(J){this._cb=J}return D.prototype.unwrap=function(){return this._cb()},D}();y.LazyServiceIdentifer=a;function W(D){return function(J,te,ce){if(D===void 0)throw new Error(S.UNDEFINED_INJECT_ANNOTATION(J.name));var Y=new X.Metadata(v.INJECT_TAG,D);typeof ce=="number"?B.tagParameter(J,te,ce,Y):B.tagProperty(J,te,Y)}}y.inject=W},Z1HP:function(Re,y,o){var S=o("ycre"),v=o("quyA"),X=o("q4HE");function B(a){return v(a)?X(a):S(a)}Re.exports=B},ZCgT:function(Re,y,o){var S=o("tLB3"),v=1/0,X=17976931348623157e292;function B(a){if(!a)return a===0?a:0;if(a=S(a),a===v||a===-v){var W=a<0?-1:1;return W*X}return a===a?a:0}Re.exports=B},ZK94:function(Re,y){Re.exports.RADIUS=6378137,Re.exports.FLATTENING=1/298.257223563,Re.exports.POLAR_RADIUS=63567523142e-4},ZaHm:function(Re,y,o){"use strict";o.r(y),o.d(y,"create",function(){return v}),o.d(y,"clone",function(){return X}),o.d(y,"copy",function(){return B}),o.d(y,"fromValues",function(){return a}),o.d(y,"set",function(){return W}),o.d(y,"identity",function(){return D}),o.d(y,"transpose",function(){return J}),o.d(y,"invert",function(){return te}),o.d(y,"adjoint",function(){return ce}),o.d(y,"determinant",function(){return Y}),o.d(y,"multiply",function(){return ke}),o.d(y,"translate",function(){return Ke}),o.d(y,"scale",function(){return We}),o.d(y,"rotate",function(){return Oe}),o.d(y,"rotateX",function(){return st}),o.d(y,"rotateY",function(){return Le}),o.d(y,"rotateZ",function(){return xt}),o.d(y,"fromTranslation",function(){return it}),o.d(y,"fromScaling",function(){return $e}),o.d(y,"fromRotation",function(){return Ze}),o.d(y,"fromXRotation",function(){return St}),o.d(y,"fromYRotation",function(){return bt}),o.d(y,"fromZRotation",function(){return Ne}),o.d(y,"fromRotationTranslation",function(){return ze}),o.d(y,"fromQuat2",function(){return Ue}),o.d(y,"getTranslation",function(){return lt}),o.d(y,"getScaling",function(){return Me}),o.d(y,"getRotation",function(){return ct}),o.d(y,"fromRotationTranslationScale",function(){return Gt}),o.d(y,"fromRotationTranslationScaleOrigin",function(){return $t}),o.d(y,"fromQuat",function(){return ar}),o.d(y,"frustum",function(){return oe}),o.d(y,"perspective",function(){return Q}),o.d(y,"perspectiveFromFieldOfView",function(){return G}),o.d(y,"ortho",function(){return Ce}),o.d(y,"lookAt",function(){return be}),o.d(y,"targetTo",function(){return Te}),o.d(y,"str",function(){return me}),o.d(y,"frob",function(){return rt}),o.d(y,"add",function(){return Kt}),o.d(y,"subtract",function(){return _t}),o.d(y,"multiplyScalar",function(){return ge}),o.d(y,"multiplyScalarAndAdd",function(){return ye}),o.d(y,"exactEquals",function(){return Ve}),o.d(y,"equals",function(){return ft}),o.d(y,"mul",function(){return Ie}),o.d(y,"sub",function(){return pt});var S=o("yU0y");function v(){var C=new S.a(16);return S.a!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0),C[0]=1,C[5]=1,C[10]=1,C[15]=1,C}function X(C){var R=new S.a(16);return R[0]=C[0],R[1]=C[1],R[2]=C[2],R[3]=C[3],R[4]=C[4],R[5]=C[5],R[6]=C[6],R[7]=C[7],R[8]=C[8],R[9]=C[9],R[10]=C[10],R[11]=C[11],R[12]=C[12],R[13]=C[13],R[14]=C[14],R[15]=C[15],R}function B(C,R){return C[0]=R[0],C[1]=R[1],C[2]=R[2],C[3]=R[3],C[4]=R[4],C[5]=R[5],C[6]=R[6],C[7]=R[7],C[8]=R[8],C[9]=R[9],C[10]=R[10],C[11]=R[11],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15],C}function a(C,R,q,fe,Ge,Je,yt,nt,Nt,$,Ye,ie,et,Bt,lr,dt){var vt=new S.a(16);return vt[0]=C,vt[1]=R,vt[2]=q,vt[3]=fe,vt[4]=Ge,vt[5]=Je,vt[6]=yt,vt[7]=nt,vt[8]=Nt,vt[9]=$,vt[10]=Ye,vt[11]=ie,vt[12]=et,vt[13]=Bt,vt[14]=lr,vt[15]=dt,vt}function W(C,R,q,fe,Ge,Je,yt,nt,Nt,$,Ye,ie,et,Bt,lr,dt,vt){return C[0]=R,C[1]=q,C[2]=fe,C[3]=Ge,C[4]=Je,C[5]=yt,C[6]=nt,C[7]=Nt,C[8]=$,C[9]=Ye,C[10]=ie,C[11]=et,C[12]=Bt,C[13]=lr,C[14]=dt,C[15]=vt,C}function D(C){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function J(C,R){if(C===R){var q=R[1],fe=R[2],Ge=R[3],Je=R[6],yt=R[7],nt=R[11];C[1]=R[4],C[2]=R[8],C[3]=R[12],C[4]=q,C[6]=R[9],C[7]=R[13],C[8]=fe,C[9]=Je,C[11]=R[14],C[12]=Ge,C[13]=yt,C[14]=nt}else C[0]=R[0],C[1]=R[4],C[2]=R[8],C[3]=R[12],C[4]=R[1],C[5]=R[5],C[6]=R[9],C[7]=R[13],C[8]=R[2],C[9]=R[6],C[10]=R[10],C[11]=R[14],C[12]=R[3],C[13]=R[7],C[14]=R[11],C[15]=R[15];return C}function te(C,R){var q=R[0],fe=R[1],Ge=R[2],Je=R[3],yt=R[4],nt=R[5],Nt=R[6],$=R[7],Ye=R[8],ie=R[9],et=R[10],Bt=R[11],lr=R[12],dt=R[13],vt=R[14],Ct=R[15],gt=q*nt-fe*yt,we=q*Nt-Ge*yt,ht=q*$-Je*yt,Qe=fe*Nt-Ge*nt,Vt=fe*$-Je*nt,pr=Ge*$-Je*Nt,Zr=Ye*dt-ie*lr,cr=Ye*vt-et*lr,jn=Ye*Ct-Bt*lr,Sn=ie*vt-et*dt,ai=ie*Ct-Bt*dt,fi=et*Ct-Bt*vt,Zn=gt*fi-we*ai+ht*Sn+Qe*jn-Vt*cr+pr*Zr;return Zn?(Zn=1/Zn,C[0]=(nt*fi-Nt*ai+$*Sn)*Zn,C[1]=(Ge*ai-fe*fi-Je*Sn)*Zn,C[2]=(dt*pr-vt*Vt+Ct*Qe)*Zn,C[3]=(et*Vt-ie*pr-Bt*Qe)*Zn,C[4]=(Nt*jn-yt*fi-$*cr)*Zn,C[5]=(q*fi-Ge*jn+Je*cr)*Zn,C[6]=(vt*ht-lr*pr-Ct*we)*Zn,C[7]=(Ye*pr-et*ht+Bt*we)*Zn,C[8]=(yt*ai-nt*jn+$*Zr)*Zn,C[9]=(fe*jn-q*ai-Je*Zr)*Zn,C[10]=(lr*Vt-dt*ht+Ct*gt)*Zn,C[11]=(ie*ht-Ye*Vt-Bt*gt)*Zn,C[12]=(nt*cr-yt*Sn-Nt*Zr)*Zn,C[13]=(q*Sn-fe*cr+Ge*Zr)*Zn,C[14]=(dt*we-lr*Qe-vt*gt)*Zn,C[15]=(Ye*Qe-ie*we+et*gt)*Zn,C):null}function ce(C,R){var q=R[0],fe=R[1],Ge=R[2],Je=R[3],yt=R[4],nt=R[5],Nt=R[6],$=R[7],Ye=R[8],ie=R[9],et=R[10],Bt=R[11],lr=R[12],dt=R[13],vt=R[14],Ct=R[15];return C[0]=nt*(et*Ct-Bt*vt)-ie*(Nt*Ct-$*vt)+dt*(Nt*Bt-$*et),C[1]=-(fe*(et*Ct-Bt*vt)-ie*(Ge*Ct-Je*vt)+dt*(Ge*Bt-Je*et)),C[2]=fe*(Nt*Ct-$*vt)-nt*(Ge*Ct-Je*vt)+dt*(Ge*$-Je*Nt),C[3]=-(fe*(Nt*Bt-$*et)-nt*(Ge*Bt-Je*et)+ie*(Ge*$-Je*Nt)),C[4]=-(yt*(et*Ct-Bt*vt)-Ye*(Nt*Ct-$*vt)+lr*(Nt*Bt-$*et)),C[5]=q*(et*Ct-Bt*vt)-Ye*(Ge*Ct-Je*vt)+lr*(Ge*Bt-Je*et),C[6]=-(q*(Nt*Ct-$*vt)-yt*(Ge*Ct-Je*vt)+lr*(Ge*$-Je*Nt)),C[7]=q*(Nt*Bt-$*et)-yt*(Ge*Bt-Je*et)+Ye*(Ge*$-Je*Nt),C[8]=yt*(ie*Ct-Bt*dt)-Ye*(nt*Ct-$*dt)+lr*(nt*Bt-$*ie),C[9]=-(q*(ie*Ct-Bt*dt)-Ye*(fe*Ct-Je*dt)+lr*(fe*Bt-Je*ie)),C[10]=q*(nt*Ct-$*dt)-yt*(fe*Ct-Je*dt)+lr*(fe*$-Je*nt),C[11]=-(q*(nt*Bt-$*ie)-yt*(fe*Bt-Je*ie)+Ye*(fe*$-Je*nt)),C[12]=-(yt*(ie*vt-et*dt)-Ye*(nt*vt-Nt*dt)+lr*(nt*et-Nt*ie)),C[13]=q*(ie*vt-et*dt)-Ye*(fe*vt-Ge*dt)+lr*(fe*et-Ge*ie),C[14]=-(q*(nt*vt-Nt*dt)-yt*(fe*vt-Ge*dt)+lr*(fe*Nt-Ge*nt)),C[15]=q*(nt*et-Nt*ie)-yt*(fe*et-Ge*ie)+Ye*(fe*Nt-Ge*nt),C}function Y(C){var R=C[0],q=C[1],fe=C[2],Ge=C[3],Je=C[4],yt=C[5],nt=C[6],Nt=C[7],$=C[8],Ye=C[9],ie=C[10],et=C[11],Bt=C[12],lr=C[13],dt=C[14],vt=C[15],Ct=R*yt-q*Je,gt=R*nt-fe*Je,we=R*Nt-Ge*Je,ht=q*nt-fe*yt,Qe=q*Nt-Ge*yt,Vt=fe*Nt-Ge*nt,pr=$*lr-Ye*Bt,Zr=$*dt-ie*Bt,cr=$*vt-et*Bt,jn=Ye*dt-ie*lr,Sn=Ye*vt-et*lr,ai=ie*vt-et*dt;return Ct*ai-gt*Sn+we*jn+ht*cr-Qe*Zr+Vt*pr}function ke(C,R,q){var fe=R[0],Ge=R[1],Je=R[2],yt=R[3],nt=R[4],Nt=R[5],$=R[6],Ye=R[7],ie=R[8],et=R[9],Bt=R[10],lr=R[11],dt=R[12],vt=R[13],Ct=R[14],gt=R[15],we=q[0],ht=q[1],Qe=q[2],Vt=q[3];return C[0]=we*fe+ht*nt+Qe*ie+Vt*dt,C[1]=we*Ge+ht*Nt+Qe*et+Vt*vt,C[2]=we*Je+ht*$+Qe*Bt+Vt*Ct,C[3]=we*yt+ht*Ye+Qe*lr+Vt*gt,we=q[4],ht=q[5],Qe=q[6],Vt=q[7],C[4]=we*fe+ht*nt+Qe*ie+Vt*dt,C[5]=we*Ge+ht*Nt+Qe*et+Vt*vt,C[6]=we*Je+ht*$+Qe*Bt+Vt*Ct,C[7]=we*yt+ht*Ye+Qe*lr+Vt*gt,we=q[8],ht=q[9],Qe=q[10],Vt=q[11],C[8]=we*fe+ht*nt+Qe*ie+Vt*dt,C[9]=we*Ge+ht*Nt+Qe*et+Vt*vt,C[10]=we*Je+ht*$+Qe*Bt+Vt*Ct,C[11]=we*yt+ht*Ye+Qe*lr+Vt*gt,we=q[12],ht=q[13],Qe=q[14],Vt=q[15],C[12]=we*fe+ht*nt+Qe*ie+Vt*dt,C[13]=we*Ge+ht*Nt+Qe*et+Vt*vt,C[14]=we*Je+ht*$+Qe*Bt+Vt*Ct,C[15]=we*yt+ht*Ye+Qe*lr+Vt*gt,C}function Ke(C,R,q){var fe=q[0],Ge=q[1],Je=q[2],yt,nt,Nt,$,Ye,ie,et,Bt,lr,dt,vt,Ct;return R===C?(C[12]=R[0]*fe+R[4]*Ge+R[8]*Je+R[12],C[13]=R[1]*fe+R[5]*Ge+R[9]*Je+R[13],C[14]=R[2]*fe+R[6]*Ge+R[10]*Je+R[14],C[15]=R[3]*fe+R[7]*Ge+R[11]*Je+R[15]):(yt=R[0],nt=R[1],Nt=R[2],$=R[3],Ye=R[4],ie=R[5],et=R[6],Bt=R[7],lr=R[8],dt=R[9],vt=R[10],Ct=R[11],C[0]=yt,C[1]=nt,C[2]=Nt,C[3]=$,C[4]=Ye,C[5]=ie,C[6]=et,C[7]=Bt,C[8]=lr,C[9]=dt,C[10]=vt,C[11]=Ct,C[12]=yt*fe+Ye*Ge+lr*Je+R[12],C[13]=nt*fe+ie*Ge+dt*Je+R[13],C[14]=Nt*fe+et*Ge+vt*Je+R[14],C[15]=$*fe+Bt*Ge+Ct*Je+R[15]),C}function We(C,R,q){var fe=q[0],Ge=q[1],Je=q[2];return C[0]=R[0]*fe,C[1]=R[1]*fe,C[2]=R[2]*fe,C[3]=R[3]*fe,C[4]=R[4]*Ge,C[5]=R[5]*Ge,C[6]=R[6]*Ge,C[7]=R[7]*Ge,C[8]=R[8]*Je,C[9]=R[9]*Je,C[10]=R[10]*Je,C[11]=R[11]*Je,C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15],C}function Oe(C,R,q,fe){var Ge=fe[0],Je=fe[1],yt=fe[2],nt=Math.hypot(Ge,Je,yt),Nt,$,Ye,ie,et,Bt,lr,dt,vt,Ct,gt,we,ht,Qe,Vt,pr,Zr,cr,jn,Sn,ai,fi,Zn,Hn;return nt<S.b?null:(nt=1/nt,Ge*=nt,Je*=nt,yt*=nt,Nt=Math.sin(q),$=Math.cos(q),Ye=1-$,ie=R[0],et=R[1],Bt=R[2],lr=R[3],dt=R[4],vt=R[5],Ct=R[6],gt=R[7],we=R[8],ht=R[9],Qe=R[10],Vt=R[11],pr=Ge*Ge*Ye+$,Zr=Je*Ge*Ye+yt*Nt,cr=yt*Ge*Ye-Je*Nt,jn=Ge*Je*Ye-yt*Nt,Sn=Je*Je*Ye+$,ai=yt*Je*Ye+Ge*Nt,fi=Ge*yt*Ye+Je*Nt,Zn=Je*yt*Ye-Ge*Nt,Hn=yt*yt*Ye+$,C[0]=ie*pr+dt*Zr+we*cr,C[1]=et*pr+vt*Zr+ht*cr,C[2]=Bt*pr+Ct*Zr+Qe*cr,C[3]=lr*pr+gt*Zr+Vt*cr,C[4]=ie*jn+dt*Sn+we*ai,C[5]=et*jn+vt*Sn+ht*ai,C[6]=Bt*jn+Ct*Sn+Qe*ai,C[7]=lr*jn+gt*Sn+Vt*ai,C[8]=ie*fi+dt*Zn+we*Hn,C[9]=et*fi+vt*Zn+ht*Hn,C[10]=Bt*fi+Ct*Zn+Qe*Hn,C[11]=lr*fi+gt*Zn+Vt*Hn,R!==C&&(C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C)}function st(C,R,q){var fe=Math.sin(q),Ge=Math.cos(q),Je=R[4],yt=R[5],nt=R[6],Nt=R[7],$=R[8],Ye=R[9],ie=R[10],et=R[11];return R!==C&&(C[0]=R[0],C[1]=R[1],C[2]=R[2],C[3]=R[3],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[4]=Je*Ge+$*fe,C[5]=yt*Ge+Ye*fe,C[6]=nt*Ge+ie*fe,C[7]=Nt*Ge+et*fe,C[8]=$*Ge-Je*fe,C[9]=Ye*Ge-yt*fe,C[10]=ie*Ge-nt*fe,C[11]=et*Ge-Nt*fe,C}function Le(C,R,q){var fe=Math.sin(q),Ge=Math.cos(q),Je=R[0],yt=R[1],nt=R[2],Nt=R[3],$=R[8],Ye=R[9],ie=R[10],et=R[11];return R!==C&&(C[4]=R[4],C[5]=R[5],C[6]=R[6],C[7]=R[7],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[0]=Je*Ge-$*fe,C[1]=yt*Ge-Ye*fe,C[2]=nt*Ge-ie*fe,C[3]=Nt*Ge-et*fe,C[8]=Je*fe+$*Ge,C[9]=yt*fe+Ye*Ge,C[10]=nt*fe+ie*Ge,C[11]=Nt*fe+et*Ge,C}function xt(C,R,q){var fe=Math.sin(q),Ge=Math.cos(q),Je=R[0],yt=R[1],nt=R[2],Nt=R[3],$=R[4],Ye=R[5],ie=R[6],et=R[7];return R!==C&&(C[8]=R[8],C[9]=R[9],C[10]=R[10],C[11]=R[11],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[0]=Je*Ge+$*fe,C[1]=yt*Ge+Ye*fe,C[2]=nt*Ge+ie*fe,C[3]=Nt*Ge+et*fe,C[4]=$*Ge-Je*fe,C[5]=Ye*Ge-yt*fe,C[6]=ie*Ge-nt*fe,C[7]=et*Ge-Nt*fe,C}function it(C,R){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=R[0],C[13]=R[1],C[14]=R[2],C[15]=1,C}function $e(C,R){return C[0]=R[0],C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=R[1],C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=R[2],C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Ze(C,R,q){var fe=q[0],Ge=q[1],Je=q[2],yt=Math.hypot(fe,Ge,Je),nt,Nt,$;return yt<S.b?null:(yt=1/yt,fe*=yt,Ge*=yt,Je*=yt,nt=Math.sin(R),Nt=Math.cos(R),$=1-Nt,C[0]=fe*fe*$+Nt,C[1]=Ge*fe*$+Je*nt,C[2]=Je*fe*$-Ge*nt,C[3]=0,C[4]=fe*Ge*$-Je*nt,C[5]=Ge*Ge*$+Nt,C[6]=Je*Ge*$+fe*nt,C[7]=0,C[8]=fe*Je*$+Ge*nt,C[9]=Ge*Je*$-fe*nt,C[10]=Je*Je*$+Nt,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C)}function St(C,R){var q=Math.sin(R),fe=Math.cos(R);return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=fe,C[6]=q,C[7]=0,C[8]=0,C[9]=-q,C[10]=fe,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function bt(C,R){var q=Math.sin(R),fe=Math.cos(R);return C[0]=fe,C[1]=0,C[2]=-q,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=q,C[9]=0,C[10]=fe,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Ne(C,R){var q=Math.sin(R),fe=Math.cos(R);return C[0]=fe,C[1]=q,C[2]=0,C[3]=0,C[4]=-q,C[5]=fe,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function ze(C,R,q){var fe=R[0],Ge=R[1],Je=R[2],yt=R[3],nt=fe+fe,Nt=Ge+Ge,$=Je+Je,Ye=fe*nt,ie=fe*Nt,et=fe*$,Bt=Ge*Nt,lr=Ge*$,dt=Je*$,vt=yt*nt,Ct=yt*Nt,gt=yt*$;return C[0]=1-(Bt+dt),C[1]=ie+gt,C[2]=et-Ct,C[3]=0,C[4]=ie-gt,C[5]=1-(Ye+dt),C[6]=lr+vt,C[7]=0,C[8]=et+Ct,C[9]=lr-vt,C[10]=1-(Ye+Bt),C[11]=0,C[12]=q[0],C[13]=q[1],C[14]=q[2],C[15]=1,C}function Ue(C,R){var q=new S.a(3),fe=-R[0],Ge=-R[1],Je=-R[2],yt=R[3],nt=R[4],Nt=R[5],$=R[6],Ye=R[7],ie=fe*fe+Ge*Ge+Je*Je+yt*yt;return ie>0?(q[0]=(nt*yt+Ye*fe+Nt*Je-$*Ge)*2/ie,q[1]=(Nt*yt+Ye*Ge+$*fe-nt*Je)*2/ie,q[2]=($*yt+Ye*Je+nt*Ge-Nt*fe)*2/ie):(q[0]=(nt*yt+Ye*fe+Nt*Je-$*Ge)*2,q[1]=(Nt*yt+Ye*Ge+$*fe-nt*Je)*2,q[2]=($*yt+Ye*Je+nt*Ge-Nt*fe)*2),ze(C,R,q),C}function lt(C,R){return C[0]=R[12],C[1]=R[13],C[2]=R[14],C}function Me(C,R){var q=R[0],fe=R[1],Ge=R[2],Je=R[4],yt=R[5],nt=R[6],Nt=R[8],$=R[9],Ye=R[10];return C[0]=Math.hypot(q,fe,Ge),C[1]=Math.hypot(Je,yt,nt),C[2]=Math.hypot(Nt,$,Ye),C}function ct(C,R){var q=new S.a(3);Me(q,R);var fe=1/q[0],Ge=1/q[1],Je=1/q[2],yt=R[0]*fe,nt=R[1]*Ge,Nt=R[2]*Je,$=R[4]*fe,Ye=R[5]*Ge,ie=R[6]*Je,et=R[8]*fe,Bt=R[9]*Ge,lr=R[10]*Je,dt=yt+Ye+lr,vt=0;return dt>0?(vt=Math.sqrt(dt+1)*2,C[3]=.25*vt,C[0]=(ie-Bt)/vt,C[1]=(et-Nt)/vt,C[2]=(nt-$)/vt):yt>Ye&&yt>lr?(vt=Math.sqrt(1+yt-Ye-lr)*2,C[3]=(ie-Bt)/vt,C[0]=.25*vt,C[1]=(nt+$)/vt,C[2]=(et+Nt)/vt):Ye>lr?(vt=Math.sqrt(1+Ye-yt-lr)*2,C[3]=(et-Nt)/vt,C[0]=(nt+$)/vt,C[1]=.25*vt,C[2]=(ie+Bt)/vt):(vt=Math.sqrt(1+lr-yt-Ye)*2,C[3]=(nt-$)/vt,C[0]=(et+Nt)/vt,C[1]=(ie+Bt)/vt,C[2]=.25*vt),C}function Gt(C,R,q,fe){var Ge=R[0],Je=R[1],yt=R[2],nt=R[3],Nt=Ge+Ge,$=Je+Je,Ye=yt+yt,ie=Ge*Nt,et=Ge*$,Bt=Ge*Ye,lr=Je*$,dt=Je*Ye,vt=yt*Ye,Ct=nt*Nt,gt=nt*$,we=nt*Ye,ht=fe[0],Qe=fe[1],Vt=fe[2];return C[0]=(1-(lr+vt))*ht,C[1]=(et+we)*ht,C[2]=(Bt-gt)*ht,C[3]=0,C[4]=(et-we)*Qe,C[5]=(1-(ie+vt))*Qe,C[6]=(dt+Ct)*Qe,C[7]=0,C[8]=(Bt+gt)*Vt,C[9]=(dt-Ct)*Vt,C[10]=(1-(ie+lr))*Vt,C[11]=0,C[12]=q[0],C[13]=q[1],C[14]=q[2],C[15]=1,C}function $t(C,R,q,fe,Ge){var Je=R[0],yt=R[1],nt=R[2],Nt=R[3],$=Je+Je,Ye=yt+yt,ie=nt+nt,et=Je*$,Bt=Je*Ye,lr=Je*ie,dt=yt*Ye,vt=yt*ie,Ct=nt*ie,gt=Nt*$,we=Nt*Ye,ht=Nt*ie,Qe=fe[0],Vt=fe[1],pr=fe[2],Zr=Ge[0],cr=Ge[1],jn=Ge[2],Sn=(1-(dt+Ct))*Qe,ai=(Bt+ht)*Qe,fi=(lr-we)*Qe,Zn=(Bt-ht)*Vt,Hn=(1-(et+Ct))*Vt,k=(vt+gt)*Vt,H=(lr+we)*pr,le=(vt-gt)*pr,de=(1-(et+dt))*pr;return C[0]=Sn,C[1]=ai,C[2]=fi,C[3]=0,C[4]=Zn,C[5]=Hn,C[6]=k,C[7]=0,C[8]=H,C[9]=le,C[10]=de,C[11]=0,C[12]=q[0]+Zr-(Sn*Zr+Zn*cr+H*jn),C[13]=q[1]+cr-(ai*Zr+Hn*cr+le*jn),C[14]=q[2]+jn-(fi*Zr+k*cr+de*jn),C[15]=1,C}function ar(C,R){var q=R[0],fe=R[1],Ge=R[2],Je=R[3],yt=q+q,nt=fe+fe,Nt=Ge+Ge,$=q*yt,Ye=fe*yt,ie=fe*nt,et=Ge*yt,Bt=Ge*nt,lr=Ge*Nt,dt=Je*yt,vt=Je*nt,Ct=Je*Nt;return C[0]=1-ie-lr,C[1]=Ye+Ct,C[2]=et-vt,C[3]=0,C[4]=Ye-Ct,C[5]=1-$-lr,C[6]=Bt+dt,C[7]=0,C[8]=et+vt,C[9]=Bt-dt,C[10]=1-$-ie,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function oe(C,R,q,fe,Ge,Je,yt){var nt=1/(q-R),Nt=1/(Ge-fe),$=1/(Je-yt);return C[0]=Je*2*nt,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Je*2*Nt,C[6]=0,C[7]=0,C[8]=(q+R)*nt,C[9]=(Ge+fe)*Nt,C[10]=(yt+Je)*$,C[11]=-1,C[12]=0,C[13]=0,C[14]=yt*Je*2*$,C[15]=0,C}function Q(C,R,q,fe,Ge){var Je=1/Math.tan(R/2),yt;return C[0]=Je/q,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Je,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,Ge!=null&&Ge!==Infinity?(yt=1/(fe-Ge),C[10]=(Ge+fe)*yt,C[14]=2*Ge*fe*yt):(C[10]=-1,C[14]=-2*fe),C}function G(C,R,q,fe){var Ge=Math.tan(R.upDegrees*Math.PI/180),Je=Math.tan(R.downDegrees*Math.PI/180),yt=Math.tan(R.leftDegrees*Math.PI/180),nt=Math.tan(R.rightDegrees*Math.PI/180),Nt=2/(yt+nt),$=2/(Ge+Je);return C[0]=Nt,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=$,C[6]=0,C[7]=0,C[8]=-((yt-nt)*Nt*.5),C[9]=(Ge-Je)*$*.5,C[10]=fe/(q-fe),C[11]=-1,C[12]=0,C[13]=0,C[14]=fe*q/(q-fe),C[15]=0,C}function Ce(C,R,q,fe,Ge,Je,yt){var nt=1/(R-q),Nt=1/(fe-Ge),$=1/(Je-yt);return C[0]=-2*nt,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*Nt,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*$,C[11]=0,C[12]=(R+q)*nt,C[13]=(Ge+fe)*Nt,C[14]=(yt+Je)*$,C[15]=1,C}function be(C,R,q,fe){var Ge,Je,yt,nt,Nt,$,Ye,ie,et,Bt,lr=R[0],dt=R[1],vt=R[2],Ct=fe[0],gt=fe[1],we=fe[2],ht=q[0],Qe=q[1],Vt=q[2];return Math.abs(lr-ht)<S.b&&Math.abs(dt-Qe)<S.b&&Math.abs(vt-Vt)<S.b?D(C):(Ye=lr-ht,ie=dt-Qe,et=vt-Vt,Bt=1/Math.hypot(Ye,ie,et),Ye*=Bt,ie*=Bt,et*=Bt,Ge=gt*et-we*ie,Je=we*Ye-Ct*et,yt=Ct*ie-gt*Ye,Bt=Math.hypot(Ge,Je,yt),Bt?(Bt=1/Bt,Ge*=Bt,Je*=Bt,yt*=Bt):(Ge=0,Je=0,yt=0),nt=ie*yt-et*Je,Nt=et*Ge-Ye*yt,$=Ye*Je-ie*Ge,Bt=Math.hypot(nt,Nt,$),Bt?(Bt=1/Bt,nt*=Bt,Nt*=Bt,$*=Bt):(nt=0,Nt=0,$=0),C[0]=Ge,C[1]=nt,C[2]=Ye,C[3]=0,C[4]=Je,C[5]=Nt,C[6]=ie,C[7]=0,C[8]=yt,C[9]=$,C[10]=et,C[11]=0,C[12]=-(Ge*lr+Je*dt+yt*vt),C[13]=-(nt*lr+Nt*dt+$*vt),C[14]=-(Ye*lr+ie*dt+et*vt),C[15]=1,C)}function Te(C,R,q,fe){var Ge=R[0],Je=R[1],yt=R[2],nt=fe[0],Nt=fe[1],$=fe[2],Ye=Ge-q[0],ie=Je-q[1],et=yt-q[2],Bt=Ye*Ye+ie*ie+et*et;Bt>0&&(Bt=1/Math.sqrt(Bt),Ye*=Bt,ie*=Bt,et*=Bt);var lr=Nt*et-$*ie,dt=$*Ye-nt*et,vt=nt*ie-Nt*Ye;return Bt=lr*lr+dt*dt+vt*vt,Bt>0&&(Bt=1/Math.sqrt(Bt),lr*=Bt,dt*=Bt,vt*=Bt),C[0]=lr,C[1]=dt,C[2]=vt,C[3]=0,C[4]=ie*vt-et*dt,C[5]=et*lr-Ye*vt,C[6]=Ye*dt-ie*lr,C[7]=0,C[8]=Ye,C[9]=ie,C[10]=et,C[11]=0,C[12]=Ge,C[13]=Je,C[14]=yt,C[15]=1,C}function me(C){return"mat4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+", "+C[8]+", "+C[9]+", "+C[10]+", "+C[11]+", "+C[12]+", "+C[13]+", "+C[14]+", "+C[15]+")"}function rt(C){return Math.hypot(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15])}function Kt(C,R,q){return C[0]=R[0]+q[0],C[1]=R[1]+q[1],C[2]=R[2]+q[2],C[3]=R[3]+q[3],C[4]=R[4]+q[4],C[5]=R[5]+q[5],C[6]=R[6]+q[6],C[7]=R[7]+q[7],C[8]=R[8]+q[8],C[9]=R[9]+q[9],C[10]=R[10]+q[10],C[11]=R[11]+q[11],C[12]=R[12]+q[12],C[13]=R[13]+q[13],C[14]=R[14]+q[14],C[15]=R[15]+q[15],C}function _t(C,R,q){return C[0]=R[0]-q[0],C[1]=R[1]-q[1],C[2]=R[2]-q[2],C[3]=R[3]-q[3],C[4]=R[4]-q[4],C[5]=R[5]-q[5],C[6]=R[6]-q[6],C[7]=R[7]-q[7],C[8]=R[8]-q[8],C[9]=R[9]-q[9],C[10]=R[10]-q[10],C[11]=R[11]-q[11],C[12]=R[12]-q[12],C[13]=R[13]-q[13],C[14]=R[14]-q[14],C[15]=R[15]-q[15],C}function ge(C,R,q){return C[0]=R[0]*q,C[1]=R[1]*q,C[2]=R[2]*q,C[3]=R[3]*q,C[4]=R[4]*q,C[5]=R[5]*q,C[6]=R[6]*q,C[7]=R[7]*q,C[8]=R[8]*q,C[9]=R[9]*q,C[10]=R[10]*q,C[11]=R[11]*q,C[12]=R[12]*q,C[13]=R[13]*q,C[14]=R[14]*q,C[15]=R[15]*q,C}function ye(C,R,q,fe){return C[0]=R[0]+q[0]*fe,C[1]=R[1]+q[1]*fe,C[2]=R[2]+q[2]*fe,C[3]=R[3]+q[3]*fe,C[4]=R[4]+q[4]*fe,C[5]=R[5]+q[5]*fe,C[6]=R[6]+q[6]*fe,C[7]=R[7]+q[7]*fe,C[8]=R[8]+q[8]*fe,C[9]=R[9]+q[9]*fe,C[10]=R[10]+q[10]*fe,C[11]=R[11]+q[11]*fe,C[12]=R[12]+q[12]*fe,C[13]=R[13]+q[13]*fe,C[14]=R[14]+q[14]*fe,C[15]=R[15]+q[15]*fe,C}function Ve(C,R){return C[0]===R[0]&&C[1]===R[1]&&C[2]===R[2]&&C[3]===R[3]&&C[4]===R[4]&&C[5]===R[5]&&C[6]===R[6]&&C[7]===R[7]&&C[8]===R[8]&&C[9]===R[9]&&C[10]===R[10]&&C[11]===R[11]&&C[12]===R[12]&&C[13]===R[13]&&C[14]===R[14]&&C[15]===R[15]}function ft(C,R){var q=C[0],fe=C[1],Ge=C[2],Je=C[3],yt=C[4],nt=C[5],Nt=C[6],$=C[7],Ye=C[8],ie=C[9],et=C[10],Bt=C[11],lr=C[12],dt=C[13],vt=C[14],Ct=C[15],gt=R[0],we=R[1],ht=R[2],Qe=R[3],Vt=R[4],pr=R[5],Zr=R[6],cr=R[7],jn=R[8],Sn=R[9],ai=R[10],fi=R[11],Zn=R[12],Hn=R[13],k=R[14],H=R[15];return Math.abs(q-gt)<=S.b*Math.max(1,Math.abs(q),Math.abs(gt))&&Math.abs(fe-we)<=S.b*Math.max(1,Math.abs(fe),Math.abs(we))&&Math.abs(Ge-ht)<=S.b*Math.max(1,Math.abs(Ge),Math.abs(ht))&&Math.abs(Je-Qe)<=S.b*Math.max(1,Math.abs(Je),Math.abs(Qe))&&Math.abs(yt-Vt)<=S.b*Math.max(1,Math.abs(yt),Math.abs(Vt))&&Math.abs(nt-pr)<=S.b*Math.max(1,Math.abs(nt),Math.abs(pr))&&Math.abs(Nt-Zr)<=S.b*Math.max(1,Math.abs(Nt),Math.abs(Zr))&&Math.abs($-cr)<=S.b*Math.max(1,Math.abs($),Math.abs(cr))&&Math.abs(Ye-jn)<=S.b*Math.max(1,Math.abs(Ye),Math.abs(jn))&&Math.abs(ie-Sn)<=S.b*Math.max(1,Math.abs(ie),Math.abs(Sn))&&Math.abs(et-ai)<=S.b*Math.max(1,Math.abs(et),Math.abs(ai))&&Math.abs(Bt-fi)<=S.b*Math.max(1,Math.abs(Bt),Math.abs(fi))&&Math.abs(lr-Zn)<=S.b*Math.max(1,Math.abs(lr),Math.abs(Zn))&&Math.abs(dt-Hn)<=S.b*Math.max(1,Math.abs(dt),Math.abs(Hn))&&Math.abs(vt-k)<=S.b*Math.max(1,Math.abs(vt),Math.abs(k))&&Math.abs(Ct-H)<=S.b*Math.max(1,Math.abs(Ct),Math.abs(H))}var Ie=ke,pt=_t},Ztfv:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.tagProperty=y.tagParameter=y.decorate=void 0;var S=o("MON2"),v=o("xfSm");function X(te,ce,Y,ke){var Ke=v.TAGGED;a(Ke,te,ce,ke,Y)}y.tagParameter=X;function B(te,ce,Y){var ke=v.TAGGED_PROP;a(ke,te.constructor,ce,Y)}y.tagProperty=B;function a(te,ce,Y,ke,Ke){var We={},Oe=typeof Ke=="number",st=Ke!==void 0&&Oe?Ke.toString():Y;if(Oe&&Y!==void 0)throw new Error(S.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(te,ce)&&(We=Reflect.getMetadata(te,ce));var Le=We[st];if(!Array.isArray(Le))Le=[];else for(var xt=0,it=Le;xt<it.length;xt++){var $e=it[xt];if($e.key===ke.key)throw new Error(S.DUPLICATED_METADATA+" "+$e.key.toString())}Le.push(ke),We[st]=Le,Reflect.defineMetadata(te,We,ce)}function W(te,ce){Reflect.decorate(te,ce)}function D(te,ce){return function(Y,ke){ce(Y,ke,te)}}function J(te,ce,Y){typeof Y=="number"?W([D(Y,te)],ce):typeof Y=="string"?Reflect.decorate([te],ce,Y):W([te],ce)}y.decorate=J},ZxFD:function(Re,y,o){"use strict";o.r(y),o.d(y,"create",function(){return v}),o.d(y,"clone",function(){return X}),o.d(y,"fromValues",function(){return B}),o.d(y,"copy",function(){return a}),o.d(y,"set",function(){return W}),o.d(y,"add",function(){return D}),o.d(y,"subtract",function(){return J}),o.d(y,"multiply",function(){return te}),o.d(y,"divide",function(){return ce}),o.d(y,"ceil",function(){return Y}),o.d(y,"floor",function(){return ke}),o.d(y,"min",function(){return Ke}),o.d(y,"max",function(){return We}),o.d(y,"round",function(){return Oe}),o.d(y,"scale",function(){return st}),o.d(y,"scaleAndAdd",function(){return Le}),o.d(y,"distance",function(){return xt}),o.d(y,"squaredDistance",function(){return it}),o.d(y,"length",function(){return $e}),o.d(y,"squaredLength",function(){return Ze}),o.d(y,"negate",function(){return St}),o.d(y,"inverse",function(){return bt}),o.d(y,"normalize",function(){return Ne}),o.d(y,"dot",function(){return ze}),o.d(y,"cross",function(){return Ue}),o.d(y,"lerp",function(){return lt}),o.d(y,"random",function(){return Me}),o.d(y,"transformMat2",function(){return ct}),o.d(y,"transformMat2d",function(){return Gt}),o.d(y,"transformMat3",function(){return $t}),o.d(y,"transformMat4",function(){return ar}),o.d(y,"rotate",function(){return oe}),o.d(y,"angle",function(){return Q}),o.d(y,"zero",function(){return G}),o.d(y,"str",function(){return Ce}),o.d(y,"exactEquals",function(){return be}),o.d(y,"equals",function(){return Te}),o.d(y,"len",function(){return me}),o.d(y,"sub",function(){return rt}),o.d(y,"mul",function(){return Kt}),o.d(y,"div",function(){return _t}),o.d(y,"dist",function(){return ge}),o.d(y,"sqrDist",function(){return ye}),o.d(y,"sqrLen",function(){return Ve}),o.d(y,"forEach",function(){return ft});var S=o("yU0y");function v(){var Ie=new S.a(2);return S.a!=Float32Array&&(Ie[0]=0,Ie[1]=0),Ie}function X(Ie){var pt=new S.a(2);return pt[0]=Ie[0],pt[1]=Ie[1],pt}function B(Ie,pt){var C=new S.a(2);return C[0]=Ie,C[1]=pt,C}function a(Ie,pt){return Ie[0]=pt[0],Ie[1]=pt[1],Ie}function W(Ie,pt,C){return Ie[0]=pt,Ie[1]=C,Ie}function D(Ie,pt,C){return Ie[0]=pt[0]+C[0],Ie[1]=pt[1]+C[1],Ie}function J(Ie,pt,C){return Ie[0]=pt[0]-C[0],Ie[1]=pt[1]-C[1],Ie}function te(Ie,pt,C){return Ie[0]=pt[0]*C[0],Ie[1]=pt[1]*C[1],Ie}function ce(Ie,pt,C){return Ie[0]=pt[0]/C[0],Ie[1]=pt[1]/C[1],Ie}function Y(Ie,pt){return Ie[0]=Math.ceil(pt[0]),Ie[1]=Math.ceil(pt[1]),Ie}function ke(Ie,pt){return Ie[0]=Math.floor(pt[0]),Ie[1]=Math.floor(pt[1]),Ie}function Ke(Ie,pt,C){return Ie[0]=Math.min(pt[0],C[0]),Ie[1]=Math.min(pt[1],C[1]),Ie}function We(Ie,pt,C){return Ie[0]=Math.max(pt[0],C[0]),Ie[1]=Math.max(pt[1],C[1]),Ie}function Oe(Ie,pt){return Ie[0]=Math.round(pt[0]),Ie[1]=Math.round(pt[1]),Ie}function st(Ie,pt,C){return Ie[0]=pt[0]*C,Ie[1]=pt[1]*C,Ie}function Le(Ie,pt,C,R){return Ie[0]=pt[0]+C[0]*R,Ie[1]=pt[1]+C[1]*R,Ie}function xt(Ie,pt){var C=pt[0]-Ie[0],R=pt[1]-Ie[1];return Math.hypot(C,R)}function it(Ie,pt){var C=pt[0]-Ie[0],R=pt[1]-Ie[1];return C*C+R*R}function $e(Ie){var pt=Ie[0],C=Ie[1];return Math.hypot(pt,C)}function Ze(Ie){var pt=Ie[0],C=Ie[1];return pt*pt+C*C}function St(Ie,pt){return Ie[0]=-pt[0],Ie[1]=-pt[1],Ie}function bt(Ie,pt){return Ie[0]=1/pt[0],Ie[1]=1/pt[1],Ie}function Ne(Ie,pt){var C=pt[0],R=pt[1],q=C*C+R*R;return q>0&&(q=1/Math.sqrt(q)),Ie[0]=pt[0]*q,Ie[1]=pt[1]*q,Ie}function ze(Ie,pt){return Ie[0]*pt[0]+Ie[1]*pt[1]}function Ue(Ie,pt,C){var R=pt[0]*C[1]-pt[1]*C[0];return Ie[0]=Ie[1]=0,Ie[2]=R,Ie}function lt(Ie,pt,C,R){var q=pt[0],fe=pt[1];return Ie[0]=q+R*(C[0]-q),Ie[1]=fe+R*(C[1]-fe),Ie}function Me(Ie,pt){pt=pt||1;var C=S.c()*2*Math.PI;return Ie[0]=Math.cos(C)*pt,Ie[1]=Math.sin(C)*pt,Ie}function ct(Ie,pt,C){var R=pt[0],q=pt[1];return Ie[0]=C[0]*R+C[2]*q,Ie[1]=C[1]*R+C[3]*q,Ie}function Gt(Ie,pt,C){var R=pt[0],q=pt[1];return Ie[0]=C[0]*R+C[2]*q+C[4],Ie[1]=C[1]*R+C[3]*q+C[5],Ie}function $t(Ie,pt,C){var R=pt[0],q=pt[1];return Ie[0]=C[0]*R+C[3]*q+C[6],Ie[1]=C[1]*R+C[4]*q+C[7],Ie}function ar(Ie,pt,C){var R=pt[0],q=pt[1];return Ie[0]=C[0]*R+C[4]*q+C[12],Ie[1]=C[1]*R+C[5]*q+C[13],Ie}function oe(Ie,pt,C,R){var q=pt[0]-C[0],fe=pt[1]-C[1],Ge=Math.sin(R),Je=Math.cos(R);return Ie[0]=q*Je-fe*Ge+C[0],Ie[1]=q*Ge+fe*Je+C[1],Ie}function Q(Ie,pt){var C=Ie[0],R=Ie[1],q=pt[0],fe=pt[1],Ge=Math.sqrt(C*C+R*R)*Math.sqrt(q*q+fe*fe),Je=Ge&&(C*q+R*fe)/Ge;return Math.acos(Math.min(Math.max(Je,-1),1))}function G(Ie){return Ie[0]=0,Ie[1]=0,Ie}function Ce(Ie){return"vec2("+Ie[0]+", "+Ie[1]+")"}function be(Ie,pt){return Ie[0]===pt[0]&&Ie[1]===pt[1]}function Te(Ie,pt){var C=Ie[0],R=Ie[1],q=pt[0],fe=pt[1];return Math.abs(C-q)<=S.b*Math.max(1,Math.abs(C),Math.abs(q))&&Math.abs(R-fe)<=S.b*Math.max(1,Math.abs(R),Math.abs(fe))}var me=$e,rt=J,Kt=te,_t=ce,ge=xt,ye=it,Ve=Ze,ft=function(){var Ie=v();return function(pt,C,R,q,fe,Ge){var Je,yt;for(C||(C=2),R||(R=0),q?yt=Math.min(q*C+R,pt.length):yt=pt.length,Je=R;Je<yt;Je+=C)Ie[0]=pt[Je],Ie[1]=pt[Je+1],fe(Ie,Ie,Ge),pt[Je]=Ie[0],pt[Je+1]=Ie[1];return pt}}()},ZzCi:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.named=void 0;var S=o("xfSm"),v=o("GXnB"),X=o("Ztfv");function B(a){return function(W,D,J){var te=new v.Metadata(S.NAMED_TAG,a);typeof J=="number"?X.tagParameter(W,D,J,te):X.tagProperty(W,D,te)}}y.named=B},a5Wf:function(Re,y,o){"use strict";o.r(y);var S=o("IzEo"),v=o("bx4M"),X=o("14J3"),B=o("BMrR"),a=o("nKUr"),W=o("jCWc"),D=o("kPKH"),J=o("1OyB"),te=o("vuIU"),ce=o("Ji7U"),Y=o("LK+K"),ke=o("aHsQ"),Ke=o("sGsY"),We=o("9kvl"),Oe=o("q1tI"),st=o.n(Oe),Le=o("FRQA"),xt=o("ZhIB"),it=o.n(xt),$e=o("yP6+"),Ze=o("VTBJ");function St(w){var p=w.style;p.height="100%";var s=parseInt("".concat(getComputedStyle(w).height),10),d=parseInt("".concat(getComputedStyle(w).paddingTop),10)+parseInt("".concat(getComputedStyle(w).paddingBottom),10);return s-d}function bt(w){if(!w)return 0;var p=w,s=St(p),d=p.parentNode;return d&&(s=St(d)),s}function Ne(){return function(w){var p=function(s){Object(ce.a)(g,s);var d=Object(Y.a)(g);function g(){var L;Object(J.a)(this,g);for(var N=arguments.length,K=new Array(N),ee=0;ee<N;ee++)K[ee]=arguments[ee];return L=d.call.apply(d,[this].concat(K)),L.state={computedHeight:0},L.root=null,L.handleRoot=function(Z){L.root=Z},L}return Object(te.a)(g,[{key:"componentDidMount",value:function(){var N=this.props.height;if(!N&&this.root){var K=bt(this.root);this.setState({computedHeight:K}),K<1&&(K=bt(this.root),this.setState({computedHeight:K}))}}},{key:"render",value:function(){var N=this.props.height,K=this.state.computedHeight,ee=N||K;return Object(a.jsx)("div",{ref:this.handleRoot,children:ee>0&&Object(a.jsx)(w,Object(Ze.a)(Object(Ze.a)({},this.props),{},{height:ee}))})}}]),g}(st.a.Component);return p}}var ze=Ne,Ue=$e.Guide.Arc,lt=$e.Guide.Html,Me=$e.Guide.Line,ct=function(p){switch(p){case"2":return"\u5DEE";case"4":return"\u4E2D";case"6":return"\u826F";case"8":return"\u4F18";default:return""}};$e.Shape.registerShape&&$e.Shape.registerShape("point","pointer",{drawShape:function(p,s){var d=p.points[0];d=this.parsePoint(d);var g=this.parsePoint({x:0,y:0});return s.addShape("line",{attrs:{x1:g.x,y1:g.y,x2:d.x,y2:d.y,stroke:p.color,lineWidth:2,lineCap:"round"}}),s.addShape("circle",{attrs:{x:g.x,y:g.y,r:6,stroke:p.color,lineWidth:3,fill:"#fff"}})}});var Gt=function(p){var s=p.title,d=p.height,g=d===void 0?1:d,L=p.percent,N=p.forceFit,K=N===void 0?!0:N,ee=p.formatter,Z=ee===void 0?ct:ee,Se=p.color,pe=Se===void 0?"#2F9CFF":Se,Fe=p.bgColor,mt=Fe===void 0?"#F0F2F5":Fe,Yt={value:{type:"linear",min:0,max:10,tickCount:6,nice:!0}},jt=[{value:L/10}],Qt=function(){return`
  <div style="width: 300px;text-align: center;font-size: 12px!important;">
    <div style="font-size: 14px; color: rgba(0,0,0,0.43);margin: 0;">`.concat(s,`</div>
    <div style="font-size: 24px;color: rgba(0,0,0,0.85);margin: 0;">
      `).concat((jt[0].value*10).toFixed(2),`%
    </div>
  </div>`)},ur={fontSize:12,fill:"rgba(0, 0, 0, 0.65)",textAlign:"center"};return Object(a.jsxs)($e.Chart,{height:g,data:jt,scale:Yt,padding:[-16,0,16,0],forceFit:K,children:[Object(a.jsx)($e.Coord,{type:"polar",startAngle:-1.25*Math.PI,endAngle:.25*Math.PI,radius:.8}),Object(a.jsx)($e.Axis,{name:"1",line:void 0}),Object(a.jsx)($e.Axis,{line:void 0,tickLine:void 0,subTickLine:void 0,name:"value",zIndex:2,label:{offset:-12,formatter:Z,textStyle:ur}}),Object(a.jsxs)($e.Guide,{children:[Object(a.jsx)(Me,{start:[3,.905],end:[3,.85],lineStyle:{stroke:pe,lineDash:void 0,lineWidth:2}}),Object(a.jsx)(Me,{start:[5,.905],end:[5,.85],lineStyle:{stroke:pe,lineDash:void 0,lineWidth:3}}),Object(a.jsx)(Me,{start:[7,.905],end:[7,.85],lineStyle:{stroke:pe,lineDash:void 0,lineWidth:3}}),Object(a.jsx)(Ue,{start:[0,.965],end:[10,.965],style:{stroke:mt,lineWidth:10}}),Object(a.jsx)(Ue,{start:[0,.965],end:[jt[0].value,.965],style:{stroke:pe,lineWidth:10}}),Object(a.jsx)(lt,{position:["50%","95%"],html:Qt()})]}),Object(a.jsx)($e.Geom,{line:!1,type:"point",position:"value*1",shape:"pointer",color:pe,active:!1})]})},$t=ze()(Gt),ar=o("iz+Y"),oe=o.n(ar),Q=function(p){var s=p.height,d=s===void 0?1:s,g=p.data,L=g===void 0?[]:g,N=p.forceFit,K=N===void 0?!0:N,ee=p.color,Z=ee===void 0?"rgba(24, 144, 255, 0.2)":ee,Se=p.borderColor,pe=Se===void 0?"#1089ff":Se,Fe=p.scale,mt=Fe===void 0?{x:{},y:{}}:Fe,Yt=p.borderWidth,jt=Yt===void 0?2:Yt,Qt=p.line,ur=p.xAxis,kr=p.yAxis,on=p.animate,Gr=on===void 0?!0:on,ln=[36,5,30,5],wn={x:Object(Ze.a)({type:"cat",range:[0,1]},mt.x),y:Object(Ze.a)({min:0},mt.y)},Gn=["x*y",function(Vi,va){return{name:Vi,value:va}}],ii=d+54;return Object(a.jsx)("div",{className:oe.a.miniChart,style:{height:d},children:Object(a.jsx)("div",{className:oe.a.chartContent,children:d>0&&Object(a.jsxs)($e.Chart,{animate:Gr,scale:wn,height:ii,forceFit:K,data:L,padding:ln,children:[Object(a.jsx)($e.Axis,Object(Ze.a)({name:"x",label:null,line:null,tickLine:null,grid:null},ur),"axis-x"),Object(a.jsx)($e.Axis,Object(Ze.a)({name:"y",label:null,line:null,tickLine:null,grid:null},kr),"axis-y"),Object(a.jsx)($e.Tooltip,{showTitle:!1,crosshairs:!1}),Object(a.jsx)($e.Geom,{type:"area",position:"x*y",color:Z,tooltip:Gn,shape:"smooth",style:{fillOpacity:1}}),Qt?Object(a.jsx)($e.Geom,{type:"line",position:"x*y",shape:"smooth",color:pe,size:jt,tooltip:!1}):Object(a.jsx)("span",{style:{display:"none"}})]})})})},G=ze()(Q),Ce=o("/zsF"),be=o("PArb"),Te=o("rePB"),me=o("cQSq"),rt=o.n(me),Kt=o("9/5/"),_t=o.n(Kt),ge=o("Jssm"),ye=o.n(ge),Ve=o("TSYQ"),ft=o.n(Ve),Ie=o("d9mD"),pt=o.n(Ie),C=function(w){Object(ce.a)(s,w);var p=Object(Y.a)(s);function s(){var d;Object(J.a)(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.state={legendData:[],legendBlock:!1},d.chart=void 0,d.root=void 0,d.requestRef=0,d.resize=_t()(function(){var K=d.props.hasLegend,ee=d.state.legendBlock;if(!K||!d.root){window.removeEventListener("resize",d.resize);return}d.root&&d.root.parentNode&&d.root.parentNode.clientWidth<=380?ee||d.setState({legendBlock:!0}):ee&&d.setState({legendBlock:!1})},300),d.getG2Instance=function(K){d.chart=K,requestAnimationFrame(function(){d.getLegendData(),d.resize()})},d.getLegendData=function(){if(!!d.chart){var K=d.chart.getAllGeoms()[0];if(!!K){var ee=K.get("dataArray")||[],Z=ee.map(function(Se){var pe=Se[0]._origin;return pe.color=Se[0].color,pe.checked=!0,pe});d.setState({legendData:Z})}}},d.handleRoot=function(K){d.root=K},d.handleLegendClick=function(K,ee){var Z=K;Z.checked=!Z.checked;var Se=d.state.legendData;Se[ee]=Z;var pe=Se.filter(function(Fe){return Fe.checked}).map(function(Fe){return Fe.x});d.chart&&d.chart.filter("x",function(Fe){return pe.indexOf("".concat(Fe))>-1}),d.setState({legendData:Se})},d}return Object(te.a)(s,[{key:"componentDidMount",value:function(){var g=this;window.addEventListener("resize",function(){g.requestRef=requestAnimationFrame(function(){return g.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(g){var L=this.props.data;L!==g.data&&this.getLegendData()}},{key:"componentWillUnmount",value:function(){this.requestRef&&window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize),this.resize&&this.resize.cancel()}},{key:"render",value:function(){var g,L=this,N=this.props,K=N.valueFormat,ee=N.subTitle,Z=N.total,Se=N.hasLegend,pe=Se===void 0?!1:Se,Fe=N.className,mt=N.style,Yt=N.height,jt=Yt===void 0?0:Yt,Qt=N.forceFit,ur=Qt===void 0?!0:Qt,kr=N.percent,on=N.color,Gr=N.inner,ln=Gr===void 0?.75:Gr,wn=N.animate,Gn=wn===void 0?!0:wn,ii=N.colors,Vi=N.lineWidth,va=Vi===void 0?1:Vi,Ia=this.state,qu=Ia.legendData,ts=Ia.legendBlock,us=ft()(pt.a.pie,Fe,(g={},Object(Te.a)(g,pt.a.hasLegend,!!pe),Object(Te.a)(g,pt.a.legendBlock,ts),g)),Su=this.props,Nf=Su.data,Ml=Su.selected,Wc=Ml===void 0?!0:Ml,_a=Su.tooltip,Da=_a===void 0?!0:_a,wc=Nf||[],pl=Wc,Xc=Da,Jf=ii;wc=wc||[],pl=pl||!0,Xc=Xc||!0;var po,vl={x:{type:"cat",range:[0,1]},y:{min:0}};(kr||kr===0)&&(pl=!1,Xc=!1,po=function(Cf){return Cf==="\u5360\u6BD4"?on||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},wc=[{x:"\u5360\u6BD4",y:parseFloat("".concat(kr))},{x:"\u53CD\u6BD4",y:100-parseFloat("".concat(kr))}]);var hf=["x*percent",function(Xa,Cf){return{name:Xa,value:"".concat((Cf*100).toFixed(2),"%")}}],df=[12,0,12,0],_h=new me.DataView;return _h.source(wc).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),Object(a.jsxs)("div",{ref:this.handleRoot,className:us,style:mt,children:[Object(a.jsx)(ye.a,{maxFontSize:25,children:Object(a.jsxs)("div",{className:pt.a.chart,children:[Object(a.jsxs)($e.Chart,{scale:vl,height:jt,forceFit:ur,data:_h,padding:df,animate:Gn,onGetG2Instance:this.getG2Instance,children:[!!Xc&&Object(a.jsx)($e.Tooltip,{showTitle:!1}),Object(a.jsx)($e.Coord,{type:"theta",innerRadius:ln}),Object(a.jsx)($e.Geom,{style:{lineWidth:va,stroke:"#fff"},tooltip:Xc?hf:void 0,type:"intervalStack",position:"percent",color:["x",kr||kr===0?po:Jf],selected:pl})]}),(ee||Z)&&Object(a.jsxs)("div",{className:pt.a.total,children:[ee&&Object(a.jsx)("h4",{className:"pie-sub-title",children:ee}),Z&&Object(a.jsx)("div",{className:"pie-stat",children:typeof Z=="function"?Z():Z})]})]})}),pe&&Object(a.jsx)("ul",{className:pt.a.legend,children:qu.map(function(Xa,Cf){return Object(a.jsxs)("li",{onClick:function(){return L.handleLegendClick(Xa,Cf)},children:[Object(a.jsx)("span",{className:pt.a.dot,style:{backgroundColor:Xa.checked?Xa.color:"#aaa"}}),Object(a.jsx)("span",{className:pt.a.legendTitle,children:Xa.x}),Object(a.jsx)(be.a,{type:"vertical"}),Object(a.jsx)("span",{className:pt.a.percent,children:"".concat((Number.isNaN(Xa.percent)?0:Xa.percent*100).toFixed(2),"%")}),Object(a.jsx)("span",{className:pt.a.value,children:K?K(Xa.y):Xa.y})]},Xa.x)})})]})}}]),s}(Oe.Component),R=ze()(C),q=o("ODXe"),fe=o("1XEM"),Ge=o.n(fe),Je="https://gw.alipayobjects.com/zos/rmsportal/gWyeGLCdFFRavBGIDzWk.png",yt=function(w){Object(ce.a)(s,w);var p=Object(Y.a)(s);function s(){var d;Object(J.a)(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.state={dv:null,height:0,width:0},d.requestRef=0,d.isUnmount=!1,d.root=void 0,d.imageMask=void 0,d.resize=function(){d.requestRef=requestAnimationFrame(function(){d.renderChart(d.props)})},d.saveRootRef=function(K){d.root=K},d.initTagCloud=function(){function K(ee){return Object(Ze.a)(Object(Ze.a)({},ee.style),{},{fillOpacity:ee.opacity,fontSize:ee.origin._origin.size,rotate:ee.origin._origin.rotate,text:ee.origin._origin.text,textAlign:"center",fontFamily:ee.origin._origin.font,fill:ee.color,textBaseline:"Alphabetic"})}$e.Shape.registerShape("point","cloud",{drawShape:function(Z,Se){var pe=K(Z);return Se.addShape("text",{attrs:Object(Ze.a)(Object(Ze.a)({},pe),{},{x:Z.x,y:Z.y})})}})},d.renderChart=_t()(function(K){var ee=K||d.props,Z=ee.data,Se=ee.height;if(!(Z.length<1||!d.root)){var pe=Se,Fe=d.root.offsetWidth,mt=function(){var jt=new rt.a.View().source(Z),Qt=jt.range("value"),ur=Object(q.a)(Qt,2),kr=ur[0],on=ur[1];jt.transform({type:"tag-cloud",fields:["name","value"],imageMask:d.imageMask,font:"Verdana",size:[Fe,pe],padding:0,timeInterval:5e3,rotate:function(){return 0},fontSize:function(ln){var wn=Math.pow((ln.value-kr)/(on-kr),2);return wn*(17.5-5)+5}}),!d.isUnmount&&d.setState({dv:jt,width:Fe,height:pe})};d.imageMask?mt():(d.imageMask=new Image,d.imageMask.crossOrigin="",d.imageMask.src=Je,d.imageMask.onload=mt)}},200),d}return Object(te.a)(s,[{key:"componentDidMount",value:function(){var g=this;requestAnimationFrame(function(){g.initTagCloud(),g.renderChart(g.props)}),window.addEventListener("resize",this.resize,{passive:!0})}},{key:"componentDidUpdate",value:function(g){var L=this.props.data;g&&JSON.stringify(g.data)!==JSON.stringify(L)&&this.renderChart(this.props)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var g=this.props,L=g.className,N=g.height,K=this.state,ee=K.dv,Z=K.width,Se=K.height;return Object(a.jsx)("div",{className:ft()(Ge.a.tagCloud,L),style:{width:"100%",height:N},ref:this.saveRootRef,children:ee&&Object(a.jsxs)($e.Chart,{width:Z,height:Se,data:ee,padding:0,scale:{x:{nice:!1},y:{nice:!1}},children:[Object(a.jsx)($e.Tooltip,{showTitle:!1}),Object(a.jsx)($e.Coord,{reflect:"y"}),Object(a.jsx)($e.Geom,{type:"point",position:"x*y",color:"text",shape:"cloud",tooltip:["text*value",function(Fe,mt){return{name:Fe,value:mt}}]})]})})}}]),s}(Oe.Component),nt=ze()(yt),Nt=o("CIdX"),$=o.n(Nt),Ye=function(w){Object(ce.a)(s,w);var p=Object(Y.a)(s);function s(){var d;Object(J.a)(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.state={radio:1},d.timer=0,d.root=null,d.node=null,d.resize=function(){if(d.root){var K=d.props.height,ee=K===void 0?1:K,Z=d.root.parentNode,Se=Z.offsetWidth;d.setState({radio:Se<ee?Se/ee:1})}},d}return Object(te.a)(s,[{key:"componentDidMount",value:function(){var g=this;this.renderChart(),this.resize(),window.addEventListener("resize",function(){requestAnimationFrame(function(){return g.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(g){var L=this.props.percent;g.percent!==L&&this.renderChart("update")}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.timer),this.node&&(this.node.innerHTML=""),window.removeEventListener("resize",this.resize)}},{key:"renderChart",value:function(g){var L=this.props,N=L.percent,K=L.color,ee=K===void 0?"#1890FF":K,Z=N/100,Se=this;if(cancelAnimationFrame(this.timer),!this.node||Z!==0&&!Z)return;var pe=this.node,Fe=pe.getContext("2d");if(!Fe)return;var mt=pe.width,Yt=pe.height,jt=mt/2,Qt=2,ur=jt-Qt;Fe.beginPath(),Fe.lineWidth=Qt*2;for(var kr=mt-Qt,on=kr/8,Gr=.2,ln=Gr,wn=Qt,Gn=0,ii=0,Vi=.005,va=[],Ia=jt-Qt,qu=-(Math.PI/2),ts=!0,us=qu;us<qu+2*Math.PI;us+=1/(8*Math.PI))va.push([jt+Ia*Math.cos(us),jt+Ia*Math.sin(us)]);var Su=va.shift();Fe.strokeStyle=ee,Fe.moveTo(Su[0],Su[1]);function Nf(){if(!!Fe){Fe.beginPath(),Fe.save();for(var Wc=[],_a=wn;_a<=wn+kr;_a+=20/kr){var Da=Gn+(wn+_a)/on,wc=Math.sin(Da)*ln,pl=_a,Xc=2*ur*(1-ii)+(jt-ur)-on*wc;Fe.lineTo(pl,Xc),Wc.push([pl,Xc])}var Jf=Wc.shift();Fe.lineTo(wn+kr,Yt),Fe.lineTo(wn,Yt),Fe.lineTo(Jf[0],Jf[1]);var po=Fe.createLinearGradient(0,0,0,Yt);po.addColorStop(0,"#ffffff"),po.addColorStop(1,ee),Fe.fillStyle=po,Fe.fill(),Fe.restore()}}function Ml(){if(!!Fe){if(Fe.clearRect(0,0,mt,Yt),ts&&g!=="update")if(va.length){var Wc=va.shift();Fe.lineTo(Wc[0],Wc[1]),Fe.stroke()}else ts=!1,Fe.lineTo(Su[0],Su[1]),Fe.stroke(),va=[],Fe.globalCompositeOperation="destination-over",Fe.beginPath(),Fe.lineWidth=Qt,Fe.arc(jt,jt,Ia,0,2*Math.PI,!0),Fe.beginPath(),Fe.save(),Fe.arc(jt,jt,jt-3*Qt,0,2*Math.PI,!0),Fe.restore(),Fe.clip(),Fe.fillStyle=ee;else{if(Z>=.85){if(ln>Gr/4){var _a=Gr*.01;ln-=_a}}else if(Z<=.1){if(ln<Gr*1.5){var Da=Gr*.01;ln+=Da}}else{if(ln<=Gr){var wc=Gr*.01;ln+=wc}if(ln>=Gr){var pl=Gr*.01;ln-=pl}}Z-ii>0&&(ii+=Vi),Z-ii<0&&(ii-=Vi),Gn+=.07,Nf()}Se.timer=requestAnimationFrame(Ml)}}Ml()}},{key:"render",value:function(){var g=this,L=this.state.radio,N=this.props,K=N.percent,ee=N.title,Z=N.height,Se=Z===void 0?1:Z;return Object(a.jsxs)("div",{className:$.a.waterWave,ref:function(Fe){return g.root=Fe},style:{transform:"scale(".concat(L,")")},children:[Object(a.jsx)("div",{style:{width:Se,height:Se,overflow:"hidden"},children:Object(a.jsx)("canvas",{className:$.a.waterWaveCanvasWrapper,ref:function(Fe){return g.node=Fe},width:Se*2,height:Se*2})}),Object(a.jsxs)("div",{className:$.a.text,style:{width:Se},children:[ee&&Object(a.jsx)("span",{children:ee}),Object(a.jsxs)("h4",{children:[K,"%"]})]})]})}}]),s}(Oe.Component),ie=ze()(Ye),et=o("o0o1"),Bt=o.n(et),lr=o("HaE+"),dt=Object(Oe.createContext)({});function vt(){return Object(Oe.useContext)(dt)}var Ct=o("8ml+"),gt=o("lwsE"),we=o.n(gt),ht=o("W8MJ"),Qe=o.n(ht),Vt=o("7W2i"),pr=o.n(Vt),Zr=o("a1gu"),cr=o.n(Zr),jn=o("Nsbk"),Sn=o.n(jn),ai=o("lSNA"),fi=o.n(ai),Zn=o("yG8O"),Hn=o.n(Zn),k=o("U+yc"),H=o.n(k),le=o("1ABj"),de=o("h1nZ"),at,At,Ft,He,Pt,or;function jr(w,p){var s=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),s.push.apply(s,d)}return s}function Hr(w){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?jr(Object(s),!0).forEach(function(d){fi()(w,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(s)):jr(Object(s)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(s,d))})}return w}var sr=(at=Object(de.lazyInject)(de.TYPES.ILogService),At=Object(de.lazyInject)(de.TYPES.IGlobalConfigService),Ft=(or=function(){function w(p){we()(this,w),Hn()(this,"logger",He,this),Hn()(this,"configService",Pt,this),this.config=void 0,this.config=p}return Qe()(w,[{key:"setContainer",value:function(s,d){s.bind(de.TYPES.MapConfig).toConstantValue(Hr(Hr({},this.config),{},{id:d})),s.bind(de.TYPES.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),w}(),or),He=H()(Ft.prototype,"logger",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pt=H()(Ft.prototype,"configService",[At],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ft),Fr=o("QILm"),_n=o.n(Fr),dn=o("yXPU"),Er=o.n(dn),Tn=o("hi0z"),vn=o.n(Tn),gn=o("Hel2"),Ar=o("IOcx"),$r=o("4cb6"),Mn={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},Xi=o("J4zp"),vi=o.n(Xi),wi=Math.PI/180,Di=function(){function w(){we()(this,w),this.projectionMatrix=Ar.b.create(),this.viewMatrix=Ar.b.create(),this.viewProjectionMatrix=Ar.b.create(),this.ViewProjectionMatrixUncentered=Ar.b.create(),this.viewUncenteredMatrix=Ar.b.create(),this.zoom=void 0,this.center=void 0}return Qe()(w,[{key:"syncWithMapCamera",value:function(s){var d=s.zoom,g=d===void 0?1:d,L=s.pitch,N=L===void 0?0:L,K=s.bearing,ee=K===void 0?0:K,Z=s.center,Se=Z===void 0?[0,0]:Z,pe=s.offsetOrigin,Fe=pe===void 0?[0,0]:pe,mt=s.cameraHeight,Yt=mt===void 0?1:mt,jt=s.aspect,Qt=jt===void 0?1:jt,ur=s.near,kr=ur===void 0?.1:ur,on=s.far,Gr=on===void 0?1e3:on,ln=s.fov,wn=ln===void 0?0:ln;this.zoom=g,this.center=Se;var Gn=N*wi,ii=(360-ee)*wi;Ar.b.perspective(this.projectionMatrix,wn,Qt,kr,Gr);var Vi=Ar.d.fromValues(Yt*Math.sin(Gn)*Math.sin(ii),-Yt*Math.sin(Gn)*Math.cos(ii),Yt*Math.cos(Gn)),va=Ar.d.fromValues(-Math.cos(Gn)*Math.sin(ii),Math.cos(Gn)*Math.cos(ii),Math.sin(Gn));Ar.b.lookAt(this.viewMatrix,Vi,Ar.d.fromValues(0,0,0),va),this.viewUncenteredMatrix=Ar.b.clone(this.viewMatrix),Ar.b.translate(this.viewMatrix,this.viewMatrix,Ar.d.fromValues(-Fe[0],Fe[1],0)),Ar.b.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),Ar.b.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var s=vi()(this.center,2),d=s[0],g=s[1];return[d,g]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(s,d){var g=85.0511287798,L=Math.max(Math.min(g,s[1]),-g),N=256<<20,K=Math.PI/180,ee=s[0]*K,Z=L*K;Z=Math.log(Math.tan(Math.PI/4+Z/2));var Se=.5/Math.PI,pe=.5,Fe=-.5/Math.PI;return K=.5,ee=N*(Se*ee+pe)-215440491,Z=-(N*(Fe*Z+K)-106744817),[ee,Z]}}]),w}(),Ka,hi,ga,Pi,gi,ci,Oa,mo,$a,Ko,Uu,Ui,Ca,ns;function na(w,p){var s=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),s.push.apply(s,d)}return s}function Ja(w){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?na(Object(s),!0).forEach(function(d){fi()(w,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(s)):na(Object(s)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(s,d))})}return w}o("BGjm")(`/* @antv/l7-maps */
.amap-logo{
 display: none !important;
}
`);var is=0;window.forceWebGL=!0;var $i="15cd8a57710d40c9b7c0e3cc120f1200",oo="1.4.15",so="amap-script",Ys=!1,Ao=[],Zl=12,Ks=(Ka=Object($r.injectable)(),hi=Object($r.inject)(de.TYPES.IGlobalConfigService),ga=Object($r.inject)(de.TYPES.ILogService),Pi=Object($r.inject)(de.TYPES.MapConfig),gi=Object($r.inject)(de.TYPES.ICoordinateSystemService),ci=Object($r.inject)(de.TYPES.IEventEmitter),Ka(Oa=(mo=(ns=function(){function w(){var p=this;we()(this,w),this.map=void 0,Hn()(this,"configService",$a,this),Hn()(this,"logger",Ko,this),Hn()(this,"config",Uu,this),Hn()(this,"coordinateSystemService",Ui,this),Hn()(this,"eventEmitter",Ca,this),this.markerContainer=void 0,this.$mapContainer=void 0,this.viewport=void 0,this.cameraChangedCallback=void 0,this.handleCameraChanged=function(s){var d=s.camera,g=d.fov,L=d.near,N=d.far,K=d.height,ee=d.pitch,Z=d.rotation,Se=d.aspect,pe=d.position,Fe=p.getCenter(),mt=Fe.lng,Yt=Fe.lat;p.cameraChangedCallback&&(p.viewport.syncWithMapCamera({aspect:Se,bearing:360-Z,far:N,fov:g,cameraHeight:K,near:L,pitch:ee,zoom:p.map.getZoom()-1,center:[mt,Yt],offsetOrigin:[pe.x,pe.y]}),p.viewport.getZoom()>Zl?p.coordinateSystemService.setCoordinateSystem(de.CoordinateSystem.P20_OFFSET):p.coordinateSystemService.setCoordinateSystem(de.CoordinateSystem.P20),p.cameraChangedCallback(p.viewport))}}return Qe()(w,[{key:"addMarkerContainer",value:function(){var s=this.map.getContainer();if(s!==null){var d=s.getElementsByClassName("amap-maps")[0];this.markerContainer=gn.a.create("div","l7-marker-container",d)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(s,d){de.MapServiceEvent.indexOf(s)!==-1?this.eventEmitter.on(s,d):this.map.on(s,d)}},{key:"off",value:function(s,d){de.MapServiceEvent.indexOf(s)!==-1?this.eventEmitter.off(s,d):this.map.off(s,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var s;return(s=this.map.getContainer())===null||s===void 0?void 0:s.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var s=this.map.getSize();return[s.getWidth(),s.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(s){return this.map.setZoom(s)}},{key:"getCenter",value:function(){var s=this.map.getCenter();return{lng:s.getLng(),lat:s.getLat()}}},{key:"setCenter",value:function(s){this.map.setCenter(s)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var s=this.map.getBounds().toBounds(),d=s.getNorthEast(),g=s.getSouthWest(),L=this.getCenter(),N=L.lng>d.getLng()||L.lng<g.getLng()?180-d.getLng():d.getLng(),K=L.lng<g.getLng()?g.getLng()-180:g.getLng();return[[K,g.getLat()],[N,d.getLat()]]}},{key:"getMinZoom",value:function(){var s=this.map.get("zooms");return s[0]-1}},{key:"getMaxZoom",value:function(){var s=this.map.get("zooms");return s[1]-1}},{key:"setRotation",value:function(s){return this.map.setRotation(s)}},{key:"setPitch",value:function(s){return this.map.setPitch(s)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(s){this.map.panTo(s)}},{key:"panBy",value:function(s){this.map.panTo(s)}},{key:"fitBounds",value:function(s){this.map.setBounds(new AMap.Bounds([s[0][0],s[0][1],s[1][0],s[1][1]]))}},{key:"setZoomAndCenter",value:function(s,d){this.map.setZoomAndCenter(s,d)}},{key:"setMapStyle",value:function(s){this.map.setMapStyle(this.getMapStyle(s))}},{key:"setMapStatus",value:function(s){this.map.setStatus(s)}},{key:"pixelToLngLat",value:function(s){var d=this.map.pixelToLngLat(new AMap.Pixel(s[0],s[1]));return{lng:d.getLng(),lat:d.getLat()}}},{key:"lngLatToPixel",value:function(s){var d=this.map.lnglatToPixel(new AMap.LngLat(s[0],s[1]));return{x:d.getX(),y:d.getY()}}},{key:"containerToLngLat",value:function(s){var d=new AMap.Pixel(s[0],s[1]),g=this.map.containerToLngLat(d);return{lng:g==null?void 0:g.getLng(),lat:g==null?void 0:g.getLat()}}},{key:"lngLatToContainer",value:function(s){var d=new AMap.LngLat(s[0],s[1]),g=this.map.lngLatToContainer(d);return{x:g.getX(),y:g.getY()}}},{key:"lngLatToMercator",value:function(s,d){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(s,d,g){var L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],N=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},K=this.viewport.projectFlat(s),ee=Ar.b.create();return Ar.b.translate(ee,ee,Ar.d.fromValues(K[0],K[1],d)),Ar.b.scale(ee,ee,Ar.d.fromValues(L[0],L[1],L[2])),Ar.b.rotateX(ee,ee,g[0]),Ar.b.rotateY(ee,ee,g[1]),Ar.b.rotateZ(ee,ee,g[2]),ee}},{key:"init",value:function(){var p=Er()(Bt.a.mark(function d(){var g=this,L,N,K,ee,Z,Se,pe,Fe,mt,Yt,jt,Qt,ur,kr;return Bt.a.wrap(function(Gr){for(;;)switch(Gr.prev=Gr.next){case 0:return L=this.config,N=L.id,K=L.style,ee=K===void 0?"light":K,Z=L.minZoom,Se=Z===void 0?0:Z,pe=L.maxZoom,Fe=pe===void 0?18:pe,mt=L.token,Yt=mt===void 0?$i:mt,jt=L.mapInstance,Qt=L.plugin,ur=Qt===void 0?[]:Qt,kr=_n()(L,["id","style","minZoom","maxZoom","token","mapInstance","plugin"]),Gr.next=3,new Promise(function(ln){var wn=function(){if(jt)g.map=jt,g.$mapContainer=g.map.getContainer(),setTimeout(function(){g.map.on("camerachange",g.handleCameraChanged),ln()},30);else{g.$mapContainer=g.creatAmapContainer(N);var ii=new AMap.Map(g.$mapContainer,Ja({mapStyle:g.getMapStyle(ee),zooms:[Se,Fe],viewMode:"3D"},kr));ii.on("camerachange",g.handleCameraChanged),g.map=ii,setTimeout(function(){ln()},10)}};!Ys&&!jt?(Yt===$i&&g.logger.warn(g.configService.getSceneWarninfo("MapToken")),Ys=!0,ur.push("Map3D"),vn.a.load({key:Yt,version:oo,plugins:ur}).then(function(Gn){wn(),Ao.length&&(Ao.forEach(function(ii){return ii()}),Ao=[])}).catch(function(Gn){throw new Error(Gn)})):Ys&&window.AMap||jt?wn():Ao.push(wn)});case 3:this.viewport=new Di;case 4:case"end":return Gr.stop()}},d,this)}));function s(){return p.apply(this,arguments)}return s}()},{key:"exportMap",value:function(s){var d,g=(d=this.getContainer())===null||d===void 0?void 0:d.getElementsByClassName("amap-layer")[0],L=s==="jpg"?g==null?void 0:g.toDataURL("image/jpeg"):g==null?void 0:g.toDataURL("image/png");return L}},{key:"emit",value:function(s){for(var d,g=arguments.length,L=new Array(g>1?g-1:0),N=1;N<g;N++)L[N-1]=arguments[N];(d=this.eventEmitter).emit.apply(d,[s].concat(L))}},{key:"once",value:function(s){for(var d,g=arguments.length,L=new Array(g>1?g-1:0),N=1;N<g;N++)L[N-1]=arguments[N];(d=this.eventEmitter).once.apply(d,[s].concat(L))}},{key:"destroy",value:function(){this.map.destroy(),delete window.initAMap;var s=document.getElementById(so);s&&document.head.removeChild(s)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(s){this.cameraChangedCallback=s}},{key:"getMapStyle",value:function(s){return Mn[s]?Mn[s]:s}},{key:"creatAmapContainer",value:function(s){var d=s;typeof s=="string"&&(d=document.getElementById(s));var g=document.createElement("div");return g.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,g.id="l7_amap_div"+is++,d.appendChild(g),g}}]),w}(),ns),$a=H()(mo.prototype,"configService",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ko=H()(mo.prototype,"logger",[ga],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uu=H()(mo.prototype,"config",[Pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ui=H()(mo.prototype,"coordinateSystemService",[gi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ca=H()(mo.prototype,"eventEmitter",[ci],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mo))||Oa);function _o(w){var p=kt();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function kt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var De=function(w){pr()(s,w);var p=_o(s);function s(){return we()(this,s),p.apply(this,arguments)}return Qe()(s,[{key:"getServiceConstructor",value:function(){return Ks}}]),s}(sr);function It(w,p){var s=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),s.push.apply(s,d)}return s}function fr(w){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?It(Object(s),!0).forEach(function(d){tn(w,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(s)):It(Object(s)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(s,d))})}return w}function tn(w,p,s){return p in w?Object.defineProperty(w,p,{value:s,enumerable:!0,configurable:!0,writable:!0}):w[p]=s,w}function En(w,p){return No(w)||go(w,p)||La(w,p)||Un()}function Un(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function La(w,p){if(!!w){if(typeof w=="string")return no(w,p);var s=Object.prototype.toString.call(w).slice(8,-1);if(s==="Object"&&w.constructor&&(s=w.constructor.name),s==="Map"||s==="Set")return Array.from(w);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return no(w,p)}}function no(w,p){(p==null||p>w.length)&&(p=w.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=w[s];return d}function go(w,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))){var s=[],d=!0,g=!1,L=void 0;try{for(var N=w[Symbol.iterator](),K;!(d=(K=N.next()).done)&&(s.push(K.value),!(p&&s.length===p));d=!0);}catch(ee){g=!0,L=ee}finally{try{!d&&N.return!=null&&N.return()}finally{if(g)throw L}}return s}}function No(w){if(Array.isArray(w))return w}var Vu=st.a.memo(function(w){var p=w.style,s=w.className,d=w.map,g=w.option,L=w.onSceneLoaded,N=w.children,K=Object(Oe.useRef)(null),ee=Object(Oe.useState)(),Z=En(ee,2),Se=Z[0],pe=Z[1];return Object(Oe.useEffect)(function(){var Fe=new Ct.Scene(fr(fr({id:K.current},g),{},{map:new De(d)}));return Fe.on("loaded",function(){pe(Fe),L&&L(Fe)}),function(){Fe.destroy()}},[]),Object(Oe.useEffect)(function(){Se&&d.style&&Se.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(Oe.useEffect)(function(){Se&&d.zoom&&Se.setZoom(d.zoom)},[d.zoom]),Object(Oe.useEffect)(function(){Se&&d.center&&Se.setCenter(d.center)},[JSON.stringify(d.center)]),Object(Oe.useEffect)(function(){Se&&d.pitch&&Se.setPitch(d.pitch)},[d.pitch]),Object(Oe.useEffect)(function(){Se&&d.rotation&&Se.setRotation(d.rotation)},[d.rotation]),st.a.createElement(dt.Provider,{value:Se},st.a.createElement("div",{ref:K,className:s,style:p},Se&&N))}),Wl=Vu,$s=o("4ZJM"),Ic=o.n($s),Il=o("md7G"),fs=o("foSv"),zs=o("JX7q"),uo=o("bl9R");function hs(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Js(w,p){var s=uo.transformMat4([],p,w);return uo.scale(s,s,1/s[3]),s}function lu(w,p){var s=w%p;return s<0?p+s:s}function Xl(w,p,s){return s*p+(1-s)*w}var ya=o("ZaHm"),Na=o("ZxFD"),ml=o("n+fv");function Ns(w,p){if(!w)throw new Error(p||"viewport-mercator-project: assertion failed.")}var ds=Math.PI,Mt=ds/4,rr=ds/180,Pr=180/ds,Vn=512,Ji=4003e4,Ra=1.5;function Ha(w){return Math.pow(2,w)}function Qi(w){return Math.log2(w)}function xa(w,p){var s=Object(q.a)(w,2),d=s[0],g=s[1];Ns(Number.isFinite(d)&&Number.isFinite(p)),Ns(Number.isFinite(g)&&g>=-90&&g<=90,"invalid latitude"),p*=Vn;var L=d*rr,N=g*rr,K=p*(L+ds)/(2*ds),ee=p*(ds-Math.log(Math.tan(Mt+N*.5)))/(2*ds);return[K,ee]}function Co(w,p){var s=Object(q.a)(w,2),d=s[0],g=s[1];p*=Vn;var L=d/p*(2*ds)-ds,N=2*(Math.atan(Math.exp(ds-g/p*(2*ds)))-Mt);return[L*Pr,N*Pr]}function Fs(w){var p=w.latitude;Ns(Number.isFinite(p));var s=Math.cos(p*rr);return Qi(Ji*s)-9}function ha(w){var p=w.latitude,s=w.longitude,d=w.zoom,g=w.scale,L=w.highPrecision,N=L===void 0?!1:L;g=g!==void 0?g:Ha(d),Ns(Number.isFinite(p)&&Number.isFinite(s)&&Number.isFinite(g));var K={},ee=Vn*g,Z=Math.cos(p*rr),Se=ee/360,pe=Se/Z,Fe=ee/Ji/Z;if(K.pixelsPerMeter=[Fe,-Fe,Fe],K.metersPerPixel=[1/Fe,-1/Fe,1/Fe],K.pixelsPerDegree=[Se,-pe,Fe],K.degreesPerPixel=[1/Se,-1/pe,1/Fe],N){var mt=rr*Math.tan(p*rr)/Z,Yt=Se*mt/2,jt=ee/Ji*mt,Qt=jt/pe*Fe;K.pixelsPerDegree2=[0,-Yt,jt],K.pixelsPerMeter2=[Qt,0,Qt]}return K}function Yl(w,p){var s=Object(q.a)(w,3),d=s[0],g=s[1],L=s[2],N=Object(q.a)(p,3),K=N[0],ee=N[1],Z=N[2],Se=1,pe=ha({longitude:d,latitude:g,scale:Se,highPrecision:!0}),Fe=pe.pixelsPerMeter,mt=pe.pixelsPerMeter2,Yt=xa(w,Se);Yt[0]+=K*(Fe[0]+mt[0]*ee),Yt[1]+=ee*(Fe[1]+mt[1]*ee);var jt=Co(Yt,Se),Qt=(L||0)+(Z||0);return Number.isFinite(L)||Number.isFinite(Z)?[jt[0],jt[1],Qt]:jt}function cu(w){var p=w.height,s=w.pitch,d=w.bearing,g=w.altitude,L=w.center,N=L===void 0?null:L,K=w.flipY,ee=K===void 0?!1:K,Z=hs();return ya.translate(Z,Z,[0,0,-g]),ya.scale(Z,Z,[1,1,1/p]),ya.rotateX(Z,Z,-s*rr),ya.rotateZ(Z,Z,d*rr),ee&&ya.scale(Z,Z,[1,-1,1]),N&&ya.translate(Z,Z,ml.negate([],N)),Z}function ws(w){var p=w.width,s=w.height,d=w.altitude,g=d===void 0?Ra:d,L=w.pitch,N=L===void 0?0:L,K=w.nearZMultiplier,ee=K===void 0?1:K,Z=w.farZMultiplier,Se=Z===void 0?1:Z,pe=N*rr,Fe=Math.atan(.5/g),mt=Math.sin(Fe)*g/Math.sin(Math.PI/2-pe-Fe),Yt=Math.cos(Math.PI/2-pe)*mt+g;return{fov:2*Math.atan(s/2/g),aspect:p/s,focalDistance:g,near:ee,far:Yt*Se}}function gl(w){var p=w.width,s=w.height,d=w.pitch,g=w.altitude,L=w.nearZMultiplier,N=w.farZMultiplier,K=ws({width:p,height:s,altitude:g,pitch:d,nearZMultiplier:L,farZMultiplier:N}),ee=K.fov,Z=K.aspect,Se=K.near,pe=K.far,Fe=ya.perspective([],ee,Z,Se,pe);return Fe}function fu(w,p){var s=Object(q.a)(w,3),d=s[0],g=s[1],L=s[2],N=L===void 0?0:L;return Ns(Number.isFinite(d)&&Number.isFinite(g)&&Number.isFinite(N)),Js(p,[d,g,N,1])}function Gu(w,p){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,d=Object(q.a)(w,3),g=d[0],L=d[1],N=d[2];if(Ns(Number.isFinite(g)&&Number.isFinite(L),"invalid pixel coordinate"),Number.isFinite(N)){var K=Js(p,[g,L,N,1]);return K}var ee=Js(p,[g,L,0,1]),Z=Js(p,[g,L,1,1]),Se=ee[2],pe=Z[2],Fe=Se===pe?0:((s||0)-Se)/(pe-Se);return Na.lerp([],ee,Z,Fe)}var Qs=hs(),rl=function(){function w(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=p.width,d=p.height,g=p.viewMatrix,L=g===void 0?Qs:g,N=p.projectionMatrix,K=N===void 0?Qs:N;Object(J.a)(this,w),this.width=s||1,this.height=d||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=L,this.projectionMatrix=K;var ee=hs();ya.multiply(ee,ee,this.projectionMatrix),ya.multiply(ee,ee,this.viewMatrix),this.viewProjectionMatrix=ee;var Z=hs();ya.scale(Z,Z,[this.width/2,-this.height/2,1]),ya.translate(Z,Z,[1,-1,0]),ya.multiply(Z,Z,this.viewProjectionMatrix);var Se=ya.invert(hs(),Z);if(!Se)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=Z,this.pixelUnprojectionMatrix=Se,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(te.a)(w,[{key:"equals",value:function(s){return s instanceof w?s.width===this.width&&s.height===this.height&&ya.equals(s.projectionMatrix,this.projectionMatrix)&&ya.equals(s.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=d.topLeft,L=g===void 0?!0:g,N=this.projectPosition(s),K=fu(N,this.pixelProjectionMatrix),ee=Object(q.a)(K,2),Z=ee[0],Se=ee[1],pe=L?Se:this.height-Se;return s.length===2?[Z,pe]:[Z,pe,K[2]]}},{key:"unproject",value:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=d.topLeft,L=g===void 0?!0:g,N=d.targetZ,K=Object(q.a)(s,3),ee=K[0],Z=K[1],Se=K[2],pe=L?Z:this.height-Z,Fe=N&&N*this.pixelsPerMeter,mt=Gu([ee,pe,Se],this.pixelUnprojectionMatrix,Fe),Yt=this.unprojectPosition(mt),jt=Object(q.a)(Yt,3),Qt=jt[0],ur=jt[1],kr=jt[2];return Number.isFinite(Se)?[Qt,ur,kr]:Number.isFinite(N)?[Qt,ur,N]:[Qt,ur]}},{key:"projectPosition",value:function(s){var d=this.projectFlat(s),g=Object(q.a)(d,2),L=g[0],N=g[1],K=(s[2]||0)*this.pixelsPerMeter;return[L,N,K]}},{key:"unprojectPosition",value:function(s){var d=this.unprojectFlat(s),g=Object(q.a)(d,2),L=g[0],N=g[1],K=(s[2]||0)/this.pixelsPerMeter;return[L,N,K]}},{key:"projectFlat",value:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return s}},{key:"unprojectFlat",value:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return s}}]),w}();function hu(w){var p=w.width,s=w.height,d=w.bounds,g=w.minExtent,L=g===void 0?0:g,N=w.maxZoom,K=N===void 0?24:N,ee=w.padding,Z=ee===void 0?0:ee,Se=w.offset,pe=Se===void 0?[0,0]:Se,Fe=Object(q.a)(d,2),mt=Object(q.a)(Fe[0],2),Yt=mt[0],jt=mt[1],Qt=Object(q.a)(Fe[1],2),ur=Qt[0],kr=Qt[1];if(Number.isFinite(Z)){var on=Z;Z={top:on,bottom:on,left:on,right:on}}else Ns(Number.isFinite(Z.top)&&Number.isFinite(Z.bottom)&&Number.isFinite(Z.left)&&Number.isFinite(Z.right));var Gr=new pc({width:p,height:s,longitude:0,latitude:0,zoom:0}),ln=Gr.project([Yt,kr]),wn=Gr.project([ur,jt]),Gn=[Math.max(Math.abs(wn[0]-ln[0]),L),Math.max(Math.abs(wn[1]-ln[1]),L)],ii=[p-Z.left-Z.right-Math.abs(pe[0])*2,s-Z.top-Z.bottom-Math.abs(pe[1])*2];Ns(ii[0]>0&&ii[1]>0);var Vi=ii[0]/Gn[0],va=ii[1]/Gn[1],Ia=(Z.right-Z.left)/2/Vi,qu=(Z.bottom-Z.top)/2/va,ts=[(wn[0]+ln[0])/2+Ia,(wn[1]+ln[1])/2+qu],us=Gr.unproject(ts),Su=Gr.zoom+Math.log2(Math.abs(Math.min(Vi,va)));return{longitude:us[0],latitude:us[1],zoom:Math.min(Su,K)}}var pc=function(w){Object(ce.a)(p,w);function p(){var s,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=d.width,L=d.height,N=d.latitude,K=N===void 0?0:N,ee=d.longitude,Z=ee===void 0?0:ee,Se=d.zoom,pe=Se===void 0?0:Se,Fe=d.pitch,mt=Fe===void 0?0:Fe,Yt=d.bearing,jt=Yt===void 0?0:Yt,Qt=d.altitude,ur=Qt===void 0?1.5:Qt,kr=d.nearZMultiplier,on=d.farZMultiplier;Object(J.a)(this,p),g=g||1,L=L||1;var Gr=Ha(pe);ur=Math.max(.75,ur);var ln=xa([Z,K],Gr);ln[2]=0;var wn=gl({width:g,height:L,pitch:mt,bearing:jt,altitude:ur,nearZMultiplier:kr||1/L,farZMultiplier:on||1.01}),Gn=cu({height:L,center:ln,pitch:mt,bearing:jt,altitude:ur,flipY:!0});return s=Object(Il.a)(this,Object(fs.a)(p).call(this,{width:g,height:L,viewMatrix:Gn,projectionMatrix:wn})),s.latitude=K,s.longitude=Z,s.zoom=pe,s.pitch=mt,s.bearing=jt,s.altitude=ur,s.scale=Gr,s.center=ln,s.pixelsPerMeter=ha(Object(zs.a)(Object(zs.a)(s))).pixelsPerMeter[2],Object.freeze(Object(zs.a)(Object(zs.a)(s))),s}return Object(te.a)(p,[{key:"projectFlat",value:function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return xa(d,g)}},{key:"unprojectFlat",value:function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Co(d,g)}},{key:"getMapCenterByLngLatPosition",value:function(d){var g=d.lngLat,L=d.pos,N=Gu(L,this.pixelUnprojectionMatrix),K=xa(g,this.scale),ee=Na.add([],K,Na.negate([],N)),Z=Na.add([],this.center,ee);return Co(Z,this.scale)}},{key:"getLocationAtPoint",value:function(d){var g=d.lngLat,L=d.pos;return this.getMapCenterByLngLatPosition({lngLat:g,pos:L})}},{key:"fitBounds",value:function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},L=this.width,N=this.height,K=hu(Object.assign({width:L,height:N,bounds:d},g)),ee=K.longitude,Z=K.latitude,Se=K.zoom;return new p({width:L,height:N,longitude:ee,latitude:Z,zoom:Se})}}]),p}(rl),Pf=function(){function w(){we()(this,w),this.viewport=void 0}return Qe()(w,[{key:"syncWithMapCamera",value:function(s){var d=s.center,g=s.zoom,L=s.pitch,N=s.bearing,K=s.viewportHeight,ee=s.viewportWidth;this.viewport=new pc({width:ee,height:K,longitude:d&&d[0],latitude:d&&d[1],zoom:g,pitch:L,bearing:N})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(s,d){return this.viewport.projectFlat(s,d)}}]),w}(),da={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Oc,vc,qc,ef,tf,Qa,Au,qs,ps,Lc,mc,yl,nl,gc;function eu(w,p){var s=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),s.push.apply(s,d)}return s}function Hu(w){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?eu(Object(s),!0).forEach(function(d){fi()(w,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(s)):eu(Object(s)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(s,d))})}return w}o("BGjm")(`/* @antv/l7-maps */
.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:"";cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=Ic.a;var Rc={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Kl=0,wa=12,Dc="pk.eyJ1IjoibHp4dWUiLCJhIjoiYnhfTURyRSJ9.Ugm314vAKPHBzcPmY1p4KQ",Mf=(Oc=Object($r.injectable)(),vc=Object($r.inject)(de.TYPES.MapConfig),qc=Object($r.inject)(de.TYPES.IGlobalConfigService),ef=Object($r.inject)(de.TYPES.ILogService),tf=Object($r.inject)(de.TYPES.ICoordinateSystemService),Qa=Object($r.inject)(de.TYPES.IEventEmitter),Oc(Au=(qs=(gc=function(){function w(){var p=this;we()(this,w),this.map=void 0,Hn()(this,"config",ps,this),Hn()(this,"configService",Lc,this),Hn()(this,"logger",mc,this),Hn()(this,"coordinateSystemService",yl,this),Hn()(this,"eventEmitter",nl,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var s=p.map.getCenter().wrap(),d=s.lat,g=s.lng;p.viewport.syncWithMapCamera({bearing:p.map.getBearing(),center:[g,d],viewportHeight:p.map.transform.height,pitch:p.map.getPitch(),viewportWidth:p.map.transform.width,zoom:p.map.getZoom(),cameraHeight:0}),p.viewport.getZoom()>wa?p.coordinateSystemService.setCoordinateSystem(de.CoordinateSystem.LNGLAT_OFFSET):p.coordinateSystemService.setCoordinateSystem(de.CoordinateSystem.LNGLAT),p.cameraChangedCallback(p.viewport)}}return Qe()(w,[{key:"addMarkerContainer",value:function(){var s=this.map.getCanvasContainer();this.markerContainer=gn.a.create("div","l7-marker-container",s),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(s,d){de.MapServiceEvent.indexOf(s)!==-1?this.eventEmitter.on(s,d):this.map.on(Rc[s]||s,d)}},{key:"off",value:function(s,d){this.map.off(Rc[s]||s,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var s=this.map.transform;return[s.width,s.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(s){return this.map.setZoom(s)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(s){this.map.setCenter(s)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(s){this.map.setBearing(s)}},{key:"zoomIn",value:function(s,d){this.map.zoomIn(s,d)}},{key:"zoomOut",value:function(s,d){this.map.zoomOut(s,d)}},{key:"setPitch",value:function(s){return this.map.setPitch(s)}},{key:"panTo",value:function(s){this.map.panTo(s)}},{key:"panBy",value:function(s){this.panTo(s)}},{key:"fitBounds",value:function(s,d){this.map.fitBounds(s,d)}},{key:"setMaxZoom",value:function(s){this.map.setMaxZoom(s)}},{key:"setMinZoom",value:function(s){this.map.setMinZoom(s)}},{key:"setMapStatus",value:function(s){s.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),s.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),s.dragEnable===!1&&this.map.dragPan.disable(),s.dragEnable===!0&&this.map.dragPan.enable(),s.rotateEnable===!1&&this.map.dragRotate.disable(),s.rotateEnable===!0&&this.map.dragRotate.enable(),s.keyboardEnable===!1&&this.map.keyboard.disable(),s.keyboardEnable===!0&&this.map.keyboard.enable(),s.zoomEnable===!1&&this.map.scrollZoom.disable(),s.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(s,d){this.map.flyTo({zoom:s,center:d})}},{key:"setMapStyle",value:function(s){this.map.setStyle(this.getMapStyle(s))}},{key:"pixelToLngLat",value:function(s){return this.map.unproject(s)}},{key:"lngLatToPixel",value:function(s){return this.map.project(s)}},{key:"containerToLngLat",value:function(s){return this.map.unproject(s)}},{key:"lngLatToContainer",value:function(s){return this.map.project(s)}},{key:"lngLatToMercator",value:function(s,d){var g=window.mapboxgl.MercatorCoordinate.fromLngLat(s,d),L=g.x,N=L===void 0?0:L,K=g.y,ee=K===void 0?0:K,Z=g.z,Se=Z===void 0?0:Z;return{x:N,y:ee,z:Se}}},{key:"getModelMatrix",value:function(s,d,g){var L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],N=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},K=window.mapboxgl.MercatorCoordinate.fromLngLat(s,d),ee=K.meterInMercatorCoordinateUnits(),Z=Ar.b.create();return Ar.b.translate(Z,Z,Ar.d.fromValues(K.x-N.x,K.y-N.y,K.z||0-N.z)),Ar.b.scale(Z,Z,Ar.d.fromValues(ee*L[0],-ee*L[1],ee*L[2])),Ar.b.rotateX(Z,Z,g[0]),Ar.b.rotateY(Z,Z,g[1]),Ar.b.rotateZ(Z,Z,g[2]),Z}},{key:"init",value:function(){var p=Er()(Bt.a.mark(function d(){var g,L,N,K,ee,Z,Se,pe,Fe,mt,Yt,jt,Qt;return Bt.a.wrap(function(kr){for(;;)switch(kr.prev=kr.next){case 0:g=this.config,L=g.id,N=L===void 0?"map":L,K=g.attributionControl,ee=K===void 0?!1:K,Z=g.style,Se=Z===void 0?"light":Z,pe=g.token,Fe=pe===void 0?Dc:pe,mt=g.rotation,Yt=mt===void 0?0:mt,jt=g.mapInstance,Qt=_n()(g,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new Pf,!jt&&!window.mapboxgl&&this.logger.error(this.configService.getSceneWarninfo("SDK")),Fe===Dc&&Se!=="blank"&&!window.mapboxgl.accessToken&&!jt&&this.logger.warn(this.configService.getSceneWarninfo("MapToken")),!jt&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=Fe),jt?(this.map=jt,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(N),this.map=new window.mapboxgl.Map(Hu({container:this.$mapContainer,style:this.getMapStyle(Se),attributionControl:ee,bearing:Yt},Qt))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return kr.stop()}},d,this)}));function s(){return p.apply(this,arguments)}return s}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(s){for(var d,g=arguments.length,L=new Array(g>1?g-1:0),N=1;N<g;N++)L[N-1]=arguments[N];(d=this.eventEmitter).emit.apply(d,[s].concat(L))}},{key:"once",value:function(s){for(var d,g=arguments.length,L=new Array(g>1?g-1:0),N=1;N<g;N++)L[N-1]=arguments[N];(d=this.eventEmitter).once.apply(d,[s].concat(L))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(s){var d=this.map.getCanvas(),g=s==="jpg"?d==null?void 0:d.toDataURL("image/jpeg"):d==null?void 0:d.toDataURL("image/png");return g}},{key:"onCameraChanged",value:function(s){this.cameraChangedCallback=s}},{key:"creatAmapContainer",value:function(s){var d=s;typeof s=="string"&&(d=document.getElementById(s));var g=document.createElement("div");return g.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,g.id="l7_mapbox_div"+Kl++,d.appendChild(g),g}},{key:"getMapStyle",value:function(s){return typeof s!="string"?s:da[s]?da[s]:s}}]),w}(),gc),ps=H()(qs.prototype,"config",[vc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lc=H()(qs.prototype,"configService",[qc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mc=H()(qs.prototype,"logger",[ef],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yl=H()(qs.prototype,"coordinateSystemService",[tf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nl=H()(qs.prototype,"eventEmitter",[Qa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qs))||Au);function yc(w){var p=zc();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function zc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}o("BGjm")(`/* @antv/l7-maps */
.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var $l=function(w){pr()(s,w);var p=yc(s);function s(){return we()(this,s),p.apply(this,arguments)}return Qe()(s,[{key:"getServiceConstructor",value:function(){return Mf}}]),s}(sr);function Zu(w,p){var s=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),s.push.apply(s,d)}return s}function _u(w){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?Zu(Object(s),!0).forEach(function(d){Ol(w,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(s)):Zu(Object(s)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(s,d))})}return w}function Ol(w,p,s){return p in w?Object.defineProperty(w,p,{value:s,enumerable:!0,configurable:!0,writable:!0}):w[p]=s,w}function Fo(w,p){return Rl(w)||Nc(w,p)||Ll(w,p)||Jl()}function Jl(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ll(w,p){if(!!w){if(typeof w=="string")return xl(w,p);var s=Object.prototype.toString.call(w).slice(8,-1);if(s==="Object"&&w.constructor&&(s=w.constructor.name),s==="Map"||s==="Set")return Array.from(w);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return xl(w,p)}}function xl(w,p){(p==null||p>w.length)&&(p=w.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=w[s];return d}function Nc(w,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))){var s=[],d=!0,g=!1,L=void 0;try{for(var N=w[Symbol.iterator](),K;!(d=(K=N.next()).done)&&(s.push(K.value),!(p&&s.length===p));d=!0);}catch(ee){g=!0,L=ee}finally{try{!d&&N.return!=null&&N.return()}finally{if(g)throw L}}return s}}function Rl(w){if(Array.isArray(w))return w}var tu=st.a.memo(function(w){var p=w.style,s=w.className,d=w.map,g=w.option,L=w.onSceneLoaded,N=Object(Oe.createRef)(),K=Object(Oe.useState)(),ee=Fo(K,2),Z=ee[0],Se=ee[1];return Object(Oe.useEffect)(function(){var pe=new Ct.Scene(_u(_u({id:N.current},g),{},{map:new $l(d)}));return pe.on("loaded",function(){Se(pe),L&&L(pe)}),function(){pe.destroy()}},[]),Object(Oe.useEffect)(function(){Z&&d.style&&Z.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(Oe.useEffect)(function(){Z&&d.zoom&&Z.setZoom(d.zoom)},[d.zoom]),Object(Oe.useEffect)(function(){Z&&d.center&&Z.setCenter(d.center)},[JSON.stringify(d.center)]),Object(Oe.useEffect)(function(){Z&&d.pitch!==void 0&&Z.setPitch(d.pitch||0)},[d.pitch]),Object(Oe.useEffect)(function(){Z&&d.rotation&&Z.setRotation(d.rotation)},[d.rotation]),st.a.createElement(dt.Provider,{value:Z},Object(Oe.createElement)("div",{ref:N,style:p,className:s},Z&&w.children))}),mf=tu,gf=o("PJYZ"),rf=o.n(gf),bl=o("QkVN"),Fa=o.n(bl),il=o("uhBA"),Dl=o("cDf5"),xc=o.n(Dl),Fc=o("zvhG"),zl=o.n(Fc);function If(w,p){var s;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(s=Of(w))||p&&w&&typeof w.length=="number"){s&&(w=s);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Z){throw Z},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=w[Symbol.iterator]()},n:function(){var Z=s.next();return L=Z.done,Z},e:function(Z){N=!0,K=Z},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function Of(w,p){if(!!w){if(typeof w=="string")return nf(w,p);var s=Object.prototype.toString.call(w).slice(8,-1);if(s==="Object"&&w.constructor&&(s=w.constructor.name),s==="Map"||s==="Set")return Array.from(w);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return nf(w,p)}}function nf(w,p){(p==null||p>w.length)&&(p=w.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=w[s];return d}var Sl;function Ql(w,p,s){var d=s-p,g=((w-p)%d+d)%d+p;return g===p?s:g}function Cu(w,p,s){return Math.min(s,Math.max(p,w))}function Bs(w,p,s){return w*(1-s)+p*s}function al(w,p,s,d){var g=new zl.a(w,p,s,d);return function(L){return g.solve(L)}}var Bc=al(.25,.1,.25,1);function Wu(){return window.matchMedia?(Sl==null&&(Sl=window.matchMedia("(prefers-reduced-motion: reduce)")),Sl.matches):!1}function Ba(w,p){var s={},d=If(p),g;try{for(d.s();!(g=d.n()).done;){var L=g.value;L in w&&(s[L]=w[L])}}catch(N){d.e(N)}finally{d.f()}return s}var du=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date),ol=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,sl=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;function zi(w){var p=ol(w);return{cancel:function(){return sl(p)}}}var pa=function(){Qe()(w,null,[{key:"convert",value:function(s){return s instanceof w?s:new w(s)}}]);function w(p,s){we()(this,w),this.ne=void 0,this.sw=void 0,p&&(s?this.setSouthWest(p).setNorthEast(s):p.length===4?this.setSouthWest([p[0],p[1]]).setNorthEast([p[2],p[3]]):this.setSouthWest(p[0]).setNorthEast(p[1]))}return Qe()(w,[{key:"setNorthEast",value:function(s){return this.ne=s instanceof Sa?new Sa(s.lng,s.lat):Sa.convert(s),this}},{key:"setSouthWest",value:function(s){return this.sw=s instanceof Sa?new Sa(s.lng,s.lat):Sa.convert(s),this}},{key:"extend",value:function(s){var d=this.sw,g=this.ne,L,N;if(s instanceof Sa)L=s,N=s;else if(s instanceof w){if(L=s.sw,N=s.ne,!L||!N)return this}else{if(Array.isArray(s))if(s.length===4||s.every(Array.isArray)){var K=s;return this.extend(w.convert(K))}else{var ee=s;return this.extend(Sa.convert(ee))}return this}return!d&&!g?(this.sw=new Sa(L.lng,L.lat),this.ne=new Sa(N.lng,N.lat)):(d.lng=Math.min(L.lng,d.lng),d.lat=Math.min(L.lat,d.lat),g.lng=Math.max(N.lng,g.lng),g.lat=Math.max(N.lat,g.lat)),this}},{key:"getCenter",value:function(){return new Sa((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new Sa(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new Sa(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(s){var d=Sa.convert(s),g=d.lng,L=d.lat,N=this.sw.lat<=L&&L<=this.ne.lat,K=this.sw.lng<=g&&g<=this.ne.lng;return this.sw.lng>this.ne.lng&&(K=this.sw.lng>=g&&g>=this.ne.lng),N&&K}}]),w}(),Ps=63710088e-1,Sa=function(){Qe()(w,null,[{key:"convert",value:function(s){if(s instanceof w)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new w(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&xc()(s)==="object"&&s!==null){var d="lng"in s?s.lng:s.lon;return new w(Number(d),Number(s.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]);function w(p,s){if(we()(this,w),this.lng=void 0,this.lat=void 0,isNaN(p)||isNaN(s))throw new Error("Invalid LngLat object: (".concat(p,", ").concat(s,")"));if(this.lng=+p,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return Qe()(w,[{key:"wrap",value:function(){return new w(Ql(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toBounds",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=40075017,g=360*s/d,L=g/Math.cos(Math.PI/180*this.lat);return new pa(new w(this.lng-L,this.lat-g),new w(this.lng+L,this.lat+g))}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(s){var d=Math.PI/180,g=this.lat*d,L=s.lat*d,N=Math.sin(g)*Math.sin(L)+Math.cos(g)*Math.cos(L)*Math.cos((s.lng-this.lng)*d),K=Ps*Math.acos(Math.min(N,1));return K}}]),w}(),Gi=function(){Qe()(w,null,[{key:"convert",value:function(s){return s instanceof w?s:Array.isArray(s)?new w(s[0],s[1]):s}}]);function w(p,s){we()(this,w),this.x=void 0,this.y=void 0,this.x=p,this.y=s}return Qe()(w,[{key:"clone",value:function(){return new w(this.x,this.y)}},{key:"_add",value:function(s){return this.x+=s.x,this.y+=s.y,this}},{key:"add",value:function(s){return this.clone()._add(s)}},{key:"_sub",value:function(s){return this.x-=s.x,this.y-=s.y,this}},{key:"sub",value:function(s){return this.clone()._sub(s)}},{key:"_multByPoint",value:function(s){return this.x*=s.x,this.y*=s.y,this}},{key:"multByPoint",value:function(s){return this.clone()._multByPoint(s)}},{key:"_divByPoint",value:function(s){return this.x/=s.x,this.y/=s.y,this}},{key:"divByPoint",value:function(s){return this.clone()._divByPoint(s)}},{key:"_mult",value:function(s){return this.x*=s,this.y*=s,this}},{key:"mult",value:function(s){return this.clone()._mult(s)}},{key:"_div",value:function(s){return this.x/=s,this.y/=s,this}},{key:"div",value:function(s){return this.clone()._div(s)}},{key:"_rotate",value:function(s){var d=Math.cos(s),g=Math.sin(s),L=d*this.x-g*this.y,N=g*this.x+d*this.y;return this.x=L,this.y=N,this}},{key:"rotate",value:function(s){return this.clone()._rotate(s)}},{key:"_rotateAround",value:function(s,d){var g=Math.cos(s),L=Math.sin(s),N=d.x+g*(this.x-d.x)-L*(this.y-d.y),K=d.y+L*(this.x-d.x)+g*(this.y-d.y);return this.x=N,this.y=K,this}},{key:"roateAround",value:function(s,d){return this.clone()._rotateAround(s,d)}},{key:"_matMult",value:function(s){var d=s[0]*this.x+s[1]*this.y,g=s[2]*this.x+s[3]*this.y;return this.x=d,this.y=g,this}},{key:"matMult",value:function(s){return this.clone()._matMult(s)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var s=this.y;return this.y=this.x,this.x=-s,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(s){return this.x===s.x&&this.y===s.y}},{key:"dist",value:function(s){return Math.sqrt(this.distSqr(s))}},{key:"distSqr",value:function(s){var d=s.x-this.x,g=s.y-this.y;return d*d+g*g}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(s){return Math.atan2(this.y-s.y,this.x-s.x)}},{key:"angleWith",value:function(s){return this.angleWithSep(s.x,s.y)}},{key:"angleWithSep",value:function(s,d){return Math.atan2(this.x*d-this.y*s,this.x*s+this.y*d)}}]),w}(),ql=function(){function w(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(we()(this,w),this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,isNaN(p)||p<0||isNaN(s)||s<0||isNaN(d)||d<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=p,this.bottom=s,this.left=d,this.right=g}return Qe()(w,[{key:"interpolate",value:function(s,d,g){return d.top!=null&&s.top!=null&&(this.top=Bs(s.top,d.top,g)),d.bottom!=null&&s.bottom!=null&&(this.bottom=Bs(s.bottom,d.bottom,g)),d.left!=null&&s.left!=null&&(this.left=Bs(s.left,d.left,g)),d.right!=null&&s.right!=null&&(this.right=Bs(s.right,d.right,g)),this}},{key:"getCenter",value:function(s,d){var g=Cu((this.left+s-this.right)/2,0,s),L=Cu((this.top+d-this.bottom)/2,0,d);return new Gi(g,L)}},{key:"equals",value:function(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}},{key:"clone",value:function(){return new w(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),w}(),yf=2*Math.PI*Ps;function as(w){return yf*Math.cos(w*Math.PI/180)}function ul(w){return(180+w)/360}function pu(w){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+w*Math.PI/360)))/360}function Xu(w,p){return w/as(p)}function io(w){return w*360-180}function os(w){var p=180-w*360;return 360/Math.PI*Math.atan(Math.exp(p*Math.PI/180))-90}function Nl(w,p){return w*as(os(p))}function lo(w){return 1/Math.cos(w*Math.PI/180)}var In=function(){Qe()(w,null,[{key:"fromLngLat",value:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,g=Sa.convert(s);return new w(ul(g.lng),pu(g.lat),Xu(d,g.lat))}}]);function w(p,s){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;we()(this,w),this.x=void 0,this.y=void 0,this.z=void 0,this.x=+p,this.y=+s,this.z=+d}return Qe()(w,[{key:"toLngLat",value:function(){return new Sa(io(this.x),os(this.y))}},{key:"toAltitude",value:function(){return Nl(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/yf*lo(os(this.y))}}]),w}();function ks(w,p){var s;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(s=bc(w))||p&&w&&typeof w.length=="number"){s&&(w=s);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Z){throw Z},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=w[Symbol.iterator]()},n:function(){var Z=s.next();return L=Z.done,Z},e:function(Z){N=!0,K=Z},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function bc(w,p){if(!!w){if(typeof w=="string")return El(w,p);var s=Object.prototype.toString.call(w).slice(8,-1);if(s==="Object"&&w.constructor&&(s=w.constructor.name),s==="Map"||s==="Set")return Array.from(w);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return El(w,p)}}function El(w,p){(p==null||p>w.length)&&(p=w.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=w[s];return d}var wu=8192,js=function(){Qe()(w,[{key:"minZoom",get:function(){return this._minZoom},set:function(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}},{key:"minPitch",get:function(){return this._minPitch},set:function(s){this._minPitch!==s&&(this._minPitch=s,this._pitch=Math.max(this._pitch,s))}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(s){this._maxPitch!==s&&(this._maxPitch=s,this._pitch=Math.min(this._pitch,s))}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new Gi(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(s){var d=-Ql(s,-180,180)*Math.PI/180;this.angle!==d&&(this.unmodified=!1,this.angle=d,this.calcMatrices(),this.rotationMatrix=Ar.a.create(),Ar.a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(s){var d=Cu(s,this._minPitch,this._maxPitch)/180*Math.PI;this._pitch!==d&&(this.unmodified=!1,this._pitch=d,this.calcMatrices())}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this.unmodified=!1,this._fov=s/180*Math.PI,this.calcMatrices())}},{key:"zoom",get:function(){return this._zoom},set:function(s){var d=Math.min(Math.max(s,this._minZoom),this._maxZoom);this._zoom!==d&&(this.unmodified=!1,this._zoom=d,this.scale=this.zoomScale(d),this.tileZoom=Math.floor(d),this.zoomFraction=d-this.tileZoom,this.constrain(),this.calcMatrices())}},{key:"center",get:function(){return this._center},set:function(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this.unmodified=!1,this._center=s,this.constrain(),this.calcMatrices())}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(s){this.edgeInsets.equals(s)||(this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,s,1),this.calcMatrices())}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}}]);function w(p,s,d,g,L){we()(this,w),this.tileSize=void 0,this.tileZoom=void 0,this.lngRange=void 0,this.latRange=void 0,this.maxValidLatitude=void 0,this.scale=void 0,this.width=void 0,this.height=void 0,this.angle=void 0,this.rotationMatrix=void 0,this.pixelsToGLUnits=void 0,this.cameraToCenterDistance=void 0,this.mercatorMatrix=void 0,this.projMatrix=void 0,this.invProjMatrix=void 0,this.alignedProjMatrix=void 0,this.pixelMatrix=void 0,this.pixelMatrixInverse=void 0,this.glCoordMatrix=void 0,this.labelPlaneMatrix=void 0,this._fov=void 0,this._pitch=void 0,this._zoom=void 0,this._renderWorldCopies=void 0,this._minZoom=void 0,this._maxZoom=void 0,this._minPitch=void 0,this._maxPitch=void 0,this._center=void 0,this.zoomFraction=void 0,this.unmodified=void 0,this.edgeInsets=void 0,this.constraining=void 0,this.posMatrixCache=void 0,this.alignedPosMatrixCache=void 0,this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=L===void 0?!0:L,this._minZoom=p||0,this._maxZoom=s||22,this._minPitch=d==null?0:d,this._maxPitch=g==null?60:g,this.setMaxBounds(),this.width=0,this.height=0,this._center=new Sa(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new ql,this.posMatrixCache={},this.alignedPosMatrixCache={}}return Qe()(w,[{key:"clone",value:function(){var s=new w(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return s.tileSize=this.tileSize,s.latRange=this.latRange,s.width=this.width,s.height=this.height,s.center=this._center,s.zoom=this.zoom,s.angle=this.angle,s.fov=this._fov,s.pitch=this._pitch,s.unmodified=this.unmodified,s.edgeInsets=this.edgeInsets.clone(),s.calcMatrices(),s}},{key:"isPaddingEqual",value:function(s){return this.edgeInsets.equals(s)}},{key:"interpolatePadding",value:function(s,d,g){this.unmodified=!1,this.edgeInsets.interpolate(s,d,g),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(s){var d=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,d)}},{key:"resize",value:function(s,d){this.width=s,this.height=d,this.pixelsToGLUnits=[2/s,-2/d],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(s){return Math.pow(2,s)}},{key:"scaleZoom",value:function(s){return Math.log(s)/Math.LN2}},{key:"project",value:function(s){var d=Cu(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new Gi(ul(s.lng)*this.worldSize,pu(d)*this.worldSize)}},{key:"unproject",value:function(s){return new In(s.x/this.worldSize,s.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(s,d){var g=this.pointCoordinate(d),L=this.pointCoordinate(this.centerPoint),N=this.locationCoordinate(s),K=new In(N.x-(g.x-L.x),N.y-(g.y-L.y));this.center=this.coordinateLocation(K),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(s){var d=0,g=new Float32Array([s.x,s.y,0,1]),L=new Float32Array([s.x,s.y,1,1]);Ar.e.transformMat4(g,g,this.pixelMatrixInverse),Ar.e.transformMat4(L,L,this.pixelMatrixInverse);var N=g[3],K=L[3],ee=g[0]/N,Z=L[0]/K,Se=g[1]/N,pe=L[1]/K,Fe=g[2]/N,mt=L[2]/K,Yt=Fe===mt?0:(d-Fe)/(mt-Fe);return new In(Bs(ee,Z,Yt)/this.worldSize,Bs(Se,pe,Yt)/this.worldSize)}},{key:"getBounds",value:function(){return new pa().extend(this.pointLocation(new Gi(0,0))).extend(this.pointLocation(new Gi(this.width,0))).extend(this.pointLocation(new Gi(this.width,this.height))).extend(this.pointLocation(new Gi(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new pa([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var s=this.pointCoordinate(new Gi(0,0)),d=new Float32Array([s.x*this.worldSize,s.y*this.worldSize,0,1]),g=Ar.e.transformMat4(d,d,this.pixelMatrix);return g[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var s=this._pitch,d=Math.tan(s)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Gi(0,d))}},{key:"getCameraQueryGeometry",value:function(s){var d=this.getCameraPoint();if(s.length===1)return[s[0],d];var g=d.x,L=d.y,N=d.x,K=d.y,ee=ks(s),Z;try{for(ee.s();!(Z=ee.n()).done;){var Se=Z.value;g=Math.min(g,Se.x),L=Math.min(L,Se.y),N=Math.max(N,Se.x),K=Math.max(K,Se.y)}}catch(pe){ee.e(pe)}finally{ee.f()}return[new Gi(g,L),new Gi(N,L),new Gi(N,K),new Gi(g,K),new Gi(g,L)]}},{key:"coordinatePoint",value:function(s){var d=Ar.e.fromValues(s.x*this.worldSize,s.y*this.worldSize,0,1);return Ar.e.transformMat4(d,d,this.pixelMatrix),new Gi(d[0]/d[3],d[1]/d[3])}},{key:"locationPoint",value:function(s){return this.coordinatePoint(this.locationCoordinate(s))}},{key:"pointLocation",value:function(s){return this.coordinateLocation(this.pointCoordinate(s))}},{key:"locationCoordinate",value:function(s){return In.fromLngLat(s)}},{key:"coordinateLocation",value:function(s){return s.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!(!this.center||!this.width||!this.height||this.constraining)){this.constraining=!0;var s=-90,d=90,g=-180,L=180,N,K,ee,Z,Se=this.size,pe=this.unmodified;if(this.latRange){var Fe=this.latRange;s=pu(Fe[1])*this.worldSize,d=pu(Fe[0])*this.worldSize,N=d-s<Se.y?Se.y/(d-s):0}if(this.lngRange){var mt=this.lngRange;g=ul(mt[0])*this.worldSize,L=ul(mt[1])*this.worldSize,K=L-g<Se.x?Se.x/(L-g):0}var Yt=this.point,jt=Math.max(K||0,N||0);if(jt){this.center=this.unproject(new Gi(K?(L+g)/2:Yt.x,N?(d+s)/2:Yt.y)),this.zoom+=this.scaleZoom(jt),this.unmodified=pe,this.constraining=!1;return}if(this.latRange){var Qt=Yt.y,ur=Se.y/2;Qt-ur<s&&(Z=s+ur),Qt+ur>d&&(Z=d-ur)}if(this.lngRange){var kr=Yt.x,on=Se.x/2;kr-on<g&&(ee=g+on),kr+on>L&&(ee=L-on)}(ee!==void 0||Z!==void 0)&&(this.center=this.unproject(new Gi(ee!==void 0?ee:Yt.x,Z!==void 0?Z:Yt.y))),this.unmodified=pe,this.constraining=!1}}},{key:"calcMatrices",value:function(){if(!!this.height){var s=this._fov/2,d=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(s)*this.height;var g=Math.PI/2+this._pitch,L=this._fov*(.5+d.y/this.height),N=Math.sin(L)*this.cameraToCenterDistance/Math.sin(Cu(Math.PI-g-L,.01,Math.PI-.01)),K=this.point,ee=K.x,Z=K.y,Se=Math.cos(Math.PI/2-this._pitch)*N+this.cameraToCenterDistance,pe=Se*1.01,Fe=this.height/50,mt=Ar.b.create();Ar.b.perspective(mt,this._fov,this.width/this.height,Fe,pe),mt[8]=-d.x*2/this.width,mt[9]=d.y*2/this.height,Ar.b.scale(mt,mt,[1,-1,1]),Ar.b.translate(mt,mt,[0,0,-this.cameraToCenterDistance]),Ar.b.rotateX(mt,mt,this._pitch),Ar.b.rotateZ(mt,mt,this.angle),Ar.b.translate(mt,mt,[-ee,-Z,0]),this.mercatorMatrix=Ar.b.scale(Ar.b.create(),mt,[this.worldSize,this.worldSize,this.worldSize]),Ar.b.scale(mt,mt,Ar.d.fromValues(1,1,Xu(1,this.center.lat)*this.worldSize)),this.projMatrix=mt,this.invProjMatrix=Ar.b.invert(Ar.b.create(),this.projMatrix);var Yt=this.width%2/2,jt=this.height%2/2,Qt=Math.cos(this.angle),ur=Math.sin(this.angle),kr=ee-Math.round(ee)+Qt*Yt+ur*jt,on=Z-Math.round(Z)+Qt*jt+ur*Yt,Gr=Ar.b.clone(mt);if(Ar.b.translate(Gr,Gr,[kr>.5?kr-1:kr,on>.5?on-1:on,0]),this.alignedProjMatrix=Gr,mt=Ar.b.create(),Ar.b.scale(mt,mt,[this.width/2,-this.height/2,1]),Ar.b.translate(mt,mt,[1,-1,0]),this.labelPlaneMatrix=mt,mt=Ar.b.create(),Ar.b.scale(mt,mt,[1,-1,1]),Ar.b.translate(mt,mt,[-1,-1,0]),Ar.b.scale(mt,mt,[2/this.width,2/this.height,1]),this.glCoordMatrix=mt,this.pixelMatrix=Ar.b.multiply(Ar.b.create(),this.labelPlaneMatrix,this.projMatrix),mt=Ar.b.invert(Ar.b.create(),this.pixelMatrix),!mt)throw new Error("failed to invert matrix");this.pixelMatrixInverse=mt,this.posMatrixCache={},this.alignedPosMatrixCache={}}}}]),w}(),qi=function w(p){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};we()(this,w),this.type=void 0,Fa()(this,s),this.type=p};function qr(w){var p=kc();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function kc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Sc=function(w){pr()(s,w);var p=qr(s);function s(d){var g;we()(this,s),g=p.call(this),g.transform=void 0,g.options=void 0,g.moving=void 0,g.zooming=void 0,g.rotating=void 0,g.pitching=void 0,g.padding=void 0,g.bearingSnap=void 0,g.easeEndTimeoutID=void 0,g.easeStart=void 0,g.easeOptions=void 0,g.easeId=void 0,g.onEaseFrame=void 0,g.onEaseEnd=void 0,g.easeFrameId=void 0,g.renderFrameCallback=function(){var Se=Math.min((du()-g.easeStart)/g.easeOptions.duration,1);g.onEaseFrame(g.easeOptions.easing(Se)),Se<1?g.easeFrameId=g.requestRenderFrame(g.renderFrameCallback):g.stop()},g.options=d;var L=d.minZoom,N=d.maxZoom,K=d.minPitch,ee=d.maxPitch,Z=d.renderWorldCopies;return g.moving=!1,g.zooming=!1,g.bearingSnap=d.bearingSnap,g.transform=new js(L,N,K,ee,Z),g}return Qe()(s,[{key:"requestRenderFrame",value:function(g){return 0}},{key:"cancelRenderFrame",value:function(g){}},{key:"getCenter",value:function(){var g=this.transform.center,L=g.lng,N=g.lat;return new Sa(L,N)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(g,L){return this.jumpTo({center:g},L)}},{key:"setPitch",value:function(g,L){return this.jumpTo({pitch:g},L),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(g,L,N){return this.easeTo(Fa()({center:g},L),N)}},{key:"zoomOut",value:function(g,L){return this.zoomTo(this.getZoom()-1,g,L),this}},{key:"setBearing",value:function(g,L){return this.jumpTo({bearing:g},L),this}},{key:"setZoom",value:function(g,L){return this.jumpTo({zoom:g},L),this}},{key:"zoomIn",value:function(g,L){return this.zoomTo(this.getZoom()+1,g,L),this}},{key:"zoomTo",value:function(g,L,N){return this.easeTo(Fa()({zoom:g},L),N)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(g,L){return this.jumpTo({padding:g},L),this}},{key:"rotateTo",value:function(g,L,N){return this.easeTo(Fa()({bearing:g},L),N)}},{key:"resetNorth",value:function(g,L){return this.rotateTo(0,Fa()({duration:1e3},g),L),this}},{key:"resetNorthPitch",value:function(g,L){return this.easeTo(Fa()({bearing:0,pitch:0,duration:1e3},g),L),this}},{key:"fitBounds",value:function(g,L,N){return this.fitInternal(this.cameraForBounds(g,L),L,N)}},{key:"cameraForBounds",value:function(g,L){return g=pa.convert(g),this.cameraForBoxAndBearing(g.getNorthWest(),g.getSouthEast(),0,L)}},{key:"snapToNorth",value:function(g,L){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(g,L):this}},{key:"jumpTo",value:function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},L=arguments.length>1?arguments[1]:void 0;this.stop();var N=this.transform,K=!1,ee=!1,Z=!1;return g.zoom&&N.zoom!==+g.zoom&&(K=!0,N.zoom=+g.zoom),g.center!==void 0&&(N.center=Sa.convert(g.center)),g.bearing&&N.bearing!==+g.bearing&&(ee=!0,N.bearing=+g.bearing),g.pitch&&N.pitch!==+g.pitch&&(Z=!0,N.pitch=+g.pitch),g.padding!=null&&!N.isPaddingEqual(g.padding)&&(N.padding=g.padding),this.emit("movestart",new qi("movestart",L)),this.emit("move",new qi("move",L)),K&&(this.emit("zoomstart",new qi("zoomstart",L)),this.emit("zoom",new qi("zoom",L)),this.emit("zoomend",new qi("zoomend",L))),ee&&(this.emit("rotatestart",new qi("rotatestart",L)),this.emit("rotate",new qi("rotate",L)),this.emit("rotateend",new qi("rotateend",L))),Z&&(this.emit("pitchstart",new qi("pitchstart",L)),this.emit("pitch",new qi("pitch",L)),this.emit("pitchend",new qi("pitchend",L))),this.emit("moveend",new qi("moveend",L))}},{key:"easeTo",value:function(){var g=this,L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=arguments.length>1?arguments[1]:void 0;L=Fa()({offset:[0,0],duration:500,easing:Bc},L),(L.animate===!1||!L.essential&&Wu())&&(L.duration=0);var K=this.transform,ee=this.getZoom(),Z=this.getBearing(),Se=this.getPitch(),pe=this.getPadding(),Fe=L.zoom?+L.zoom:ee,mt=L.bearing?this.normalizeBearing(L.bearing,Z):Z,Yt=L.pitch?+L.pitch:Se,jt=L.padding?L.padding:K.padding,Qt=Gi.convert(L.offset),ur=K.centerPoint.add(Qt),kr=K.pointLocation(ur),on=Sa.convert(L.center||kr);this.normalizeCenter(on);var Gr=K.project(kr),ln=K.project(on).sub(Gr),wn=K.zoomScale(Fe-ee),Gn,ii;L.around&&(Gn=Sa.convert(L.around),ii=K.locationPoint(Gn));var Vi={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||Fe!==ee,this.rotating=this.rotating||Z!==mt,this.pitching=this.pitching||Yt!==Se,this.padding=!K.isPaddingEqual(jt),this.easeId=L.easeId,this.prepareEase(N,L.noMoveStart,Vi),clearTimeout(this.easeEndTimeoutID),this.ease(function(va){if(g.zooming&&(K.zoom=Bs(ee,Fe,va)),g.rotating&&(K.bearing=Bs(Z,mt,va)),g.pitching&&(K.pitch=Bs(Se,Yt,va)),g.padding&&(K.interpolatePadding(pe,jt,va),ur=K.centerPoint.add(Qt)),Gn)K.setLocationAtPoint(Gn,ii);else{var Ia=K.zoomScale(K.zoom-ee),qu=Fe>ee?Math.min(2,wn):Math.max(.5,wn),ts=Math.pow(qu,1-va),us=K.unproject(Gr.add(ln.mult(va*ts)).mult(Ia));K.setLocationAtPoint(K.renderWorldCopies?us.wrap():us,ur)}g.fireMoveEvents(N)},function(va){g.afterEase(N,va)},L),this}},{key:"flyTo",value:function(){var g=this,L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=arguments.length>1?arguments[1]:void 0;if(!L.essential&&Wu()){var K=Ba(L,["center","zoom","bearing","pitch","around"]);return this.jumpTo(K,N)}this.stop(),L=Fa()({offset:[0,0],speed:1.2,curve:1.42,easing:Bc},L);var ee=this.transform,Z=this.getZoom(),Se=this.getBearing(),pe=this.getPitch(),Fe=this.getPadding(),mt=L.zoom?Cu(+L.zoom,ee.minZoom,ee.maxZoom):Z,Yt=L.bearing?this.normalizeBearing(L.bearing,Se):Se,jt=L.pitch?+L.pitch:pe,Qt="padding"in L?L.padding:ee.padding,ur=ee.zoomScale(mt-Z),kr=Gi.convert(L.offset),on=ee.centerPoint.add(kr),Gr=ee.pointLocation(on),ln=Sa.convert(L.center||Gr);this.normalizeCenter(ln);var wn=ee.project(Gr),Gn=ee.project(ln).sub(wn),ii=L.curve,Vi=Math.max(ee.width,ee.height),va=Vi/ur,Ia=Gn.mag();if("minZoom"in L){var qu=Cu(Math.min(L.minZoom,Z,mt),ee.minZoom,ee.maxZoom),ts=Vi/ee.zoomScale(qu-Z);ii=Math.sqrt(ts/Ia*2)}var us=ii*ii;function Su(po){var vl=(va*va-Vi*Vi+(po?-1:1)*us*us*Ia*Ia)/(2*(po?va:Vi)*us*Ia);return Math.log(Math.sqrt(vl*vl+1)-vl)}function Nf(po){return(Math.exp(po)-Math.exp(-po))/2}function Ml(po){return(Math.exp(po)+Math.exp(-po))/2}function Wc(po){return Nf(po)/Ml(po)}var _a=Su(0),Da=function(vl){return Ml(_a)/Ml(_a+ii*vl)},wc=function(vl){return Vi*((Ml(_a)*Wc(_a+ii*vl)-Nf(_a))/us)/Ia},pl=(Su(1)-_a)/ii;if(Math.abs(Ia)<1e-6||!isFinite(pl)){if(Math.abs(Vi-va)<1e-6)return this.easeTo(L,N);var Xc=va<Vi?-1:1;pl=Math.abs(Math.log(va/Vi))/ii,wc=function(){return 0},Da=function(vl){return Math.exp(Xc*ii*vl)}}if("duration"in L)L.duration=+L.duration;else{var Jf="screenSpeed"in L?+L.screenSpeed/ii:+L.speed;L.duration=1e3*pl/Jf}return L.maxDuration&&L.duration>L.maxDuration&&(L.duration=0),this.zooming=!0,this.rotating=Se!==Yt,this.pitching=jt!==pe,this.padding=!ee.isPaddingEqual(Qt),this.prepareEase(N,!1),this.ease(function(po){var vl=po*pl,hf=1/Da(vl);ee.zoom=po===1?mt:Z+ee.scaleZoom(hf),g.rotating&&(ee.bearing=Bs(Se,Yt,po)),g.pitching&&(ee.pitch=Bs(pe,jt,po)),g.padding&&(ee.interpolatePadding(Fe,Qt,po),on=ee.centerPoint.add(kr));var df=po===1?ln:ee.unproject(wn.add(Gn.mult(wc(vl))).mult(hf));ee.setLocationAtPoint(ee.renderWorldCopies?df.wrap():df,on),g.fireMoveEvents(N)},function(){return g.afterEase(N)},L),this}},{key:"fitScreenCoordinates",value:function(g,L,N,K,ee){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(Gi.convert(g)),this.transform.pointLocation(Gi.convert(L)),N,K),K,ee)}},{key:"stop",value:function(g,L){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var N=this.onEaseEnd;delete this.onEaseEnd,N.call(this,L)}return this}},{key:"normalizeBearing",value:function(g,L){g=Ql(g,-180,180);var N=Math.abs(g-L);return Math.abs(g-360-L)<N&&(g-=360),Math.abs(g+360-L)<N&&(g+=360),g}},{key:"normalizeCenter",value:function(g){var L=this.transform;if(!(!L.renderWorldCopies||L.lngRange)){var N=g.lng-L.center.lng;g.lng+=N>180?-360:N<-180?360:0}}},{key:"fireMoveEvents",value:function(g){this.emit("move",new qi("move",g)),this.zooming&&this.emit("zoom",new qi("zoom",g)),this.rotating&&this.emit("rotate",new qi("rotate",g)),this.pitching&&this.emit("rotate",new qi("pitch",g))}},{key:"prepareEase",value:function(g){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!L&&!N.moving&&this.emit("movestart",new qi("movestart",g)),this.zooming&&!N.zooming&&this.emit("zoomstart",new qi("zoomstart",g)),this.rotating&&!N.rotating&&this.emit("rotatestart",new qi("rotatestart",g)),this.pitching&&!N.pitching&&this.emit("pitchstart",new qi("pitchstart",g))}},{key:"afterEase",value:function(g,L){if(!(this.easeId&&L&&this.easeId===L)){delete this.easeId;var N=this.zooming,K=this.rotating,ee=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,N&&this.emit("zoomend",new qi("zoomend",g)),K&&this.emit("rotateend",new qi("rotateend",g)),ee&&this.emit("pitchend",new qi("pitchend",g)),this.emit("moveend",new qi("moveend",g))}}},{key:"ease",value:function(g,L,N){N.animate===!1||N.duration===0?(g(1),L()):(this.easeStart=du(),this.easeOptions=N,this.onEaseFrame=g,this.onEaseEnd=L,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(g,L,N,K){var ee={top:0,bottom:0,right:0,left:0};if(K=Fa()({padding:ee,offset:[0,0],maxZoom:this.transform.maxZoom},K),typeof K.padding=="number"){var Z=K.padding;K.padding={top:Z,bottom:Z,right:Z,left:Z}}K.padding=Fa()(ee,K.padding);var Se=this.transform,pe=Se.padding,Fe=Se.project(Sa.convert(g)),mt=Se.project(Sa.convert(L)),Yt=Fe.rotate(-N*Math.PI/180),jt=mt.rotate(-N*Math.PI/180),Qt=new Gi(Math.max(Yt.x,jt.x),Math.max(Yt.y,jt.y)),ur=new Gi(Math.min(Yt.x,jt.x),Math.min(Yt.y,jt.y)),kr=Qt.sub(ur),on=(Se.width-(pe.left+pe.right+K.padding.left+K.padding.right))/kr.x,Gr=(Se.height-(pe.top+pe.bottom+K.padding.top+K.padding.bottom))/kr.y;if(!(Gr<0||on<0)){var ln=Math.min(Se.scaleZoom(Se.scale*Math.min(on,Gr)),K.maxZoom),wn=Gi.convert(K.offset),Gn=(K.padding.left-K.padding.right)/2,ii=(K.padding.top-K.padding.bottom)/2,Vi=new Gi(wn.x+Gn,wn.y+ii),va=Vi.mult(Se.scale/Se.zoomScale(ln)),Ia=Se.unproject(Fe.add(mt).div(2).sub(va));return{center:Ia,zoom:ln,bearing:N}}}},{key:"fitInternal",value:function(g,L,N){return g?(L=Fa()(g,L),delete L.padding,L.linear?this.easeTo(L,N):this.flyTo(L,N)):this}}]),s}(il.EventEmitter);function ll(w,p){var s;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(s=vu(w))||p&&w&&typeof w.length=="number"){s&&(w=s);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Z){throw Z},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=w[Symbol.iterator]()},n:function(){var Z=s.next();return L=Z.done,Z},e:function(Z){N=!0,K=Z},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function vu(w,p){if(!!w){if(typeof w=="string")return Ms(w,p);var s=Object.prototype.toString.call(w).slice(8,-1);if(s==="Object"&&w.constructor&&(s=w.constructor.name),s==="Map"||s==="Set")return Array.from(w);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Ms(w,p)}}function Ms(w,p){(p==null||p>w.length)&&(p=w.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=w[s];return d}var Is={},$o=Is;Is.create=function(w,p,s){var d=window.document.createElement(w);return p!==void 0&&(d.className=p),s&&s.appendChild(d),d},Is.createNS=function(w,p){var s=window.document.createElementNS(w,p);return s};var Bo=window.document&&window.document.documentElement.style;function cl(w){if(!Bo)return w[0];var p=ll(w),s;try{for(p.s();!(s=p.n()).done;){var d=s.value;if(d in Bo)return d}}catch(g){p.e(g)}finally{p.f()}return w[0]}var Tl=cl(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),Fl;Is.disableDrag=function(){Bo&&Tl&&(Fl=Bo[Tl],Bo[Tl]="none")},Is.enableDrag=function(){Bo&&Tl&&(Bo[Tl]=Fl)};var af=cl(["transform","WebkitTransform"]);Is.setTransform=function(w,p){w.style[af]=p};var Bl=!1;try{var Os=Object.defineProperty({},"passive",{get:function(){Bl=!0}});window.addEventListener("test",Os,Os),window.removeEventListener("test",Os,Os)}catch(w){Bl=!1}Is.addEventListener=function(w,p,s){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in d&&Bl?w.addEventListener(p,s,d):w.addEventListener(p,s,d.capture)},Is.removeEventListener=function(w,p,s){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in d&&Bl?w.removeEventListener(p,s,d):w.removeEventListener(p,s,d.capture)};var ss=function w(p){p.preventDefault(),p.stopPropagation(),window.removeEventListener("click",w,!0)};Is.suppressClick=function(){window.addEventListener("click",ss,!0),window.setTimeout(function(){window.removeEventListener("click",ss,!0)},0)},Is.mousePos=function(w,p){var s=w.getBoundingClientRect();return new Gi(p.clientX-s.left-w.clientLeft,p.clientY-s.top-w.clientTop)},Is.touchPos=function(w,p){var s=w.getBoundingClientRect(),d=[],g=ll(p),L;try{for(g.s();!(L=g.n()).done;){var N=L.value;d.push(new Gi(N.clientX-s.left-w.clientLeft,N.clientY-s.top-w.clientTop))}}catch(K){g.e(K)}finally{g.f()}return d},Is.mouseButton=function(w){return typeof window.InstallTrigger!="undefined"&&w.button===2&&w.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:w.button},Is.remove=function(w){w.parentNode&&w.parentNode.removeChild(w)};function Mi(w){var p=Yu();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function Yu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var ka=function(w){pr()(s,w);var p=Mi(s);function s(d,g,L){var N,K=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};we()(this,s);var ee=$o.mousePos(g.getCanvasContainer(),L),Z=g.unproject(ee);return N=p.call(this,d,Fa()({point:ee,lngLat:Z,originalEvent:L},K)),N.type=void 0,N.target=void 0,N.originalEvent=void 0,N.point=void 0,N.lngLat=void 0,N.defaultPrevented=void 0,N.defaultPrevented=!1,N.target=g,N}return Qe()(s,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),s}(qi);function wo(w){var p=Al();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function Al(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var mu=function(w){pr()(s,w);var p=wo(s);function s(d,g,L){var N;we()(this,s);var K=d==="touchend"?L.changedTouches:L.touches,ee=$o.touchPos(g.getCanvasContainer(),K),Z=ee.map(function(Fe){return g.unproject(Fe)}),Se=ee.reduce(function(Fe,mt,Yt,jt){return Fe.add(mt.div(jt.length))},new Gi(0,0)),pe=g.unproject(Se);return N=p.call(this,d,{points:ee,point:Se,lngLats:Z,lngLat:pe,originalEvent:L}),N.type=void 0,N.target=void 0,N.originalEvent=void 0,N.lngLat=void 0,N.point=void 0,N.points=void 0,N.lngLats=void 0,N.defaultPrevented=void 0,N.defaultPrevented=!1,N}return Qe()(s,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),s}(qi);function gu(w){var p=Es();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function Es(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Ec=function(w){pr()(s,w);var p=gu(s);function s(d,g,L){var N;return we()(this,s),N=p.call(this,d,{originalEvent:L}),N.type=void 0,N.originalEvent=void 0,N.defaultPrevented=void 0,N.target=void 0,N.defaultPrevented=!1,N}return Qe()(s,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),s}(qi),$n=function(){function w(p){we()(this,w),this.map=void 0,this.delayContextMenu=void 0,this.contextMenuEvent=void 0,this.map=p}return Qe()(w,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(s){this.map.emit(s.type,new ka(s.type,this.map,s))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new ka("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(s){this.delayContextMenu?this.contextMenuEvent=s:this.map.emit(s.type,new ka(s.type,this.map,s)),this.map.listeners("contextmenu")&&s.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),w}(),Fn=function(){function w(p,s){we()(this,w),this.map=void 0,this.el=void 0,this.container=void 0,this.enabled=void 0,this.active=void 0,this.startPos=void 0,this.lastPos=void 0,this.box=void 0,this.clickTolerance=void 0,this.map=p,this.el=p.getCanvasContainer(),this.container=p.getContainer(),this.clickTolerance=s.clickTolerance||1}return Qe()(w,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){this.isEnabled()||(this.enabled=!0)}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"mousedown",value:function(s,d){!this.isEnabled()||!(s.shiftKey&&s.button===0)||($o.disableDrag(),this.startPos=this.lastPos=d,this.active=!0)}},{key:"mousemoveWindow",value:function(s,d){if(!!this.active){var g=d;if(!(this.lastPos.equals(g)||!this.box&&g.dist(this.startPos)<this.clickTolerance)){var L=this.startPos;this.lastPos=g,this.box||(this.box=$o.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",s));var N=Math.min(L.x,g.x),K=Math.max(L.x,g.x),ee=Math.min(L.y,g.y),Z=Math.max(L.y,g.y);$o.setTransform(this.box,"translate(".concat(N,"px,").concat(ee,"px)")),this.box&&(this.box.style.width="".concat(K-N,"px"),this.box.style.height="".concat(Z-ee,"px"))}}}},{key:"mouseupWindow",value:function(s,d){var g=this;if(!!this.active&&s.button===0){var L=this.startPos,N=d;if(this.reset(),$o.suppressClick(),L.x===N.x&&L.y===N.y)this.fireEvent("boxzoomcancel",s);else return this.map.emit("boxzoomend",new qi("boxzoomend",{originalEvent:s})),{cameraAnimation:function(ee){return ee.fitScreenCoordinates(L,N,g.map.getBearing(),{linear:!0})}}}}},{key:"keydown",value:function(s){!this.active||s.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",s))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&($o.remove(this.box),this.box=null),$o.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(s,d){return this.map.emit(s,new qi(s,{originalEvent:d}))}}]),w}(),Tc=Fn,vs=function(){function w(){we()(this,w),this.enabled=void 0,this.active=void 0,this.reset()}return Qe()(w,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(s,d){return s.preventDefault(),{cameraAnimation:function(L){L.easeTo({duration:300,zoom:L.getZoom()+(s.shiftKey?-1:1),around:L.unproject(d)},{originalEvent:s})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}();function ko(w){var p=Po();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function Po(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var ru=function(w){pr()(s,w);var p=ko(s);function s(){var d;we()(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.type="renderFrame",d.timeStamp=void 0,d}return s}(qi);function Pu(w,p){var s;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(s=ec(w))||p&&w&&typeof w.length=="number"){s&&(w=s);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Z){throw Z},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=w[Symbol.iterator]()},n:function(){var Z=s.next();return L=Z.done,Z},e:function(Z){N=!0,K=Z},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function ec(w,p){if(!!w){if(typeof w=="string")return Hi(w,p);var s=Object.prototype.toString.call(w).slice(8,-1);if(s==="Object"&&w.constructor&&(s=w.constructor.name),s==="Map"||s==="Set")return Array.from(w);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Hi(w,p)}}function Hi(w,p){(p==null||p>w.length)&&(p=w.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=w[s];return d}var Za={linearity:.3,easing:al(0,0,.3,1)},fl=Fa()({deceleration:2500,maxSpeed:1400},Za),hl=Fa()({deceleration:20,maxSpeed:1400},Za),tc=Fa()({deceleration:1e3,maxSpeed:360},Za),Mu=Fa()({deceleration:1e3,maxSpeed:90},Za),Ls=function(){function w(p){we()(this,w),this.map=void 0,this.inertiaBuffer=void 0,this.map=p,this.clear()}return Qe()(w,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(s){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:du(),settings:s})}},{key:"drainInertiaBuffer",value:function(){for(var s=this.inertiaBuffer,d=du(),g=160;s.length>0&&d-s[0].time>g;)s.shift()}},{key:"onMoveEnd",value:function(s){if(this.drainInertiaBuffer(),!(this.inertiaBuffer.length<2)){var d={zoom:0,bearing:0,pitch:0,pan:new Gi(0,0),pinchAround:void 0,around:void 0},g=Pu(this.inertiaBuffer),L;try{for(g.s();!(L=g.n()).done;){var N=L.value.settings;d.zoom+=N.zoomDelta||0,d.bearing+=N.bearingDelta||0,d.pitch+=N.pitchDelta||0,N.panDelta&&d.pan._add(N.panDelta),N.around&&(d.around=N.around),N.pinchAround&&(d.pinchAround=N.pinchAround)}}catch(jt){g.e(jt)}finally{g.f()}var K=this.inertiaBuffer[this.inertiaBuffer.length-1],ee=K.time-this.inertiaBuffer[0].time,Z={};if(d.pan.mag()){var Se=ms(d.pan.mag(),ee,Fa()({},fl,s||{}));Z.offset=d.pan.mult(Se.amount/d.pan.mag()),Z.center=this.map.transform.center,kl(Z,Se)}if(d.zoom){var pe=ms(d.zoom,ee,hl);Z.zoom=this.map.transform.zoom+pe.amount,kl(Z,pe)}if(d.bearing){var Fe=ms(d.bearing,ee,tc);Z.bearing=this.map.transform.bearing+Cu(Fe.amount,-179,179),kl(Z,Fe)}if(d.pitch){var mt=ms(d.pitch,ee,Mu);Z.pitch=this.map.transform.pitch+mt.amount,kl(Z,mt)}if(Z.zoom||Z.bearing){var Yt=d.pinchAround===void 0?d.around:d.pinchAround;Z.around=Yt?this.map.unproject(Yt):this.map.getCenter()}return this.clear(),Fa()(Z,{noMoveStart:!0})}}}]),w}();function kl(w,p){(!w.duration||w.duration<p.duration)&&(w.duration=p.duration,w.easing=p.easing)}function ms(w,p,s){var d=s.maxSpeed,g=s.linearity,L=s.deceleration,N=Cu(w*g/(p/1e3),-d,d),K=Math.abs(N)/(L*g);return{easing:s.easing,duration:K*1e3,amount:N*(K/2)}}var xf={panStep:100,bearingStep:15,pitchStep:10},jl=function(){function w(){we()(this,w),this.enabled=void 0,this.active=void 0,this.panStep=void 0,this.bearingStep=void 0,this.pitchStep=void 0;var p=xf;this.panStep=p.panStep,this.bearingStep=p.bearingStep,this.pitchStep=p.pitchStep}return Qe()(w,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(s){var d=this;if(!(s.altKey||s.ctrlKey||s.metaKey)){var g=0,L=0,N=0,K=0,ee=0;switch(s.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:s.shiftKey?L=-1:(s.preventDefault(),K=-1);break;case 39:s.shiftKey?L=1:(s.preventDefault(),K=1);break;case 38:s.shiftKey?N=1:(s.preventDefault(),ee=-1);break;case 40:s.shiftKey?N=-1:(s.preventDefault(),ee=1);break;default:return}return{cameraAnimation:function(Se){var pe=Se.getZoom();Se.easeTo({duration:300,easeId:"keyboardHandler",easing:jc,zoom:g?Math.round(pe)+g*(s.shiftKey?2:1):pe,bearing:Se.getBearing()+L*d.bearingStep,pitch:Se.getPitch()+N*d.pitchStep,offset:[-K*d.panStep,-ee*d.panStep],center:Se.getCenter()},{originalEvent:s})}}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}();function jc(w){return w*(2-w)}var bf=jl,Us=function(){function w(p,s){we()(this,w),this.mousedownPos=void 0,this.clickTolerance=void 0,this.map=void 0,this.map=p,this.clickTolerance=s.clickTolerance}return Qe()(w,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(s){return this.firePreventable(new Ec(s.type,this.map,s))}},{key:"mousedown",value:function(s,d){return this.mousedownPos=d,this.firePreventable(new ka(s.type,this.map,s))}},{key:"mouseup",value:function(s){this.map.emit(s.type,new ka(s.type,this.map,s))}},{key:"click",value:function(s,d){this.mousedownPos&&this.mousedownPos.dist(d)>=this.clickTolerance||this.map.emit(s.type,new ka(s.type,this.map,s))}},{key:"dblclick",value:function(s){return this.firePreventable(new ka(s.type,this.map,s))}},{key:"mouseover",value:function(s){this.map.emit(s.type,new ka(s.type,this.map,s))}},{key:"mouseout",value:function(s){this.map.emit(s.type,new ka(s.type,this.map,s))}},{key:"touchstart",value:function(s){return this.firePreventable(new mu(s.type,this.map,s))}},{key:"touchmove",value:function(s){this.map.emit(s.type,new mu(s.type,this.map,s))}},{key:"touchend",value:function(s){this.map.emit(s.type,new mu(s.type,this.map,s))}},{key:"touchcancel",value:function(s){this.map.emit(s.type,new mu(s.type,this.map,s))}},{key:"firePreventable",value:function(s){if(this.map.emit(s.type,s),s.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),w}(),_l=o("iWIM"),Ul=o.n(_l),Iu,Ou=0,Cl=2,Ku=(Iu={},fi()(Iu,Ou,1),fi()(Iu,Cl,2),Iu);function Rs(w,p){var s=Ku[p];return w.buttons===void 0||(w.buttons&s)!==s}var Ac=function(){function w(p){we()(this,w),this.enabled=void 0,this.active=void 0,this.lastPoint=void 0,this.eventButton=void 0,this.moved=void 0,this.clickTolerance=void 0,this.reset(),this.clickTolerance=p.clickTolerance||1}return Qe()(w,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(s,d){if(!this.lastPoint){var g=$o.mouseButton(s);!this.correctButton(s,g)||(this.lastPoint=d,this.eventButton=g)}}},{key:"mousemoveWindow",value:function(s,d){var g=this.lastPoint;if(!!g){if(s.preventDefault(),Rs(s,this.eventButton)){this.reset();return}if(!(!this.moved&&d.dist(g)<this.clickTolerance))return this.moved=!0,this.lastPoint=d,this.move(g,d)}}},{key:"mouseupWindow",value:function(s){if(!!this.lastPoint){var d=$o.mouseButton(s);d===this.eventButton&&(this.moved&&$o.suppressClick(),this.reset())}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(s,d){return!1}},{key:"move",value:function(s,d){}}]),w}();function rc(w){var p=nc();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function nc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var ic=function(w){pr()(s,w);var p=rc(s);function s(){return we()(this,s),p.apply(this,arguments)}return Qe()(s,[{key:"mousedown",value:function(g,L){Ul()(Sn()(s.prototype),"mousedown",this).call(this,g,L),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(g,L){return{around:L,panDelta:L.sub(g)}}},{key:"correctButton",value:function(g,L){return L===Ou&&!g.ctrlKey}}]),s}(Ac);function u(w){var p=i();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function i(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var n=function(w){pr()(s,w);var p=u(s);function s(){return we()(this,s),p.apply(this,arguments)}return Qe()(s,[{key:"correctButton",value:function(g,L){return L===Ou&&g.ctrlKey||L===Cl}},{key:"move",value:function(g,L){var N=-.5,K=(L.y-g.y)*N;if(K)return this.active=!0,{pitchDelta:K}}},{key:"contextmenu",value:function(g){g.preventDefault()}}]),s}(Ac);function c(w){var p=x();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function x(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var P=function(w){pr()(s,w);var p=c(s);function s(){return we()(this,s),p.apply(this,arguments)}return Qe()(s,[{key:"contextmenu",value:function(g){g.preventDefault()}},{key:"correctButton",value:function(g,L){return L===Ou&&g.ctrlKey||L===Cl}},{key:"move",value:function(g,L){var N=.8,K=(L.x-g.x)*N;if(K)return this.active=!0,{bearingDelta:K}}}]),s}(Ac),O=4.000244140625,F=1/100,ue=1/450,Ee=2,Xe=function(){function w(p,s){var d=this;we()(this,w),this.map=void 0,this.el=void 0,this.enabled=void 0,this.active=void 0,this.zooming=void 0,this.aroundCenter=void 0,this.around=void 0,this.aroundPoint=void 0,this.type=void 0,this.lastValue=void 0,this.timeout=void 0,this.finishTimeout=void 0,this.lastWheelEvent=void 0,this.lastWheelEventTime=void 0,this.startZoom=void 0,this.targetZoom=void 0,this.delta=void 0,this.easing=void 0,this.prevEase=void 0,this.frameId=void 0,this.handler=void 0,this.defaultZoomRate=void 0,this.wheelZoomRate=void 0,this.onScrollFrame=function(){if(!!d.frameId&&(d.frameId=null,!!d.isActive())){var g=d.map.transform;if(d.delta!==0){var L=d.type==="wheel"&&Math.abs(d.delta)>O?d.wheelZoomRate:d.defaultZoomRate,N=Ee/(1+Math.exp(-Math.abs(d.delta*L)));d.delta<0&&N!==0&&(N=1/N);var K=typeof d.targetZoom=="number"?g.zoomScale(d.targetZoom):g.scale;d.targetZoom=Math.min(g.maxZoom,Math.max(g.minZoom,g.scaleZoom(K*N))),d.type==="wheel"&&(d.startZoom=g.zoom,d.easing=d.smoothOutEasing(200)),d.delta=0}var ee=typeof d.targetZoom=="number"?d.targetZoom:g.zoom,Z=d.startZoom,Se=d.easing,pe=!1,Fe;if(d.type==="wheel"&&Z&&Se){var mt=Math.min((du()-d.lastWheelEventTime)/200,1),Yt=Se(mt);Fe=Bs(Z,ee,Yt),mt<1?d.frameId||(d.frameId=!0):pe=!0}else Fe=ee,pe=!0;return d.active=!0,pe&&(d.active=!1,d.finishTimeout=setTimeout(function(){d.zooming=!1,d.handler.triggerRenderFrame(),delete d.targetZoom,delete d.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!pe,zoomDelta:Fe-g.zoom,around:d.aroundPoint,originalEvent:d.lastWheelEvent}}},this.map=p,this.el=p.getCanvasContainer(),this.handler=s,this.delta=0,this.defaultZoomRate=F,this.wheelZoomRate=ue}return Qe()(w,[{key:"setZoomRate",value:function(s){this.defaultZoomRate=s}},{key:"setWheelZoomRate",value:function(s){this.wheelZoomRate=s}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(s){this.isEnabled()||(this.enabled=!0,this.aroundCenter=s&&s.around==="center")}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"wheel",value:function(s){if(!!this.isEnabled()){var d=s.deltaMode===window.WheelEvent.DOM_DELTA_LINE?s.deltaY*40:s.deltaY,g=du(),L=g-(this.lastWheelEventTime||0);this.lastWheelEventTime=g,d!==0&&d%O==0?this.type="wheel":d!==0&&Math.abs(d)<4?this.type="trackpad":L>400?(this.type=null,this.lastValue=d,this.timeout=setTimeout(this.onTimeout,40,s)):this.type||(this.type=Math.abs(L*d)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,d+=this.lastValue)),s.shiftKey&&d&&(d=d/4),this.type&&(this.lastWheelEvent=s,this.delta-=d,this.active||this.start(s)),s.preventDefault()}}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(s){this.type="wheel",this.delta-=this.lastValue,this.active||this.start(s)}},{key:"start",value:function(s){if(!!this.delta){this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var d=$o.mousePos(this.el,s);this.around=Sa.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(d)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}}},{key:"smoothOutEasing",value:function(s){var d=Bc;if(this.prevEase){var g=this.prevEase,L=(du()-g.start)/g.duration,N=g.easing(L+.01)-g.easing(L),K=.27/Math.sqrt(N*N+1e-4)*.01,ee=Math.sqrt(.27*.27-K*K);d=al(K,ee,.25,1)}return this.prevEase={start:du(),duration:s,easing:d},d}}]),w}(),qe=Xe,tt=function(){function w(p,s){we()(this,w),this.clickZoom=void 0,this.tapZoom=void 0,this.clickZoom=p,this.tapZoom=s}return Qe()(w,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),w}(),zt=function(){function w(p,s,d){we()(this,w),this.inertiaOptions=void 0,this.el=void 0,this.mousePan=void 0,this.touchPan=void 0,this.el=p,this.mousePan=s,this.touchPan=d}return Qe()(w,[{key:"enable",value:function(s){this.inertiaOptions=s||{},this.mousePan.enable(),this.touchPan.enable(),this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),w}(),Lt=function(){function w(p,s,d){we()(this,w),this.mouseRotate=void 0,this.mousePitch=void 0,this.pitchWithRotate=void 0,this.pitchWithRotate=p.pitchWithRotate,this.mouseRotate=s,this.mousePitch=d}return Qe()(w,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),w}(),Xt=function(){function w(p,s,d,g){we()(this,w),this.el=void 0,this.touchZoom=void 0,this.touchRotate=void 0,this.tapDragZoom=void 0,this.rotationDisabled=void 0,this.enabled=void 0,this.el=p,this.touchZoom=s,this.touchRotate=d,this.tapDragZoom=g,this.rotationDisabled=!1,this.enabled=!0}return Qe()(w,[{key:"enable",value:function(s){this.touchZoom.enable(s),this.rotationDisabled||this.touchRotate.enable(s),this.tapDragZoom.enable(),this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),w}();function Dt(w,p){for(var s={},d=0;d<w.length;d++)s[w[d].identifier]=p[d];return s}function Ut(w,p){var s;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(s=er(w))||p&&w&&typeof w.length=="number"){s&&(w=s);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Z){throw Z},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=w[Symbol.iterator]()},n:function(){var Z=s.next();return L=Z.done,Z},e:function(Z){N=!0,K=Z},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function er(w,p){if(!!w){if(typeof w=="string")return qt(w,p);var s=Object.prototype.toString.call(w).slice(8,-1);if(s==="Object"&&w.constructor&&(s=w.constructor.name),s==="Map"||s==="Set")return Array.from(w);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return qt(w,p)}}function qt(w,p){(p==null||p>w.length)&&(p=w.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=w[s];return d}function Ir(w){var p=new Gi(0,0),s=Ut(w),d;try{for(s.s();!(d=s.n()).done;){var g=d.value;p._add(g)}}catch(L){s.e(L)}finally{s.f()}return p.div(w.length)}var hr=500,Tr=500,_r=30,nn=function(){function w(p){we()(this,w),this.numTouches=void 0,this.centroid=void 0,this.startTime=void 0,this.aborted=void 0,this.touches=void 0,this.reset(),this.numTouches=p.numTouches}return Qe()(w,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(s,d,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=s.timeStamp),g.length===this.numTouches&&(this.centroid=Ir(d),this.touches=Dt(g,d)))}},{key:"touchmove",value:function(s,d,g){if(!(this.aborted||!this.centroid)){var L=Dt(g,d);for(var N in this.touches)if(this.touches[N]){var K=this.touches[N],ee=L[N];(!ee||ee.dist(K)>_r)&&(this.aborted=!0)}}}},{key:"touchend",value:function(s,d,g){if((!this.centroid||s.timeStamp-this.startTime>Tr)&&(this.aborted=!0),g.length===0){var L=!this.aborted&&this.centroid;if(this.reset(),L)return L}}}]),w}(),Yr=function(){function w(p){we()(this,w),this.singleTap=void 0,this.numTaps=void 0,this.lastTime=void 0,this.lastTap=void 0,this.count=void 0,this.singleTap=new nn(p),this.numTaps=p.numTaps,this.reset()}return Qe()(w,[{key:"reset",value:function(){this.lastTime=Infinity,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(s,d,g){this.singleTap.touchstart(s,d,g)}},{key:"touchmove",value:function(s,d,g){this.singleTap.touchmove(s,d,g)}},{key:"touchend",value:function(s,d,g){var L=this.singleTap.touchend(s,d,g);if(L){var N=s.timeStamp-this.lastTime<hr,K=!this.lastTap||this.lastTap.dist(L)<_r;if((!N||!K)&&this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=L,this.count===this.numTaps)return this.reset(),L}}}]),w}(),yn=function(){function w(){we()(this,w),this.enabled=void 0,this.active=void 0,this.swipePoint=void 0,this.swipeTouch=void 0,this.tapTime=void 0,this.tap=void 0,this.tap=new Yr({numTouches:1,numTaps:1}),this.reset()}return Qe()(w,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(s,d,g){this.swipePoint||(this.tapTime&&s.timeStamp-this.tapTime>hr&&this.reset(),this.tapTime?g.length>0&&(this.swipePoint=d[0],this.swipeTouch=g[0].identifier):this.tap.touchstart(s,d,g))}},{key:"touchmove",value:function(s,d,g){if(!this.tapTime)this.tap.touchmove(s,d,g);else if(this.swipePoint){if(g[0].identifier!==this.swipeTouch)return;var L=d[0],N=L.y-this.swipePoint.y;return this.swipePoint=L,s.preventDefault(),this.active=!0,{zoomDelta:N/128}}}},{key:"touchend",value:function(s,d,g){if(this.tapTime)this.swipePoint&&g.length===0&&this.reset();else{var L=this.tap.touchend(s,d,g);L&&(this.tapTime=s.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}(),On=function(){function w(){we()(this,w),this.enabled=void 0,this.active=void 0,this.zoomIn=void 0,this.zoomOut=void 0,this.zoomIn=new Yr({numTouches:1,numTaps:2}),this.zoomOut=new Yr({numTouches:2,numTaps:1}),this.reset()}return Qe()(w,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(s,d,g){this.zoomIn.touchstart(s,d,g),this.zoomOut.touchstart(s,d,g)}},{key:"touchmove",value:function(s,d,g){this.zoomIn.touchmove(s,d,g),this.zoomOut.touchmove(s,d,g)}},{key:"touchend",value:function(s,d,g){var L=this,N=this.zoomIn.touchend(s,d,g),K=this.zoomOut.touchend(s,d,g);if(N)return this.active=!0,s.preventDefault(),setTimeout(function(){return L.reset()},0),{cameraAnimation:function(Z){return Z.easeTo({duration:300,zoom:Z.getZoom()+1,around:Z.unproject(N)},{originalEvent:s})}};if(K)return this.active=!0,s.preventDefault(),setTimeout(function(){return L.reset()},0),{cameraAnimation:function(Z){return Z.easeTo({duration:300,zoom:Z.getZoom()-1,around:Z.unproject(K)},{originalEvent:s})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}(),Qn=function(){function w(p){we()(this,w),this.enabled=void 0,this.active=void 0,this.touches=void 0,this.minTouches=void 0,this.clickTolerance=void 0,this.sum=void 0,this.minTouches=1,this.clickTolerance=p.clickTolerance||1,this.reset()}return Qe()(w,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new Gi(0,0)}},{key:"touchstart",value:function(s,d,g){return this.calculateTransform(s,d,g)}},{key:"touchmove",value:function(s,d,g){if(!!this.active)return s.preventDefault(),this.calculateTransform(s,d,g)}},{key:"touchend",value:function(s,d,g){this.calculateTransform(s,d,g),this.active&&g.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(s,d,g){g.length>0&&(this.active=!0);var L=Dt(g,d),N=new Gi(0,0),K=new Gi(0,0),ee=0;for(var Z in L)if(L[Z]){var Se=L[Z],pe=this.touches[Z];pe&&(N._add(Se),K._add(Se.sub(pe)),ee++,L[Z]=Se)}if(this.touches=L,!(ee<this.minTouches||!K.mag())){var Fe=K.div(ee);if(this.sum._add(Fe),!(this.sum.mag()<this.clickTolerance)){var mt=N.div(ee);return{around:mt,panDelta:Fe}}}}}]),w}(),oi=function(){function w(){we()(this,w),this.enabled=void 0,this.active=void 0,this.firstTwoTouches=void 0,this.vector=void 0,this.startVector=void 0,this.aroundCenter=void 0,this.reset()}return Qe()(w,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(s){}},{key:"move",value:function(s,d,g){}},{key:"touchstart",value:function(s,d,g){this.firstTwoTouches||g.length<2||(this.firstTwoTouches=[g[0].identifier,g[1].identifier],this.start([d[0],d[1]]))}},{key:"touchmove",value:function(s,d,g){if(!!this.firstTwoTouches){s.preventDefault();var L=vi()(this.firstTwoTouches,2),N=L[0],K=L[1],ee=yi(g,d,N),Z=yi(g,d,K);if(!(!ee||!Z)){var Se=this.aroundCenter?null:ee.add(Z).div(2);return this.move([ee,Z],Se,s)}}}},{key:"touchend",value:function(s,d,g){if(!!this.firstTwoTouches){var L=vi()(this.firstTwoTouches,2),N=L[0],K=L[1],ee=yi(g,d,N),Z=yi(g,d,K);ee&&Z||(this.active&&$o.suppressClick(),this.reset())}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(s){this.enabled=!0,this.aroundCenter=!!s&&s.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}();function yi(w,p,s){for(var d=0;d<w.length;d++)if(w[d].identifier===s)return p[d]}function Zi(w){var p=An();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function An(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}function si(w){return Math.abs(w.y)>Math.abs(w.x)}var xi=100,Wn=function(w){pr()(s,w);var p=Zi(s);function s(){var d;we()(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.valid=void 0,d.firstMove=void 0,d.lastPoints=void 0,d}return Qe()(s,[{key:"reset",value:function(){Ul()(Sn()(s.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(g){this.lastPoints=g,si(g[0].sub(g[1]))&&(this.valid=!1)}},{key:"move",value:function(g,L,N){var K=g[0].sub(this.lastPoints[0]),ee=g[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(K,ee,N.timeStamp),!!this.valid){this.lastPoints=g,this.active=!0;var Z=(K.y+ee.y)/2,Se=-.5;return{pitchDelta:Z*Se}}}},{key:"gestureBeginsVertically",value:function(g,L,N){if(this.valid!==void 0)return this.valid;var K=2,ee=g.mag()>=K,Z=L.mag()>=K;if(!(!ee&&!Z)){if(!ee||!Z)return this.firstMove===void 0&&(this.firstMove=N),N-this.firstMove<xi?void 0:!1;var Se=g.y>0==L.y>0;return si(g)&&si(L)&&Se}}}]),s}(oi);function Ti(w){var p=ri();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function ri(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Ii=25;function Bi(w,p){return w.angleWith(p)*180/Math.PI}var qa=function(w){pr()(s,w);var p=Ti(s);function s(){var d;we()(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.minDiameter=void 0,d}return Qe()(s,[{key:"reset",value:function(){Ul()(Sn()(s.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(g){this.startVector=this.vector=g[0].sub(g[1]),this.minDiameter=g[0].dist(g[1])}},{key:"move",value:function(g,L){var N=this.vector;if(this.vector=g[0].sub(g[1]),!(!this.active&&this.isBelowThreshold(this.vector)))return this.active=!0,{bearingDelta:Bi(this.vector,N),pinchAround:L}}},{key:"isBelowThreshold",value:function(g){this.minDiameter=Math.min(this.minDiameter,g.mag());var L=Math.PI*this.minDiameter,N=Ii/L*360,K=Bi(g,this.startVector);return Math.abs(K)<N}}]),s}(oi);function Pa(w){var p=yo();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function yo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Ea=.1;function Wa(w,p){return Math.log(w/p)/Math.LN2}var Ds=function(w){pr()(s,w);var p=Pa(s);function s(){var d;we()(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.distance=void 0,d.startDistance=void 0,d}return Qe()(s,[{key:"reset",value:function(){Ul()(Sn()(s.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(g){this.startDistance=this.distance=g[0].dist(g[1])}},{key:"move",value:function(g,L){var N=this.distance;if(this.distance=g[0].dist(g[1]),!(!this.active&&Math.abs(Wa(this.distance,this.startDistance))<Ea))return this.active=!0,{zoomDelta:Wa(this.distance,N),pinchAround:L}}}]),s}(oi);function xo(w,p){var s;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(s=yu(w))||p&&w&&typeof w.length=="number"){s&&(w=s);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Z){throw Z},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=w[Symbol.iterator]()},n:function(){var Z=s.next();return L=Z.done,Z},e:function(Z){N=!0,K=Z},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function yu(w,p){if(!!w){if(typeof w=="string")return xu(w,p);var s=Object.prototype.toString.call(w).slice(8,-1);if(s==="Object"&&w.constructor&&(s=w.constructor.name),s==="Map"||s==="Set")return Array.from(w);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return xu(w,p)}}function xu(w,p){(p==null||p>w.length)&&(p=w.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=w[s];return d}var jo=function(p){return p.zoom||p.drag||p.pitch||p.rotate};function Ts(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta}var Lu=function(){function w(p,s){var d=this;we()(this,w),this.map=void 0,this.el=void 0,this.handlers=void 0,this.eventsInProgress=void 0,this.frameId=void 0,this.inertia=void 0,this.bearingSnap=void 0,this.handlersById=void 0,this.updatingCamera=void 0,this.changes=void 0,this.previousActiveHandlers=void 0,this.bearingChanged=void 0,this.listeners=void 0,this.handleWindowEvent=function(pe){d.handleEvent(pe,"".concat(pe.type,"Window"))},this.handleEvent=function(pe,Fe){if(pe.type==="blur"){d.stop();return}d.updatingCamera=!0;var mt=pe.type==="renderFrame"?void 0:pe,Yt={needsRenderFrame:!1},jt={},Qt={},ur=pe.touches?d.getMapTouches(pe.touches):void 0,kr=ur?$o.touchPos(d.el,ur):$o.mousePos(d.el,pe),on=xo(d.handlers),Gr;try{for(on.s();!(Gr=on.n()).done;){var ln=Gr.value,wn=ln.handlerName,Gn=ln.handler,ii=ln.allowed;if(!!Gn.isEnabled()){var Vi=void 0;if(d.blockedByActive(Qt,ii,wn))Gn.reset();else{var va=Fe||pe.type;Gn&&Gn[va]&&(Vi=Gn[va](pe,kr,ur),d.mergeIHandlerResult(Yt,jt,Vi,wn,mt),Vi&&Vi.needsRenderFrame&&d.triggerRenderFrame())}(Vi||Gn.isActive())&&(Qt[wn]=Gn)}}}catch(us){on.e(us)}finally{on.f()}var Ia={};for(var qu in d.previousActiveHandlers)Qt[qu]||(Ia[qu]=mt);d.previousActiveHandlers=Qt,(Object.keys(Ia).length||Ts(Yt))&&(d.changes.push([Yt,jt,Ia]),d.triggerRenderFrame()),(Object.keys(Qt).length||Ts(Yt))&&d.map.stop(!0),d.updatingCamera=!1;var ts=Yt.cameraAnimation;ts&&(d.inertia.clear(),d.fireEvents({},{}),d.changes=[],ts(d.map))},this.map=p,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new Ls(p),this.bearingSnap=s.bearingSnap,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(s);var g=this.el;this.listeners=[[g,"touchstart",{passive:!1}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];var L=xo(this.listeners),N;try{for(L.s();!(N=L.n()).done;){var K=vi()(N.value,3),ee=K[0],Z=K[1],Se=K[2];$o.addEventListener(ee,Z,ee===window.document?this.handleWindowEvent:this.handleEvent,Se)}}catch(pe){L.e(pe)}finally{L.f()}}return Qe()(w,[{key:"destroy",value:function(){var s=xo(this.listeners),d;try{for(s.s();!(d=s.n()).done;){var g=vi()(d.value,3),L=g[0],N=g[1],K=g[2];$o.removeEventListener(L,N,L===window.document?this.handleWindowEvent:this.handleEvent,K)}}catch(ee){s.e(ee)}finally{s.f()}}},{key:"stop",value:function(){if(!this.updatingCamera){var s=xo(this.handlers),d;try{for(s.s();!(d=s.n()).done;){var g=d.value.handler;g.reset()}}catch(L){s.e(L)}finally{s.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}}},{key:"isActive",value:function(){var s=xo(this.handlers),d;try{for(s.s();!(d=s.n()).done;){var g=d.value.handler;if(g.isActive())return!0}}catch(L){s.e(L)}finally{s.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(jo(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(s,d,g,L,N){if(!!g){Fa()(s,g);var K={handlerName:L,originalEvent:g.originalEvent||N};g.zoomDelta!==void 0&&(d.zoom=K),g.panDelta!==void 0&&(d.drag=K),g.pitchDelta!==void 0&&(d.pitch=K),g.bearingDelta!==void 0&&(d.rotate=K)}}},{key:"triggerRenderFrame",value:function(){var s=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(d){delete s.frameId,s.handleEvent(new ru("renderFrame",{timeStamp:d})),s.applyChanges()}))}},{key:"addDefaultHandlers",value:function(s){var d=this.map,g=d.getCanvasContainer();this.add("mapEvent",new Us(d,s));var L=d.boxZoom=new Tc(d,s);this.add("boxZoom",L);var N=new On,K=new vs;d.doubleClickZoom=new tt(K,N),this.add("tapZoom",N),this.add("clickZoom",K);var ee=new yn;this.add("tapDragZoom",ee);var Z=d.touchPitch=new Wn;this.add("touchPitch",Z);var Se=new n(s),pe=new P(s);d.dragRotate=new Lt(s,Se,pe),this.add("mouseRotate",Se,["mousePitch"]),this.add("mousePitch",pe,["mouseRotate"]);var Fe=new ic(s),mt=new Qn(s);d.dragPan=new zt(g,Fe,mt),this.add("mousePan",Fe),this.add("touchPan",mt,["touchZoom","touchRotate"]);var Yt=new qa,jt=new Ds;d.touchZoomRotate=new Xt(g,jt,Yt,ee),this.add("touchRotate",Yt,["touchPan","touchZoom"]),this.add("touchZoom",jt,["touchPan","touchRotate"]);var Qt=d.scrollZoom=new qe(d,this);this.add("scrollZoom",Qt,["mousePan"]);var ur=d.keyboard=new bf;this.add("keyboard",ur),this.add("blockableMapEvent",new $n(d));for(var kr=0,on=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];kr<on.length;kr++){var Gr=on[kr];s.interactive&&s[Gr]&&d[Gr].enable(s[Gr])}}},{key:"add",value:function(s,d,g){this.handlers.push({handlerName:s,handler:d,allowed:g}),this.handlersById[s]=d}},{key:"blockedByActive",value:function(s,d,g){for(var L in s)if(L!==g&&(!d||d.indexOf(L)<0))return!0;return!1}},{key:"getMapTouches",value:function(s){var d=[],g=xo(s),L;try{for(g.s();!(L=g.n()).done;){var N=L.value,K=N.target;this.el.contains(K)&&d.push(N)}}catch(ee){g.e(ee)}finally{g.f()}return d}},{key:"applyChanges",value:function(){var s={},d={},g={},L=xo(this.changes),N;try{for(L.s();!(N=L.n()).done;){var K=vi()(N.value,3),ee=K[0],Z=K[1],Se=K[2];ee.panDelta&&(s.panDelta=(s.panDelta||new Gi(0,0))._add(ee.panDelta)),ee.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+ee.zoomDelta),ee.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+ee.bearingDelta),ee.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+ee.pitchDelta),ee.around!==void 0&&(s.around=ee.around),ee.pinchAround!==void 0&&(s.pinchAround=ee.pinchAround),ee.noInertia&&(s.noInertia=ee.noInertia),Fa()(d,Z),Fa()(g,Se)}}catch(pe){L.e(pe)}finally{L.f()}this.updateMapTransform(s,d,g),this.changes=[]}},{key:"updateMapTransform",value:function(s,d,g){var L=this.map,N=L.transform;if(!Ts(s))return this.fireEvents(d,g);var K=s.panDelta,ee=s.zoomDelta,Z=s.bearingDelta,Se=s.pitchDelta,pe=s.pinchAround,Fe=s.around;pe!==void 0&&(Fe=pe),L.stop(!0),Fe=Fe||L.transform.centerPoint;var mt=N.pointLocation(K?Fe.sub(K):Fe);Z&&(N.bearing+=Z),Se&&(N.pitch+=Se),ee&&(N.zoom+=ee),N.setLocationAtPoint(mt,Fe),this.map.update(),s.noInertia||this.inertia.record(s),this.fireEvents(d,g)}},{key:"fireEvents",value:function(s,d){var g=this,L=jo(this.eventsInProgress),N=jo(s),K={};for(var ee in s)if(s[ee]){var Z=s[ee].originalEvent;this.eventsInProgress[ee]||(K["".concat(ee,"start")]=Z),this.eventsInProgress[ee]=s[ee]}!L&&N&&this.fireEvent("movestart",N.originalEvent);for(var Se in K)K[Se]&&this.fireEvent(Se,K[Se]);s.rotate&&(this.bearingChanged=!0),N&&this.fireEvent("move",N.originalEvent);for(var pe in s)if(s[pe]){var Fe=s[pe].originalEvent;this.fireEvent(pe,Fe)}var mt={},Yt;for(var jt in this.eventsInProgress)if(this.eventsInProgress[jt]){var Qt=this.eventsInProgress[jt],ur=Qt.handlerName,kr=Qt.originalEvent;this.handlersById[ur].isActive()||(delete this.eventsInProgress[jt],Yt=d[ur]||kr,mt["".concat(jt,"end")]=Yt)}for(var on in mt)mt[on]&&this.fireEvent(on,mt[on]);var Gr=jo(this.eventsInProgress);if((L||N)&&!Gr){this.updatingCamera=!0;var ln=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),wn=function(ii){return ii!==0&&-g.bearingSnap<ii&&ii<g.bearingSnap};ln?(wn(ln.bearing||this.map.getBearing())&&(ln.bearing=0),this.map.easeTo(ln,{originalEvent:Yt})):(this.map.emit("moveend",new qi("moveend",{originalEvent:Yt})),wn(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(s,d){this.map.emit(s,new qi(s,d?{originalEvent:d}:{}))}}]),w}(),ac=Lu,$u=o("DzJC"),oc=o.n($u),sc=function(){function w(p){var s=this;we()(this,w),this.map=void 0,this.updateHash=void 0,this.hashName=void 0,this.onHashChange=function(){var d=s.getCurrentHash();if(d.length>=3&&!d.some(function(L){return isNaN(+L)})){var g=s.map.dragRotate.isEnabled()&&s.map.touchZoomRotate.isEnabled()?+(d[3]||0):s.map.getBearing();return s.map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:g,pitch:+(d[4]||0)}),!0}return!1},this.getCurrentHash=function(){var d=window.location.hash.replace("#","");if(s.hashName){var g;return d.split("&").map(function(L){return L.split("=")}).forEach(function(L){L[0]===s.hashName&&(g=L)}),(g&&g[1]||"").split("/")}return d.split("/")},this.updateHashUnthrottled=function(){var d=s.getHashString();try{window.history.replaceState(window.history.state,"",d)}catch(g){}},this.hashName=p&&encodeURIComponent(p),this.updateHash=oc()(this.updateHashUnthrottled,30*1e3/100)}return Qe()(w,[{key:"addTo",value:function(s){return this.map=s,window.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return window.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(s){var d=this.map.getCenter(),g=Math.round(this.map.getZoom()*100)/100,L=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),N=Math.pow(10,L),K=Math.round(d.lng*N)/N,ee=Math.round(d.lat*N)/N,Z=this.map.getBearing(),Se=this.map.getPitch(),pe="";if(s?pe+="/".concat(K,"/").concat(ee,"/").concat(g):pe+="".concat(g,"/").concat(ee,"/").concat(K),(Z||Se)&&(pe+="/".concat(Math.round(Z*10)/10)),Se&&(pe+="/".concat(Math.round(Se))),this.hashName){var Fe=this.hashName,mt=!1,Yt=window.location.hash.slice(1).split("&").map(function(jt){var Qt=jt.split("=")[0];return Qt===Fe?(mt=!0,"".concat(Qt,"=").concat(pe)):jt}).filter(function(jt){return jt});return mt||Yt.push("".concat(Fe,"=").concat(pe)),"#".concat(Yt.join("&"))}return"#".concat(pe)}}]),w}(),Ru=sc,dl=null,As=[],co=30,Du=1e3/co,bu=window.performance,Mo={create:"create",load:"load",fullLoad:"fullLoad"},Io={mark:function(p){bu.mark(p)},frame:function(p){var s=p;if(dl!=null){var d=s-dl;As.push(d)}dl=s},clearMetrics:function(){dl=null,As=[],bu.clearMeasures("loadTime"),bu.clearMeasures("fullLoadTime");for(var p in Mo)bu.clearMarks(Mo[p])},getPerformanceMetrics:function(){var p=bu.measure("loadTime",Mo.create,Mo.load).duration,s=bu.measure("fullLoadTime",Mo.create,Mo.fullLoad).duration,d=As.length,g=As.reduce(function(ee,Z){return ee+Z},0)/d/1e3,L=1/g,N=As.filter(function(ee){return ee>Du}).reduce(function(ee,Z){return ee+(Z-Du)/Du},0),K=N/(d+N)*100;return{loadTime:p,fullLoadTime:s,fps:L,percentDroppedFrames:K}}};function Oo(w,p){var s;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(s=Jo(w))||p&&w&&typeof w.length=="number"){s&&(w=s);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Z){throw Z},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=w[Symbol.iterator]()},n:function(){var Z=s.next();return L=Z.done,Z},e:function(Z){N=!0,K=Z},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function Jo(w,p){if(!!w){if(typeof w=="string")return bo(w,p);var s=Object.prototype.toString.call(w).slice(8,-1);if(s==="Object"&&w.constructor&&(s=w.constructor.name),s==="Map"||s==="Set")return Array.from(w);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return bo(w,p)}}function bo(w,p){(p==null||p>w.length)&&(p=w.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=w[s];return d}var Uo=function(){function w(){we()(this,w),this.queue=void 0,this.id=void 0,this.cleared=void 0,this.currentlyRunning=void 0,this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return Qe()(w,[{key:"add",value:function(s){var d=++this.id,g=this.queue;return g.push({callback:s,id:d,cancelled:!1}),d}},{key:"remove",value:function(s){var d=this.currentlyRunning,g=d?this.queue.concat(d):this.queue,L=Oo(g),N;try{for(L.s();!(N=L.n()).done;){var K=N.value;if(K.id===s){K.cancelled=!0;return}}}catch(ee){L.e(ee)}finally{L.f()}}},{key:"run",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=this.currentlyRunning=this.queue;this.queue=[];var g=Oo(d),L;try{for(g.s();!(L=g.n()).done;){var N=L.value;if(!N.cancelled&&(N.callback(s),this.cleared))break}}catch(K){g.e(K)}finally{g.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),w}(),Vs=Uo;function wl(w){var p=Uc();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function Uc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}o("BGjm")(`/* @antv/l7-map */
.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var Vl=-2,Ju=22,zu=0,Nu=60,Gs={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:Vl,maxZoom:Ju,minPitch:zu,maxPitch:Nu,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},Lo=function(w){pr()(s,w);var p=wl(s);function s(d){var g;we()(this,s),g=p.call(this,Fa()({},Gs,d)),g.doubleClickZoom=void 0,g.dragRotate=void 0,g.dragPan=void 0,g.touchZoomRotate=void 0,g.scrollZoom=void 0,g.keyboard=void 0,g.touchPitch=void 0,g.boxZoom=void 0,g.handlers=void 0,g.container=void 0,g.canvas=void 0,g.canvasContainer=void 0,g.renderTaskQueue=new Vs,g.frame=void 0,g.trackResize=!0,g.hash=void 0,g.onWindowOnline=function(){g.update()},g.onWindowResize=function(N){g.trackResize&&g.resize({originalEvent:N}).update()},g.initContainer(),g.resize(),g.handlers=new ac(rf()(g),g.options),typeof window!="undefined"&&(window.addEventListener("online",g.onWindowOnline,!1),window.addEventListener("resize",g.onWindowResize,!1),window.addEventListener("orientationchange",g.onWindowResize,!1));var L=typeof d.hash=="string"&&d.hash||void 0;return d.hash&&(g.hash=new Ru(L).addTo(rf()(g))),(!g.hash||!g.hash.onHashChange())&&(g.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(g.resize(),g.fitBounds(d.bounds,Fa()({},d.fitBoundsOptions,{duration:0})))),g}return Qe()(s,[{key:"resize",value:function(g){var L=this.containerDimensions(),N=L[0],K=L[1];this.transform.resize(N,K);var ee=!this.moving;return ee&&(this.stop(),this.emit("movestart",new Event("movestart",g)),this.emit("move",new Event("move",g))),this.emit("resize",new Event("resize",g)),ee&&this.emit("moveend",new Event("moveend",g)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(g){return this.transform.locationPoint(Sa.convert(g))}},{key:"unproject",value:function(g){return this.transform.pointLocation(Gi.convert(g))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(g){this.transform.setMaxBounds(pa.convert(g))}},{key:"setStyle",value:function(g){}},{key:"setMinZoom",value:function(g){if(g=g==null?Vl:g,g>=Vl&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between ".concat(Vl," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(g){if(g=g==null?Ju:g,g>=this.transform.minZoom)return this.transform.maxZoom=g,this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(g){if(g=g==null?zu:g,g<zu)throw new Error("minPitch must be greater than or equal to ".concat(zu));if(g>=zu&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between ".concat(zu," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(g){if(g=g==null?Nu:g,g>Nu)throw new Error("maxPitch must be less than or equal to ".concat(Nu));if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(g){this.transform.renderWorldCopies=!!g}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(g){return this.update(),this.renderTaskQueue.add(g)}},{key:"cancelRenderFrame",value:function(g){return this.renderTaskQueue.remove(g)}},{key:"triggerRepaint",value:function(){var g=this;this.frame||(this.frame=zi(function(L){Io.frame(L),g.frame=null,g.update(L)}))}},{key:"update",value:function(g){var L=this;this.frame||(this.frame=zi(function(N){Io.frame(N),L.frame=null,L.renderTaskQueue.run(g)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var g=this.container;g.classList.add("l7-map");var L=this.canvasContainer=gn.a.create("div","l7-canvas-container",g);this.options.interactive&&L.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var g=0,L=0;return this.container&&(g=this.container.clientWidth||400,L=this.container.clientHeight||300),[g,L]}},{key:"resizeCanvas",value:function(g,L){var N=window.devicePixelRatio||1;this.canvas.width=N*g,this.canvas.height=N*L,this.canvas.style.width="".concat(g,"px"),this.canvas.style.height="".concat(L,"px")}}]),s}(Sc),Vc=function(){function w(){we()(this,w),this.viewport=void 0}return Qe()(w,[{key:"syncWithMapCamera",value:function(s){var d=s.center,g=s.zoom,L=s.pitch,N=s.bearing,K=s.viewportHeight,ee=s.viewportWidth;this.viewport=new pc({width:ee,height:K,longitude:d&&d[0],latitude:d&&d[1],zoom:g,pitch:L,bearing:N})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(s,d){return this.viewport.projectFlat(s,d)}}]),w}(),gs={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},of,Lf,Rf,Uf,Qu,Sf,sf,uc,Fu,lc,Vf,_c,Cc,Gf;function Hf(w,p){var s=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),s.push.apply(s,d)}return s}function ah(w){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?Hf(Object(s),!0).forEach(function(d){fi()(w,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(s)):Hf(Object(s)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(s,d))})}return w}var Zf={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Df=12,ch=(of=Object($r.injectable)(),Lf=Object($r.inject)(de.TYPES.MapConfig),Rf=Object($r.inject)(de.TYPES.IGlobalConfigService),Uf=Object($r.inject)(de.TYPES.ILogService),Qu=Object($r.inject)(de.TYPES.ICoordinateSystemService),Sf=Object($r.inject)(de.TYPES.IEventEmitter),of(sf=(uc=(Gf=function(){function w(){var p=this;we()(this,w),this.map=void 0,Hn()(this,"config",Fu,this),Hn()(this,"configService",lc,this),Hn()(this,"logger",Vf,this),Hn()(this,"coordinateSystemService",_c,this),Hn()(this,"eventEmitter",Cc,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var s=p.map.getCenter(),d=s.lat,g=s.lng,L=p.config.offsetCoordinate,N=L===void 0?!0:L;p.viewport.syncWithMapCamera({bearing:p.map.getBearing(),center:[g,d],viewportHeight:p.map.transform.height,pitch:p.map.getPitch(),viewportWidth:p.map.transform.width,zoom:p.map.getZoom(),cameraHeight:0}),p.viewport.getZoom()>Df&&N?p.coordinateSystemService.setCoordinateSystem(de.CoordinateSystem.LNGLAT_OFFSET):p.coordinateSystemService.setCoordinateSystem(de.CoordinateSystem.LNGLAT),p.cameraChangedCallback(p.viewport)}}return Qe()(w,[{key:"addMarkerContainer",value:function(){var s=this.map.getCanvasContainer();this.markerContainer=gn.a.create("div","l7-marker-container",s),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(s,d){de.MapServiceEvent.indexOf(s)!==-1?this.eventEmitter.on(s,d):this.map.on(Zf[s]||s,d)}},{key:"off",value:function(s,d){this.map.off(Zf[s]||s,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var s=this.map.transform;return[s.width,s.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(s){return this.map.setZoom(s)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(s){this.map.setCenter(s)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(s){this.map.setBearing(s)}},{key:"zoomIn",value:function(s,d){this.map.zoomIn(s,d)}},{key:"zoomOut",value:function(s,d){this.map.zoomOut(s,d)}},{key:"setPitch",value:function(s){return this.map.setPitch(s)}},{key:"panTo",value:function(s){this.map.panTo(s)}},{key:"panBy",value:function(s){this.panTo(s)}},{key:"fitBounds",value:function(s,d){this.map.fitBounds(s,d)}},{key:"setMaxZoom",value:function(s){this.map.setMaxZoom(s)}},{key:"setMinZoom",value:function(s){this.map.setMinZoom(s)}},{key:"setMapStatus",value:function(s){s.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),s.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),s.dragEnable===!1&&this.map.dragPan.disable(),s.dragEnable===!0&&this.map.dragPan.enable(),s.rotateEnable===!1&&this.map.dragRotate.disable(),s.dragEnable===!0&&this.map.dragRotate.enable(),s.keyboardEnable===!1&&this.map.keyboard.disable(),s.keyboardEnable===!0&&this.map.keyboard.enable(),s.zoomEnable===!1&&this.map.scrollZoom.disable(),s.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(s,d){this.map.flyTo({zoom:s,center:d})}},{key:"setMapStyle",value:function(s){this.map.setStyle(this.getMapStyle(s))}},{key:"pixelToLngLat",value:function(s){return this.map.unproject(s)}},{key:"lngLatToPixel",value:function(s){return this.map.project(s)}},{key:"containerToLngLat",value:function(s){return this.map.unproject(s)}},{key:"lngLatToContainer",value:function(s){return this.map.project(s)}},{key:"lngLatToMercator",value:function(s,d){throw new Error("not implement")}},{key:"getModelMatrix",value:function(s,d,g){var L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],N=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var p=Er()(Bt.a.mark(function d(){var g,L,N,K,ee,Z,Se,pe,Fe,mt,Yt;return Bt.a.wrap(function(Qt){for(;;)switch(Qt.prev=Qt.next){case 0:g=this.config,L=g.id,N=L===void 0?"map":L,K=g.attributionControl,ee=K===void 0?!1:K,Z=g.style,Se=Z===void 0?"light":Z,pe=g.rotation,Fe=pe===void 0?0:pe,mt=g.mapInstance,Yt=_n()(g,["id","attributionControl","style","rotation","mapInstance"]),this.viewport=new Vc,mt?(this.map=mt,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(N),this.map=new Lo(ah({container:this.$mapContainer,style:this.getMapStyle(Se),bearing:Fe},Yt))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 6:case"end":return Qt.stop()}},d,this)}));function s(){return p.apply(this,arguments)}return s}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(s){for(var d,g=arguments.length,L=new Array(g>1?g-1:0),N=1;N<g;N++)L[N-1]=arguments[N];(d=this.eventEmitter).emit.apply(d,[s].concat(L))}},{key:"once",value:function(s){for(var d,g=arguments.length,L=new Array(g>1?g-1:0),N=1;N<g;N++)L[N-1]=arguments[N];(d=this.eventEmitter).once.apply(d,[s].concat(L))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(s){var d=this.map.getCanvas(),g=s==="jpg"?d==null?void 0:d.toDataURL("image/jpeg"):d==null?void 0:d.toDataURL("image/png");return g}},{key:"onCameraChanged",value:function(s){this.cameraChangedCallback=s}},{key:"creatAmapContainer",value:function(s){var d=s;return typeof s=="string"&&(d=document.getElementById(s)),d}},{key:"getMapStyle",value:function(s){return typeof s!="string"?s:gs[s]?gs[s]:s}}]),w}(),Gf),Fu=H()(uc.prototype,"config",[Lf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lc=H()(uc.prototype,"configService",[Rf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vf=H()(uc.prototype,"logger",[Uf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_c=H()(uc.prototype,"coordinateSystemService",[Qu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cc=H()(uc.prototype,"eventEmitter",[Sf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uc))||sf);function cc(w){var p=uf();return function(){var d=Sn()(w),g;if(p){var L=Sn()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function uf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var ao=function(w){pr()(s,w);var p=cc(s);function s(){return we()(this,s),p.apply(this,arguments)}return Qe()(s,[{key:"getServiceConstructor",value:function(){return ch}}]),s}(sr);function Gl(w,p){var s=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),s.push.apply(s,d)}return s}function lf(w){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?Gl(Object(s),!0).forEach(function(d){Gc(w,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(s)):Gl(Object(s)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(s,d))})}return w}function Gc(w,p,s){return p in w?Object.defineProperty(w,p,{value:s,enumerable:!0,configurable:!0,writable:!0}):w[p]=s,w}function nu(w,p){return cf(w)||Hc(w,p)||Ef(w,p)||Pl()}function Pl(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ef(w,p){if(!!w){if(typeof w=="string")return Tf(w,p);var s=Object.prototype.toString.call(w).slice(8,-1);if(s==="Object"&&w.constructor&&(s=w.constructor.name),s==="Map"||s==="Set")return Array.from(w);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Tf(w,p)}}function Tf(w,p){(p==null||p>w.length)&&(p=w.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=w[s];return d}function Hc(w,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))){var s=[],d=!0,g=!1,L=void 0;try{for(var N=w[Symbol.iterator](),K;!(d=(K=N.next()).done)&&(s.push(K.value),!(p&&s.length===p));d=!0);}catch(ee){g=!0,L=ee}finally{try{!d&&N.return!=null&&N.return()}finally{if(g)throw L}}return s}}function cf(w){if(Array.isArray(w))return w}var Zc=st.a.memo(function(w){var p=w.style,s=w.className,d=w.map,g=w.option,L=w.onSceneLoaded,N=w.children,K=Object(Oe.useRef)(null),ee=Object(Oe.useState)(),Z=nu(ee,2),Se=Z[0],pe=Z[1];return Object(Oe.useEffect)(function(){var Fe=new Ct.Scene(lf(lf({id:K.current},g),{},{map:new ao(d)}));return Fe.on("loaded",function(){pe(Fe),L&&L(Fe)}),function(){Fe.destroy()}},[]),Object(Oe.useEffect)(function(){Se&&d.style&&Se.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(Oe.useEffect)(function(){Se&&d.zoom&&Se.setZoom(d.zoom)},[d.zoom]),Object(Oe.useEffect)(function(){Se&&d.center&&Se.setCenter(d.center)},[JSON.stringify(d.center)]),Object(Oe.useEffect)(function(){Se&&d.pitch&&Se.setPitch(d.pitch)},[d.pitch]),Object(Oe.useEffect)(function(){Se&&d.rotation&&Se.setRotation(d.rotation)},[d.rotation]),st.a.createElement(dt.Provider,{value:Se},st.a.createElement("div",{ref:K,className:s,style:p},Se&&N))}),Hl=Zc;function ne(w,p){return ut(w)||_e(w,p)||z(w,p)||se()}function se(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z(w,p){if(!!w){if(typeof w=="string")return V(w,p);var s=Object.prototype.toString.call(w).slice(8,-1);if(s==="Object"&&w.constructor&&(s=w.constructor.name),s==="Map"||s==="Set")return Array.from(w);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return V(w,p)}}function V(w,p){(p==null||p>w.length)&&(p=w.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=w[s];return d}function _e(w,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))){var s=[],d=!0,g=!1,L=void 0;try{for(var N=w[Symbol.iterator](),K;!(d=(K=N.next()).done)&&(s.push(K.value),!(p&&s.length===p));d=!0);}catch(ee){g=!0,L=ee}finally{try{!d&&N.return!=null&&N.return()}finally{if(g)throw L}}return s}}function ut(w){if(Array.isArray(w))return w}var Ht=st.a.memo(function(w){var p=w.style,s=w.className,d=w.map,g=w.children,L=Object(Oe.useRef)(null),N=Object(Oe.useState)(),K=ne(N,2),ee=K[0],Z=K[1];return Object(Oe.useEffect)(function(){var Se=new Ct.Scene({id:L.current,map:d});return Se.on("loaded",function(){Z(Se)}),function(){Se.destroy()}},[]),st.a.createElement(dt.Provider,{value:ee},st.a.createElement("div",{ref:L,className:s,style:p},ee&&g))}),ir=st.a.memo(function(p){var s=vt(),d=Object(Oe.useRef)(),g=p.type,L=p.position;return Object(Oe.useEffect)(function(){var N;switch(g){case"scale":N=new Ct.Scale({position:L||"bottomright"});break;case"zoom":N=new Ct.Zoom({position:L||"topright"});break;case"logo":N=new Ct.Logo({position:L||"bottomleft"})}return d.current=N,s.addControl(N),function(){d.current=void 0,s.removeControl(N)}},[g]),Object(Oe.useEffect)(function(){d.current&&d.current.setPosition(L)},[L]),null}),tr=o("i8i4");function Or(w,p){return ra(w)||ni(w,p)||zn(w,p)||an()}function an(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zn(w,p){if(!!w){if(typeof w=="string")return Xn(w,p);var s=Object.prototype.toString.call(w).slice(8,-1);if(s==="Object"&&w.constructor&&(s=w.constructor.name),s==="Map"||s==="Set")return Array.from(w);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Xn(w,p)}}function Xn(w,p){(p==null||p>w.length)&&(p=w.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=w[s];return d}function ni(w,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))){var s=[],d=!0,g=!1,L=void 0;try{for(var N=w[Symbol.iterator](),K;!(d=(K=N.next()).done)&&(s.push(K.value),!(p&&s.length===p));d=!0);}catch(ee){g=!0,L=ee}finally{try{!d&&N.return!=null&&N.return()}finally{if(g)throw L}}return s}}function ra(w){if(Array.isArray(w))return w}var Oi=Oe.useEffect,la=Oe.useState;function Yi(w){var p=w.className,s=w.style,d=w.children,g=w.position,L=vt(),N=la(function(){return document.createElement("div")}),K=Or(N,1),ee=K[0];return Oi(function(){var Z=new Ct.Control({position:g});return Z.onAdd=function(){if(p&&(ee.className=p),s){var Se=Object.keys(s).map(function(pe){return"".concat(pe,":").concat(s[pe])}).join(";");ee.style.cssText=Se}return ee},L.addControl(Z),function(){L.removeControl(Z)}},[]),Object(tr.createPortal)(d,ee)}var ja=Object(Oe.createContext)({});function Ro(){return Object(Oe.useContext)(ja)}var So=Oe.useEffect,Ya=Oe.memo(function(p){var s=p.layer,d=p.active;return So(function(){s.active(d.option)},[JSON.stringify(d)]),null}),Vo=Oe.useEffect,ea=Oe.memo(function(p){var s=p.layer,d=p.animate;return Vo(function(){s.animate(d)},[JSON.stringify(d)]),null}),fo=Oe.useEffect,iu=Oe.memo(function(p){var s=p.layer,d=p.color;return fo(function(){d.field?s.color(d.field,d.values):s.color(d.values)},[d.field,d.scale,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),Ta=Oe.useEffect,Ua=Oe.memo(function(p){var s=p.layer,d=p.filter;return Ta(function(){d.field&&s.filter(d.field,d.values)},[d.field,d.values,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),bi=Oe.useEffect,Do=Oe.memo(function(p){var s=p.layer,d=p.scale;return bi(function(){s.scale(d.values)},[d.values]),null}),fc=Oe.useEffect,Wf=Oe.memo(function(p){var s=p.layer,d=p.select;return fc(function(){s.select(d.option)},[JSON.stringify(d)]),null}),fh=Oe.useEffect,Xf=Oe.memo(function(p){var s=p.layer,d=p.shape;return fh(function(){d.field?s.shape(d.field,d.values):s.shape(d.values)},[d.field,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),Bu=Oe.useEffect,Yf=Oe.memo(function(p){var s=p.layer,d=p.size;return Bu(function(){d.field?s.size(d.field,d.values):s.size(d.values)},[d.field,d.scale,JSON.stringify(d.values),JSON.stringify(d.options)]),null});function ff(w,p){if(w==null)return{};var s=Kf(w,p),d,g;if(Object.getOwnPropertySymbols){var L=Object.getOwnPropertySymbols(w);for(g=0;g<L.length;g++)d=L[g],!(p.indexOf(d)>=0)&&(!Object.prototype.propertyIsEnumerable.call(w,d)||(s[d]=w[d]))}return s}function Kf(w,p){if(w==null)return{};var s={},d=Object.keys(w),g,L;for(L=0;L<d.length;L++)g=d[L],!(p.indexOf(g)>=0)&&(s[g]=w[g]);return s}var Th=Oe.useEffect,hh=Oe.memo(function(p){var s=p.layer,d=p.source,g=d.data,L=ff(d,["data"]);return Th(function(){s.inited?s.setData(g,L):s.source(g,L),L.autoFit&&s.fitBounds(L&&L.fitBoundsOptions)},[g,JSON.stringify(L)]),null}),Af=Oe.useEffect,oh=Oe.memo(function(p){var s=p.layer,d=p.style;return Af(function(){s.style(d)},Object.keys(d).map(function(g){return d[g]})),null});function $f(w,p){return Ah(w)||zf(w,p)||Fh(w,p)||dh()}function dh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fh(w,p){if(!!w){if(typeof w=="string")return _f(w,p);var s=Object.prototype.toString.call(w).slice(8,-1);if(s==="Object"&&w.constructor&&(s=w.constructor.name),s==="Map"||s==="Set")return Array.from(w);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return _f(w,p)}}function _f(w,p){(p==null||p>w.length)&&(p=w.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=w[s];return d}function zf(w,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))){var s=[],d=!0,g=!1,L=void 0;try{for(var N=w[Symbol.iterator](),K;!(d=(K=N.next()).done)&&(s.push(K.value),!(p&&s.length===p));d=!0);}catch(ee){g=!0,L=ee}finally{try{!d&&N.return!=null&&N.return()}finally{if(g)throw L}}return s}}function Ah(w){if(Array.isArray(w))return w}var xe=Oe.useEffect,Be=Oe.useState;function Et(w,p){var s=p.source,d=p.color,g=p.shape,L=p.style,N=p.size,K=p.scale,ee=p.active,Z=p.select,Se=p.filter,pe=p.animate,Fe=p.options,mt=p.onLayerLoaded,Yt=vt(),jt=Be(),Qt=$f(jt,2),ur=Qt[0],kr=Qt[1];if(!ur){var on;switch(w){case"polygonLayer":on=new Ct.PolygonLayer(Fe);break;case"lineLayer":on=new Ct.LineLayer(Fe);break;case"pointLayer":on=new Ct.PointLayer(Fe);break;case"heatmapLayer":on=new Ct.HeatmapLayer(Fe);break;case"rasterLayer":on=new Ct.RasterLayer(Fe);break;case"imageLayer":on=new Ct.ImageLayer(Fe);break;case"citybuildingLayer":on=new Ct.CityBuildingLayer(Fe);break;default:on=new Ct.PolygonLayer(Fe)}on.on("inited",function(){mt&&mt(on,Yt)}),kr(on)}return xe(function(){if(ur!==void 0)return Yt.addLayer(ur),function(){Yt.removeLayer(ur)}},[]),xe(function(){ur&&ur.inited&&Fe&&(ur.updateLayerConfig(Fe),Yt.render())},[Fe==null?void 0:Fe.minZoom,Fe==null?void 0:Fe.maxZoom,Fe==null?void 0:Fe.visible]),xe(function(){ur&&ur.inited&&Fe&&Fe.zIndex&&ur.setIndex(Fe.zIndex)},[Fe==null?void 0:Fe.zIndex]),xe(function(){ur&&ur.inited&&Fe&&Fe.blend&&ur.setBlend(Fe.blend)},[Fe==null?void 0:Fe.blend]),xe(function(){ur&&Yt.render()},[]),ur!=null?Oe.createElement(ja.Provider,{value:ur},Oe.createElement(hh,{layer:ur,source:s}),K&&Oe.createElement(Do,{layer:ur,scale:K}),d&&Oe.createElement(iu,{layer:ur,color:d}),N&&Oe.createElement(Yf,{layer:ur,size:N}),g&&Oe.createElement(Xf,{layer:ur,shape:g}),L&&Oe.createElement(oh,{layer:ur,style:L}),ee&&Oe.createElement(Ya,{layer:ur,active:ee}),Z&&Oe.createElement(Wf,{layer:ur,select:Z}),Se&&Oe.createElement(Ua,{layer:ur,filter:Se}),pe&&Oe.createElement(ea,{layer:ur,animate:pe}),p.children):null}var gr=Oe.memo(function(p){return Et("polygonLayer",p)}),Mr=Oe.memo(function(p){return Et("lineLayer",p)}),Cr=Oe.memo(function(p){return Et("pointLayer",p)}),xr=Oe.memo(function(p){return Et("heatmapLayer",p)}),Wr=Oe.memo(function(p){return Et("rasterLayer",p)}),sn=Oe.memo(function(p){return Et("imageLayer",p)}),en=Oe.memo(function(p){return Et("citybuildingLayer",p)}),Qr=Oe.useEffect,fn=Oe.memo(function(w){var p=w.type,s=w.handler,d=Ro();return Qr(function(){return d.off(p,s),d.on(p,s),function(){d.off(p,s)}},[p,s]),null}),Cn=Oe.memo(function(w){var p=[{title:"1",color:"rgb(239,243,255)"},{title:"10",color:"rgb(198,219,239)"},{title:"30",color:"rgb(158,202,225)"},{title:"50",color:"rgb(107,174,214)"},{title:"60",color:"rgb(49,130,189)"},{title:"100",color:"rgb(8,81,156)"}],s=w.items,d=s===void 0?p:s;return Oe.createElement("div",null,Oe.createElement("div",null,d.map(function(g,L){return Oe.createElement("div",{key:L,style:{background:g.color,height:"100%",display:"inline-block",cursor:"pointer",width:""+(100-d.length)/d.length+"%",marginRight:"1%",padding:5}})})),Oe.createElement("div",null,d.map(function(g,L){return Oe.createElement("div",{key:L,style:{background:"#fff",height:"100%",display:"inline-block",textAlign:"left",cursor:"pointer",width:""+(100-d.length)/d.length+"%",marginRight:"1%"}},g.title)})))});function cn(w){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?cn=function(s){return typeof s}:cn=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},cn(w)}function rn(w,p){var s=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),s.push.apply(s,d)}return s}function yr(w){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?rn(Object(s),!0).forEach(function(d){vr(w,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(s)):rn(Object(s)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(s,d))})}return w}function vr(w,p,s){return p in w?Object.defineProperty(w,p,{value:s,enumerable:!0,configurable:!0,writable:!0}):w[p]=s,w}function Xr(w,p){if(!(w instanceof p))throw new TypeError("Cannot call a class as a function")}function Pn(w,p){for(var s=0;s<p.length;s++){var d=p[s];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(w,d.key,d)}}function Lr(w,p,s){return p&&Pn(w.prototype,p),s&&Pn(w,s),w}function qn(w,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(p&&p.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),p&&Jr(w,p)}function Jr(w,p){return Jr=Object.setPrototypeOf||function(d,g){return d.__proto__=g,d},Jr(w,p)}function Br(w){var p=Yn();return function(){var d=ti(w),g;if(p){var L=ti(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return Ur(this,g)}}function Ur(w,p){return p&&(cn(p)==="object"||typeof p=="function")?p:Kr(w)}function Kr(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}function Yn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}function ti(w){return ti=Object.setPrototypeOf?Object.getPrototypeOf:function(s){return s.__proto__||Object.getPrototypeOf(s)},ti(w)}var un=function(w){qn(s,w);var p=Br(s);function s(d){var g;return Xr(this,s),g=p.call(this,d),g.el=document.createElement("div"),g}return Lr(s,[{key:"componentDidMount",value:function(){var g,L=this.props,N=L.lnglat,K=L.children,ee=L.option,Z=L.lngLat,Se=new Ct.Popup(yr(yr({},ee),{},{stopPropagation:(g=this.props.option)===null||g===void 0?void 0:g.stopPropagation}));N&&Se.setLnglat(N),Z&&Se.setLnglat(Z),K&&Se.setDOMContent(this.el),this.popup=Se,this.scene.addPopup(Se)}},{key:"componentDidUpdate",value:function(g){var L,N,K,ee,Z,Se,pe=Array.isArray(g.lnglat)?g.lnglat:[g==null||(L=g.lnglat)===null||L===void 0?void 0:L.lng,g==null||(N=g.lnglat)===null||N===void 0?void 0:N.lat],Fe=Array.isArray(this.props.lnglat)?this.props.lnglat:[(K=this.props)===null||K===void 0||(ee=K.lnglat)===null||ee===void 0?void 0:ee.lng,(Z=this.props)===null||Z===void 0||(Se=Z.lnglat)===null||Se===void 0?void 0:Se.lat],mt=pe.toString()!==Fe.toString();if(mt){var Yt;this.popup.remove(),this.popup=new Ct.Popup(yr(yr({},this.props.option),{},{stopPropagation:(Yt=this.props.option)===null||Yt===void 0?void 0:Yt.stopPropagation})),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup)}}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var g=this;return Oe.createElement(dt.Consumer,{},function(L){return L&&(g.scene=L),Object(tr.createPortal)(g.props.children,g.el)})}}]),s}(Oe.PureComponent);function Vr(w){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Vr=function(s){return typeof s}:Vr=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Vr(w)}function Nr(w,p){if(!(w instanceof p))throw new TypeError("Cannot call a class as a function")}function di(w,p){for(var s=0;s<p.length;s++){var d=p[s];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(w,d.key,d)}}function pi(w,p,s){return p&&di(w.prototype,p),s&&di(w,s),w}function kn(w,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(p&&p.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),p&&Ni(w,p)}function Ni(w,p){return Ni=Object.setPrototypeOf||function(d,g){return d.__proto__=g,d},Ni(w,p)}function Ci(w){var p=Go();return function(){var d=Ho(w),g;if(p){var L=Ho(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return ki(this,g)}}function ki(w,p){return p&&(Vr(p)==="object"||typeof p=="function")?p:ca(w)}function ca(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}function Go(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}function Ho(w){return Ho=Object.setPrototypeOf?Object.getPrototypeOf:function(s){return s.__proto__||Object.getPrototypeOf(s)},Ho(w)}var ta=function(w){kn(s,w);var p=Ci(s);function s(d){var g;return Nr(this,s),g=p.call(this,d),g.el=document.createElement("div"),g}return pi(s,[{key:"componentDidMount",value:function(){var g=this.props,L=g.lnglat,N=g.children,K=g.option,ee=g.onMarkerLoaded,Z=new Ct.Marker(K);L&&Z.setLnglat(L),N&&Z.setElement(this.el),this.marker=Z,ee&&ee(Z),this.scene.addMarker(Z)}},{key:"componentDidUpdate",value:function(g){var L,N=(g==null?void 0:g.lnglat.toString())!==((L=this.props)===null||L===void 0?void 0:L.lnglat.toString());N&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var g=this;return Oe.createElement(dt.Consumer,{},function(L){return L&&(g.scene=L),Object(tr.createPortal)(g.props.children,g.el)})}}]),s}(Oe.PureComponent),ho=Oe.useEffect,Ma=Oe.memo(function(w){var p=w.type,s=w.handler,d=vt();return ho(function(){return d.on(p,s),function(){d.off(p,s)}},[p]),null}),_s=Ma,Qo=Oe.useEffect,ys=Oe.memo(function(p){var s=p.name,d=p.url,g=vt();return Qo(function(){g.addImage(s,d)},[s,d]),null}),qo=o("95SA"),Hs=["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],zo=function(w){Object(ce.a)(s,w);var p=Object(Y.a)(s);function s(){var d;Object(J.a)(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.state={data:null,grid:null,loading:!1},d}return Object(te.a)(s,[{key:"componentDidMount",value:function(){var d=Object(lr.a)(Bt.a.mark(function L(){var N,K,ee,Z;return Bt.a.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.next=2,Promise.all([fetch("https://gw.alipayobjects.com/os/bmw-prod/c5dba875-b6ea-4e88-b778-66a862906c93.json").then(function(Fe){return Fe.json()}),fetch("https://gw.alipayobjects.com/os/bmw-prod/8990e8b4-c58e-419b-afb9-8ea3daff2dd1.json").then(function(Fe){return Fe.json()})]);case 2:N=pe.sent,K=Object(q.a)(N,2),ee=K[0],Z=K[1],this.setState({data:ee,grid:Z,loading:!0});case 7:case"end":return pe.stop()}},L,this)}));function g(){return d.apply(this,arguments)}return g}()},{key:"render",value:function(){var g=this.state,L=g.data,N=g.grid,K=g.loading;return K===!1?Object(a.jsx)(qo.a,{}):Object(a.jsxs)(mf,{map:{center:[110.19382669582967,50.258134],pitch:0,style:"blank",zoom:1},style:{position:"relative",width:"100%",height:"452px"},children:[N&&Object(a.jsx)(xr,{source:{data:N,transforms:[{type:"hexagon",size:8e5,field:"capacity",method:"sum"}]},color:{values:"#ddd"},shape:{values:"hexagon"},style:{coverage:.7,opacity:.8}},"1"),L&&[Object(a.jsx)(Cr,{options:{autoFit:!0},source:{data:L},scale:{values:{color:{field:"cum_conf",type:"quantile"},size:{field:"cum_conf",type:"log"}}},color:{field:"cum_conf",values:Hs},shape:{values:"circle"},active:{option:{color:"#0c2c84"}},size:{field:"cum_conf",values:[0,30]},style:{opacity:.8}},"2"),Object(a.jsx)(Cr,{source:{data:L},color:{values:"#fff"},shape:{field:"Short_Name_ZH",values:"text"},filter:{field:"cum_conf",values:function(Z){return Z>2e3}},size:{values:12},style:{opacity:1,strokeOpacity:1,strokeWidth:0}},"5")]]})}}]),s}(Oe.Component),ui={Pie:R,WaterWave:ie,Gauge:$t,MiniArea:G,TagCloud:nt,Map:zo},Zs=o("KQm4"),Aa=o("H+7v"),bn=o.n(Aa);function Li(w){return w*1<10?"0".concat(w):w}function ji(){for(var w=[],p=0;p<24;p+=1)w.push({x:"".concat(Li(p),":00"),y:Math.floor(Math.random()*200)+p*50});return w}var es=function(w){Object(ce.a)(s,w);var p=Object(Y.a)(s);function s(){var d;Object(J.a)(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.state={activeData:ji()},d.timer=void 0,d.requestRef=void 0,d.loopData=function(){d.requestRef=requestAnimationFrame(function(){d.timer=window.setTimeout(function(){d.setState({activeData:ji()},function(){d.loopData()})},1e3)})},d}return Object(te.a)(s,[{key:"componentDidMount",value:function(){this.loopData()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.requestRef&&cancelAnimationFrame(this.requestRef)}},{key:"render",value:function(){var g=this.state.activeData,L=g===void 0?[]:g;return Object(a.jsxs)("div",{className:bn.a.activeChart,children:[Object(a.jsx)(Ke.a,{title:"\u76EE\u6807\u8BC4\u4F30",value:"\u6709\u671B\u8FBE\u5230\u9884\u671F"}),Object(a.jsx)("div",{style:{marginTop:32},children:Object(a.jsx)(G,{animate:!1,line:!0,borderWidth:2,height:84,scale:{y:{tickCount:3}},yAxis:{tickLine:void 0,label:void 0,title:void 0,line:void 0},data:L})}),L&&Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{className:bn.a.activeChartGrid,children:[Object(a.jsxs)("p",{children:[Object(Zs.a)(L).sort()[L.length-1].y+200," \u4EBF\u5143"]}),Object(a.jsxs)("p",{children:[Object(Zs.a)(L).sort()[Math.floor(L.length/2)].y," \u4EBF\u5143"]})]}),Object(a.jsx)("div",{className:bn.a.dashedLine,children:Object(a.jsx)("div",{className:bn.a.line})}),Object(a.jsx)("div",{className:bn.a.dashedLine,children:Object(a.jsx)("div",{className:bn.a.line})})]}),L&&Object(a.jsxs)("div",{className:bn.a.activeChartLegend,children:[Object(a.jsx)("span",{children:"00:00"}),Object(a.jsx)("span",{children:L[Math.floor(L.length/2)].x}),Object(a.jsx)("span",{children:L[L.length-1].x})]})]})}}]),s}(Oe.Component),au=o("Wnft"),hc=o.n(au),Ot=Ke.a.Countdown,Sr=Date.now()+1e3*60*60*24*2+1e3*30,mr=function(w){Object(ce.a)(s,w);var p=Object(Y.a)(s);function s(){return Object(J.a)(this,s),p.apply(this,arguments)}return Object(te.a)(s,[{key:"componentDidMount",value:function(){var g=this.props.dispatch;g({type:"dashboardAndmonitor/fetchTags"})}},{key:"render",value:function(){var g=this.props,L=g.dashboardAndmonitor,N=g.loading,K=L.tags;return Object(a.jsx)(Le.a,{children:Object(a.jsxs)(st.a.Fragment,{children:[Object(a.jsxs)(B.a,{gutter:24,children:[Object(a.jsx)(D.a,{xl:18,lg:24,md:24,sm:24,xs:24,style:{marginBottom:24},children:Object(a.jsxs)(v.a,{title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.trading-activity",defaultMessage:"Real-Time Trading Activity"}),bordered:!1,children:[Object(a.jsxs)(B.a,{children:[Object(a.jsx)(D.a,{md:6,sm:12,xs:24,children:Object(a.jsx)(Ke.a,{title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.total-transactions",defaultMessage:"Total transactions today"}),suffix:"\u5143",value:it()(124543233).format("0,0")})}),Object(a.jsx)(D.a,{md:6,sm:12,xs:24,children:Object(a.jsx)(Ke.a,{title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.sales-target",defaultMessage:"Sales target completion rate"}),value:"92%"})}),Object(a.jsx)(D.a,{md:6,sm:12,xs:24,children:Object(a.jsx)(Ot,{title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.remaining-time",defaultMessage:"Remaining time of activity"}),value:Sr,format:"HH:mm:ss:SSS"})}),Object(a.jsx)(D.a,{md:6,sm:12,xs:24,children:Object(a.jsx)(Ke.a,{title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.total-transactions-per-second",defaultMessage:"Total transactions per second"}),suffix:"\u5143",value:it()(234).format("0,0")})})]}),Object(a.jsx)("div",{className:hc.a.mapChart,children:Object(a.jsx)(zo,{})})]})}),Object(a.jsxs)(D.a,{xl:6,lg:24,md:24,sm:24,xs:24,children:[Object(a.jsx)(v.a,{title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.activity-forecast",defaultMessage:"Activity forecast"}),style:{marginBottom:24},bordered:!1,children:Object(a.jsx)(es,{})}),Object(a.jsx)(v.a,{title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.efficiency",defaultMessage:"Efficiency"}),style:{marginBottom:24},bodyStyle:{textAlign:"center"},bordered:!1,children:Object(a.jsx)($t,{title:Object(We.d)({id:"dashboardandmonitor.monitor.ratio",defaultMessage:"Ratio"}),height:180,percent:87})})]})]}),Object(a.jsxs)(B.a,{gutter:24,children:[Object(a.jsx)(D.a,{xl:12,lg:24,sm:24,xs:24,style:{marginBottom:24},children:Object(a.jsx)(v.a,{title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.proportion-per-category",defaultMessage:"Proportion Per Category"}),bordered:!1,className:hc.a.pieCard,children:Object(a.jsxs)(B.a,{style:{padding:"16px 0"},children:[Object(a.jsx)(D.a,{span:8,children:Object(a.jsx)(R,{animate:!1,percent:28,title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.fast-food",defaultMessage:"Fast food"}),total:"28%",height:128,lineWidth:2})}),Object(a.jsx)(D.a,{span:8,children:Object(a.jsx)(R,{animate:!1,color:"#5DDECF",percent:22,title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.western-food",defaultMessage:"Western food"}),total:"22%",height:128,lineWidth:2})}),Object(a.jsx)(D.a,{span:8,children:Object(a.jsx)(R,{animate:!1,color:"#2FC25B",percent:32,title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.hot-pot",defaultMessage:"Hot pot"}),total:"32%",height:128,lineWidth:2})})]})})}),Object(a.jsx)(D.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24},children:Object(a.jsx)(v.a,{title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.popular-searches",defaultMessage:"Popular Searches"}),loading:N,bordered:!1,bodyStyle:{overflow:"hidden"},children:Object(a.jsx)(nt,{data:K||[],height:161})})}),Object(a.jsx)(D.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24},children:Object(a.jsx)(v.a,{title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.resource-surplus",defaultMessage:"Resource Surplus"}),bodyStyle:{textAlign:"center",fontSize:0},bordered:!1,children:Object(a.jsx)(ie,{height:161,title:Object(a.jsx)(We.a,{id:"dashboardandmonitor.monitor.fund-surplus",defaultMessage:"Fund Surplus"}),percent:34})})})]})]})})}}]),s}(Oe.Component),Rn=y.default=Object(We.c)(function(w){var p=w.dashboardAndmonitor,s=w.loading;return{dashboardAndmonitor:p,loading:s.models.dashboardAndmonitor}})(mr)},aF1E:function(Re,y,o){"use strict";o.d(y,"a",function(){return a});var S=o("lSNA"),v=o.n(S);function X(W,D){var J=Object.keys(W);if(Object.getOwnPropertySymbols){var te=Object.getOwnPropertySymbols(W);D&&(te=te.filter(function(ce){return Object.getOwnPropertyDescriptor(W,ce).enumerable})),J.push.apply(J,te)}return J}function B(W){for(var D=1;D<arguments.length;D++){var J=arguments[D]!=null?arguments[D]:{};D%2?X(Object(J),!0).forEach(function(te){v()(W,te,J[te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(W,Object.getOwnPropertyDescriptors(J)):X(Object(J)).forEach(function(te){Object.defineProperty(W,te,Object.getOwnPropertyDescriptor(J,te))})}return W}function a(W,D){var J=D.sourceField,te=D.targetField,ce=D.data,Y={};return ce.forEach(function(ke){Y[ke[J]]=ke}),W.dataArray=W.dataArray.map(function(ke){var Ke=ke[te];return B(B({},ke),Y[Ke])}),W}},aHsQ:function(Re,y,o){"use strict";var S=o("cIOH"),v=o.n(S),X=o("6D9b"),B=o.n(X),a=o("cWXX")},aPG5:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.resolve=void 0;var S=o("MON2"),v=o("FV85"),X=o("qK8v"),B=o("ujMp"),a=o("cSJO"),W=function(ce,Y,ke){try{return ke()}catch(Ke){throw X.isStackOverflowExeption(Ke)?new Error(S.CIRCULAR_DEPENDENCY_IN_FACTORY(ce,Y.toString())):Ke}},D=function te(ce){return function(Y){Y.parentContext.setCurrentRequest(Y);var ke=Y.bindings,Ke=Y.childRequests,We=Y.target&&Y.target.isArray(),Oe=!Y.parentRequest||!Y.parentRequest.target||!Y.target||!Y.parentRequest.target.matchesArray(Y.target.serviceIdentifier);if(We&&Oe)return Ke.map(function(Ze){var St=te(ce);return St(Ze)});var st=null;if(Y.target.isOptional()&&ke.length===0)return;var Le=ke[0],xt=Le.scope===v.BindingScopeEnum.Singleton,it=Le.scope===v.BindingScopeEnum.Request;if(xt&&Le.activated)return Le.cache;if(it&&ce!==null&&ce.has(Le.id))return ce.get(Le.id);if(Le.type===v.BindingTypeEnum.ConstantValue)st=Le.cache;else if(Le.type===v.BindingTypeEnum.Function)st=Le.cache;else if(Le.type===v.BindingTypeEnum.Constructor)st=Le.implementationType;else if(Le.type===v.BindingTypeEnum.DynamicValue&&Le.dynamicValue!==null)st=W("toDynamicValue",Le.serviceIdentifier,function(){return Le.dynamicValue(Y.parentContext)});else if(Le.type===v.BindingTypeEnum.Factory&&Le.factory!==null)st=W("toFactory",Le.serviceIdentifier,function(){return Le.factory(Y.parentContext)});else if(Le.type===v.BindingTypeEnum.Provider&&Le.provider!==null)st=W("toProvider",Le.serviceIdentifier,function(){return Le.provider(Y.parentContext)});else if(Le.type===v.BindingTypeEnum.Instance&&Le.implementationType!==null)st=a.resolveInstance(Le.implementationType,Ke,te(ce));else{var $e=B.getServiceIdentifierAsString(Y.serviceIdentifier);throw new Error(S.INVALID_BINDING_TYPE+" "+$e)}return typeof Le.onActivation=="function"&&(st=Le.onActivation(Y.parentContext,st)),xt&&(Le.cache=st,Le.activated=!0),it&&ce!==null&&!ce.has(Le.id)&&ce.set(Le.id,st),st}};function J(te){var ce=D(te.plan.rootRequest.requestScope);return ce(te.plan.rootRequest)}y.resolve=J},asDA:function(Re,y){function o(S,v,X,B){var a=-1,W=S==null?0:S.length;for(B&&W&&(X=S[++a]);++a<W;)X=v(X,S[a],a,S);return X}Re.exports=o},b2z7:function(Re,y){var o=/\w*$/;function S(v){var X=new v.constructor(v.source,o.exec(v));return X.lastIndex=v.lastIndex,X}Re.exports=S},bB6j:function(Re,y,o){"use strict";o.d(y,"a",function(){return S});var S={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},bPkA:function(Re,y,o){"use strict";o.d(y,"a",function(){return S});var S;(function(v){v.Normal="normal",v.PostProcessing="post-processing"})(S||(S={}))},bTtR:function(Re,y){},bYl4:function(Re,y){},bahg:function(Re,y){function o(S){return S.split("")}Re.exports=o},bl9R:function(Re,y,o){"use strict";o.r(y),o.d(y,"create",function(){return v}),o.d(y,"clone",function(){return X}),o.d(y,"fromValues",function(){return B}),o.d(y,"copy",function(){return a}),o.d(y,"set",function(){return W}),o.d(y,"add",function(){return D}),o.d(y,"subtract",function(){return J}),o.d(y,"multiply",function(){return te}),o.d(y,"divide",function(){return ce}),o.d(y,"ceil",function(){return Y}),o.d(y,"floor",function(){return ke}),o.d(y,"min",function(){return Ke}),o.d(y,"max",function(){return We}),o.d(y,"round",function(){return Oe}),o.d(y,"scale",function(){return st}),o.d(y,"scaleAndAdd",function(){return Le}),o.d(y,"distance",function(){return xt}),o.d(y,"squaredDistance",function(){return it}),o.d(y,"length",function(){return $e}),o.d(y,"squaredLength",function(){return Ze}),o.d(y,"negate",function(){return St}),o.d(y,"inverse",function(){return bt}),o.d(y,"normalize",function(){return Ne}),o.d(y,"dot",function(){return ze}),o.d(y,"cross",function(){return Ue}),o.d(y,"lerp",function(){return lt}),o.d(y,"random",function(){return Me}),o.d(y,"transformMat4",function(){return ct}),o.d(y,"transformQuat",function(){return Gt}),o.d(y,"zero",function(){return $t}),o.d(y,"str",function(){return ar}),o.d(y,"exactEquals",function(){return oe}),o.d(y,"equals",function(){return Q}),o.d(y,"sub",function(){return G}),o.d(y,"mul",function(){return Ce}),o.d(y,"div",function(){return be}),o.d(y,"dist",function(){return Te}),o.d(y,"sqrDist",function(){return me}),o.d(y,"len",function(){return rt}),o.d(y,"sqrLen",function(){return Kt}),o.d(y,"forEach",function(){return _t});var S=o("yU0y");function v(){var ge=new S.a(4);return S.a!=Float32Array&&(ge[0]=0,ge[1]=0,ge[2]=0,ge[3]=0),ge}function X(ge){var ye=new S.a(4);return ye[0]=ge[0],ye[1]=ge[1],ye[2]=ge[2],ye[3]=ge[3],ye}function B(ge,ye,Ve,ft){var Ie=new S.a(4);return Ie[0]=ge,Ie[1]=ye,Ie[2]=Ve,Ie[3]=ft,Ie}function a(ge,ye){return ge[0]=ye[0],ge[1]=ye[1],ge[2]=ye[2],ge[3]=ye[3],ge}function W(ge,ye,Ve,ft,Ie){return ge[0]=ye,ge[1]=Ve,ge[2]=ft,ge[3]=Ie,ge}function D(ge,ye,Ve){return ge[0]=ye[0]+Ve[0],ge[1]=ye[1]+Ve[1],ge[2]=ye[2]+Ve[2],ge[3]=ye[3]+Ve[3],ge}function J(ge,ye,Ve){return ge[0]=ye[0]-Ve[0],ge[1]=ye[1]-Ve[1],ge[2]=ye[2]-Ve[2],ge[3]=ye[3]-Ve[3],ge}function te(ge,ye,Ve){return ge[0]=ye[0]*Ve[0],ge[1]=ye[1]*Ve[1],ge[2]=ye[2]*Ve[2],ge[3]=ye[3]*Ve[3],ge}function ce(ge,ye,Ve){return ge[0]=ye[0]/Ve[0],ge[1]=ye[1]/Ve[1],ge[2]=ye[2]/Ve[2],ge[3]=ye[3]/Ve[3],ge}function Y(ge,ye){return ge[0]=Math.ceil(ye[0]),ge[1]=Math.ceil(ye[1]),ge[2]=Math.ceil(ye[2]),ge[3]=Math.ceil(ye[3]),ge}function ke(ge,ye){return ge[0]=Math.floor(ye[0]),ge[1]=Math.floor(ye[1]),ge[2]=Math.floor(ye[2]),ge[3]=Math.floor(ye[3]),ge}function Ke(ge,ye,Ve){return ge[0]=Math.min(ye[0],Ve[0]),ge[1]=Math.min(ye[1],Ve[1]),ge[2]=Math.min(ye[2],Ve[2]),ge[3]=Math.min(ye[3],Ve[3]),ge}function We(ge,ye,Ve){return ge[0]=Math.max(ye[0],Ve[0]),ge[1]=Math.max(ye[1],Ve[1]),ge[2]=Math.max(ye[2],Ve[2]),ge[3]=Math.max(ye[3],Ve[3]),ge}function Oe(ge,ye){return ge[0]=Math.round(ye[0]),ge[1]=Math.round(ye[1]),ge[2]=Math.round(ye[2]),ge[3]=Math.round(ye[3]),ge}function st(ge,ye,Ve){return ge[0]=ye[0]*Ve,ge[1]=ye[1]*Ve,ge[2]=ye[2]*Ve,ge[3]=ye[3]*Ve,ge}function Le(ge,ye,Ve,ft){return ge[0]=ye[0]+Ve[0]*ft,ge[1]=ye[1]+Ve[1]*ft,ge[2]=ye[2]+Ve[2]*ft,ge[3]=ye[3]+Ve[3]*ft,ge}function xt(ge,ye){var Ve=ye[0]-ge[0],ft=ye[1]-ge[1],Ie=ye[2]-ge[2],pt=ye[3]-ge[3];return Math.hypot(Ve,ft,Ie,pt)}function it(ge,ye){var Ve=ye[0]-ge[0],ft=ye[1]-ge[1],Ie=ye[2]-ge[2],pt=ye[3]-ge[3];return Ve*Ve+ft*ft+Ie*Ie+pt*pt}function $e(ge){var ye=ge[0],Ve=ge[1],ft=ge[2],Ie=ge[3];return Math.hypot(ye,Ve,ft,Ie)}function Ze(ge){var ye=ge[0],Ve=ge[1],ft=ge[2],Ie=ge[3];return ye*ye+Ve*Ve+ft*ft+Ie*Ie}function St(ge,ye){return ge[0]=-ye[0],ge[1]=-ye[1],ge[2]=-ye[2],ge[3]=-ye[3],ge}function bt(ge,ye){return ge[0]=1/ye[0],ge[1]=1/ye[1],ge[2]=1/ye[2],ge[3]=1/ye[3],ge}function Ne(ge,ye){var Ve=ye[0],ft=ye[1],Ie=ye[2],pt=ye[3],C=Ve*Ve+ft*ft+Ie*Ie+pt*pt;return C>0&&(C=1/Math.sqrt(C)),ge[0]=Ve*C,ge[1]=ft*C,ge[2]=Ie*C,ge[3]=pt*C,ge}function ze(ge,ye){return ge[0]*ye[0]+ge[1]*ye[1]+ge[2]*ye[2]+ge[3]*ye[3]}function Ue(ge,ye,Ve,ft){var Ie=Ve[0]*ft[1]-Ve[1]*ft[0],pt=Ve[0]*ft[2]-Ve[2]*ft[0],C=Ve[0]*ft[3]-Ve[3]*ft[0],R=Ve[1]*ft[2]-Ve[2]*ft[1],q=Ve[1]*ft[3]-Ve[3]*ft[1],fe=Ve[2]*ft[3]-Ve[3]*ft[2],Ge=ye[0],Je=ye[1],yt=ye[2],nt=ye[3];return ge[0]=Je*fe-yt*q+nt*R,ge[1]=-(Ge*fe)+yt*C-nt*pt,ge[2]=Ge*q-Je*C+nt*Ie,ge[3]=-(Ge*R)+Je*pt-yt*Ie,ge}function lt(ge,ye,Ve,ft){var Ie=ye[0],pt=ye[1],C=ye[2],R=ye[3];return ge[0]=Ie+ft*(Ve[0]-Ie),ge[1]=pt+ft*(Ve[1]-pt),ge[2]=C+ft*(Ve[2]-C),ge[3]=R+ft*(Ve[3]-R),ge}function Me(ge,ye){ye=ye||1;var Ve,ft,Ie,pt,C,R;do Ve=S.c()*2-1,ft=S.c()*2-1,C=Ve*Ve+ft*ft;while(C>=1);do Ie=S.c()*2-1,pt=S.c()*2-1,R=Ie*Ie+pt*pt;while(R>=1);var q=Math.sqrt((1-C)/R);return ge[0]=ye*Ve,ge[1]=ye*ft,ge[2]=ye*Ie*q,ge[3]=ye*pt*q,ge}function ct(ge,ye,Ve){var ft=ye[0],Ie=ye[1],pt=ye[2],C=ye[3];return ge[0]=Ve[0]*ft+Ve[4]*Ie+Ve[8]*pt+Ve[12]*C,ge[1]=Ve[1]*ft+Ve[5]*Ie+Ve[9]*pt+Ve[13]*C,ge[2]=Ve[2]*ft+Ve[6]*Ie+Ve[10]*pt+Ve[14]*C,ge[3]=Ve[3]*ft+Ve[7]*Ie+Ve[11]*pt+Ve[15]*C,ge}function Gt(ge,ye,Ve){var ft=ye[0],Ie=ye[1],pt=ye[2],C=Ve[0],R=Ve[1],q=Ve[2],fe=Ve[3],Ge=fe*ft+R*pt-q*Ie,Je=fe*Ie+q*ft-C*pt,yt=fe*pt+C*Ie-R*ft,nt=-C*ft-R*Ie-q*pt;return ge[0]=Ge*fe+nt*-C+Je*-q-yt*-R,ge[1]=Je*fe+nt*-R+yt*-C-Ge*-q,ge[2]=yt*fe+nt*-q+Ge*-R-Je*-C,ge[3]=ye[3],ge}function $t(ge){return ge[0]=0,ge[1]=0,ge[2]=0,ge[3]=0,ge}function ar(ge){return"vec4("+ge[0]+", "+ge[1]+", "+ge[2]+", "+ge[3]+")"}function oe(ge,ye){return ge[0]===ye[0]&&ge[1]===ye[1]&&ge[2]===ye[2]&&ge[3]===ye[3]}function Q(ge,ye){var Ve=ge[0],ft=ge[1],Ie=ge[2],pt=ge[3],C=ye[0],R=ye[1],q=ye[2],fe=ye[3];return Math.abs(Ve-C)<=S.b*Math.max(1,Math.abs(Ve),Math.abs(C))&&Math.abs(ft-R)<=S.b*Math.max(1,Math.abs(ft),Math.abs(R))&&Math.abs(Ie-q)<=S.b*Math.max(1,Math.abs(Ie),Math.abs(q))&&Math.abs(pt-fe)<=S.b*Math.max(1,Math.abs(pt),Math.abs(fe))}var G=J,Ce=te,be=ce,Te=xt,me=it,rt=$e,Kt=Ze,_t=function(){var ge=v();return function(ye,Ve,ft,Ie,pt,C){var R,q;for(Ve||(Ve=4),ft||(ft=0),Ie?q=Math.min(Ie*Ve+ft,ye.length):q=ye.length,R=ft;R<q;R+=Ve)ge[0]=ye[R],ge[1]=ye[R+1],ge[2]=ye[R+2],ge[3]=ye[R+3],pt(ge,ge,C),ye[R]=ge[0],ye[R+1]=ge[1],ye[R+2]=ge[2],ye[R+3]=ge[3];return ye}}()},bzyH:function(Re,y){},cSJO:function(Re,y,o){"use strict";var S=this&&this.__spreadArrays||function(){for(var te=0,ce=0,Y=arguments.length;ce<Y;ce++)te+=arguments[ce].length;for(var ke=Array(te),Ke=0,ce=0;ce<Y;ce++)for(var We=arguments[ce],Oe=0,st=We.length;Oe<st;Oe++,Ke++)ke[Ke]=We[Oe];return ke};Object.defineProperty(y,"__esModule",{value:!0}),y.resolveInstance=void 0;var v=o("MON2"),X=o("FV85"),B=o("xfSm");function a(te,ce,Y){var ke=ce.filter(function(We){return We.target!==null&&We.target.type===X.TargetTypeEnum.ClassProperty}),Ke=ke.map(Y);return ke.forEach(function(We,Oe){var st="";st=We.target.name.value();var Le=Ke[Oe];te[st]=Le}),te}function W(te,ce){return new(te.bind.apply(te,S([void 0],ce)))}function D(te,ce){if(Reflect.hasMetadata(B.POST_CONSTRUCT,te)){var Y=Reflect.getMetadata(B.POST_CONSTRUCT,te);try{ce[Y.value]()}catch(ke){throw new Error(v.POST_CONSTRUCT_ERROR(te.name,ke.message))}}}function J(te,ce,Y){var ke=null;if(ce.length>0){var Ke=ce.filter(function(Oe){return Oe.target!==null&&Oe.target.type===X.TargetTypeEnum.ConstructorArgument}),We=Ke.map(Y);ke=W(te,We),ke=a(ke,ce,Y)}else ke=new te;return D(te,ke),ke}y.resolveInstance=J},cWXX:function(Re,y,o){"use strict";var S=o("cIOH"),v=o.n(S),X=o("oIFs"),B=o.n(X)},cWyK:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var S=o("/rf6");function v(it,$e,Ze){if(it!==null)for(var St,bt,Ne,ze,Ue,lt,Me,ct=0,Gt=0,$t,ar=it.type,oe=ar==="FeatureCollection",Q=ar==="Feature",G=oe?it.features.length:1,Ce=0;Ce<G;Ce++){Me=oe?it.features[Ce].geometry:Q?it.geometry:it,$t=Me?Me.type==="GeometryCollection":!1,Ue=$t?Me.geometries.length:1;for(var be=0;be<Ue;be++){var Te=0,me=0;if(ze=$t?Me.geometries[be]:Me,ze!==null){lt=ze.coordinates;var rt=ze.type;switch(ct=Ze&&(rt==="Polygon"||rt==="MultiPolygon")?1:0,rt){case null:break;case"Point":if($e(lt,Gt,Ce,Te,me)===!1)return!1;Gt++,Te++;break;case"LineString":case"MultiPoint":for(St=0;St<lt.length;St++){if($e(lt[St],Gt,Ce,Te,me)===!1)return!1;Gt++,rt==="MultiPoint"&&Te++}rt==="LineString"&&Te++;break;case"Polygon":case"MultiLineString":for(St=0;St<lt.length;St++){for(bt=0;bt<lt[St].length-ct;bt++){if($e(lt[St][bt],Gt,Ce,Te,me)===!1)return!1;Gt++}rt==="MultiLineString"&&Te++,rt==="Polygon"&&me++}rt==="Polygon"&&Te++;break;case"MultiPolygon":for(St=0;St<lt.length;St++){for(me=0,bt=0;bt<lt[St].length;bt++){for(Ne=0;Ne<lt[St][bt].length-ct;Ne++){if($e(lt[St][bt][Ne],Gt,Ce,Te,me)===!1)return!1;Gt++}me++}Te++}break;case"GeometryCollection":for(St=0;St<ze.geometries.length;St++)if(v(ze.geometries[St],$e,Ze)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function X(it,$e,Ze,St){var bt=Ze;return v(it,function(Ne,ze,Ue,lt,Me){ze===0&&Ze===void 0?bt=Ne:bt=$e(bt,Ne,ze,Ue,lt,Me)},St),bt}function B(it,$e){var Ze;switch(it.type){case"FeatureCollection":for(Ze=0;Ze<it.features.length&&$e(it.features[Ze].properties,Ze)!==!1;Ze++);break;case"Feature":$e(it.properties,0);break}}function a(it,$e,Ze){var St=Ze;return B(it,function(bt,Ne){Ne===0&&Ze===void 0?St=bt:St=$e(St,bt,Ne)}),St}function W(it,$e){if(it.type==="Feature")$e(it,0);else if(it.type==="FeatureCollection")for(var Ze=0;Ze<it.features.length&&$e(it.features[Ze],Ze)!==!1;Ze++);}function D(it,$e,Ze){var St=Ze;return W(it,function(bt,Ne){Ne===0&&Ze===void 0?St=bt:St=$e(St,bt,Ne)}),St}function J(it){var $e=[];return v(it,function(Ze){$e.push(Ze)}),$e}function te(it,$e){var Ze,St,bt,Ne,ze,Ue,lt,Me,ct,Gt,$t=0,ar=it.type==="FeatureCollection",oe=it.type==="Feature",Q=ar?it.features.length:1;for(Ze=0;Ze<Q;Ze++){for(Ue=ar?it.features[Ze].geometry:oe?it.geometry:it,Me=ar?it.features[Ze].properties:oe?it.properties:{},ct=ar?it.features[Ze].bbox:oe?it.bbox:void 0,Gt=ar?it.features[Ze].id:oe?it.id:void 0,lt=Ue?Ue.type==="GeometryCollection":!1,ze=lt?Ue.geometries.length:1,bt=0;bt<ze;bt++){if(Ne=lt?Ue.geometries[bt]:Ue,Ne===null){if($e(null,$t,Me,ct,Gt)===!1)return!1;continue}switch(Ne.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if($e(Ne,$t,Me,ct,Gt)===!1)return!1;break}case"GeometryCollection":{for(St=0;St<Ne.geometries.length;St++)if($e(Ne.geometries[St],$t,Me,ct,Gt)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}$t++}}function ce(it,$e,Ze){var St=Ze;return te(it,function(bt,Ne,ze,Ue,lt){Ne===0&&Ze===void 0?St=bt:St=$e(St,bt,Ne,ze,Ue,lt)}),St}function Y(it,$e){te(it,function(Ze,St,bt,Ne,ze){var Ue=Ze===null?null:Ze.type;switch(Ue){case null:case"Point":case"LineString":case"Polygon":return $e(S.feature(Ze,bt,{bbox:Ne,id:ze}),St,0)===!1?!1:void 0}var lt;switch(Ue){case"MultiPoint":lt="Point";break;case"MultiLineString":lt="LineString";break;case"MultiPolygon":lt="Polygon";break}for(var Me=0;Me<Ze.coordinates.length;Me++){var ct=Ze.coordinates[Me],Gt={type:lt,coordinates:ct};if($e(S.feature(Gt,bt),St,Me)===!1)return!1}})}function ke(it,$e,Ze){var St=Ze;return Y(it,function(bt,Ne,ze){Ne===0&&ze===0&&Ze===void 0?St=bt:St=$e(St,bt,Ne,ze)}),St}function Ke(it,$e){Y(it,function(Ze,St,bt){var Ne=0;if(!!Ze.geometry){var ze=Ze.geometry.type;if(!(ze==="Point"||ze==="MultiPoint")){var Ue,lt=0,Me=0,ct=0;if(v(Ze,function(Gt,$t,ar,oe,Q){if(Ue===void 0||St>lt||oe>Me||Q>ct){Ue=Gt,lt=St,Me=oe,ct=Q,Ne=0;return}var G=S.lineString([Ue,Gt],Ze.properties);if($e(G,St,bt,Q,Ne)===!1)return!1;Ne++,Ue=Gt})===!1)return!1}}})}function We(it,$e,Ze){var St=Ze,bt=!1;return Ke(it,function(Ne,ze,Ue,lt,Me){bt===!1&&Ze===void 0?St=Ne:St=$e(St,Ne,ze,Ue,lt,Me),bt=!0}),St}function Oe(it,$e){if(!it)throw new Error("geojson is required");Y(it,function(Ze,St,bt){if(Ze.geometry!==null){var Ne=Ze.geometry.type,ze=Ze.geometry.coordinates;switch(Ne){case"LineString":if($e(Ze,St,bt,0,0)===!1)return!1;break;case"Polygon":for(var Ue=0;Ue<ze.length;Ue++)if($e(S.lineString(ze[Ue],Ze.properties),St,bt,Ue)===!1)return!1;break}}})}function st(it,$e,Ze){var St=Ze;return Oe(it,function(bt,Ne,ze,Ue){Ne===0&&Ze===void 0?St=bt:St=$e(St,bt,Ne,ze,Ue)}),St}function Le(it,$e){if($e=$e||{},!S.isObject($e))throw new Error("options is invalid");var Ze=$e.featureIndex||0,St=$e.multiFeatureIndex||0,bt=$e.geometryIndex||0,Ne=$e.segmentIndex||0,ze=$e.properties,Ue;switch(it.type){case"FeatureCollection":Ze<0&&(Ze=it.features.length+Ze),ze=ze||it.features[Ze].properties,Ue=it.features[Ze].geometry;break;case"Feature":ze=ze||it.properties,Ue=it.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ue=it;break;default:throw new Error("geojson is invalid")}if(Ue===null)return null;var lt=Ue.coordinates;switch(Ue.type){case"Point":case"MultiPoint":return null;case"LineString":return Ne<0&&(Ne=lt.length+Ne-1),S.lineString([lt[Ne],lt[Ne+1]],ze,$e);case"Polygon":return bt<0&&(bt=lt.length+bt),Ne<0&&(Ne=lt[bt].length+Ne-1),S.lineString([lt[bt][Ne],lt[bt][Ne+1]],ze,$e);case"MultiLineString":return St<0&&(St=lt.length+St),Ne<0&&(Ne=lt[St].length+Ne-1),S.lineString([lt[St][Ne],lt[St][Ne+1]],ze,$e);case"MultiPolygon":return St<0&&(St=lt.length+St),bt<0&&(bt=lt[St].length+bt),Ne<0&&(Ne=lt[St][bt].length-Ne-1),S.lineString([lt[St][bt][Ne],lt[St][bt][Ne+1]],ze,$e)}throw new Error("geojson is invalid")}function xt(it,$e){if($e=$e||{},!S.isObject($e))throw new Error("options is invalid");var Ze=$e.featureIndex||0,St=$e.multiFeatureIndex||0,bt=$e.geometryIndex||0,Ne=$e.coordIndex||0,ze=$e.properties,Ue;switch(it.type){case"FeatureCollection":Ze<0&&(Ze=it.features.length+Ze),ze=ze||it.features[Ze].properties,Ue=it.features[Ze].geometry;break;case"Feature":ze=ze||it.properties,Ue=it.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ue=it;break;default:throw new Error("geojson is invalid")}if(Ue===null)return null;var lt=Ue.coordinates;switch(Ue.type){case"Point":return S.point(lt,ze,$e);case"MultiPoint":return St<0&&(St=lt.length+St),S.point(lt[St],ze,$e);case"LineString":return Ne<0&&(Ne=lt.length+Ne),S.point(lt[Ne],ze,$e);case"Polygon":return bt<0&&(bt=lt.length+bt),Ne<0&&(Ne=lt[bt].length+Ne),S.point(lt[bt][Ne],ze,$e);case"MultiLineString":return St<0&&(St=lt.length+St),Ne<0&&(Ne=lt[St].length+Ne),S.point(lt[St][Ne],ze,$e);case"MultiPolygon":return St<0&&(St=lt.length+St),bt<0&&(bt=lt[St].length+bt),Ne<0&&(Ne=lt[St][bt].length-Ne),S.point(lt[St][bt][Ne],ze,$e)}throw new Error("geojson is invalid")}y.coordEach=v,y.coordReduce=X,y.propEach=B,y.propReduce=a,y.featureEach=W,y.featureReduce=D,y.coordAll=J,y.geomEach=te,y.geomReduce=ce,y.flattenEach=Y,y.flattenReduce=ke,y.segmentEach=Ke,y.segmentReduce=We,y.lineEach=Oe,y.lineReduce=st,y.findSegment=Le,y.findPoint=xt},cZ5Q:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.injectable=void 0;var S=o("MON2"),v=o("xfSm");function X(){return function(B){if(Reflect.hasOwnMetadata(v.PARAM_TYPES,B))throw new Error(S.DUPLICATED_INJECTABLE_DECORATOR);var a=Reflect.getMetadata(v.DESIGN_PARAM_TYPES,B)||[];return Reflect.defineMetadata(v.PARAM_TYPES,a,B),B}}y.injectable=X},cZlC:function(Re,y,o){"use strict";o.d(y,"b",function(){return S}),o.d(y,"c",function(){return v}),o.d(y,"a",function(){return X});var S;(function(B){B.LINEAR="linear",B.POWER="power",B.LOG="log",B.IDENTITY="identity",B.TIME="time",B.QUANTILE="quantile",B.QUANTIZE="quantize",B.THRESHOLD="threshold",B.CAT="cat"})(S||(S={}));var v;(function(B){B.CONSTANT="constant",B.VARIABLE="variable"})(v||(v={}));var X;(function(B){B[B.Attribute=0]="Attribute",B[B.InstancedAttribute=1]="InstancedAttribute",B[B.Uniform=2]="Uniform"})(X||(X={}))},"cq/+":function(Re,y,o){var S=o("mc0g"),v=S();Re.exports=v},cvCv:function(Re,y){function o(S){return function(){return S}}Re.exports=o},d9O0:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.id=void 0;var S=0;function v(){return S++}y.id=v},d9mD:function(Re,y,o){Re.exports={pie:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-pie",chart:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-chart",hasLegend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-hasLegend",legend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legend",dot:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-dot",line:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-line",legendTitle:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendTitle",percent:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-percent",value:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-value",title:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-title",total:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-total",legendBlock:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendBlock"}},dQpi:function(Re,y,o){var S=o("yGk4"),v=o("vN+2"),X=o("rEGp"),B=1/0,a=S&&1/X(new S([,-0]))[1]==B?function(W){return new S(W)}:v;Re.exports=a},dTAl:function(Re,y,o){var S=o("GoyQ"),v=Object.create,X=function(){function B(){}return function(a){if(!S(a))return{};if(v)return v(a);B.prototype=a;var W=new B;return B.prototype=void 0,W}}();Re.exports=X},dVn5:function(Re,y){var o=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function S(v){return v.match(o)||[]}Re.exports=S},dX1H:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Target=void 0;var S=o("xfSm"),v=o("d9O0"),X=o("GXnB"),B=o("zxMA"),a=function(){function W(D,J,te,ce){this.id=v.id(),this.type=D,this.serviceIdentifier=te,this.name=new B.QueryableString(J||""),this.metadata=new Array;var Y=null;typeof ce=="string"?Y=new X.Metadata(S.NAMED_TAG,ce):ce instanceof X.Metadata&&(Y=ce),Y!==null&&this.metadata.push(Y)}return W.prototype.hasTag=function(D){for(var J=0,te=this.metadata;J<te.length;J++){var ce=te[J];if(ce.key===D)return!0}return!1},W.prototype.isArray=function(){return this.hasTag(S.MULTI_INJECT_TAG)},W.prototype.matchesArray=function(D){return this.matchesTag(S.MULTI_INJECT_TAG)(D)},W.prototype.isNamed=function(){return this.hasTag(S.NAMED_TAG)},W.prototype.isTagged=function(){return this.metadata.some(function(D){return D.key!==S.INJECT_TAG&&D.key!==S.MULTI_INJECT_TAG&&D.key!==S.NAME_TAG&&D.key!==S.UNMANAGED_TAG&&D.key!==S.NAMED_TAG})},W.prototype.isOptional=function(){return this.matchesTag(S.OPTIONAL_TAG)(!0)},W.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(D){return D.key===S.NAMED_TAG})[0]:null},W.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(D){return D.key!==S.INJECT_TAG&&D.key!==S.MULTI_INJECT_TAG&&D.key!==S.NAME_TAG&&D.key!==S.UNMANAGED_TAG&&D.key!==S.NAMED_TAG}):null},W.prototype.matchesNamedTag=function(D){return this.matchesTag(S.NAMED_TAG)(D)},W.prototype.matchesTag=function(D){var J=this;return function(te){for(var ce=0,Y=J.metadata;ce<Y.length;ce++){var ke=Y[ce];if(ke.key===D&&ke.value===te)return!0}return!1}},W}();y.Target=a},doU7:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingCount=void 0;var S={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};y.BindingCount=S},dt0z:function(Re,y,o){var S=o("zoYe");function v(X){return X==null?"":S(X)}Re.exports=v},dxzI:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.AsyncContainerModule=y.ContainerModule=void 0;var S=o("d9O0"),v=function(){function B(a){this.id=S.id(),this.registry=a}return B}();y.ContainerModule=v;var X=function(){function B(a){this.id=S.id(),this.registry=a}return B}();y.AsyncContainerModule=X},eUgh:function(Re,y){function o(S,v){for(var X=-1,B=S==null?0:S.length,a=Array(B);++X<B;)a[X]=v(S[X],X,S);return a}Re.exports=o},"eg+a":function(Re,y,o){"use strict";o.d(y,"a",function(){return S});var S=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},fX6N:function(Re,y,o){"use strict";o.d(y,"d",function(){return Ef}),o.d(y,"b",function(){return Zc}),o.d(y,"a",function(){return Hl});var S=o("mNvP"),v=o("uhBA"),X=o.n(v),B=o("4cb6"),a=o("APxj"),W=o.n(a),D=o("bB6j"),J=o("lSNA"),te=o.n(J),ce=o("lwsE"),Y=o.n(ce),ke=o("W8MJ"),Ke=o.n(ke),We=o("Hel2"),Oe=o("rxlC"),st=o.n(Oe);function Le(ne,se){var z=Object.keys(ne);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ne);se&&(V=V.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),z.push.apply(z,V)}return z}function xt(ne){for(var se=1;se<arguments.length;se++){var z=arguments[se]!=null?arguments[se]:{};se%2?Le(Object(z),!0).forEach(function(V){te()(ne,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(z)):Le(Object(z)).forEach(function(V){Object.defineProperty(ne,V,Object.getOwnPropertyDescriptor(z,V))})}return ne}function it(ne,se){var z;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(z=$e(ne))||se&&ne&&typeof ne.length=="number"){z&&(ne=z);var V=0,_e=function(){};return{s:_e,n:function(){return V>=ne.length?{done:!0}:{done:!1,value:ne[V++]}},e:function(Or){throw Or},f:_e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ut=!0,Ht=!1,ir;return{s:function(){z=ne[Symbol.iterator]()},n:function(){var Or=z.next();return ut=Or.done,Or},e:function(Or){Ht=!0,ir=Or},f:function(){try{!ut&&z.return!=null&&z.return()}finally{if(Ht)throw ir}}}}function $e(ne,se){if(!!ne){if(typeof ne=="string")return Ze(ne,se);var z=Object.prototype.toString.call(ne).slice(8,-1);if(z==="Object"&&ne.constructor&&(z=ne.constructor.name),z==="Map"||z==="Set")return Array.from(ne);if(z==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(z))return Ze(ne,se)}}function Ze(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var z=0,V=new Array(se);z<se;z++)V[z]=ne[z];return V}var St=30;function bt(ne){var se=ne.characterSet,z=ne.getFontWidth,V=ne.fontHeight,_e=ne.buffer,ut=ne.maxCanvasWidth,Ht=ne.mapping,ir=Ht===void 0?{}:Ht,tr=ne.xOffset,Or=tr===void 0?0:tr,an=ne.yOffset,zn=an===void 0?0:an,Xn=0,ni=Or;Array.from(se).forEach(function(Oi,la){if(!ir[Oi]){var Yi=z(Oi,la);ni+St>ut&&(ni=0,Xn++),ir[Oi]={x:ni,y:zn+Xn*St,width:St,height:St,advance:Yi},ni+=St}});var ra=V+_e*2;return{mapping:ir,xOffset:ni,yOffset:zn+Xn*ra,canvasHeight:Ue(zn+(Xn+1)*ra)}}function Ne(ne,se,z){var V=0,_e=0,ut=0,Ht=[],ir={},tr=it(ne),Or;try{for(tr.s();!(Or=tr.n()).done;){var an=Or.value;if(!ir[an.id]){var zn=an.size;V+zn+se>z&&(ze(ir,Ht,_e),V=0,_e=ut+_e+se,ut=0,Ht=[]),Ht.push({icon:an,xOffset:V}),V=V+zn+se,ut=Math.max(ut,zn)}}}catch(ni){tr.e(ni)}finally{tr.f()}Ht.length>0&&ze(ir,Ht,_e);var Xn=Ue(ut+_e+se);return{mapping:ir,canvasHeight:Xn}}function ze(ne,se,z){var V=it(se),_e;try{for(V.s();!(_e=V.n()).done;){var ut=_e.value,Ht=ut.icon,ir=ut.xOffset;ne[Ht.id]=xt(xt({},Ht),{},{x:ir,y:z,image:Ht.image,width:Ht.width,height:Ht.height})}}catch(tr){V.e(tr)}finally{V.f()}}function Ue(ne){return Math.pow(2,Math.ceil(Math.log2(ne)))}var lt,Me,ct;function Gt(ne,se){var z;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(z=$t(ne))||se&&ne&&typeof ne.length=="number"){z&&(ne=z);var V=0,_e=function(){};return{s:_e,n:function(){return V>=ne.length?{done:!0}:{done:!1,value:ne[V++]}},e:function(Or){throw Or},f:_e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ut=!0,Ht=!1,ir;return{s:function(){z=ne[Symbol.iterator]()},n:function(){var Or=z.next();return ut=Or.done,Or},e:function(Or){Ht=!0,ir=Or},f:function(){try{!ut&&z.return!=null&&z.return()}finally{if(Ht)throw ir}}}}function $t(ne,se){if(!!ne){if(typeof ne=="string")return ar(ne,se);var z=Object.prototype.toString.call(ne).slice(8,-1);if(z==="Object"&&ne.constructor&&(z=ne.constructor.name),z==="Map"||z==="Set")return Array.from(ne);if(z==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(z))return ar(ne,se)}}function ar(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var z=0,V=new Array(se);z<se;z++)V[z]=ne[z];return V}function oe(ne,se){var z=Object.keys(ne);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ne);se&&(V=V.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),z.push.apply(z,V)}return z}function Q(ne){for(var se=1;se<arguments.length;se++){var z=arguments[se]!=null?arguments[se]:{};se%2?oe(Object(z),!0).forEach(function(V){te()(ne,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(z)):oe(Object(z)).forEach(function(V){Object.defineProperty(ne,V,Object.getOwnPropertyDescriptor(z,V))})}return ne}var G=Ie(),Ce="sans-serif",be="normal",Te=24,me=3,rt=.25,Kt=8,_t=1024,ge=1,ye=1,Ve=3,ft=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function Ie(){for(var ne=[],se=32;se<128;se++)ne.push(String.fromCharCode(se));return ne}function pt(ne,se,z,V){ne.font="".concat(V," ").concat(z,"px ").concat(se),ne.fillStyle="black",ne.textBaseline="middle"}function C(ne,se){for(var z=0;z<ne.length;z++)se.data[4*z+3]=ne[z]}var R=(lt=Object(B.injectable)(),lt(Me=(ct=function(){function ne(){Y()(this,ne),this.fontAtlas=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new We.b(Ve)}return Ke()(ne,[{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:Ce,fontWeight:be,characterSet:G,fontSize:Te,buffer:me,sdf:!0,cutoff:rt,radius:Kt},this.key=""}},{key:"addIconGlyphs",value:function(z){var V=this;z.forEach(function(_e){V.iconFontGlyphs[_e.name]=_e.unicode})}},{key:"getGlyph",value:function(z){return this.iconFontGlyphs[z]?String.fromCharCode(parseInt(this.iconFontGlyphs[z],16)):""}},{key:"setFontOptions",value:function(z){this.fontOptions=Q(Q({},this.fontOptions),z),this.key=this.getKey();var V=this.getNewChars(this.key,this.fontOptions.characterSet),_e=this.cache.get(this.key);if(!(_e&&V.length===0)){var ut=this.generateFontAtlas(this.key,V,_e);this.fontAtlas=ut,this.cache.set(this.key,ut)}}},{key:"destroy",value:function(){this.cache.clear()}},{key:"generateFontAtlas",value:function(z,V,_e){var ut=this.fontOptions,Ht=ut.fontFamily,ir=ut.fontWeight,tr=ut.fontSize,Or=ut.buffer,an=ut.sdf,zn=ut.radius,Xn=ut.cutoff,ni=_e&&_e.data;ni||(ni=document.createElement("canvas"),ni.width=_t);var ra=ni.getContext("2d");pt(ra,Ht,tr,ir);var Oi=bt(Q({getFontWidth:function(fc){return ra.measureText(fc).width},fontHeight:tr*ye,buffer:Or,characterSet:V,maxCanvasWidth:_t},_e&&{mapping:_e.mapping,xOffset:_e.xOffset,yOffset:_e.yOffset})),la=Oi.mapping,Yi=Oi.canvasHeight,ja=Oi.xOffset,Ro=Oi.yOffset,So=ra.getImageData(0,0,ni.width,ni.height);if(ni.height=Yi,ra.putImageData(So,0,0),pt(ra,Ht,tr,ir),an){var Ya=new st.a(tr,Or,zn,Xn,Ht,ir),Vo=ra.getImageData(0,0,Ya.size,Ya.size),ea=Gt(V),fo;try{for(ea.s();!(fo=ea.n()).done;){var iu=fo.value;C(Ya.draw(iu),Vo),ra.putImageData(Vo,la[iu].x,la[iu].y)}}catch(Do){ea.e(Do)}finally{ea.f()}}else{var Ta=Gt(V),Ua;try{for(Ta.s();!(Ua=Ta.n()).done;){var bi=Ua.value;ra.fillText(bi,la[bi].x,la[bi].y+tr*ge)}}catch(Do){Ta.e(Do)}finally{Ta.f()}}return{xOffset:ja,yOffset:Ro,mapping:la,data:ni,width:ni.width,height:ni.height}}},{key:"getKey",value:function(){var z=this.fontOptions,V=z.fontFamily,_e=z.fontWeight,ut=z.fontSize,Ht=z.buffer,ir=z.sdf,tr=z.radius,Or=z.cutoff;return ir?"".concat(V," ").concat(_e," ").concat(ut," ").concat(Ht," ").concat(tr," ").concat(Or):"".concat(V," ").concat(_e," ").concat(ut," ").concat(Ht)}},{key:"getNewChars",value:function(z,V){var _e=this.cache.get(z);if(!_e)return V;var ut=[],Ht=_e.mapping,ir=new Set(Object.keys(Ht)),tr=new Set(V);return tr.forEach(function(Or){ir.has(Or)||ut.push(Or)}),ut}},{key:"scale",get:function(){return ye}},{key:"canvas",get:function(){var z=this.cache.get(this.key);return z&&z.data}},{key:"mapping",get:function(){var z=this.cache.get(this.key);return z&&z.mapping}}]),ne}(),ct))||Me),q=o("7W2i"),fe=o.n(q),Ge=o("a1gu"),Je=o.n(Ge),yt=o("Nsbk"),nt=o.n(yt),Nt,$,Ye;function ie(ne){var se=et();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function et(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Bt=3,lr=1024,dt=64,vt=(Nt=Object(B.injectable)(),Nt($=(Ye=function(ne){fe()(z,ne);var se=ie(z);function z(){var V;Y()(this,z);for(var _e=arguments.length,ut=new Array(_e),Ht=0;Ht<_e;Ht++)ut[Ht]=arguments[Ht];return V=se.call.apply(se,[this].concat(ut)),V.canvasHeight=128,V.texture=void 0,V.canvas=void 0,V.iconData=void 0,V.iconMap=void 0,V.ctx=void 0,V.loadingImageCount=0,V}return Ke()(z,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(_e,ut){var Ht=this,ir=new Image;if(this.loadingImageCount++,this.hasImage(_e))throw new Error("Image Id already exists");this.iconData.push({id:_e,size:dt}),this.updateIconMap(),this.loadImage(ut).then(function(tr){ir=tr;var Or=Ht.iconData.find(function(an){return an.id===_e});Or&&(Or.image=ir,Or.width=ir.width,Or.height=ir.height),Ht.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(_e){return this.iconMap.hasOwnProperty(_e)}},{key:"removeImage",value:function(_e){this.hasImage(_e)&&(this.iconData=this.iconData.filter(function(ut){return ut.id!==_e}),delete this.iconMap[_e],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var _e=this;this.canvas.width=lr,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(ut){var Ht=_e.iconMap[ut],ir=Ht.x,tr=Ht.y,Or=Ht.image,an=Ht.width,zn=an===void 0?64:an,Xn=Ht.height,ni=Xn===void 0?64:Xn,ra=Math.max(zn,ni),Oi=ra/dt,la=ni/Oi,Yi=zn/Oi;Or&&_e.ctx.drawImage(Or,ir+(dt-Yi)/2,tr+(dt-la)/2,Yi,la)})}},{key:"updateIconMap",value:function(){var _e=Ne(this.iconData,Bt,lr),ut=_e.mapping,Ht=_e.canvasHeight;this.iconMap=ut,this.canvasHeight=Ht}},{key:"loadImage",value:function(_e){return new Promise(function(ut,Ht){if(_e instanceof HTMLImageElement){ut(_e);return}var ir=new Image;ir.crossOrigin="anonymous",ir.onload=function(){ut(ir)},ir.onerror=function(){Ht(new Error("Could not load image at "+_e))},ir.src=_e instanceof File?URL.createObjectURL(_e):_e})}}]),z}(v.EventEmitter),Ye))||$),Ct=o("J4zp"),gt=o.n(Ct),we=o("IOcx"),ht,Qe,Vt,pr=(ht=Object(B.injectable)(),ht(Qe=(Vt=function(){function ne(){Y()(this,ne),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return Ke()(ne,[{key:"init",value:function(){}},{key:"update",value:function(z){this.viewport=z,this.viewMatrixInverse=we.b.invert(we.b.create(),this.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var z=this.viewport.getCenter(),V=gt()(z,2),_e=V[0],ut=V[1];return[_e,ut]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(z,V){return this.viewport.projectFlat(z,V)}},{key:"setViewProjectionMatrix",value:function(z){this.overridedViewProjectionMatrix=z}},{key:"jitterProjectionMatrix",value:function(z,V){var _e=we.b.fromTranslation(we.b.create(),[z,V,0]);this.jitteredProjectionMatrix=we.b.multiply(we.b.create(),_e,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=we.b.multiply(we.b.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),ne}(),Vt))||Qe),Zr,cr,jn;function Sn(ne,se){var z;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(z=ai(ne))||se&&ne&&typeof ne.length=="number"){z&&(ne=z);var V=0,_e=function(){};return{s:_e,n:function(){return V>=ne.length?{done:!0}:{done:!1,value:ne[V++]}},e:function(Or){throw Or},f:_e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ut=!0,Ht=!1,ir;return{s:function(){z=ne[Symbol.iterator]()},n:function(){var Or=z.next();return ut=Or.done,Or},e:function(Or){Ht=!0,ir=Or},f:function(){try{!ut&&z.return!=null&&z.return()}finally{if(Ht)throw ir}}}}function ai(ne,se){if(!!ne){if(typeof ne=="string")return fi(ne,se);var z=Object.prototype.toString.call(ne).slice(8,-1);if(z==="Object"&&ne.constructor&&(z=ne.constructor.name),z==="Map"||z==="Set")return Array.from(ne);if(z==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(z))return fi(ne,se)}}function fi(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var z=0,V=new Array(se);z<se;z++)V[z]=ne[z];return V}var Zn=(Zr=Object(B.injectable)(),Zr(cr=(jn=function(){function ne(){Y()(this,ne),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return Ke()(ne,[{key:"init",value:function(z,V){this.container=z.container,this.scene=V,this.mapsService=V.get(D.a.IMapService),this.initControlPos()}},{key:"addControl",value:function(z,V){var _e=V.get(D.a.IMapService);_e.map?(z.addTo(this.scene),this.controls.push(z)):this.unAddControls.push(z)}},{key:"getControlByName",value:function(z){return this.controls.find(function(V){return V.controlOption.name===z})}},{key:"removeControl",value:function(z){var V=this.controls.indexOf(z);return V>-1&&this.controls.splice(V,1),z.remove(),this}},{key:"addControls",value:function(){var z=this;this.unAddControls.forEach(function(V){V.addTo(z.scene),z.controls.push(V)}),this.unAddControls=[]}},{key:"destroy",value:function(){var z=Sn(this.controls),V;try{for(z.s();!(V=z.n()).done;){var _e=V.value;_e.remove()}}catch(ut){z.e(ut)}finally{z.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var z=this.controlCorners={},V="l7-",_e=this.controlContainer=We.a.create("div",V+"control-container",this.container);function ut(Ht,ir){var tr=V+Ht+" "+V+ir;z[Ht+ir]=We.a.create("div",tr,_e)}ut("top","left"),ut("top","right"),ut("bottom","left"),ut("bottom","right")}},{key:"clearControlPos",value:function(){for(var z in this.controlCorners)this.controlCorners[z]&&We.a.remove(this.controlCorners[z]);this.controlContainer&&We.a.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),ne}(),jn))||cr),Hn,k,H,le=(Hn=Object(B.injectable)(),Hn(k=(H=function(){function ne(){Y()(this,ne),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return Ke()(ne,[{key:"addMarkerLayer",value:function(z){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(z),z.addTo(this.scene)):this.unAddMarkerLayers.push(z)}},{key:"removeMarkerLayer",value:function(z){z.destroy(),this.markerLayers.indexOf(z);var V=this.markerLayers.indexOf(z);V>-1&&this.markerLayers.splice(V,1)}},{key:"addMarker",value:function(z){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(z),z.addTo(this.scene)):this.unAddMarkers.push(z)}},{key:"addMarkers",value:function(){var z=this;this.unAddMarkers.forEach(function(V){V.addTo(z.scene),z.markers.push(V)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var z=this;this.unAddMarkerLayers.forEach(function(V){z.markerLayers.push(V),V.addTo(z.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(z){z.remove(),this.markers.indexOf(z);var V=this.markers.indexOf(z);V>-1&&this.markers.splice(V,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(z){this.scene=z,this.mapsService=z.get(D.a.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(z){z.remove()}),this.markers=[],this.markerLayers.forEach(function(z){z.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(z){z.destroy()}}]),ne}(),H))||k),de,at,At,Ft=(de=Object(B.injectable)(),de(at=(At=function(){function ne(){Y()(this,ne),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return Ke()(ne,[{key:"removePopup",value:function(z){z.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(z){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(z.addTo(this.scene),this.popup=z):this.unAddPopup=z}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(z){this.scene=z,this.mapsService=z.get(D.a.IMapService)}}]),ne}(),At))||at),He=o("QkVN"),Pt=o.n(He),or={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},jr=or,Hr,sr,Fr;function _n(ne,se){var z=Object.keys(ne);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ne);se&&(V=V.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),z.push.apply(z,V)}return z}function dn(ne){for(var se=1;se<arguments.length;se++){var z=arguments[se]!=null?arguments[se]:{};se%2?_n(Object(z),!0).forEach(function(V){te()(ne,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(z)):_n(Object(z)).forEach(function(V){Object.defineProperty(ne,V,Object.getOwnPropertyDescriptor(z,V))})}return ne}var Er={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},Tn={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15}},vn=(Hr=Object(B.injectable)(),Hr(sr=(Fr=function(){function ne(){Y()(this,ne),this.sceneConfigCache={},this.layerConfigCache={}}return Ke()(ne,[{key:"getSceneConfig",value:function(z){return this.sceneConfigCache[z]}},{key:"getSceneWarninfo",value:function(z){return jr[z]}},{key:"setSceneConfig",value:function(z,V){this.sceneConfigCache[z]=dn(dn({},Er),V)}},{key:"getLayerConfig",value:function(z){return this.layerConfigCache[z]}},{key:"setLayerConfig",value:function(z,V,_e){this.layerConfigCache[V]=dn({},Pt()({},this.sceneConfigCache[z],Tn,_e))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),ne}(),Fr))||sr),gn=o("yG8O"),Ar=o.n(gn),$r=o("U+yc"),Mn=o.n($r),Xi=o("1ABj"),vi=Math.PI/180,wi=512,Di=4003e4;function Ka(ne){var se=ne.latitude,z=se===void 0?0:se,V=ne.zoom,_e=V===void 0?0:V,ut=ne.scale,Ht=ne.highPrecision,ir=Ht===void 0?!1:Ht,tr=ne.flipY,Or=tr===void 0?!1:tr;ut=ut!==void 0?ut:Math.pow(2,_e);var an={},zn=wi*ut,Xn=Math.cos(z*vi),ni=zn/360,ra=ni/Xn,Oi=zn/Di/Xn;if(an.pixelsPerMeter=[Oi,-Oi,Oi],an.metersPerPixel=[1/Oi,-1/Oi,1/Oi],an.pixelsPerDegree=[ni,-ra,Oi],an.degreesPerPixel=[1/ni,-1/ra,1/Oi],ir){var la=vi*Math.tan(z*vi)/Xn,Yi=ni*la/2,ja=zn/Di*la,Ro=ja/ra*Oi;an.pixelsPerDegree2=[0,-Yi,ja],an.pixelsPerMeter2=[Ro,0,Ro],Or&&(an.pixelsPerDegree2[1]=-an.pixelsPerDegree2[1],an.pixelsPerMeter2[1]=-an.pixelsPerMeter2[1])}return Or&&(an.pixelsPerMeter[1]=-an.pixelsPerMeter[1],an.metersPerPixel[1]=-an.metersPerPixel[1],an.pixelsPerDegree[1]=-an.pixelsPerDegree[1],an.degreesPerPixel[1]=-an.degreesPerPixel[1]),an}var hi=o("HthE"),ga,Pi,gi,ci,Oa,mo,$a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Ko=(ga=Object(B.injectable)(),Pi=Object(B.inject)(D.a.ICameraService),ga(gi=(ci=(mo=function(){function ne(){Y()(this,ne),this.needRefresh=!0,Ar()(this,"cameraService",Oa,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return Ke()(ne,[{key:"refresh",value:function(){var z=this.cameraService.getZoom(),V=this.cameraService.getZoomScale(),_e=this.cameraService.getCenter(),ut=Ka({latitude:_e[1],zoom:z}),Ht=ut.pixelsPerMeter,ir=ut.pixelsPerDegree;this.viewportCenter=_e,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=Ht,this.pixelsPerDegree=ir,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===hi.a.LNGLAT||this.coordinateSystem===hi.a.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===hi.a.LNGLAT_OFFSET?this.calculateLnglatOffset(_e,z):this.coordinateSystem===hi.a.P20_OFFSET&&this.calculateLnglatOffset(_e,z,V,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(z){this.coordinateSystem=z}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(z,V,_e,ut){var Ht=Ka({latitude:z[1],zoom:V,scale:_e,flipY:ut,highPrecision:!0}),ir=Ht.pixelsPerMeter,tr=Ht.pixelsPerDegree,Or=Ht.pixelsPerDegree2,an=this.cameraService.getViewMatrix(),zn=this.cameraService.getProjectionMatrix(),Xn=we.b.multiply([],zn,an),ni=this.cameraService.projectFlat([Math.fround(z[0]),Math.fround(z[1])],Math.pow(2,V));this.viewportCenterProjection=we.e.transformMat4([],[ni[0],ni[1],0,1],Xn),an=this.cameraService.getViewMatrixUncentered()||an,Xn=we.b.multiply([],zn,an),Xn=we.b.multiply([],Xn,$a),this.cameraService.setViewProjectionMatrix(Xn),this.pixelsPerMeter=ir,this.pixelsPerDegree=tr,this.pixelsPerDegree2=Or}}]),ne}(),mo),Oa=Mn()(ci.prototype,"cameraService",[Pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ci))||gi),Uu=o("PJYZ"),Ui=o.n(Uu),Ca=o("yLV6"),ns=o.n(Ca),na=o("V1cb"),Ja,is,$i,oo,so,Ys,Ao,Zl;function Ks(ne){var se=_o();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function _o(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var kt={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},De=(Ja=Object(B.injectable)(),is=Object(B.inject)(D.a.IMapService),$i=Object(B.inject)(D.a.ILogService),Ja(oo=(so=(Zl=function(ne){fe()(z,ne);var se=Ks(z);function z(){var V;Y()(this,z);for(var _e=arguments.length,ut=new Array(_e),Ht=0;Ht<_e;Ht++)ut[Ht]=arguments[Ht];return V=se.call.apply(se,[this].concat(ut)),Ar()(V,"mapService",Ys,Ui()(V)),Ar()(V,"logger",Ao,Ui()(V)),V.hammertime=void 0,V.lastClickTime=0,V.lastClickXY=[-1,-1],V.clickTimer=void 0,V.$containter=void 0,V.onDrag=function(ir){var tr=V.interactionEvent(ir);tr.type=kt[tr.type],V.emit(na.a.Drag,tr)},V.onHammer=function(ir){ir.srcEvent.stopPropagation();var tr=V.interactionEvent(ir);V.emit(na.a.Hover,tr)},V.onTouch=function(ir){var tr=ir.touches[0];V.onHover({x:tr.pageX,y:tr.pageY,type:"touch"})},V.onHover=function(ir){var tr=ir.clientX,Or=ir.clientY,an=tr,zn=Or,Xn=ir.type,ni=V.mapService.getMapContainer();if(ni){var ra=ni.getBoundingClientRect(),Oi=ra.top,la=ra.left;an=an-la-ni.clientLeft,zn=zn-Oi-ni.clientTop}var Yi=V.mapService.containerToLngLat([an,zn]);if(Xn==="click"){if("ontouchstart"in document.documentElement)return;V.isDoubleTap(an,zn,Yi);return}if(Xn==="touch"){V.isDoubleTap(an,zn,Yi);return}Xn!=="click"&&Xn!=="dblclick"&&V.emit(na.a.Hover,{x:an,y:zn,lngLat:Yi,type:Xn,target:ir})},V}return Ke()(z,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(na.a.Hover)}},{key:"triggerHover",value:function(_e){var ut=_e.x,Ht=_e.y;this.emit(na.a.Hover,{x:ut,y:Ht})}},{key:"triggerSelect",value:function(_e){this.emit(na.a.Select,{featureId:_e})}},{key:"triggerActive",value:function(_e){this.emit(na.a.Active,{featureId:_e})}},{key:"addEventListenerOnMap",value:function(){var _e=this.mapService.getMapContainer();if(_e){var ut=new ns.a.Manager(_e);ut.add(new ns.a.Tap({event:"dblclick",taps:2})),ut.add(new ns.a.Tap({event:"click"})),ut.add(new ns.a.Pan({threshold:0,pointers:0})),ut.add(new ns.a.Press({})),ut.on("dblclick click",this.onHammer),ut.on("panstart panmove panend pancancel",this.onDrag),_e.addEventListener("mousemove",this.onHover),_e.addEventListener("mousedown",this.onHover),_e.addEventListener("mouseup",this.onHover),_e.addEventListener("contextmenu",this.onHover),this.hammertime=ut,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var _e=this.mapService.getMapContainer();_e&&(_e.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),_e.removeEventListener("mousedown",this.onHover),_e.removeEventListener("mouseup",this.onHover),_e.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(_e){var ut=_e.type,Ht=_e.pointerType,ir,tr;Ht==="touch"?(tr=Math.floor(_e.pointers[0].clientY),ir=Math.floor(_e.pointers[0].clientX)):(tr=Math.floor(_e.srcEvent.y),ir=Math.floor(_e.srcEvent.x));var Or=this.mapService.getMapContainer();if(Or){var an=Or.getBoundingClientRect(),zn=an.top,Xn=an.left;ir-=Xn,tr-=zn}var ni=this.mapService.containerToLngLat([ir,tr]);return{x:ir,y:tr,lngLat:ni,type:ut,target:_e.srcEvent}}},{key:"isDoubleTap",value:function(_e,ut,Ht){var ir=this,tr=new Date().getTime(),Or="click";tr-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-_e)<10&&Math.abs(this.lastClickXY[1]-ut)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),Or="dblclick",this.emit(na.a.Hover,{x:_e,y:ut,lngLat:Ht,type:Or})):(this.lastClickTime=tr,this.lastClickXY=[_e,ut],this.clickTimer=setTimeout(function(){Or="click",ir.emit(na.a.Hover,{x:_e,y:ut,lngLat:Ht,type:Or})},400))}}]),z}(X.a),Zl),Ys=Mn()(so.prototype,"mapService",[is],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ao=Mn()(so.prototype,"logger",[$i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),so))||oo),It=o("o0o1"),fr=o.n(It),tn=o("yXPU"),En=o.n(tn),Un=o("o+pz"),La,no,go,No,Vu,Wl,$s,Ic,Il,fs,zs,uo;function hs(ne,se){var z=Object.keys(ne);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ne);se&&(V=V.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),z.push.apply(z,V)}return z}function Js(ne){for(var se=1;se<arguments.length;se++){var z=arguments[se]!=null?arguments[se]:{};se%2?hs(Object(z),!0).forEach(function(V){te()(ne,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(z)):hs(Object(z)).forEach(function(V){Object.defineProperty(ne,V,Object.getOwnPropertyDescriptor(z,V))})}return ne}var lu=(La=Object(B.injectable)(),no=Object(B.inject)(D.a.IRendererService),go=Object(B.inject)(D.a.IGlobalConfigService),No=Object(B.inject)(D.a.IInteractionService),Vu=Object(B.inject)(D.a.ILayerService),La(Wl=($s=(uo=function(){function ne(){var se=this;Y()(this,ne),Ar()(this,"rendererService",Ic,this),Ar()(this,"configService",Il,this),Ar()(this,"interactionService",fs,this),Ar()(this,"layerService",zs,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(z,V){var _e,ut=V.x,Ht=V.y,ir=V.lngLat,tr=V.type,Or=V.target,an=!1,zn=se.rendererService,Xn=zn.getViewportSize,ni=zn.readPixels,ra=zn.getContainer,Oi=ra().getBoundingClientRect(),la=Oi.width,Yi=Oi.height;la*=window.devicePixelRatio,Yi*=window.devicePixelRatio;var ja=z.getLayerConfig(),Ro=ja.enableHighlight,So=ja.enableSelect,Ya=ut*window.devicePixelRatio,Vo=Ht*window.devicePixelRatio;if(Ya>la-1*window.devicePixelRatio||Ya<0||Vo>Yi-1*window.devicePixelRatio||Vo<0)return!1;var ea;if(ea=ni({x:Math.floor(Ya/se.pickBufferScale),y:Math.floor((Yi-(Ht+1)*window.devicePixelRatio)/se.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:se.pickingFBO}),ea[0]!==0||ea[1]!==0||ea[2]!==0){var fo=Object(We.k)(ea),iu=z.getSource().getFeatureById(fo);fo!==z.getCurrentPickId()&&tr==="mousemove"&&(tr="mouseenter");var Ta={x:ut,y:Ht,type:tr,lngLat:ir,featureId:fo,feature:iu,target:Or};iu&&(an=!0,z.setCurrentPickId(fo),se.triggerHoverOnLayer(z,Ta))}else{var Ua={x:ut,y:Ht,lngLat:ir,type:z.getCurrentPickId()!==null&&tr==="mousemove"?"mouseout":"un"+tr,featureId:null,target:Or,feature:null};se.triggerHoverOnLayer(z,Js(Js({},Ua),{},{type:"unpick"})),se.triggerHoverOnLayer(z,Ua),z.setCurrentPickId(null)}if(Ro&&se.highlightPickedFeature(z,ea),So&&tr==="click"&&((_e=ea)===null||_e===void 0?void 0:_e.toString())!==[0,0,0,0].toString()){var bi=Object(We.k)(ea);z.getCurrentSelectedId()===null||bi!==z.getCurrentSelectedId()?(se.selectFeature(z,ea),z.setCurrentSelectedId(bi)):(se.selectFeature(z,new Uint8Array([0,0,0,0])),z.setCurrentSelectedId(null))}return an}}return Ke()(ne,[{key:"init",value:function(z){var V=this.rendererService,_e=V.createTexture2D,ut=V.createFramebuffer,Ht=V.getViewportSize,ir=V.getContainer,tr=ir().getBoundingClientRect(),Or=tr.width,an=tr.height;Or*=window.devicePixelRatio,an*=window.devicePixelRatio,this.pickBufferScale=this.configService.getSceneConfig(z).pickBufferScale||1,this.pickingFBO=ut({color:_e({width:Math.round(Or/this.pickBufferScale),height:Math.round(an/this.pickBufferScale),wrapS:Un.a.CLAMP_TO_EDGE,wrapT:Un.a.CLAMP_TO_EDGE})}),this.interactionService.on(na.a.Hover,this.pickingAllLayer.bind(this))}},{key:"pickingAllLayer",value:function(){var se=En()(fr.a.mark(function V(_e){return fr.a.wrap(function(Ht){for(;;)switch(Ht.prev=Ht.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering)){Ht.next=2;break}return Ht.abrupt("return");case 2:return this.alreadyInPicking=!0,Ht.next=5,this.pickingLayers(_e);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return Ht.stop()}},V,this)}));function z(V){return se.apply(this,arguments)}return z}()},{key:"pickingLayers",value:function(){var se=En()(fr.a.mark(function V(_e){var ut=this,Ht,ir,tr,Or,an,zn,Xn,ni;return fr.a.wrap(function(Oi){for(;;)switch(Oi.prev=Oi.next){case 0:Ht=this.rendererService,ir=Ht.getViewportSize,tr=Ht.useFramebuffer,Or=Ht.clear,an=Ht.getContainer,zn=an().getBoundingClientRect(),Xn=zn.width,ni=zn.height,Xn*=window.devicePixelRatio,ni*=window.devicePixelRatio,(this.width!==Xn||this.height!==ni)&&(this.pickingFBO.resize({width:Math.round(Xn/this.pickBufferScale),height:Math.round(ni/this.pickBufferScale)}),this.width=Xn,this.height=ni),tr(this.pickingFBO,function(){var la=ut.layerService.getLayers();la.filter(function(Yi){return Yi.needPick(_e.type)}).reverse().some(function(Yi){Or({framebuffer:ut.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Yi.hooks.beforePickingEncode.call(),Yi.renderModels(),Yi.hooks.afterPickingEncode.call();var ja=ut.pickFromPickingFBO(Yi,_e);return ja&&!Yi.getLayerConfig().enablePropagation})});case 6:case"end":return Oi.stop()}},V,this)}));function z(V){return se.apply(this,arguments)}return z}()},{key:"triggerHoverOnLayer",value:function(z,V){z.emit(V.type,V)}},{key:"highlightPickedFeature",value:function(z,V){var _e=gt()(V,3),ut=_e[0],Ht=_e[1],ir=_e[2];z.hooks.beforeHighlight.call([ut,Ht,ir])}},{key:"selectFeature",value:function(z,V){var _e=gt()(V,3),ut=_e[0],Ht=_e[1],ir=_e[2];z.hooks.beforeSelect.call([ut,Ht,ir])}}]),ne}(),uo),Ic=Mn()($s.prototype,"rendererService",[no],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Il=Mn()($s.prototype,"configService",[go],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fs=Mn()($s.prototype,"interactionService",[No],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zs=Mn()($s.prototype,"layerService",[Vu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$s))||Wl),Xl=function(){function ne(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;Y()(this,ne),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=se}return Ke()(ne,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var z=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var V=(typeof performance=="undefined"?Date:performance).now();z=(V-this.oldTime)/1e3,this.oldTime=V,this.elapsedTime+=z}return z}}]),ne}(),ya,Na,ml,Ns,ds,Mt,rr,Pr,Vn=(ya=Object(B.injectable)(),Na=Object(B.inject)(D.a.IRendererService),ml=Object(B.inject)(D.a.IGlobalConfigService),ya(Ns=(ds=(Pr=function(){function ne(){Y()(this,ne),this.clock=new Xl,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,Ar()(this,"renderService",Mt,this),Ar()(this,"configService",rr,this)}return Ke()(ne,[{key:"add",value:function(z){this.sceneInited&&z.init(),this.layers.push(z)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(z){z.inited||z.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(z){return this.layers.find(function(V){return V.id===z})}},{key:"getLayerByName",value:function(z){return this.layers.find(function(V){return V.name===z})}},{key:"remove",value:function(z){var V=this.layers.indexOf(z);V>-1&&this.layers.splice(V,1),z.emit("remove",null),z.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){this.alreadyInRendering||(this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(z){return z.inited}).filter(function(z){return z.isVisible()}).forEach(function(z){z.hooks.beforeRenderData.call(),z.hooks.beforeRender.call(),z.render(),z.hooks.afterRender.call()}),this.alreadyInRendering=!1)}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(z,V){return z.zIndex-V.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(z){return z.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++==0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount==0&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),ne}(),Pr),Mt=Mn()(ds.prototype,"renderService",[Na],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rr=Mn()(ds.prototype,"configService",[ml],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ds))||Ns),Ji=o("QILm"),Ra=o.n(Ji),Ha=o("RIqP"),Qi=o.n(Ha),xa=o("J2iB"),Co=o.n(xa),Fs=function(){function ne(se){var z=this;Y()(this,ne),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:Infinity},this.vertexAttribute=void 0,this.defaultCallback=function(V){if(V.length===0){var _e;return((_e=z.scale)===null||_e===void 0?void 0:_e.defaultValues)||[]}return V.map(function(ut,Ht){var ir,tr=(ir=z.scale)===null||ir===void 0?void 0:ir.scalers[Ht].func,Or=tr(ut);return Or})},this.setProps(se)}return Ke()(ne,[{key:"setProps",value:function(z){Object.assign(this,z)}},{key:"mapping",value:function(z){var V;if((V=this.scale)===null||V===void 0?void 0:V.callback){var _e,ut=(_e=this.scale)===null||_e===void 0?void 0:_e.callback.apply(_e,Qi()(z));if(!Co()(ut))return[ut]}return this.defaultCallback(z)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),ne}(),ha,Yl,cu,ws,gl,fu,Gu;function Qs(ne,se){var z=Object.keys(ne);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ne);se&&(V=V.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),z.push.apply(z,V)}return z}function rl(ne){for(var se=1;se<arguments.length;se++){var z=arguments[se]!=null?arguments[se]:{};se%2?Qs(Object(z),!0).forEach(function(V){te()(ne,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(z)):Qs(Object(z)).forEach(function(V){Object.defineProperty(ne,V,Object.getOwnPropertyDescriptor(z,V))})}return ne}function hu(ne){return new Promise(function(se){return setTimeout(se,ne)})}var pc=(ha={},te()(ha,Un.a.FLOAT,4),te()(ha,Un.a.UNSIGNED_BYTE,1),te()(ha,Un.a.UNSIGNED_SHORT,2),ha),Pf=(Yl=Object(B.injectable)(),cu=Object(B.inject)(D.a.IRendererService),Yl(ws=(gl=(Gu=function(){function ne(){Y()(this,ne),this.attributesAndIndices=void 0,Ar()(this,"rendererService",fu,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return Ke()(ne,[{key:"registerStyleAttribute",value:function(z){var V=this.getLayerStyleAttribute(z.name||"");return V?V.setProps(z):(V=new Fs(z),this.attributes.push(V)),V}},{key:"updateStyleAttribute",value:function(z,V,_e){var ut=this.getLayerStyleAttribute(z);ut||(ut=this.registerStyleAttribute(rl(rl({},V),{},{name:z})));var Ht=V.scale;Ht&&ut&&(ut.scale=Ht,ut.needRescale=!0,ut.needRemapping=!0,ut.needRegenerateVertices=!0,_e&&_e.featureRange&&(ut.featureRange=_e.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(z){return this.attributes.find(function(V){return V.name===z})}},{key:"getLayerAttributeScale",value:function(z){var V,_e=this.getLayerStyleAttribute(z),ut=_e==null||(V=_e.scale)===null||V===void 0?void 0:V.scalers;return ut&&ut[0]?ut[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(z,V){var _e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,ut=arguments.length>3?arguments[3]:void 0,Ht=this.attributes.find(function(So){return So.name===z});if(Ht&&Ht.descriptor){var ir=Ht.descriptor,tr=ir.update,Or=ir.buffer,an=ir.size,zn=an===void 0?0:an,Xn=pc[Or.type||Un.a.FLOAT];if(tr){var ni=this.featureLayout,ra=ni.elements,Oi=ni.sizePerElement,la=ra.slice(_e,ut);if(!la.length)return;var Yi=la[0].offset,ja=Yi*zn*Xn,Ro=la.map(function(So,Ya){for(var Vo=So.featureIdx,ea=So.vertices,fo=So.normals,iu=ea.length/Oi,Ta=[],Ua=0;Ua<iu;Ua++){var bi=fo?fo.slice(Ua*3,Ua*3+3):[];Ta.push.apply(Ta,Qi()(tr(V[Vo],Vo,ea.slice(Ua*Oi,Ua*Oi+Oi),Ya,bi)))}return Ta}).reduce(function(So,Ya){return So.push.apply(So,Qi()(Ya)),So},[]);Ht.vertexAttribute.updateBuffer({data:Ro,offset:ja})}}}},{key:"createAttributesAndIndices",value:function(z,V){var _e=this;this.featureLayout={sizePerElement:0,elements:[]},V&&(this.triangulation=V);var ut=this.attributes.map(function(Yi){return Yi.resetDescriptor(),Yi.descriptor}),Ht=0,ir=[],tr=[],Or=[],an=3;z.forEach(function(Yi,ja){var Ro=_e.triangulation(Yi),So=Ro.indices,Ya=Ro.vertices,Vo=Ro.normals,ea=Ro.size;So.forEach(function(Ua){tr.push(Ua+Ht)}),an=ea;var fo=Ya.length/ea;_e.featureLayout.sizePerElement=an,_e.featureLayout.elements.push({featureIdx:ja,vertices:Ya,normals:Vo,offset:Ht}),Ht+=fo;for(var iu=function(bi){var Do=(Vo==null?void 0:Vo.slice(bi*3,bi*3+3))||[],fc=Ya.slice(bi*ea,bi*ea+ea);ut.forEach(function(Wf,fh){if(Wf&&Wf.update){var Xf;(Xf=Wf.buffer.data).push.apply(Xf,Qi()(Wf.update(Yi,ja,fc,bi,Do)))}})},Ta=0;Ta<fo;Ta++)iu(Ta)});var zn=this.rendererService,Xn=zn.createAttribute,ni=zn.createBuffer,ra=zn.createElements,Oi={};ut.forEach(function(Yi,ja){if(Yi){var Ro=Yi.buffer,So=Yi.update,Ya=Yi.name,Vo=Ra()(Yi,["buffer","update","name"]),ea=Xn(rl({buffer:ni(Ro)},Vo));Oi[Yi.name||""]=ea,_e.attributes[ja].vertexAttribute=ea}});var la=ra({data:tr,type:Un.a.UNSIGNED_INT,count:tr.length});return this.attributesAndIndices={attributes:Oi,elements:la},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var z;this.attributes.forEach(function(V){V.vertexAttribute&&V.vertexAttribute.destroy()}),(z=this.attributesAndIndices)===null||z===void 0||z.elements.destroy(),this.attributes=[]}}]),ne}(),Gu),fu=Mn()(gl.prototype,"rendererService",[cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gl))||ws),da=o("U8pU"),Oc=o("KQm4"),vc=o("rePB"),qc=o("1OyB"),ef=o("vuIU"),tf=o("5ku3"),Qa=typeof __VERSION__!="undefined"?__VERSION__:"untranspiled source",Au=Object(tf.a)();function qs(ne){try{var se=window[ne],z="__storage_test__";return se.setItem(z,z),se.removeItem(z),se}catch(V){return null}}var ps=function(){function ne(se,z){var V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Object(qc.a)(this,ne),this.storage=qs(V),this.id=se,this.config={},Object.assign(this.config,z),this._loadConfiguration()}return Object(ef.a)(ne,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(z){return this.config={},this.updateConfiguration(z)}},{key:"updateConfiguration",value:function(z){if(Object.assign(this.config,z),this.storage){var V=JSON.stringify(this.config);this.storage.setItem(this.id,V)}return this}},{key:"_loadConfiguration",value:function(){var z={};if(this.storage){var V=this.storage.getItem(this.id);z=V?JSON.parse(V):{}}return Object.assign(this.config,z),this}}]),ne}();function Lc(ne){var se;return ne<10?se="".concat(ne.toFixed(2),"ms"):ne<100?se="".concat(ne.toFixed(1),"ms"):ne<1e3?se="".concat(ne.toFixed(0),"ms"):se="".concat((ne/1e3).toFixed(2),"s"),se}function mc(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,z=Math.max(se-ne.length,0);return"".concat(" ".repeat(z)).concat(ne)}function yl(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,z=Math.max(se-ne.length,0);return"".concat(ne).concat(" ".repeat(z))}function nl(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},z=1e-16,V=se.isInteger,_e=V===void 0?!1:V;if(Array.isArray(ne)||ArrayBuffer.isView(ne))return gc(ne,se);if(!Number.isFinite(ne))return String(ne);if(Math.abs(ne)<z)return _e?"0":"0.";if(_e||Math.abs(ne)>100&&Math.abs(ne)<1e4)return ne.toFixed(0);var ut=ne.toPrecision(2),Ht=ut.indexOf(".0");return Ht===ut.length-2?ut.slice(0,-1):ut}function gc(ne,se){for(var z=se.maxElts,V=z===void 0?16:z,_e=se.size,ut=_e===void 0?1:_e,Ht="[",ir=0;ir<ne.length&&ir<V;++ir)ir>0&&(Ht+=",".concat(ir%ut==0?" ":"")),Ht+=nl(ne[ir],se);var tr=ne.length>V?"...":"]";return"".concat(Ht).concat(tr)}function eu(ne,se,z){var V=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,_e=ne.src.replace(/\(/g,"%28").replace(/\)/g,"%29");ne.width>V&&(z=Math.min(z,V/ne.width));var ut=ne.width*z,Ht=ne.height*z,ir=["font-size:1px;","padding:".concat(Math.floor(Ht/2),"px ").concat(Math.floor(ut/2),"px;"),"line-height:".concat(Ht,"px;"),"background:url(".concat(_e,");"),"background-size:".concat(ut,"px ").concat(Ht,"px;"),"color:transparent;"].join("");return["".concat(se," %c+"),ir]}var Hu={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function Rc(ne){return typeof ne=="string"?Hu[ne.toUpperCase()]||Hu.WHITE:ne}function Kl(ne,se,z){return!Au&&typeof ne=="string"&&(se&&(se=Rc(se),ne="[".concat(se,"m").concat(ne,"[39m")),z&&(se=Rc(z),ne="[".concat(z+10,"m").concat(ne,"[49m"))),ne}function wa(ne){if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(ne=Dc(ne))){var se=0,z=function(){};return{s:z,n:function(){return se>=ne.length?{done:!0}:{done:!1,value:ne[se++]}},e:function(tr){throw tr},f:z}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var V,_e=!0,ut=!1,Ht;return{s:function(){V=ne[Symbol.iterator]()},n:function(){var tr=V.next();return _e=tr.done,tr},e:function(tr){ut=!0,Ht=tr},f:function(){try{!_e&&V.return!=null&&V.return()}finally{if(ut)throw Ht}}}}function Dc(ne,se){if(!!ne){if(typeof ne=="string")return Mf(ne,se);var z=Object.prototype.toString.call(ne).slice(8,-1);if(z==="Object"&&ne.constructor&&(z=ne.constructor.name),z==="Map"||z==="Set")return Array.from(z);if(z==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(z))return Mf(ne,se)}}function Mf(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var z=0,V=new Array(se);z<se;z++)V[z]=ne[z];return V}function yc(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],z=Object.getPrototypeOf(ne),V=Object.getOwnPropertyNames(z),_e=wa(V),ut;try{var Ht=function(){var tr=ut.value;typeof ne[tr]=="function"&&(se.find(function(Or){return tr===Or})||(ne[tr]=ne[tr].bind(ne)))};for(_e.s();!(ut=_e.n()).done;)Ht()}catch(ir){_e.e(ir)}finally{_e.f()}}function zc(ne,se){if(!ne)throw new Error(se||"Assertion failed")}var $l=o("K9nA");function Zu(){var ne;if(Au&&$l.b.performance)ne=$l.b.performance.now();else if($l.a.hrtime){var se=$l.a.hrtime();ne=se[0]*1e3+se[1]/1e6}else ne=Date.now();return ne}var _u={debug:Au&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Ol={enabled:!0,level:0};function Fo(){}var Jl={},Ll={once:!0};function xl(ne){for(var se in ne)for(var z in ne[se])return z||"untitled";return"empty"}var Nc=function(){function ne(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},z=se.id;Object(qc.a)(this,ne),this.id=z,this.VERSION=Qa,this._startTs=Zu(),this._deltaTs=Zu(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new ps("__probe-".concat(this.id,"__"),Ol),this.userData={},this.timeStamp("".concat(this.id," started")),yc(this),Object.seal(this)}return Object(ef.a)(ne,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((Zu()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Zu()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:z}),this}},{key:"setLevel",value:function(z){return this._storage.updateConfiguration({level:z}),this}},{key:"assert",value:function(z,V){zc(z,V)}},{key:"warn",value:function(z){return this._getLogFunction(0,z,_u.warn,arguments,Ll)}},{key:"error",value:function(z){return this._getLogFunction(0,z,_u.error,arguments)}},{key:"deprecated",value:function(z,V){return this.warn("`".concat(z,"` is deprecated and will be removed in a later version. Use `").concat(V,"` instead"))}},{key:"removed",value:function(z,V){return this.error("`".concat(z,"` has been removed. Use `").concat(V,"` instead"))}},{key:"probe",value:function(z,V){return this._getLogFunction(z,V,_u.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(z,V){return this._getLogFunction(z,V,_u.debug,arguments)}},{key:"info",value:function(z,V){return this._getLogFunction(z,V,console.info,arguments)}},{key:"once",value:function(z,V){return this._getLogFunction(z,V,_u.debug||_u.info,arguments,Ll)}},{key:"table",value:function(z,V,_e){return V?this._getLogFunction(z,V,console.table||Fo,_e&&[_e],{tag:xl(V)}):Fo}},{key:"image",value:function(z){var V=z.logLevel,_e=z.priority,ut=z.image,Ht=z.message,ir=Ht===void 0?"":Ht,tr=z.scale,Or=tr===void 0?1:tr;return this._shouldLog(V||_e)?Au?rf({image:ut,message:ir,scale:Or}):gf({image:ut,message:ir,scale:Or}):Fo}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(z){return this._storage.config[z]}},{key:"set",value:function(z,V){this._storage.updateConfiguration(Object(vc.a)({},z,V))}},{key:"time",value:function(z,V){return this._getLogFunction(z,V,console.time?console.time:console.info)}},{key:"timeEnd",value:function(z,V){return this._getLogFunction(z,V,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(z,V){return this._getLogFunction(z,V,console.timeStamp||Fo)}},{key:"group",value:function(z,V){var _e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};_e=tu({logLevel:z,message:V,opts:_e});var ut=_e,Ht=ut.collapsed;return _e.method=(Ht?console.groupCollapsed:console.group)||console.info,this._getLogFunction(_e)}},{key:"groupCollapsed",value:function(z,V){var _e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(z,V,Object.assign({},_e,{collapsed:!0}))}},{key:"groupEnd",value:function(z){return this._getLogFunction(z,"",console.groupEnd||Fo)}},{key:"withGroup",value:function(z,V,_e){this.group(z,V)();try{_e()}finally{this.groupEnd(z)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(z){return this.isEnabled()&&this.getLevel()>=Rl(z)}},{key:"_getLogFunction",value:function(z,V,_e){var ut=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],Ht=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(z)){var ir;Ht=tu({logLevel:z,message:V,args:ut,opts:Ht}),_e=_e||Ht.method,zc(_e),Ht.total=this.getTotal(),Ht.delta=this.getDelta(),this._deltaTs=Zu();var tr=Ht.tag||Ht.message;if(Ht.once)if(!Jl[tr])Jl[tr]=Zu();else return Fo;return V=mf(this.id,Ht.message,Ht),(ir=_e).bind.apply(ir,[console,V].concat(Object(Oc.a)(Ht.args)))}return Fo}},{key:"level",set:function(z){this.setLevel(z)},get:function(){return this.getLevel()}},{key:"priority",set:function(z){this.level=z},get:function(){return this.level}}]),ne}();Nc.VERSION=Qa;function Rl(ne){if(!ne)return 0;var se;switch(Object(da.a)(ne)){case"number":se=ne;break;case"object":se=ne.logLevel||ne.priority||0;break;default:return 0}return zc(Number.isFinite(se)&&se>=0),se}function tu(ne){var se=ne.logLevel,z=ne.message;ne.logLevel=Rl(se);for(var V=ne.args?Array.from(ne.args):[];V.length&&V.shift()!==z;);switch(ne.args=V,Object(da.a)(se)){case"string":case"function":z!==void 0&&V.unshift(z),ne.message=se;break;case"object":Object.assign(ne,se);break;default:}typeof ne.message=="function"&&(ne.message=ne.message());var _e=Object(da.a)(ne.message);return zc(_e==="string"||_e==="object"),Object.assign(ne,ne.opts)}function mf(ne,se,z){if(typeof se=="string"){var V=z.time?mc(Lc(z.total)):"";se=z.time?"".concat(ne,": ").concat(V,"  ").concat(se):"".concat(ne,": ").concat(se),se=Kl(se,z.color,z.background)}return se}function gf(ne){var se=ne.image,z=ne.message,V=z===void 0?"":z,_e=ne.scale,ut=_e===void 0?1:_e,Ht=null;try{Ht=o(2)}catch(ir){}return Ht?function(){return Ht(se,{fit:"box",width:"".concat(Math.round(80*ut),"%")}).then(function(ir){return console.log(ir)})}:Fo}function rf(ne){var se=ne.image,z=ne.message,V=z===void 0?"":z,_e=ne.scale,ut=_e===void 0?1:_e;if(typeof se=="string"){var Ht=new Image;return Ht.onload=function(){var an,zn=eu(Ht,V,ut);(an=console).log.apply(an,Object(Oc.a)(zn))},Ht.src=se,Fo}var ir=se.nodeName||"";if(ir.toLowerCase()==="img"){var tr;return(tr=console).log.apply(tr,Object(Oc.a)(eu(se,V,ut))),Fo}if(ir.toLowerCase()==="canvas"){var Or=new Image;return Or.onload=function(){var an;return(an=console).log.apply(an,Object(Oc.a)(eu(Or,V,ut)))},Or.src=se.toDataURL(),Fo}return Fo}var bl,Fa,il=new Nc({id:"L7"}).enable(!1);il.priority=5;var Dl=(bl=Object(B.injectable)(),bl(Fa=function(){function ne(){Y()(this,ne)}return Ke()(ne,[{key:"error",value:function(z){il.error(z)()}},{key:"warn",value:function(z){il.probe(1,z)()}},{key:"info",value:function(z){il.info(3,z)()}},{key:"debug",value:function(z){il.probe(4,z)()}}]),ne}())||Fa),xc=o("xp6e"),Fc=o("iegG"),zl=o.n(Fc),If=window.document.documentElement.style,Of=0;function nf(ne){var se=ne;if(typeof ne=="string"&&(se=document.getElementById(ne)),se){var z=document.createElement("div");return z.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,z.id="l7-scene-".concat(Of++),z.classList.add("l7-scene"),se.appendChild(z),z}return null}var Sl,Ql,Cu,Bs,al,Bc,Wu,Ba,du,ol,sl,zi,pa,Ps,Sa,Gi,ql,yf,as,ul,pu,Xu,io,os,Nl,lo,In,ks,bc,El,wu,js,qi,qr,kc,Sc;function ll(ne){var se=vu();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function vu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ms=(Sl=Object(B.injectable)(),Ql=Object(B.inject)(D.a.SceneID),Cu=Object(B.inject)(D.a.IIconService),Bs=Object(B.inject)(D.a.IFontService),al=Object(B.inject)(D.a.IControlService),Bc=Object(B.inject)(D.a.ILogService),Wu=Object(B.inject)(D.a.IGlobalConfigService),Ba=Object(B.inject)(D.a.IMapService),du=Object(B.inject)(D.a.ICoordinateSystemService),ol=Object(B.inject)(D.a.IRendererService),sl=Object(B.inject)(D.a.ILayerService),zi=Object(B.inject)(D.a.ICameraService),pa=Object(B.inject)(D.a.IInteractionService),Ps=Object(B.inject)(D.a.IPickingService),Sa=Object(B.inject)(D.a.IShaderModuleService),Gi=Object(B.inject)(D.a.IMarkerService),ql=Object(B.inject)(D.a.IPopupService),Sl(yf=(as=(Sc=function(ne){fe()(z,ne);var se=ll(z);function z(){var V;return Y()(this,z),V=se.call(this),V.destroyed=!1,V.loaded=!1,Ar()(V,"id",ul,Ui()(V)),Ar()(V,"iconService",pu,Ui()(V)),Ar()(V,"fontService",Xu,Ui()(V)),Ar()(V,"controlService",io,Ui()(V)),Ar()(V,"logger",os,Ui()(V)),Ar()(V,"configService",Nl,Ui()(V)),Ar()(V,"map",lo,Ui()(V)),Ar()(V,"coordinateSystemService",In,Ui()(V)),Ar()(V,"rendererService",ks,Ui()(V)),Ar()(V,"layerService",bc,Ui()(V)),Ar()(V,"cameraService",El,Ui()(V)),Ar()(V,"interactionService",wu,Ui()(V)),Ar()(V,"pickingService",js,Ui()(V)),Ar()(V,"shaderModuleService",qi,Ui()(V)),Ar()(V,"markerService",qr,Ui()(V)),Ar()(V,"popupService",kc,Ui()(V)),V.inited=!1,V.initPromise=void 0,V.rendering=!1,V.$container=void 0,V.canvas=void 0,V.markerContainer=void 0,V.hooks=void 0,V.handleWindowResized=function(){V.emit("resize"),V.$container&&(V.initContainer(),We.a.triggerResize(),V.coordinateSystemService.needRefresh=!0,V.render())},V.handleMapCameraChanged=function(_e){V.cameraService.update(_e),V.render()},V.hooks={init:new xc.a},V}return Ke()(z,[{key:"init",value:function(_e){var ut=this;this.configService.setSceneConfig(this.id,_e),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",En()(fr.a.mark(function Ht(){return fr.a.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return tr.next=2,new Promise(function(Or){ut.map.onCameraChanged(function(an){ut.cameraService.init(),ut.cameraService.update(an),Or()}),ut.map.init()});case 2:ut.map.onCameraChanged(ut.handleMapCameraChanged),ut.map.addMarkerContainer(),ut.markerService.addMarkers(),ut.markerService.addMarkerLayers(),ut.popupService.initPopup(),ut.interactionService.init(),ut.interactionService.on(na.a.Drag,ut.addSceneEvent.bind(ut)),ut.logger.debug("map ".concat(ut.id," loaded"));case 10:case"end":return tr.stop()}},Ht)}))),this.hooks.init.tapPromise("initRenderer",En()(fr.a.mark(function Ht(){var ir;return fr.a.wrap(function(Or){for(;;)switch(Or.prev=Or.next){case 0:if(ir=nf(ut.configService.getSceneConfig(ut.id).id||""),ut.$container=ir,!ir){Or.next=11;break}return ut.canvas=We.a.create("canvas","",ir),ut.setCanvas(),Or.next=7,ut.rendererService.init(ut.canvas,ut.configService.getSceneConfig(ut.id));case 7:zl()(ut.$container,ut.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(ut.handleWindowResized),Or.next=12;break;case 11:ut.logger.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:ut.pickingService.init(ut.id),ut.logger.debug("scene ".concat(ut.id," renderer loaded"));case 14:case"end":return Or.stop()}},Ht)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(_e){this.logger.debug("add layer ".concat(_e.name," to scene ").concat(this.id)),this.layerService.add(_e),this.render()}},{key:"render",value:function(){var V=En()(fr.a.mark(function ut(){return fr.a.wrap(function(ir){for(;;)switch(ir.prev=ir.next){case 0:if(!(this.rendering||this.destroyed)){ir.next=2;break}return ir.abrupt("return");case 2:if(this.rendering=!0,this.inited){ir.next=13;break}return ir.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 13:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 16:case"end":return ir.stop()}},ut,this)}));function _e(){return V.apply(this,arguments)}return _e}()},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(_e){var ut,Ht=(ut=this.$container)===null||ut===void 0?void 0:ut.getElementsByTagName("canvas")[0];this.render();var ir=_e==="jpg"?Ht==null?void 0:Ht.toDataURL("image/jpeg"):Ht==null?void 0:Ht.toDataURL("image/png");return ir}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var _e=this.$container.parentElement;_e!==null&&(this.markerContainer=We.a.create("div","l7-marker-container",_e))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){if(!this.inited){this.destroyed=!0;return}this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,Object(Fc.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)}},{key:"initContainer",value:function(){var _e,ut,Ht=window.devicePixelRatio,ir=((_e=this.$container)===null||_e===void 0?void 0:_e.clientWidth)||400,tr=((ut=this.$container)===null||ut===void 0?void 0:ut.clientHeight)||300,Or=this.canvas;Or&&(Or.width=ir*Ht,Or.height=tr*Ht,Or.style.width="".concat(ir,"px"),Or.style.height="".concat(tr,"px")),this.rendererService.viewport({x:0,y:0,width:Ht*ir,height:Ht*tr})}},{key:"setCanvas",value:function(){var _e,ut,Ht=window.devicePixelRatio,ir=((_e=this.$container)===null||_e===void 0?void 0:_e.clientWidth)||400,tr=((ut=this.$container)===null||ut===void 0?void 0:ut.clientHeight)||300,Or=this.canvas;Or.width=ir*Ht,Or.height=tr*Ht,Or.style.width="".concat(ir,"px"),Or.style.height="".concat(tr,"px")}},{key:"addSceneEvent",value:function(_e){this.emit(_e.type,_e)}}]),z}(v.EventEmitter),Sc),ul=Mn()(as.prototype,"id",[Ql],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pu=Mn()(as.prototype,"iconService",[Cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xu=Mn()(as.prototype,"fontService",[Bs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),io=Mn()(as.prototype,"controlService",[al],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),os=Mn()(as.prototype,"logger",[Bc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nl=Mn()(as.prototype,"configService",[Wu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lo=Mn()(as.prototype,"map",[Ba],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=Mn()(as.prototype,"coordinateSystemService",[du],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ks=Mn()(as.prototype,"rendererService",[ol],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bc=Mn()(as.prototype,"layerService",[sl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),El=Mn()(as.prototype,"cameraService",[zi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wu=Mn()(as.prototype,"interactionService",[pa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),js=Mn()(as.prototype,"pickingService",[Ps],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qi=Mn()(as.prototype,"shaderModuleService",[Sa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qr=Mn()(as.prototype,"markerService",[Gi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kc=Mn()(as.prototype,"popupService",[ql],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),as))||yf),Is=o("7tbW"),$o=o.n(Is);function Bo(ne){var se=0;switch(ne){case"vec2":case"ivec2":se=2;break;case"vec3":case"ivec3":se=3;break;case"vec4":case"ivec4":case"mat2":se=4;break;case"mat3":se=9;break;case"mat4":se=16;break;default:}return se}var cl=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function Tl(ne){var se={};return ne=ne.replace(cl,function(z,V,_e){var ut=_e.split(":"),Ht=ut[0].trim(),ir="";switch(ut.length>1&&(ir=ut[1].trim()),V){case"bool":ir=ir==="true";break;case"float":case"int":ir=Number(ir);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":ir?ir=ir.replace("[","").replace("]","").split(",").reduce(function(tr,Or){return tr.push(Number(Or.trim())),tr},[]):ir=new Array(Bo(V)).fill(0);break;default:}return se[Ht]=ir,"uniform ".concat(V," ").concat(Ht,`;
`)}),{content:ne,uniforms:se}}var Fl,af,Bl;function Os(ne,se){var z=Object.keys(ne);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ne);se&&(V=V.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),z.push.apply(z,V)}return z}function ss(ne){for(var se=1;se<arguments.length;se++){var z=arguments[se]!=null?arguments[se]:{};se%2?Os(Object(z),!0).forEach(function(V){te()(ne,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(z)):Os(Object(z)).forEach(function(V){Object.defineProperty(ne,V,Object.getOwnPropertyDescriptor(z,V))})}return ne}var Mi="#define PI 3.14159265359",Yu=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,ka=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,wo=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Al=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,mu=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}
`,gu=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}
`,Es=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0
#define COORDINATE_SYSTEM_P20_OFFSET 6.0
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }
  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

`,Ec=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,$n=/precision\s+(high|low|medium)p\s+float/,Fn=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,Tc=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,vs=(Fl=Object(B.injectable)(),Fl(af=(Bl=function(){function ne(){Y()(this,ne),this.moduleCache={},this.rawContentCache={}}return Ke()(ne,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:Mi,fs:Mi}),this.registerModule("decode",{vs:Yu,fs:""}),this.registerModule("projection",{vs:Es,fs:""}),this.registerModule("project",{vs:gu,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Ec}),this.registerModule("lighting",{vs:wo,fs:""}),this.registerModule("light",{vs:ka,fs:""}),this.registerModule("picking",{vs:mu,fs:Al})}},{key:"registerModule",value:function(z,V){if(!this.rawContentCache[z]){var _e=V.vs,ut=V.fs,Ht=V.uniforms,ir=Tl(_e),tr=ir.content,Or=ir.uniforms,an=Tl(ut),zn=an.content,Xn=an.uniforms;this.rawContentCache[z]={fs:zn,uniforms:ss(ss(ss({},Or),Xn),Ht),vs:tr}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(z){var V=this;if(this.moduleCache[z])return this.moduleCache[z];var _e=this.rawContentCache[z].vs,ut=this.rawContentCache[z].fs,Ht=this.processModule(_e,[],"vs"),ir=Ht.content,tr=Ht.includeList,Or=this.processModule(ut,[],"fs"),an=Or.content,zn=Or.includeList,Xn=an,ni=$o()(tr.concat(zn).concat(z)).reduce(function(ra,Oi){return ss(ss({},ra),V.rawContentCache[Oi].uniforms)},{});return $n.test(an)||(Xn=Fn+an),this.moduleCache[z]={fs:Xn.trim(),uniforms:ni,vs:ir.trim()},this.moduleCache[z]}},{key:"processModule",value:function(z,V,_e){var ut=this,Ht=z.replace(Tc,function(ir,tr){var Or=tr.split(" "),an=Or[0].replace(/"/g,"");if(V.indexOf(an)>-1)return"";var zn=ut.rawContentCache[an][_e];V.push(an);var Xn=ut.processModule(zn,V,_e),ni=Xn.content;return ni});return{content:Ht,includeList:V}}}]),ne}(),Bl))||af),ko=o("iWIM"),Po=o.n(ko),ru=o("bPkA"),Pu,ec,Hi,Za,fl,hl,tc=(Pu=Object(B.injectable)(),ec=Object(B.inject)(D.a.IShaderModuleService),Pu(Hi=(Za=(hl=function(){function ne(){Y()(this,ne),Ar()(this,"shaderModuleService",fl,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return Ke()(ne,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return ru.a.Normal}},{key:"init",value:function(z,V){this.config=V,this.rendererService=z.getContainer().get(D.a.IRendererService),this.cameraService=z.getContainer().get(D.a.ICameraService),this.mapService=z.getContainer().get(D.a.IMapService),this.interactionService=z.getContainer().get(D.a.IInteractionService),this.layerService=z.getContainer().get(D.a.ILayerService)}},{key:"render",value:function(z){}}]),ne}(),hl),fl=Mn()(Za.prototype,"shaderModuleService",[ec],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Za))||Hi),Mu,Ls;function kl(ne){var se=ms();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function ms(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var xf=(Mu=Object(B.injectable)(),Mu(Ls=function(ne){fe()(z,ne);var se=kl(z);function z(){return Y()(this,z),se.apply(this,arguments)}return Ke()(z,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(_e,ut){Po()(nt()(z.prototype),"init",this).call(this,_e,ut)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),z}(tc))||Ls),jl,jc,bf,Us,_l,Ul;function Iu(ne,se){var z;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(z=Ou(ne))||se&&ne&&typeof ne.length=="number"){z&&(ne=z);var V=0,_e=function(){};return{s:_e,n:function(){return V>=ne.length?{done:!0}:{done:!1,value:ne[V++]}},e:function(Or){throw Or},f:_e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ut=!0,Ht=!1,ir;return{s:function(){z=ne[Symbol.iterator]()},n:function(){var Or=z.next();return ut=Or.done,Or},e:function(Or){Ht=!0,ir=Or},f:function(){try{!ut&&z.return!=null&&z.return()}finally{if(Ht)throw ir}}}}function Ou(ne,se){if(!!ne){if(typeof ne=="string")return Cl(ne,se);var z=Object.prototype.toString.call(ne).slice(8,-1);if(z==="Object"&&ne.constructor&&(z=ne.constructor.name),z==="Map"||z==="Set")return Array.from(ne);if(z==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(z))return Cl(ne,se)}}function Cl(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var z=0,V=new Array(se);z<se;z++)V[z]=ne[z];return V}var Ku=(jl=Object(B.injectable)(),jc=Object(B.inject)(D.a.IPostProcessor),jl(bf=(Us=(Ul=function(){function ne(){Y()(this,ne),this.passes=[],Ar()(this,"postProcessor",_l,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}return Ke()(ne,[{key:"setLayer",value:function(z){this.layer=z}},{key:"setRenderFlag",value:function(z){this.renderFlag=z}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var se=En()(fr.a.mark(function V(){var _e,ut,Ht;return fr.a.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:_e=Iu(this.passes),tr.prev=1,_e.s();case 3:if((ut=_e.n()).done){tr.next=9;break}return Ht=ut.value,tr.next=7,Ht.render(this.layer);case 7:tr.next=3;break;case 9:tr.next=14;break;case 11:tr.prev=11,tr.t0=tr.catch(1),_e.e(tr.t0);case 14:return tr.prev=14,_e.f(),tr.finish(14);case 17:this.layer.renderModels();case 18:case"end":return tr.stop()}},V,this,[[1,11,14,17]])}));function z(){return se.apply(this,arguments)}return z}()},{key:"resize",value:function(z,V){(this.width!==z||this.height!==V)&&(this.width=z,this.height=V)}},{key:"add",value:function(z,V){z.getType()===ru.a.PostProcessing?this.postProcessor.add(z,this.layer,V):(z.init(this.layer,V),this.passes.push(z))}},{key:"insert",value:function(z,V,_e){z.init(this.layer,V),this.passes.splice(_e,0,z)}},{key:"destroy",value:function(){this.passes.length=0}}]),ne}(),Ul),_l=Mn()(Us.prototype,"postProcessor",[jc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Us))||bf),Rs,Ac,rc,nc,ic,u;function i(ne,se){var z=Object.keys(ne);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ne);se&&(V=V.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),z.push.apply(z,V)}return z}function n(ne){for(var se=1;se<arguments.length;se++){var z=arguments[se]!=null?arguments[se]:{};se%2?i(Object(z),!0).forEach(function(V){te()(ne,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(z)):i(Object(z)).forEach(function(V){Object.defineProperty(ne,V,Object.getOwnPropertyDescriptor(z,V))})}return ne}function c(ne){var se=x();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function x(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var P=(Rs=Object(B.injectable)(),Ac=Object(B.inject)(D.a.ILogService),Rs(rc=(nc=(u=function(ne){fe()(z,ne);var se=c(z);function z(){var V;Y()(this,z);for(var _e=arguments.length,ut=new Array(_e),Ht=0;Ht<_e;Ht++)ut[Ht]=arguments[Ht];return V=se.call.apply(se,[this].concat(ut)),Ar()(V,"logger",ic,Ui()(V)),V.pickingFBO=void 0,V.layer=void 0,V.width=0,V.height=0,V.alreadyInRendering=!1,V.pickFromPickingFBO=function(ir){var tr=ir.x,Or=ir.y,an=ir.lngLat,zn=ir.type;if(!(!V.layer.isVisible()||!V.layer.needPick(zn))){var Xn=V.rendererService,ni=Xn.getViewportSize,ra=Xn.readPixels,Oi=Xn.useFramebuffer,la=ni(),Yi=la.width,ja=la.height,Ro=V.layer.getLayerConfig(),So=Ro.enableHighlight,Ya=Ro.enableSelect,Vo=tr*window.devicePixelRatio,ea=Or*window.devicePixelRatio;if(!(Vo>Yi||Vo<0||ea>ja||ea<0)){var fo;Oi(V.pickingFBO,function(){var iu;if(fo=ra({x:Math.round(Vo),y:Math.round(ja-(Or+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:V.pickingFBO}),fo[0]!==0||fo[1]!==0||fo[2]!==0){V.logger.debug("picked");var Ta=Object(We.k)(fo),Ua=V.layer.getSource().getFeatureById(Ta),bi={x:tr,y:Or,type:zn,lngLat:an,featureId:Ta,feature:Ua};Ua&&(V.layer.setCurrentPickId(Ta),V.triggerHoverOnLayer(bi))}else{var Do={x:tr,y:Or,lngLat:an,type:V.layer.getCurrentPickId()===null?"un"+zn:"mouseout",featureId:null,feature:null};V.triggerHoverOnLayer(n(n({},Do),{},{type:"unpick"})),V.triggerHoverOnLayer(Do),V.layer.setCurrentPickId(null)}So&&V.highlightPickedFeature(fo),Ya&&zn==="click"&&((iu=fo)===null||iu===void 0?void 0:iu.toString())!==[0,0,0,0].toString()&&V.selectFeature(fo)})}}},V}return Ke()(z,[{key:"getType",value:function(){return ru.a.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(_e,ut){Po()(nt()(z.prototype),"init",this).call(this,_e,ut),this.layer=_e;var Ht=this.rendererService,ir=Ht.createTexture2D,tr=Ht.createFramebuffer,Or=Ht.getViewportSize,an=Or(),zn=an.width,Xn=an.height;this.pickingFBO=tr({color:ir({width:zn,height:Xn,wrapS:Un.a.CLAMP_TO_EDGE,wrapT:Un.a.CLAMP_TO_EDGE})}),this.interactionService.on(na.a.Hover,this.pickFromPickingFBO),this.interactionService.on(na.a.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(na.a.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(_e){var ut=this;if(!this.alreadyInRendering){var Ht=this.rendererService,ir=Ht.getViewportSize,tr=Ht.useFramebuffer,Or=Ht.clear,an=ir(),zn=an.width,Xn=an.height;this.alreadyInRendering=!0,(this.width!==zn||this.height!==Xn)&&(this.pickingFBO.resize({width:zn,height:Xn}),this.width=zn,this.height=Xn),tr(this.pickingFBO,function(){Or({framebuffer:ut.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var ni=ut.layer.multiPassRenderer.getRenderFlag();ut.layer.multiPassRenderer.setRenderFlag(!1),_e.hooks.beforePickingEncode.call(),_e.render(),_e.hooks.afterPickingEncode.call(),ut.layer.multiPassRenderer.setRenderFlag(ni),ut.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(_e){this.layer.emit(_e.type,_e)}},{key:"highlightPickedFeature",value:function(_e){var ut=gt()(_e,3),Ht=ut[0],ir=ut[1],tr=ut[2];this.layer.hooks.beforeHighlight.call([Ht,ir,tr]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(_e){var ut=gt()(_e,3),Ht=ut[0],ir=ut[1],tr=ut[2];this.layer.hooks.beforeSelect.call([Ht,ir,tr]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(_e){var ut=_e.featureId,Ht=Object(We.l)(ut);this.selectFeature(new Uint8Array(Ht))}},{key:"highlightFeatureHandle",value:function(_e){var ut=_e.featureId,Ht=Object(We.l)(ut);this.highlightPickedFeature(new Uint8Array(Ht))}}]),z}(tc),u),ic=Mn()(nc.prototype,"logger",[Ac],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nc))||rc),O=o("+em5"),F,ue;function Ee(ne,se){var z=Object.keys(ne);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ne);se&&(V=V.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),z.push.apply(z,V)}return z}function Xe(ne){for(var se=1;se<arguments.length;se++){var z=arguments[se]!=null?arguments[se]:{};se%2?Ee(Object(z),!0).forEach(function(V){te()(ne,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(z)):Ee(Object(z)).forEach(function(V){Object.defineProperty(ne,V,Object.getOwnPropertyDescriptor(z,V))})}return ne}function qe(ne){var se=tt();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function tt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var zt=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Lt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Xt=(F=Object(B.injectable)(),F(ue=function(ne){fe()(z,ne);var se=qe(z);function z(){return Y()(this,z),se.apply(this,arguments)}return Ke()(z,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Lt,fs:zt});var _e=this.shaderModuleService.getModule("blur-pass"),ut=_e.vs,Ht=_e.fs,ir=_e.uniforms,tr=this.rendererService.getViewportSize(),Or=tr.width,an=tr.height;return{vs:ut,fs:Ht,uniforms:Xe(Xe({},ir),{},{u_ViewportSize:[Or,an]})}}},{key:"convertOptionsToUniforms",value:function(_e){var ut={};return Co()(_e.blurRadius)||(ut.u_BlurDir=[_e.blurRadius,0]),ut}}]),z}(O.a))||ue),Dt,Ut;function er(ne,se){var z=Object.keys(ne);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ne);se&&(V=V.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),z.push.apply(z,V)}return z}function qt(ne){for(var se=1;se<arguments.length;se++){var z=arguments[se]!=null?arguments[se]:{};se%2?er(Object(z),!0).forEach(function(V){te()(ne,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(z)):er(Object(z)).forEach(function(V){Object.defineProperty(ne,V,Object.getOwnPropertyDescriptor(z,V))})}return ne}function Ir(ne){var se=hr();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function hr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Tr=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,_r=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,nn=(Dt=Object(B.injectable)(),Dt(Ut=function(ne){fe()(z,ne);var se=Ir(z);function z(){return Y()(this,z),se.apply(this,arguments)}return Ke()(z,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:_r,fs:Tr});var _e=this.shaderModuleService.getModule("blur-pass"),ut=_e.vs,Ht=_e.fs,ir=_e.uniforms,tr=this.rendererService.getViewportSize(),Or=tr.width,an=tr.height;return{vs:ut,fs:Ht,uniforms:qt(qt({},ir),{},{u_ViewportSize:[Or,an]})}}},{key:"convertOptionsToUniforms",value:function(_e){var ut={};return Co()(_e.blurRadius)||(ut.u_BlurDir=[0,_e.blurRadius]),ut}}]),z}(O.a))||Ut),Yr,yn;function On(ne,se){var z=Object.keys(ne);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ne);se&&(V=V.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),z.push.apply(z,V)}return z}function Qn(ne){for(var se=1;se<arguments.length;se++){var z=arguments[se]!=null?arguments[se]:{};se%2?On(Object(z),!0).forEach(function(V){te()(ne,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(z)):On(Object(z)).forEach(function(V){Object.defineProperty(ne,V,Object.getOwnPropertyDescriptor(z,V))})}return ne}function oi(ne){var se=yi();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function yi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Zi=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,An=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,si=(Yr=Object(B.injectable)(),Yr(yn=function(ne){fe()(z,ne);var se=oi(z);function z(){return Y()(this,z),se.apply(this,arguments)}return Ke()(z,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:An,fs:Zi});var _e=this.shaderModuleService.getModule("colorhalftone-pass"),ut=_e.vs,Ht=_e.fs,ir=_e.uniforms,tr=this.rendererService.getViewportSize(),Or=tr.width,an=tr.height;return{vs:ut,fs:Ht,uniforms:Qn(Qn({},ir),{},{u_ViewportSize:[Or,an]})}}}]),z}(O.a))||yn),xi,Wn;function Ti(ne){var se=ri();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function ri(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ii=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,Bi=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,qa=(xi=Object(B.injectable)(),xi(Wn=function(ne){fe()(z,ne);var se=Ti(z);function z(){return Y()(this,z),se.apply(this,arguments)}return Ke()(z,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:Bi,fs:Ii}),this.shaderModuleService.getModule("copy-pass")}}]),z}(O.a))||Wn),Pa,yo;function Ea(ne,se){var z=Object.keys(ne);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ne);se&&(V=V.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),z.push.apply(z,V)}return z}function Wa(ne){for(var se=1;se<arguments.length;se++){var z=arguments[se]!=null?arguments[se]:{};se%2?Ea(Object(z),!0).forEach(function(V){te()(ne,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(z)):Ea(Object(z)).forEach(function(V){Object.defineProperty(ne,V,Object.getOwnPropertyDescriptor(z,V))})}return ne}function Ds(ne){var se=xo();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function xo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var yu=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,xu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,jo=(Pa=Object(B.injectable)(),Pa(yo=function(ne){fe()(z,ne);var se=Ds(z);function z(){return Y()(this,z),se.apply(this,arguments)}return Ke()(z,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:xu,fs:yu});var _e=this.shaderModuleService.getModule("hexagonalpixelate-pass"),ut=_e.vs,Ht=_e.fs,ir=_e.uniforms,tr=this.rendererService.getViewportSize(),Or=tr.width,an=tr.height;return{vs:ut,fs:Ht,uniforms:Wa(Wa({},ir),{},{u_ViewportSize:[Or,an]})}}}]),z}(O.a))||yo),Ts,Lu;function ac(ne,se){var z=Object.keys(ne);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ne);se&&(V=V.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),z.push.apply(z,V)}return z}function $u(ne){for(var se=1;se<arguments.length;se++){var z=arguments[se]!=null?arguments[se]:{};se%2?ac(Object(z),!0).forEach(function(V){te()(ne,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(z)):ac(Object(z)).forEach(function(V){Object.defineProperty(ne,V,Object.getOwnPropertyDescriptor(z,V))})}return ne}function oc(ne){var se=sc();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function sc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ru=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,dl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,As=(Ts=Object(B.injectable)(),Ts(Lu=function(ne){fe()(z,ne);var se=oc(z);function z(){return Y()(this,z),se.apply(this,arguments)}return Ke()(z,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:dl,fs:Ru});var _e=this.shaderModuleService.getModule("ink-pass"),ut=_e.vs,Ht=_e.fs,ir=_e.uniforms,tr=this.rendererService.getViewportSize(),Or=tr.width,an=tr.height;return{vs:ut,fs:Ht,uniforms:$u($u({},ir),{},{u_ViewportSize:[Or,an]})}}}]),z}(O.a))||Lu),co,Du;function bu(ne){var se=Mo();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function Mo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Io=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,Oo=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Jo=(co=Object(B.injectable)(),co(Du=function(ne){fe()(z,ne);var se=bu(z);function z(){return Y()(this,z),se.apply(this,arguments)}return Ke()(z,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:Oo,fs:Io}),this.shaderModuleService.getModule("noise-pass")}}]),z}(O.a))||Du),bo,Uo;function Vs(ne){var se=wl();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function wl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Uc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Vl=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,Ju=(bo=Object(B.injectable)(),bo(Uo=function(ne){fe()(z,ne);var se=Vs(z);function z(){return Y()(this,z),se.apply(this,arguments)}return Ke()(z,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:Uc,fs:Vl}),this.shaderModuleService.getModule("sepia-pass")}}]),z}(O.a))||Uo),zu,Nu,Gs,Lo,Vc,gs,of,Lf=(zu=Object(B.injectable)(),Nu=Object(B.inject)(D.a.IRendererService),Gs=Object(B.postConstruct)(),zu(Lo=(Vc=(of=function(){function ne(){Y()(this,ne),Ar()(this,"rendererService",gs,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}return Ke()(ne,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:function(){var se=En()(fr.a.mark(function V(_e){var ut,Ht;return fr.a.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:ut=0;case 1:if(!(ut<this.passes.length)){tr.next=10;break}return Ht=this.passes[ut],Ht.setRenderToScreen(this.isLastEnabledPass(ut)),tr.next=6,Ht.render(_e);case 6:ut!==this.passes.length-1&&this.swap();case 7:ut++,tr.next=1;break;case 10:case"end":return tr.stop()}},V,this)}));function z(V){return se.apply(this,arguments)}return z}()},{key:"resize",value:function(z,V){this.readFBO.resize({width:z,height:V}),this.writeFBO.resize({width:z,height:V})}},{key:"add",value:function(z,V,_e){z.init(V,_e),this.passes.push(z)}},{key:"insert",value:function(z,V,_e,ut){z.init(_e,ut),this.passes.splice(V,0,z)}},{key:"getPostProcessingPassByName",value:function(z){return this.passes.find(function(V){return V.getName()===z})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(z){for(var V=z+1;V<this.passes.length;V++)if(this.passes[V].isEnabled())return!1;return!0}},{key:"swap",value:function(){var z=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=z}}]),ne}(),of),gs=Mn()(Vc.prototype,"rendererService",[Nu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mn()(Vc.prototype,"init",[Gs],Object.getOwnPropertyDescriptor(Vc.prototype,"init"),Vc.prototype),Vc))||Lo),Rf,Uf;function Qu(ne){var se=Sf();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function Sf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var sf=(Rf=Object(B.injectable)(),Rf(Uf=function(ne){fe()(z,ne);var se=Qu(z);function z(){return Y()(this,z),se.apply(this,arguments)}return Ke()(z,[{key:"getType",value:function(){return ru.a.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(_e,ut){Po()(nt()(z.prototype),"init",this).call(this,_e,ut)}},{key:"render",value:function(_e){var ut=this.rendererService,Ht=ut.useFramebuffer,ir=ut.clear;Ht(null,function(){ir({color:[0,0,0,0],depth:1,stencil:0}),_e.multiPassRenderer.setRenderFlag(!1),_e.render(),_e.multiPassRenderer.setRenderFlag(!0)})}}]),z}(tc))||Uf),uc,Fu,lc,Vf,_c,Cc,Gf,Hf;function ah(ne,se){var z=Object.keys(ne);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ne);se&&(V=V.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),z.push.apply(z,V)}return z}function Zf(ne){for(var se=1;se<arguments.length;se++){var z=arguments[se]!=null?arguments[se]:{};se%2?ah(Object(z),!0).forEach(function(V){te()(ne,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(z)):ah(Object(z)).forEach(function(V){Object.defineProperty(ne,V,Object.getOwnPropertyDescriptor(z,V))})}return ne}function Df(ne){var se=ch();return function(){var V=nt()(ne),_e;if(se){var ut=nt()(this).constructor;_e=Reflect.construct(V,arguments,ut)}else _e=V.apply(this,arguments);return Je()(this,_e)}}function ch(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var cc=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,uf=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,ao=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function Gl(ne,se){for(var z=0,V=1/se,_e=ne;_e>0;)z=z+V*(_e%se),_e=Math.floor(_e/se),V=V/se;return z}var lf=1,Gc=(uc=Object(B.injectable)(),Fu=Object(B.inject)(D.a.IShaderModuleService),lc=Object(B.inject)(D.a.ILogService),uc(Vf=(_c=(Hf=function(ne){fe()(z,ne);var se=Df(z);function z(){var V;Y()(this,z);for(var _e=arguments.length,ut=new Array(_e),Ht=0;Ht<_e;Ht++)ut[Ht]=arguments[Ht];return V=se.call.apply(se,[this].concat(ut)),Ar()(V,"shaderModuleService",Cc,Ui()(V)),Ar()(V,"logger",Gf,Ui()(V)),V.haltonSequence=[],V.accumulatingId=0,V.frame=0,V.timer=void 0,V.sampleRenderTarget=void 0,V.prevRenderTarget=void 0,V.outputRenderTarget=void 0,V.copyRenderTarget=void 0,V.blendModel=void 0,V.outputModel=void 0,V.copyModel=void 0,V}return Ke()(z,[{key:"getType",value:function(){return ru.a.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(_e,ut){Po()(nt()(z.prototype),"init",this).call(this,_e,ut);var Ht=this.rendererService,ir=Ht.createFramebuffer,tr=Ht.createTexture2D;this.sampleRenderTarget=ir({color:tr({width:1,height:1,wrapS:Un.a.CLAMP_TO_EDGE,wrapT:Un.a.CLAMP_TO_EDGE})}),this.prevRenderTarget=ir({color:tr({width:1,height:1,wrapS:Un.a.CLAMP_TO_EDGE,wrapT:Un.a.CLAMP_TO_EDGE})}),this.outputRenderTarget=ir({color:tr({width:1,height:1,wrapS:Un.a.CLAMP_TO_EDGE,wrapT:Un.a.CLAMP_TO_EDGE})}),this.copyRenderTarget=ir({color:tr({width:1,height:1,wrapS:Un.a.CLAMP_TO_EDGE,wrapT:Un.a.CLAMP_TO_EDGE})});for(var Or=0;Or<30;Or++)this.haltonSequence.push([Gl(Or,2),Gl(Or,3)]);this.blendModel=this.createTriangleModel("blend-pass",cc),this.outputModel=this.createTriangleModel("copy-pass",uf,{blend:{enable:!0,func:{srcRGB:Un.a.ONE,dstRGB:Un.a.ONE_MINUS_SRC_ALPHA,srcAlpha:Un.a.ONE,dstAlpha:Un.a.ONE_MINUS_SRC_ALPHA},equation:{rgb:Un.a.FUNC_ADD,alpha:Un.a.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",uf)}},{key:"render",value:function(_e){var ut=this,Ht=this.rendererService,ir=Ht.clear,tr=Ht.getViewportSize,Or=Ht.useFramebuffer,an=tr(),zn=an.width,Xn=an.height;this.sampleRenderTarget.resize({width:zn,height:Xn}),this.prevRenderTarget.resize({width:zn,height:Xn}),this.outputRenderTarget.resize({width:zn,height:Xn}),this.copyRenderTarget.resize({width:zn,height:Xn}),this.resetFrame(),this.stopAccumulating();var ni=_e.multiPassRenderer.getPostProcessor().getReadFBO();Or(ni,function(){ir({color:[0,0,0,0],depth:1,stencil:0,framebuffer:ni}),_e.multiPassRenderer.setRenderFlag(!1),_e.render(),_e.multiPassRenderer.setRenderFlag(!0)});var ra=function Oi(la){!ut.accumulatingId||la!==ut.accumulatingId||ut.isFinished()||(ut.doRender(_e),requestAnimationFrame(function(){Oi(la)}))};this.accumulatingId=lf++,this.timer=window.setTimeout(function(){ra(ut.accumulatingId)},50)}},{key:"doRender",value:function(_e){var ut=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var Ht=this.rendererService,ir=Ht.clear,tr=Ht.getViewportSize,Or=Ht.useFramebuffer,an=tr(),zn=an.width,Xn=an.height,ni=_e.getLayerConfig(),ra=ni.jitterScale,Oi=ra===void 0?1:ra,la=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((la[0]*2-1)/zn*Oi,(la[1]*2-1)/Xn*Oi),_e.multiPassRenderer.setRenderFlag(!1),_e.hooks.beforeRender.call(),Or(this.sampleRenderTarget,function(){ir({color:[0,0,0,0],depth:1,stencil:0,framebuffer:ut.sampleRenderTarget}),_e.render()}),_e.hooks.afterRender.call(),_e.multiPassRenderer.setRenderFlag(!0);var Yi=_e.getLayerConfig();Or(this.outputRenderTarget,function(){ut.blendModel.draw({uniforms:{u_opacity:Yi.opacity||1,u_MixRatio:ut.frame===0?1:.9,u_Diffuse1:ut.sampleRenderTarget,u_Diffuse2:ut.frame===0?_e.multiPassRenderer.getPostProcessor().getReadFBO():ut.prevRenderTarget}})}),this.frame===0&&ir({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(Or(this.copyRenderTarget,function(){ut.outputModel.draw({uniforms:{u_Texture:ut.outputRenderTarget}})}),Or(_e.multiPassRenderer.getPostProcessor().getReadFBO(),function(){ut.copyModel.draw({uniforms:{u_Texture:ut.copyRenderTarget}})}),_e.multiPassRenderer.getPostProcessor().render(_e));var ja=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=ja,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(_e,ut,Ht){this.shaderModuleService.registerModule(_e,{vs:ao,fs:ut});var ir=this.shaderModuleService.getModule(_e),tr=ir.vs,Or=ir.fs,an=ir.uniforms,zn=this.rendererService,Xn=zn.createAttribute,ni=zn.createBuffer,ra=zn.createModel;return ra(Zf({vs:tr,fs:Or,attributes:{a_Position:Xn({buffer:ni({data:[-4,-4,4,-4,0,4],type:Un.a.FLOAT}),size:2})},uniforms:Zf({},an),depth:{enable:!1},count:3},Ht))}}]),z}(tc),Hf),Cc=Mn()(_c.prototype,"shaderModuleService",[Fu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gf=Mn()(_c.prototype,"logger",[lc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_c))||Vf),nu=new B.Container;nu.bind(D.a.IGlobalConfigService).to(vn).inSingletonScope(),nu.bind(D.a.IShaderModuleService).to(vs).inSingletonScope(),nu.bind(D.a.ILogService).to(Dl).inSingletonScope(),Object(B.decorate)(Object(B.injectable)(),v.EventEmitter),nu.bind(D.a.IEventEmitter).to(v.EventEmitter);var Pl=W()(nu,!1),Ef=function(se){var z=Pl.lazyInject(se);return function(V,_e,ut){z.call(this,V,_e),ut&&(ut.initializer=function(){return V[_e]})}},Tf=function(se){var z=Pl.lazyMultiInject(se);return function(V,_e,ut){z.call(this,V,_e),ut&&(ut.initializer=function(){return V[_e]})}},Hc=y.c=nu,cf=0;function Zc(){var ne=new B.Container;return ne.parent=nu,ne.bind(D.a.SceneID).toConstantValue("".concat(cf++)),ne.bind(D.a.ILayerService).to(Vn).inSingletonScope(),ne.bind(D.a.ISceneService).to(Ms).inSingletonScope(),ne.bind(D.a.ICameraService).to(pr).inSingletonScope(),ne.bind(D.a.ICoordinateSystemService).to(Ko).inSingletonScope(),ne.bind(D.a.IInteractionService).to(De).inSingletonScope(),ne.bind(D.a.IPickingService).to(lu).inSingletonScope(),ne.bind(D.a.IControlService).to(Zn).inSingletonScope(),ne.bind(D.a.IMarkerService).to(le).inSingletonScope(),ne.bind(D.a.IIconService).to(vt).inSingletonScope(),ne.bind(D.a.IFontService).to(R).inSingletonScope(),ne.bind(D.a.IPopupService).to(Ft).inSingletonScope(),ne.bind(D.a.INormalPass).to(xf).whenTargetNamed("clear"),ne.bind(D.a.INormalPass).to(P).whenTargetNamed("pixelPicking"),ne.bind(D.a.INormalPass).to(sf).whenTargetNamed("render"),ne.bind(D.a.INormalPass).to(Gc).whenTargetNamed("taa"),ne.bind(D.a.IFactoryNormalPass).toFactory(function(se){return function(z){return se.container.getNamed(D.a.INormalPass,z)}}),ne.bind(D.a.IPostProcessingPass).to(qa).whenTargetNamed("copy"),ne.bind(D.a.IPostProcessingPass).to(Xt).whenTargetNamed("blurH"),ne.bind(D.a.IPostProcessingPass).to(nn).whenTargetNamed("blurV"),ne.bind(D.a.IPostProcessingPass).to(Jo).whenTargetNamed("noise"),ne.bind(D.a.IPostProcessingPass).to(Ju).whenTargetNamed("sepia"),ne.bind(D.a.IPostProcessingPass).to(si).whenTargetNamed("colorHalftone"),ne.bind(D.a.IPostProcessingPass).to(jo).whenTargetNamed("hexagonalPixelate"),ne.bind(D.a.IPostProcessingPass).to(As).whenTargetNamed("ink"),ne.bind(D.a.IFactoryPostProcessingPass).toFactory(function(se){return function(z){var V=se.container.getNamed(D.a.IPostProcessingPass,z);return V.setName(z),V}}),ne}function Hl(ne){var se=new B.Container;return se.parent=ne,se.bind(D.a.IStyleAttributeService).to(Pf).inSingletonScope(),se.bind(D.a.IMultiPassRenderer).to(Ku).inSingletonScope(),se.bind(D.a.IPostProcessor).to(Lf).inSingletonScope(),se}},fbrv:function(Re,y,o){"use strict";var S=this&&this.__spreadArrays||function(){for(var Oe=0,st=0,Le=arguments.length;st<Le;st++)Oe+=arguments[st].length;for(var xt=Array(Oe),it=0,st=0;st<Le;st++)for(var $e=arguments[st],Ze=0,St=$e.length;Ze<St;Ze++,it++)xt[it]=$e[Ze];return xt};Object.defineProperty(y,"__esModule",{value:!0}),y.getFunctionName=y.getBaseClassDependencyCount=y.getDependencies=void 0;var v=o("Yk9n"),X=o("MON2"),B=o("FV85"),a=o("xfSm"),W=o("ujMp");Object.defineProperty(y,"getFunctionName",{enumerable:!0,get:function(){return W.getFunctionName}});var D=o("dX1H");function J(Oe,st){var Le=W.getFunctionName(st),xt=te(Oe,Le,st,!1);return xt}y.getDependencies=J;function te(Oe,st,Le,xt){var it=Oe.getConstructorMetadata(Le),$e=it.compilerGeneratedMetadata;if($e===void 0){var Ze=X.MISSING_INJECTABLE_ANNOTATION+" "+st+".";throw new Error(Ze)}var St=it.userGeneratedMetadata,bt=Object.keys(St),Ne=Le.length===0&&bt.length>0,ze=Ne?bt.length:Le.length,Ue=Y(xt,st,$e,St,ze),lt=ke(Oe,Le),Me=S(Ue,lt);return Me}function ce(Oe,st,Le,xt,it){var $e=it[Oe.toString()]||[],Ze=We($e),St=Ze.unmanaged!==!0,bt=xt[Oe],Ne=Ze.inject||Ze.multiInject;if(bt=Ne||bt,bt instanceof v.LazyServiceIdentifer&&(bt=bt.unwrap()),St){var ze=bt===Object,Ue=bt===Function,lt=bt===void 0,Me=ze||Ue||lt;if(!st&&Me){var ct=X.MISSING_INJECT_ANNOTATION+" argument "+Oe+" in class "+Le+".";throw new Error(ct)}var Gt=new D.Target(B.TargetTypeEnum.ConstructorArgument,Ze.targetName,bt);return Gt.metadata=$e,Gt}return null}function Y(Oe,st,Le,xt,it){for(var $e=[],Ze=0;Ze<it;Ze++){var St=Ze,bt=ce(St,Oe,st,Le,xt);bt!==null&&$e.push(bt)}return $e}function ke(Oe,st){for(var Le=Oe.getPropertiesMetadata(st),xt=[],it=Object.keys(Le),$e=0,Ze=it;$e<Ze.length;$e++){var St=Ze[$e],bt=Le[St],Ne=We(Le[St]),ze=Ne.targetName||St,Ue=Ne.inject||Ne.multiInject,lt=new D.Target(B.TargetTypeEnum.ClassProperty,ze,Ue);lt.metadata=bt,xt.push(lt)}var Me=Object.getPrototypeOf(st.prototype).constructor;if(Me!==Object){var ct=ke(Oe,Me);xt=S(xt,ct)}return xt}function Ke(Oe,st){var Le=Object.getPrototypeOf(st.prototype).constructor;if(Le!==Object){var xt=W.getFunctionName(Le),it=te(Oe,xt,Le,!0),$e=it.map(function(bt){return bt.metadata.filter(function(Ne){return Ne.key===a.UNMANAGED_TAG})}),Ze=[].concat.apply([],$e).length,St=it.length-Ze;return St>0?St:Ke(Oe,Le)}else return 0}y.getBaseClassDependencyCount=Ke;function We(Oe){var st={};return Oe.forEach(function(Le){st[Le.key.toString()]=Le.value}),{inject:st[a.INJECT_TAG],multiInject:st[a.MULTI_INJECT_TAG],targetName:st[a.NAME_TAG],unmanaged:st[a.UNMANAGED_TAG]}}},fbvF:function(Re,y,o){(function(S,v){Re.exports=v()})(this,function(){"use strict";var S=function(Be){return Be instanceof Uint8Array||Be instanceof Uint16Array||Be instanceof Uint32Array||Be instanceof Int8Array||Be instanceof Int16Array||Be instanceof Int32Array||Be instanceof Float32Array||Be instanceof Float64Array||Be instanceof Uint8ClampedArray},v=function(Be,Et){for(var gr=Object.keys(Et),Mr=0;Mr<gr.length;++Mr)Be[gr[Mr]]=Et[gr[Mr]];return Be},X=`
`;function B(xe){return typeof atob!="undefined"?atob(xe):"base64:"+xe}function a(xe){var Be=new Error("(regl) "+xe);throw console.error(Be),Be}function W(xe,Be){xe||a(Be)}function D(xe){return xe?": "+xe:""}function J(xe,Be,Et){xe in Be||a("unknown parameter ("+xe+")"+D(Et)+". possible values: "+Object.keys(Be).join())}function te(xe,Be){S(xe)||a("invalid parameter type"+D(Be)+". must be a typed array")}function ce(xe,Be){switch(Be){case"number":return typeof xe=="number";case"object":return typeof xe=="object";case"string":return typeof xe=="string";case"boolean":return typeof xe=="boolean";case"function":return typeof xe=="function";case"undefined":return typeof xe=="undefined";case"symbol":return typeof xe=="symbol"}}function Y(xe,Be,Et){ce(xe,Be)||a("invalid parameter type"+D(Et)+". expected "+Be+", got "+typeof xe)}function ke(xe,Be){xe>=0&&(xe|0)===xe||a("invalid parameter type, ("+xe+")"+D(Be)+". must be a nonnegative integer")}function Ke(xe,Be,Et){Be.indexOf(xe)<0&&a("invalid value"+D(Et)+". must be one of: "+Be)}var We=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Oe(xe){Object.keys(xe).forEach(function(Be){We.indexOf(Be)<0&&a('invalid regl constructor argument "'+Be+'". must be one of '+We)})}function st(xe,Be){for(xe=xe+"";xe.length<Be;)xe=" "+xe;return xe}function Le(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function xt(xe,Be){this.number=xe,this.line=Be,this.errors=[]}function it(xe,Be,Et){this.file=xe,this.line=Be,this.message=Et}function $e(){var xe=new Error,Be=(xe.stack||xe).toString(),Et=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Be);if(Et)return Et[1];var gr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Be);return gr?gr[1]:"unknown"}function Ze(){var xe=new Error,Be=(xe.stack||xe).toString(),Et=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Be);if(Et)return Et[1];var gr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Be);return gr?gr[1]:"unknown"}function St(xe,Be){var Et=xe.split(`
`),gr=1,Mr=0,Cr={unknown:new Le,0:new Le};Cr.unknown.name=Cr[0].name=Be||$e(),Cr.unknown.lines.push(new xt(0,""));for(var xr=0;xr<Et.length;++xr){var Wr=Et[xr],sn=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Wr);if(sn)switch(sn[1]){case"line":var en=/(\d+)(\s+\d+)?/.exec(sn[2]);en&&(gr=en[1]|0,en[2]&&(Mr=en[2]|0,Mr in Cr||(Cr[Mr]=new Le)));break;case"define":var Qr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(sn[2]);Qr&&(Cr[Mr].name=Qr[1]?B(Qr[2]):Qr[2]);break}Cr[Mr].lines.push(new xt(gr++,Wr))}return Object.keys(Cr).forEach(function(fn){var Cn=Cr[fn];Cn.lines.forEach(function(cn){Cn.index[cn.number]=cn})}),Cr}function bt(xe){var Be=[];return xe.split(`
`).forEach(function(Et){if(!(Et.length<5)){var gr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Et);gr?Be.push(new it(gr[1]|0,gr[2]|0,gr[3].trim())):Et.length>0&&Be.push(new it("unknown",0,Et))}}),Be}function Ne(xe,Be){Be.forEach(function(Et){var gr=xe[Et.file];if(gr){var Mr=gr.index[Et.line];if(Mr){Mr.errors.push(Et),gr.hasErrors=!0;return}}xe.unknown.hasErrors=!0,xe.unknown.lines[0].errors.push(Et)})}function ze(xe,Be,Et,gr,Mr){if(!xe.getShaderParameter(Be,xe.COMPILE_STATUS)){var Cr=xe.getShaderInfoLog(Be),xr=gr===xe.FRAGMENT_SHADER?"fragment":"vertex";ar(Et,"string",xr+" shader source must be a string",Mr);var Wr=St(Et,Mr),sn=bt(Cr);Ne(Wr,sn),Object.keys(Wr).forEach(function(en){var Qr=Wr[en];if(!Qr.hasErrors)return;var fn=[""],Cn=[""];function cn(rn,yr){fn.push(rn),Cn.push(yr||"")}cn("file number "+en+": "+Qr.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Qr.lines.forEach(function(rn){if(rn.errors.length>0){cn(st(rn.number,4)+"|  ","background-color:yellow; font-weight:bold"),cn(rn.line+X,"color:red; background-color:yellow; font-weight:bold");var yr=0;rn.errors.forEach(function(vr){var Xr=vr.message,Pn=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Xr);if(Pn){var Lr=Pn[1];switch(Xr=Pn[2],Lr){case"assign":Lr="=";break}yr=Math.max(rn.line.indexOf(Lr,yr),0)}else yr=0;cn(st("| ",6)),cn(st("^^^",yr+3)+X,"font-weight:bold"),cn(st("| ",6)),cn(Xr+X,"font-weight:bold")}),cn(st("| ",6)+X)}else cn(st(rn.number,4)+"|  "),cn(rn.line+X,"color:red")}),typeof document!="undefined"&&!window.chrome?(Cn[0]=fn.join("%c"),console.log.apply(console,Cn)):console.log(fn.join(""))}),W.raise("Error compiling "+xr+" shader, "+Wr[0].name)}}function Ue(xe,Be,Et,gr,Mr){if(!xe.getProgramParameter(Be,xe.LINK_STATUS)){var Cr=xe.getProgramInfoLog(Be),xr=St(Et,Mr),Wr=St(gr,Mr),sn='Error linking program with vertex shader, "'+Wr[0].name+'", and fragment shader "'+xr[0].name+'"';typeof document!="undefined"?console.log("%c"+sn+X+"%c"+Cr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(sn+X+Cr),W.raise(sn)}}function lt(xe){xe._commandRef=$e()}function Me(xe,Be,Et,gr){lt(xe);function Mr(sn){return sn?gr.id(sn):0}xe._fragId=Mr(xe.static.frag),xe._vertId=Mr(xe.static.vert);function Cr(sn,en){Object.keys(en).forEach(function(Qr){sn[gr.id(Qr)]=!0})}var xr=xe._uniformSet={};Cr(xr,Be.static),Cr(xr,Be.dynamic);var Wr=xe._attributeSet={};Cr(Wr,Et.static),Cr(Wr,Et.dynamic),xe._hasCount="count"in xe.static||"count"in xe.dynamic||"elements"in xe.static||"elements"in xe.dynamic}function ct(xe,Be){var Et=Ze();a(xe+" in command "+(Be||$e())+(Et==="unknown"?"":" called from "+Et))}function Gt(xe,Be,Et){xe||ct(Be,Et||$e())}function $t(xe,Be,Et,gr){xe in Be||ct("unknown parameter ("+xe+")"+D(Et)+". possible values: "+Object.keys(Be).join(),gr||$e())}function ar(xe,Be,Et,gr){ce(xe,Be)||ct("invalid parameter type"+D(Et)+". expected "+Be+", got "+typeof xe,gr||$e())}function oe(xe){xe()}function Q(xe,Be,Et){xe.texture?Ke(xe.texture._texture.internalformat,Be,"unsupported texture format for attachment"):Ke(xe.renderbuffer._renderbuffer.format,Et,"unsupported renderbuffer format for attachment")}var G=33071,Ce=9728,be=9984,Te=9985,me=9986,rt=9987,Kt=5120,_t=5121,ge=5122,ye=5123,Ve=5124,ft=5125,Ie=5126,pt=32819,C=32820,R=33635,q=34042,fe=36193,Ge={};Ge[Kt]=Ge[_t]=1,Ge[ge]=Ge[ye]=Ge[fe]=Ge[R]=Ge[pt]=Ge[C]=2,Ge[Ve]=Ge[ft]=Ge[Ie]=Ge[q]=4;function Je(xe,Be){return xe===C||xe===pt||xe===R?2:xe===q?4:Ge[xe]*Be}function yt(xe){return!(xe&xe-1)&&!!xe}function nt(xe,Be,Et){var gr,Mr=Be.width,Cr=Be.height,xr=Be.channels;W(Mr>0&&Mr<=Et.maxTextureSize&&Cr>0&&Cr<=Et.maxTextureSize,"invalid texture shape"),(xe.wrapS!==G||xe.wrapT!==G)&&W(yt(Mr)&&yt(Cr),"incompatible wrap mode for texture, both width and height must be power of 2"),Be.mipmask===1?Mr!==1&&Cr!==1&&W(xe.minFilter!==be&&xe.minFilter!==me&&xe.minFilter!==Te&&xe.minFilter!==rt,"min filter requires mipmap"):(W(yt(Mr)&&yt(Cr),"texture must be a square power of 2 to support mipmapping"),W(Be.mipmask===(Mr<<1)-1,"missing or incomplete mipmap data")),Be.type===Ie&&(Et.extensions.indexOf("oes_texture_float_linear")<0&&W(xe.minFilter===Ce&&xe.magFilter===Ce,"filter not supported, must enable oes_texture_float_linear"),W(!xe.genMipmaps,"mipmap generation not supported with float textures"));var Wr=Be.images;for(gr=0;gr<16;++gr)if(Wr[gr]){var sn=Mr>>gr,en=Cr>>gr;W(Be.mipmask&1<<gr,"missing mipmap data");var Qr=Wr[gr];if(W(Qr.width===sn&&Qr.height===en,"invalid shape for mip images"),W(Qr.format===Be.format&&Qr.internalformat===Be.internalformat&&Qr.type===Be.type,"incompatible type for mip image"),!Qr.compressed)if(Qr.data){var fn=Math.ceil(Je(Qr.type,xr)*sn/Qr.unpackAlignment)*Qr.unpackAlignment;W(Qr.data.byteLength===fn*en,"invalid data for image, buffer size is inconsistent with image format")}else Qr.element||Qr.copy}else xe.genMipmaps||W((Be.mipmask&1<<gr)==0,"extra mipmap data");Be.compressed&&W(!xe.genMipmaps,"mipmap generation for compressed images not supported")}function Nt(xe,Be,Et,gr){var Mr=xe.width,Cr=xe.height,xr=xe.channels;W(Mr>0&&Mr<=gr.maxTextureSize&&Cr>0&&Cr<=gr.maxTextureSize,"invalid texture shape"),W(Mr===Cr,"cube map must be square"),W(Be.wrapS===G&&Be.wrapT===G,"wrap mode not supported by cube map");for(var Wr=0;Wr<Et.length;++Wr){var sn=Et[Wr];W(sn.width===Mr&&sn.height===Cr,"inconsistent cube map face shape"),Be.genMipmaps&&(W(!sn.compressed,"can not generate mipmap for compressed textures"),W(sn.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var en=sn.images,Qr=0;Qr<16;++Qr){var fn=en[Qr];if(fn){var Cn=Mr>>Qr,cn=Cr>>Qr;W(sn.mipmask&1<<Qr,"missing mipmap data"),W(fn.width===Cn&&fn.height===cn,"invalid shape for mip images"),W(fn.format===xe.format&&fn.internalformat===xe.internalformat&&fn.type===xe.type,"incompatible type for mip image"),fn.compressed||(fn.data?W(fn.data.byteLength===Cn*cn*Math.max(Je(fn.type,xr),fn.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):fn.element||fn.copy)}}}}var $=v(W,{optional:oe,raise:a,commandRaise:ct,command:Gt,parameter:J,commandParameter:$t,constructor:Oe,type:Y,commandType:ar,isTypedArray:te,nni:ke,oneOf:Ke,shaderError:ze,linkError:Ue,callSite:Ze,saveCommandRef:lt,saveDrawInfo:Me,framebufferFormat:Q,guessCommand:$e,texture2D:nt,textureCube:Nt}),Ye=0,ie=0,et=5,Bt=6;function lr(xe,Be){this.id=Ye++,this.type=xe,this.data=Be}function dt(xe){return xe.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function vt(xe){if(xe.length===0)return[];var Be=xe.charAt(0),Et=xe.charAt(xe.length-1);if(xe.length>1&&Be===Et&&(Be==='"'||Be==="'"))return['"'+dt(xe.substr(1,xe.length-2))+'"'];var gr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(xe);if(gr)return vt(xe.substr(0,gr.index)).concat(vt(gr[1])).concat(vt(xe.substr(gr.index+gr[0].length)));var Mr=xe.split(".");if(Mr.length===1)return['"'+dt(xe)+'"'];for(var Cr=[],xr=0;xr<Mr.length;++xr)Cr=Cr.concat(vt(Mr[xr]));return Cr}function Ct(xe){return"["+vt(xe).join("][")+"]"}function gt(xe,Be){return new lr(xe,Ct(Be+""))}function we(xe){return typeof xe=="function"&&!xe._reglType||xe instanceof lr}function ht(xe,Be){if(typeof xe=="function")return new lr(ie,xe);if(typeof xe=="number"||typeof xe=="boolean")return new lr(et,xe);if(Array.isArray(xe))return new lr(Bt,xe.map(function(Et,gr){return ht(Et,Be+"["+gr+"]")}));if(xe instanceof lr)return xe;$(!1,"invalid option type in uniform "+Be)}var Qe={DynamicVariable:lr,define:gt,isDynamic:we,unbox:ht,accessor:Ct},Vt={next:typeof requestAnimationFrame=="function"?function(xe){return requestAnimationFrame(xe)}:function(xe){return setTimeout(xe,16)},cancel:typeof cancelAnimationFrame=="function"?function(xe){return cancelAnimationFrame(xe)}:clearTimeout},pr=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Zr(){var xe={"":0},Be=[""];return{id:function(gr){var Mr=xe[gr];return Mr||(Mr=xe[gr]=Be.length,Be.push(gr),Mr)},str:function(gr){return Be[gr]}}}function cr(xe,Be,Et){var gr=document.createElement("canvas");v(gr.style,{border:0,margin:0,padding:0,top:0,left:0}),xe.appendChild(gr),xe===document.body&&(gr.style.position="absolute",v(xe.style,{margin:0,padding:0}));function Mr(){var Wr=window.innerWidth,sn=window.innerHeight;if(xe!==document.body){var en=xe.getBoundingClientRect();Wr=en.right-en.left,sn=en.bottom-en.top}gr.width=Et*Wr,gr.height=Et*sn,v(gr.style,{width:Wr+"px",height:sn+"px"})}var Cr;xe!==document.body&&typeof ResizeObserver=="function"?(Cr=new ResizeObserver(function(){setTimeout(Mr)}),Cr.observe(xe)):window.addEventListener("resize",Mr,!1);function xr(){Cr?Cr.disconnect():window.removeEventListener("resize",Mr),xe.removeChild(gr)}return Mr(),{canvas:gr,onDestroy:xr}}function jn(xe,Be){function Et(gr){try{return xe.getContext(gr,Be)}catch(Mr){return null}}return Et("webgl")||Et("experimental-webgl")||Et("webgl-experimental")}function Sn(xe){return typeof xe.nodeName=="string"&&typeof xe.appendChild=="function"&&typeof xe.getBoundingClientRect=="function"}function ai(xe){return typeof xe.drawArrays=="function"||typeof xe.drawElements=="function"}function fi(xe){return typeof xe=="string"?xe.split():($(Array.isArray(xe),"invalid extension array"),xe)}function Zn(xe){return typeof xe=="string"?($(typeof document!="undefined","not supported outside of DOM"),document.querySelector(xe)):xe}function Hn(xe){var Be=xe||{},Et,gr,Mr,Cr,xr={},Wr=[],sn=[],en=typeof window=="undefined"?1:window.devicePixelRatio,Qr=!1,fn=function(yr){yr&&$.raise(yr)},Cn=function(){};if(typeof Be=="string"?($(typeof document!="undefined","selector queries only supported in DOM enviroments"),Et=document.querySelector(Be),$(Et,"invalid query string for element")):typeof Be=="object"?Sn(Be)?Et=Be:ai(Be)?(Cr=Be,Mr=Cr.canvas):($.constructor(Be),"gl"in Be?Cr=Be.gl:"canvas"in Be?Mr=Zn(Be.canvas):"container"in Be&&(gr=Zn(Be.container)),"attributes"in Be&&(xr=Be.attributes,$.type(xr,"object","invalid context attributes")),"extensions"in Be&&(Wr=fi(Be.extensions)),"optionalExtensions"in Be&&(sn=fi(Be.optionalExtensions)),"onDone"in Be&&($.type(Be.onDone,"function","invalid or missing onDone callback"),fn=Be.onDone),"profile"in Be&&(Qr=!!Be.profile),"pixelRatio"in Be&&(en=+Be.pixelRatio,$(en>0,"invalid pixel ratio"))):$.raise("invalid arguments to regl"),Et&&(Et.nodeName.toLowerCase()==="canvas"?Mr=Et:gr=Et),!Cr){if(!Mr){$(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var cn=cr(gr||document.body,fn,en);if(!cn)return null;Mr=cn.canvas,Cn=cn.onDestroy}xr.premultipliedAlpha===void 0&&(xr.premultipliedAlpha=!0),Cr=jn(Mr,xr)}return Cr?{gl:Cr,canvas:Mr,container:gr,extensions:Wr,optionalExtensions:sn,pixelRatio:en,profile:Qr,onDone:fn,onDestroy:Cn}:(Cn(),fn("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function k(xe,Be){var Et={};function gr(xr){$.type(xr,"string","extension name must be string");var Wr=xr.toLowerCase(),sn;try{sn=Et[Wr]=xe.getExtension(Wr)}catch(en){}return!!sn}for(var Mr=0;Mr<Be.extensions.length;++Mr){var Cr=Be.extensions[Mr];if(!gr(Cr))return Be.onDestroy(),Be.onDone('"'+Cr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Be.optionalExtensions.forEach(gr),{extensions:Et,restore:function(){Object.keys(Et).forEach(function(Wr){if(Et[Wr]&&!gr(Wr))throw new Error("(regl): error restoring extension "+Wr)})}}}function H(xe,Be){for(var Et=Array(xe),gr=0;gr<xe;++gr)Et[gr]=Be(gr);return Et}var le=5120,de=5121,at=5122,At=5123,Ft=5124,He=5125,Pt=5126;function or(xe){for(var Be=16;Be<=1<<28;Be*=16)if(xe<=Be)return Be;return 0}function jr(xe){var Be,Et;return Be=(xe>65535)<<4,xe>>>=Be,Et=(xe>255)<<3,xe>>>=Et,Be|=Et,Et=(xe>15)<<2,xe>>>=Et,Be|=Et,Et=(xe>3)<<1,xe>>>=Et,Be|=Et,Be|xe>>1}function Hr(){var xe=H(8,function(){return[]});function Be(Cr){var xr=or(Cr),Wr=xe[jr(xr)>>2];return Wr.length>0?Wr.pop():new ArrayBuffer(xr)}function Et(Cr){xe[jr(Cr.byteLength)>>2].push(Cr)}function gr(Cr,xr){var Wr=null;switch(Cr){case le:Wr=new Int8Array(Be(xr),0,xr);break;case de:Wr=new Uint8Array(Be(xr),0,xr);break;case at:Wr=new Int16Array(Be(2*xr),0,xr);break;case At:Wr=new Uint16Array(Be(2*xr),0,xr);break;case Ft:Wr=new Int32Array(Be(4*xr),0,xr);break;case He:Wr=new Uint32Array(Be(4*xr),0,xr);break;case Pt:Wr=new Float32Array(Be(4*xr),0,xr);break;default:return null}return Wr.length!==xr?Wr.subarray(0,xr):Wr}function Mr(Cr){Et(Cr.buffer)}return{alloc:Be,free:Et,allocType:gr,freeType:Mr}}var sr=Hr();sr.zero=Hr();var Fr=3408,_n=3410,dn=3411,Er=3412,Tn=3413,vn=3414,gn=3415,Ar=33901,$r=33902,Mn=3379,Xi=3386,vi=34921,wi=36347,Di=36348,Ka=35661,hi=35660,ga=34930,Pi=36349,gi=34076,ci=34024,Oa=7936,mo=7937,$a=7938,Ko=35724,Uu=34047,Ui=36063,Ca=34852,ns=3553,na=34067,Ja=34069,is=33984,$i=6408,oo=5126,so=5121,Ys=36160,Ao=36053,Zl=36064,Ks=16384,_o=function(Be,Et){var gr=1;Et.ext_texture_filter_anisotropic&&(gr=Be.getParameter(Uu));var Mr=1,Cr=1;Et.webgl_draw_buffers&&(Mr=Be.getParameter(Ca),Cr=Be.getParameter(Ui));var xr=!!Et.oes_texture_float;if(xr){var Wr=Be.createTexture();Be.bindTexture(ns,Wr),Be.texImage2D(ns,0,$i,1,1,0,$i,oo,null);var sn=Be.createFramebuffer();if(Be.bindFramebuffer(Ys,sn),Be.framebufferTexture2D(Ys,Zl,ns,Wr,0),Be.bindTexture(ns,null),Be.checkFramebufferStatus(Ys)!==Ao)xr=!1;else{Be.viewport(0,0,1,1),Be.clearColor(1,0,0,1),Be.clear(Ks);var en=sr.allocType(oo,4);Be.readPixels(0,0,1,1,$i,oo,en),Be.getError()?xr=!1:(Be.deleteFramebuffer(sn),Be.deleteTexture(Wr),xr=en[0]===1),sr.freeType(en)}}var Qr=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),fn=!0;if(!Qr){var Cn=Be.createTexture(),cn=sr.allocType(so,36);Be.activeTexture(is),Be.bindTexture(na,Cn),Be.texImage2D(Ja,0,$i,3,3,0,$i,so,cn),sr.freeType(cn),Be.bindTexture(na,null),Be.deleteTexture(Cn),fn=!Be.getError()}return{colorBits:[Be.getParameter(_n),Be.getParameter(dn),Be.getParameter(Er),Be.getParameter(Tn)],depthBits:Be.getParameter(vn),stencilBits:Be.getParameter(gn),subpixelBits:Be.getParameter(Fr),extensions:Object.keys(Et).filter(function(rn){return!!Et[rn]}),maxAnisotropic:gr,maxDrawbuffers:Mr,maxColorAttachments:Cr,pointSizeDims:Be.getParameter(Ar),lineWidthDims:Be.getParameter($r),maxViewportDims:Be.getParameter(Xi),maxCombinedTextureUnits:Be.getParameter(Ka),maxCubeMapSize:Be.getParameter(gi),maxRenderbufferSize:Be.getParameter(ci),maxTextureUnits:Be.getParameter(ga),maxTextureSize:Be.getParameter(Mn),maxAttributes:Be.getParameter(vi),maxVertexUniforms:Be.getParameter(wi),maxVertexTextureUnits:Be.getParameter(hi),maxVaryingVectors:Be.getParameter(Di),maxFragmentUniforms:Be.getParameter(Pi),glsl:Be.getParameter(Ko),renderer:Be.getParameter(mo),vendor:Be.getParameter(Oa),version:Be.getParameter($a),readFloat:xr,npotTextureCube:fn}};function kt(xe){return!!xe&&typeof xe=="object"&&Array.isArray(xe.shape)&&Array.isArray(xe.stride)&&typeof xe.offset=="number"&&xe.shape.length===xe.stride.length&&(Array.isArray(xe.data)||S(xe.data))}var De=function(Be){return Object.keys(Be).map(function(Et){return Be[Et]})},It={shape:no,flatten:La};function fr(xe,Be,Et){for(var gr=0;gr<Be;++gr)Et[gr]=xe[gr]}function tn(xe,Be,Et,gr){for(var Mr=0,Cr=0;Cr<Be;++Cr)for(var xr=xe[Cr],Wr=0;Wr<Et;++Wr)gr[Mr++]=xr[Wr]}function En(xe,Be,Et,gr,Mr,Cr){for(var xr=Cr,Wr=0;Wr<Be;++Wr)for(var sn=xe[Wr],en=0;en<Et;++en)for(var Qr=sn[en],fn=0;fn<gr;++fn)Mr[xr++]=Qr[fn]}function Un(xe,Be,Et,gr,Mr){for(var Cr=1,xr=Et+1;xr<Be.length;++xr)Cr*=Be[xr];var Wr=Be[Et];if(Be.length-Et==4){var sn=Be[Et+1],en=Be[Et+2],Qr=Be[Et+3];for(xr=0;xr<Wr;++xr)En(xe[xr],sn,en,Qr,gr,Mr),Mr+=Cr}else for(xr=0;xr<Wr;++xr)Un(xe[xr],Be,Et+1,gr,Mr),Mr+=Cr}function La(xe,Be,Et,gr){var Mr=1;if(Be.length)for(var Cr=0;Cr<Be.length;++Cr)Mr*=Be[Cr];else Mr=0;var xr=gr||sr.allocType(Et,Mr);switch(Be.length){case 0:break;case 1:fr(xe,Be[0],xr);break;case 2:tn(xe,Be[0],Be[1],xr);break;case 3:En(xe,Be[0],Be[1],Be[2],xr,0);break;default:Un(xe,Be,0,xr,0)}return xr}function no(xe){for(var Be=[],Et=xe;Et.length;Et=Et[0])Be.push(Et.length);return Be}var go={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},No=5120,Vu=5122,Wl=5124,$s=5121,Ic=5123,Il=5125,fs=5126,zs=5126,uo={int8:No,int16:Vu,int32:Wl,uint8:$s,uint16:Ic,uint32:Il,float:fs,float32:zs},hs=35048,Js=35040,lu={dynamic:hs,stream:Js,static:35044},Xl=It.flatten,ya=It.shape,Na=35044,ml=35040,Ns=5121,ds=5126,Mt=[];Mt[5120]=1,Mt[5122]=2,Mt[5124]=4,Mt[5121]=1,Mt[5123]=2,Mt[5125]=4,Mt[5126]=4;function rr(xe){return go[Object.prototype.toString.call(xe)]|0}function Pr(xe,Be){for(var Et=0;Et<Be.length;++Et)xe[Et]=Be[Et]}function Vn(xe,Be,Et,gr,Mr,Cr,xr){for(var Wr=0,sn=0;sn<Et;++sn)for(var en=0;en<gr;++en)xe[Wr++]=Be[Mr*sn+Cr*en+xr]}function Ji(xe,Be,Et,gr){var Mr=0,Cr={};function xr(yr){this.id=Mr++,this.buffer=xe.createBuffer(),this.type=yr,this.usage=Na,this.byteLength=0,this.dimension=1,this.dtype=Ns,this.persistentData=null,Et.profile&&(this.stats={size:0})}xr.prototype.bind=function(){xe.bindBuffer(this.type,this.buffer)},xr.prototype.destroy=function(){Cn(this)};var Wr=[];function sn(yr,vr){var Xr=Wr.pop();return Xr||(Xr=new xr(yr)),Xr.bind(),fn(Xr,vr,ml,0,1,!1),Xr}function en(yr){Wr.push(yr)}function Qr(yr,vr,Xr){yr.byteLength=vr.byteLength,xe.bufferData(yr.type,vr,Xr)}function fn(yr,vr,Xr,Pn,Lr,qn){var Jr;if(yr.usage=Xr,Array.isArray(vr)){if(yr.dtype=Pn||ds,vr.length>0){var Br;if(Array.isArray(vr[0])){Jr=ya(vr);for(var Ur=1,Kr=1;Kr<Jr.length;++Kr)Ur*=Jr[Kr];yr.dimension=Ur,Br=Xl(vr,Jr,yr.dtype),Qr(yr,Br,Xr),qn?yr.persistentData=Br:sr.freeType(Br)}else if(typeof vr[0]=="number"){yr.dimension=Lr;var Yn=sr.allocType(yr.dtype,vr.length);Pr(Yn,vr),Qr(yr,Yn,Xr),qn?yr.persistentData=Yn:sr.freeType(Yn)}else S(vr[0])?(yr.dimension=vr[0].length,yr.dtype=Pn||rr(vr[0])||ds,Br=Xl(vr,[vr.length,vr[0].length],yr.dtype),Qr(yr,Br,Xr),qn?yr.persistentData=Br:sr.freeType(Br)):$.raise("invalid buffer data")}}else if(S(vr))yr.dtype=Pn||rr(vr),yr.dimension=Lr,Qr(yr,vr,Xr),qn&&(yr.persistentData=new Uint8Array(new Uint8Array(vr.buffer)));else if(kt(vr)){Jr=vr.shape;var ti=vr.stride,un=vr.offset,Vr=0,Nr=0,di=0,pi=0;Jr.length===1?(Vr=Jr[0],Nr=1,di=ti[0],pi=0):Jr.length===2?(Vr=Jr[0],Nr=Jr[1],di=ti[0],pi=ti[1]):$.raise("invalid shape"),yr.dtype=Pn||rr(vr.data)||ds,yr.dimension=Nr;var kn=sr.allocType(yr.dtype,Vr*Nr);Vn(kn,vr.data,Vr,Nr,di,pi,un),Qr(yr,kn,Xr),qn?yr.persistentData=kn:sr.freeType(kn)}else vr instanceof ArrayBuffer?(yr.dtype=Ns,yr.dimension=Lr,Qr(yr,vr,Xr),qn&&(yr.persistentData=new Uint8Array(new Uint8Array(vr)))):$.raise("invalid buffer data")}function Cn(yr){Be.bufferCount--,gr(yr);var vr=yr.buffer;$(vr,"buffer must not be deleted already"),xe.deleteBuffer(vr),yr.buffer=null,delete Cr[yr.id]}function cn(yr,vr,Xr,Pn){Be.bufferCount++;var Lr=new xr(vr);Cr[Lr.id]=Lr;function qn(Ur){var Kr=Na,Yn=null,ti=0,un=0,Vr=1;return Array.isArray(Ur)||S(Ur)||kt(Ur)||Ur instanceof ArrayBuffer?Yn=Ur:typeof Ur=="number"?ti=Ur|0:Ur&&($.type(Ur,"object","buffer arguments must be an object, a number or an array"),"data"in Ur&&($(Yn===null||Array.isArray(Yn)||S(Yn)||kt(Yn),"invalid data for buffer"),Yn=Ur.data),"usage"in Ur&&($.parameter(Ur.usage,lu,"invalid buffer usage"),Kr=lu[Ur.usage]),"type"in Ur&&($.parameter(Ur.type,uo,"invalid buffer type"),un=uo[Ur.type]),"dimension"in Ur&&($.type(Ur.dimension,"number","invalid dimension"),Vr=Ur.dimension|0),"length"in Ur&&($.nni(ti,"buffer length must be a nonnegative integer"),ti=Ur.length|0)),Lr.bind(),Yn?fn(Lr,Yn,Kr,un,Vr,Pn):(ti&&xe.bufferData(Lr.type,ti,Kr),Lr.dtype=un||Ns,Lr.usage=Kr,Lr.dimension=Vr,Lr.byteLength=ti),Et.profile&&(Lr.stats.size=Lr.byteLength*Mt[Lr.dtype]),qn}function Jr(Ur,Kr){$(Kr+Ur.byteLength<=Lr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Ur.byteLength+" starting from offset "+Kr+" to a buffer of size "+Lr.byteLength),xe.bufferSubData(Lr.type,Kr,Ur)}function Br(Ur,Kr){var Yn=(Kr||0)|0,ti;if(Lr.bind(),S(Ur)||Ur instanceof ArrayBuffer)Jr(Ur,Yn);else if(Array.isArray(Ur)){if(Ur.length>0)if(typeof Ur[0]=="number"){var un=sr.allocType(Lr.dtype,Ur.length);Pr(un,Ur),Jr(un,Yn),sr.freeType(un)}else if(Array.isArray(Ur[0])||S(Ur[0])){ti=ya(Ur);var Vr=Xl(Ur,ti,Lr.dtype);Jr(Vr,Yn),sr.freeType(Vr)}else $.raise("invalid buffer data")}else if(kt(Ur)){ti=Ur.shape;var Nr=Ur.stride,di=0,pi=0,kn=0,Ni=0;ti.length===1?(di=ti[0],pi=1,kn=Nr[0],Ni=0):ti.length===2?(di=ti[0],pi=ti[1],kn=Nr[0],Ni=Nr[1]):$.raise("invalid shape");var Ci=Array.isArray(Ur.data)?Lr.dtype:rr(Ur.data),ki=sr.allocType(Ci,di*pi);Vn(ki,Ur.data,di,pi,kn,Ni,Ur.offset),Jr(ki,Yn),sr.freeType(ki)}else $.raise("invalid data for buffer subdata");return qn}return Xr||qn(yr),qn._reglType="buffer",qn._buffer=Lr,qn.subdata=Br,Et.profile&&(qn.stats=Lr.stats),qn.destroy=function(){Cn(Lr)},qn}function rn(){De(Cr).forEach(function(yr){yr.buffer=xe.createBuffer(),xe.bindBuffer(yr.type,yr.buffer),xe.bufferData(yr.type,yr.persistentData||yr.byteLength,yr.usage)})}return Et.profile&&(Be.getTotalBufferSize=function(){var yr=0;return Object.keys(Cr).forEach(function(vr){yr+=Cr[vr].stats.size}),yr}),{create:cn,createStream:sn,destroyStream:en,clear:function(){De(Cr).forEach(Cn),Wr.forEach(Cn)},getBuffer:function(vr){return vr&&vr._buffer instanceof xr?vr._buffer:null},restore:rn,_initBuffer:fn}}var Ra=0,Ha=0,Qi=1,xa=1,Co=4,Fs=4,ha={points:Ra,point:Ha,lines:Qi,line:xa,triangles:Co,triangle:Fs,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Yl=0,cu=1,ws=4,gl=5120,fu=5121,Gu=5122,Qs=5123,rl=5124,hu=5125,pc=34963,Pf=35040,da=35044;function Oc(xe,Be,Et,gr){var Mr={},Cr=0,xr={uint8:fu,uint16:Qs};Be.oes_element_index_uint&&(xr.uint32=hu);function Wr(rn){this.id=Cr++,Mr[this.id]=this,this.buffer=rn,this.primType=ws,this.vertCount=0,this.type=0}Wr.prototype.bind=function(){this.buffer.bind()};var sn=[];function en(rn){var yr=sn.pop();return yr||(yr=new Wr(Et.create(null,pc,!0,!1)._buffer)),fn(yr,rn,Pf,-1,-1,0,0),yr}function Qr(rn){sn.push(rn)}function fn(rn,yr,vr,Xr,Pn,Lr,qn){rn.buffer.bind();var Jr;if(yr){var Br=qn;!qn&&(!S(yr)||kt(yr)&&!S(yr.data))&&(Br=Be.oes_element_index_uint?hu:Qs),Et._initBuffer(rn.buffer,yr,vr,Br,3)}else xe.bufferData(pc,Lr,vr),rn.buffer.dtype=Jr||fu,rn.buffer.usage=vr,rn.buffer.dimension=3,rn.buffer.byteLength=Lr;if(Jr=qn,!qn){switch(rn.buffer.dtype){case fu:case gl:Jr=fu;break;case Qs:case Gu:Jr=Qs;break;case hu:case rl:Jr=hu;break;default:$.raise("unsupported type for element array")}rn.buffer.dtype=Jr}rn.type=Jr,$(Jr!==hu||!!Be.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Ur=Pn;Ur<0&&(Ur=rn.buffer.byteLength,Jr===Qs?Ur>>=1:Jr===hu&&(Ur>>=2)),rn.vertCount=Ur;var Kr=Xr;if(Xr<0){Kr=ws;var Yn=rn.buffer.dimension;Yn===1&&(Kr=Yl),Yn===2&&(Kr=cu),Yn===3&&(Kr=ws)}rn.primType=Kr}function Cn(rn){gr.elementsCount--,$(rn.buffer!==null,"must not double destroy elements"),delete Mr[rn.id],rn.buffer.destroy(),rn.buffer=null}function cn(rn,yr){var vr=Et.create(null,pc,!0),Xr=new Wr(vr._buffer);gr.elementsCount++;function Pn(Lr){if(!Lr)vr(),Xr.primType=ws,Xr.vertCount=0,Xr.type=fu;else if(typeof Lr=="number")vr(Lr),Xr.primType=ws,Xr.vertCount=Lr|0,Xr.type=fu;else{var qn=null,Jr=da,Br=-1,Ur=-1,Kr=0,Yn=0;Array.isArray(Lr)||S(Lr)||kt(Lr)?qn=Lr:($.type(Lr,"object","invalid arguments for elements"),"data"in Lr&&(qn=Lr.data,$(Array.isArray(qn)||S(qn)||kt(qn),"invalid data for element buffer")),"usage"in Lr&&($.parameter(Lr.usage,lu,"invalid element buffer usage"),Jr=lu[Lr.usage]),"primitive"in Lr&&($.parameter(Lr.primitive,ha,"invalid element buffer primitive"),Br=ha[Lr.primitive]),"count"in Lr&&($(typeof Lr.count=="number"&&Lr.count>=0,"invalid vertex count for elements"),Ur=Lr.count|0),"type"in Lr&&($.parameter(Lr.type,xr,"invalid buffer type"),Yn=xr[Lr.type]),"length"in Lr?Kr=Lr.length|0:(Kr=Ur,Yn===Qs||Yn===Gu?Kr*=2:(Yn===hu||Yn===rl)&&(Kr*=4))),fn(Xr,qn,Jr,Br,Ur,Kr,Yn)}return Pn}return Pn(rn),Pn._reglType="elements",Pn._elements=Xr,Pn.subdata=function(Lr,qn){return vr.subdata(Lr,qn),Pn},Pn.destroy=function(){Cn(Xr)},Pn}return{create:cn,createStream:en,destroyStream:Qr,getElements:function(yr){return typeof yr=="function"&&yr._elements instanceof Wr?yr._elements:null},clear:function(){De(Mr).forEach(Cn)}}}var vc=new Float32Array(1),qc=new Uint32Array(vc.buffer),ef=5123;function tf(xe){for(var Be=sr.allocType(ef,xe.length),Et=0;Et<xe.length;++Et)if(isNaN(xe[Et]))Be[Et]=65535;else if(xe[Et]===Infinity)Be[Et]=31744;else if(xe[Et]===-Infinity)Be[Et]=64512;else{vc[0]=xe[Et];var gr=qc[0],Mr=gr>>>31<<15,Cr=(gr<<1>>>24)-127,xr=gr>>13&(1<<10)-1;if(Cr<-24)Be[Et]=Mr;else if(Cr<-14){var Wr=-14-Cr;Be[Et]=Mr+(xr+(1<<10)>>Wr)}else Cr>15?Be[Et]=Mr+31744:Be[Et]=Mr+(Cr+15<<10)+xr}return Be}function Qa(xe){return Array.isArray(xe)||S(xe)}var Au=function(Be){return!(Be&Be-1)&&!!Be},qs=34467,ps=3553,Lc=34067,mc=34069,yl=6408,nl=6406,gc=6407,eu=6409,Hu=6410,Rc=32854,Kl=32855,wa=36194,Dc=32819,Mf=32820,yc=33635,zc=34042,$l=6402,Zu=34041,_u=35904,Ol=35906,Fo=36193,Jl=33776,Ll=33777,xl=33778,Nc=33779,Rl=35986,tu=35987,mf=34798,gf=35840,rf=35841,bl=35842,Fa=35843,il=36196,Dl=5121,xc=5123,Fc=5125,zl=5126,If=10242,Of=10243,nf=10497,Sl=33071,Ql=33648,Cu=10240,Bs=10241,al=9728,Bc=9729,Wu=9984,Ba=9985,du=9986,ol=9987,sl=33170,zi=4352,pa=4353,Ps=4354,Sa=34046,Gi=3317,ql=37440,yf=37441,as=37443,ul=37444,pu=33984,Xu=[Wu,du,Ba,ol],io=[0,eu,Hu,gc,yl],os={};os[eu]=os[nl]=os[$l]=1,os[Zu]=os[Hu]=2,os[gc]=os[_u]=3,os[yl]=os[Ol]=4;function Nl(xe){return"[object "+xe+"]"}var lo=Nl("HTMLCanvasElement"),In=Nl("OffscreenCanvas"),ks=Nl("CanvasRenderingContext2D"),bc=Nl("ImageBitmap"),El=Nl("HTMLImageElement"),wu=Nl("HTMLVideoElement"),js=Object.keys(go).concat([lo,In,ks,bc,El,wu]),qi=[];qi[Dl]=1,qi[zl]=4,qi[Fo]=2,qi[xc]=2,qi[Fc]=4;var qr=[];qr[Rc]=2,qr[Kl]=2,qr[wa]=2,qr[Zu]=4,qr[Jl]=.5,qr[Ll]=.5,qr[xl]=1,qr[Nc]=1,qr[Rl]=.5,qr[tu]=1,qr[mf]=1,qr[gf]=.5,qr[rf]=.25,qr[bl]=.5,qr[Fa]=.25,qr[il]=.5;function kc(xe){return Array.isArray(xe)&&(xe.length===0||typeof xe[0]=="number")}function Sc(xe){if(!Array.isArray(xe))return!1;var Be=xe.length;return!(Be===0||!Qa(xe[0]))}function ll(xe){return Object.prototype.toString.call(xe)}function vu(xe){return ll(xe)===lo}function Ms(xe){return ll(xe)===In}function Is(xe){return ll(xe)===ks}function $o(xe){return ll(xe)===bc}function Bo(xe){return ll(xe)===El}function cl(xe){return ll(xe)===wu}function Tl(xe){if(!xe)return!1;var Be=ll(xe);return js.indexOf(Be)>=0?!0:kc(xe)||Sc(xe)||kt(xe)}function Fl(xe){return go[Object.prototype.toString.call(xe)]|0}function af(xe,Be){var Et=Be.length;switch(xe.type){case Dl:case xc:case Fc:case zl:var gr=sr.allocType(xe.type,Et);gr.set(Be),xe.data=gr;break;case Fo:xe.data=tf(Be);break;default:$.raise("unsupported texture type, must specify a typed array")}}function Bl(xe,Be){return sr.allocType(xe.type===Fo?zl:xe.type,Be)}function Os(xe,Be){xe.type===Fo?(xe.data=tf(Be),sr.freeType(Be)):xe.data=Be}function ss(xe,Be,Et,gr,Mr,Cr){for(var xr=xe.width,Wr=xe.height,sn=xe.channels,en=xr*Wr*sn,Qr=Bl(xe,en),fn=0,Cn=0;Cn<Wr;++Cn)for(var cn=0;cn<xr;++cn)for(var rn=0;rn<sn;++rn)Qr[fn++]=Be[Et*cn+gr*Cn+Mr*rn+Cr];Os(xe,Qr)}function Mi(xe,Be,Et,gr,Mr,Cr){var xr;if(typeof qr[xe]!="undefined"?xr=qr[xe]:xr=os[xe]*qi[Be],Cr&&(xr*=6),Mr){for(var Wr=0,sn=Et;sn>=1;)Wr+=xr*sn*sn,sn/=2;return Wr}else return xr*Et*gr}function Yu(xe,Be,Et,gr,Mr,Cr,xr){var Wr={"don't care":zi,"dont care":zi,nice:Ps,fast:pa},sn={repeat:nf,clamp:Sl,mirror:Ql},en={nearest:al,linear:Bc},Qr=v({mipmap:ol,"nearest mipmap nearest":Wu,"linear mipmap nearest":Ba,"nearest mipmap linear":du,"linear mipmap linear":ol},en),fn={none:0,browser:ul},Cn={uint8:Dl,rgba4:Dc,rgb565:yc,"rgb5 a1":Mf},cn={alpha:nl,luminance:eu,"luminance alpha":Hu,rgb:gc,rgba:yl,rgba4:Rc,"rgb5 a1":Kl,rgb565:wa},rn={};Be.ext_srgb&&(cn.srgb=_u,cn.srgba=Ol),Be.oes_texture_float&&(Cn.float32=Cn.float=zl),Be.oes_texture_half_float&&(Cn.float16=Cn["half float"]=Fo),Be.webgl_depth_texture&&(v(cn,{depth:$l,"depth stencil":Zu}),v(Cn,{uint16:xc,uint32:Fc,"depth stencil":zc})),Be.webgl_compressed_texture_s3tc&&v(rn,{"rgb s3tc dxt1":Jl,"rgba s3tc dxt1":Ll,"rgba s3tc dxt3":xl,"rgba s3tc dxt5":Nc}),Be.webgl_compressed_texture_atc&&v(rn,{"rgb atc":Rl,"rgba atc explicit alpha":tu,"rgba atc interpolated alpha":mf}),Be.webgl_compressed_texture_pvrtc&&v(rn,{"rgb pvrtc 4bppv1":gf,"rgb pvrtc 2bppv1":rf,"rgba pvrtc 4bppv1":bl,"rgba pvrtc 2bppv1":Fa}),Be.webgl_compressed_texture_etc1&&(rn["rgb etc1"]=il);var yr=Array.prototype.slice.call(xe.getParameter(qs));Object.keys(rn).forEach(function(Ot){var Sr=rn[Ot];yr.indexOf(Sr)>=0&&(cn[Ot]=Sr)});var vr=Object.keys(cn);Et.textureFormats=vr;var Xr=[];Object.keys(cn).forEach(function(Ot){var Sr=cn[Ot];Xr[Sr]=Ot});var Pn=[];Object.keys(Cn).forEach(function(Ot){var Sr=Cn[Ot];Pn[Sr]=Ot});var Lr=[];Object.keys(en).forEach(function(Ot){var Sr=en[Ot];Lr[Sr]=Ot});var qn=[];Object.keys(Qr).forEach(function(Ot){var Sr=Qr[Ot];qn[Sr]=Ot});var Jr=[];Object.keys(sn).forEach(function(Ot){var Sr=sn[Ot];Jr[Sr]=Ot});var Br=vr.reduce(function(Ot,Sr){var mr=cn[Sr];return mr===eu||mr===nl||mr===eu||mr===Hu||mr===$l||mr===Zu||Be.ext_srgb&&(mr===_u||mr===Ol)?Ot[mr]=mr:mr===Kl||Sr.indexOf("rgba")>=0?Ot[mr]=yl:Ot[mr]=gc,Ot},{});function Ur(){this.internalformat=yl,this.format=yl,this.type=Dl,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=ul,this.width=0,this.height=0,this.channels=0}function Kr(Ot,Sr){Ot.internalformat=Sr.internalformat,Ot.format=Sr.format,Ot.type=Sr.type,Ot.compressed=Sr.compressed,Ot.premultiplyAlpha=Sr.premultiplyAlpha,Ot.flipY=Sr.flipY,Ot.unpackAlignment=Sr.unpackAlignment,Ot.colorSpace=Sr.colorSpace,Ot.width=Sr.width,Ot.height=Sr.height,Ot.channels=Sr.channels}function Yn(Ot,Sr){if(!(typeof Sr!="object"||!Sr)){if("premultiplyAlpha"in Sr&&($.type(Sr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Ot.premultiplyAlpha=Sr.premultiplyAlpha),"flipY"in Sr&&($.type(Sr.flipY,"boolean","invalid texture flip"),Ot.flipY=Sr.flipY),"alignment"in Sr&&($.oneOf(Sr.alignment,[1,2,4,8],"invalid texture unpack alignment"),Ot.unpackAlignment=Sr.alignment),"colorSpace"in Sr&&($.parameter(Sr.colorSpace,fn,"invalid colorSpace"),Ot.colorSpace=fn[Sr.colorSpace]),"type"in Sr){var mr=Sr.type;$(Be.oes_texture_float||!(mr==="float"||mr==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),$(Be.oes_texture_half_float||!(mr==="half float"||mr==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),$(Be.webgl_depth_texture||!(mr==="uint16"||mr==="uint32"||mr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(mr,Cn,"invalid texture type"),Ot.type=Cn[mr]}var Rn=Ot.width,w=Ot.height,p=Ot.channels,s=!1;"shape"in Sr?($(Array.isArray(Sr.shape)&&Sr.shape.length>=2,"shape must be an array"),Rn=Sr.shape[0],w=Sr.shape[1],Sr.shape.length===3&&(p=Sr.shape[2],$(p>0&&p<=4,"invalid number of channels"),s=!0),$(Rn>=0&&Rn<=Et.maxTextureSize,"invalid width"),$(w>=0&&w<=Et.maxTextureSize,"invalid height")):("radius"in Sr&&(Rn=w=Sr.radius,$(Rn>=0&&Rn<=Et.maxTextureSize,"invalid radius")),"width"in Sr&&(Rn=Sr.width,$(Rn>=0&&Rn<=Et.maxTextureSize,"invalid width")),"height"in Sr&&(w=Sr.height,$(w>=0&&w<=Et.maxTextureSize,"invalid height")),"channels"in Sr&&(p=Sr.channels,$(p>0&&p<=4,"invalid number of channels"),s=!0)),Ot.width=Rn|0,Ot.height=w|0,Ot.channels=p|0;var d=!1;if("format"in Sr){var g=Sr.format;$(Be.webgl_depth_texture||!(g==="depth"||g==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(g,cn,"invalid texture format");var L=Ot.internalformat=cn[g];Ot.format=Br[L],g in Cn&&("type"in Sr||(Ot.type=Cn[g])),g in rn&&(Ot.compressed=!0),d=!0}!s&&d?Ot.channels=os[Ot.format]:s&&!d?Ot.channels!==io[Ot.format]&&(Ot.format=Ot.internalformat=io[Ot.channels]):d&&s&&$(Ot.channels===os[Ot.format],"number of channels inconsistent with specified format")}}function ti(Ot){xe.pixelStorei(ql,Ot.flipY),xe.pixelStorei(yf,Ot.premultiplyAlpha),xe.pixelStorei(as,Ot.colorSpace),xe.pixelStorei(Gi,Ot.unpackAlignment)}function un(){Ur.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Vr(Ot,Sr){var mr=null;if(Tl(Sr)?mr=Sr:Sr&&($.type(Sr,"object","invalid pixel data type"),Yn(Ot,Sr),"x"in Sr&&(Ot.xOffset=Sr.x|0),"y"in Sr&&(Ot.yOffset=Sr.y|0),Tl(Sr.data)&&(mr=Sr.data)),$(!Ot.compressed||mr instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Sr.copy){$(!mr,"can not specify copy and data field for the same texture");var Rn=Mr.viewportWidth,w=Mr.viewportHeight;Ot.width=Ot.width||Rn-Ot.xOffset,Ot.height=Ot.height||w-Ot.yOffset,Ot.needsCopy=!0,$(Ot.xOffset>=0&&Ot.xOffset<Rn&&Ot.yOffset>=0&&Ot.yOffset<w&&Ot.width>0&&Ot.width<=Rn&&Ot.height>0&&Ot.height<=w,"copy texture read out of bounds")}else if(!mr)Ot.width=Ot.width||1,Ot.height=Ot.height||1,Ot.channels=Ot.channels||4;else if(S(mr))Ot.channels=Ot.channels||4,Ot.data=mr,!("type"in Sr)&&Ot.type===Dl&&(Ot.type=Fl(mr));else if(kc(mr))Ot.channels=Ot.channels||4,af(Ot,mr),Ot.alignment=1,Ot.needsFree=!0;else if(kt(mr)){var p=mr.data;!Array.isArray(p)&&Ot.type===Dl&&(Ot.type=Fl(p));var s=mr.shape,d=mr.stride,g,L,N,K,ee,Z;s.length===3?(N=s[2],Z=d[2]):($(s.length===2,"invalid ndarray pixel data, must be 2 or 3D"),N=1,Z=1),g=s[0],L=s[1],K=d[0],ee=d[1],Ot.alignment=1,Ot.width=g,Ot.height=L,Ot.channels=N,Ot.format=Ot.internalformat=io[N],Ot.needsFree=!0,ss(Ot,p,K,ee,Z,mr.offset)}else if(vu(mr)||Ms(mr)||Is(mr))vu(mr)||Ms(mr)?Ot.element=mr:Ot.element=mr.canvas,Ot.width=Ot.element.width,Ot.height=Ot.element.height,Ot.channels=4;else if($o(mr))Ot.element=mr,Ot.width=mr.width,Ot.height=mr.height,Ot.channels=4;else if(Bo(mr))Ot.element=mr,Ot.width=mr.naturalWidth,Ot.height=mr.naturalHeight,Ot.channels=4;else if(cl(mr))Ot.element=mr,Ot.width=mr.videoWidth,Ot.height=mr.videoHeight,Ot.channels=4;else if(Sc(mr)){var Se=Ot.width||mr[0].length,pe=Ot.height||mr.length,Fe=Ot.channels;Qa(mr[0][0])?Fe=Fe||mr[0][0].length:Fe=Fe||1;for(var mt=It.shape(mr),Yt=1,jt=0;jt<mt.length;++jt)Yt*=mt[jt];var Qt=Bl(Ot,Yt);It.flatten(mr,mt,"",Qt),Os(Ot,Qt),Ot.alignment=1,Ot.width=Se,Ot.height=pe,Ot.channels=Fe,Ot.format=Ot.internalformat=io[Fe],Ot.needsFree=!0}Ot.type===zl?$(Et.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Ot.type===Fo&&$(Et.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Nr(Ot,Sr,mr){var Rn=Ot.element,w=Ot.data,p=Ot.internalformat,s=Ot.format,d=Ot.type,g=Ot.width,L=Ot.height;ti(Ot),Rn?xe.texImage2D(Sr,mr,s,s,d,Rn):Ot.compressed?xe.compressedTexImage2D(Sr,mr,p,g,L,0,w):Ot.needsCopy?(gr(),xe.copyTexImage2D(Sr,mr,s,Ot.xOffset,Ot.yOffset,g,L,0)):xe.texImage2D(Sr,mr,s,g,L,0,s,d,w||null)}function di(Ot,Sr,mr,Rn,w){var p=Ot.element,s=Ot.data,d=Ot.internalformat,g=Ot.format,L=Ot.type,N=Ot.width,K=Ot.height;ti(Ot),p?xe.texSubImage2D(Sr,w,mr,Rn,g,L,p):Ot.compressed?xe.compressedTexSubImage2D(Sr,w,mr,Rn,d,N,K,s):Ot.needsCopy?(gr(),xe.copyTexSubImage2D(Sr,w,mr,Rn,Ot.xOffset,Ot.yOffset,N,K)):xe.texSubImage2D(Sr,w,mr,Rn,N,K,g,L,s)}var pi=[];function kn(){return pi.pop()||new un}function Ni(Ot){Ot.needsFree&&sr.freeType(Ot.data),un.call(Ot),pi.push(Ot)}function Ci(){Ur.call(this),this.genMipmaps=!1,this.mipmapHint=zi,this.mipmask=0,this.images=Array(16)}function ki(Ot,Sr,mr){var Rn=Ot.images[0]=kn();Ot.mipmask=1,Rn.width=Ot.width=Sr,Rn.height=Ot.height=mr,Rn.channels=Ot.channels=4}function ca(Ot,Sr){var mr=null;if(Tl(Sr))mr=Ot.images[0]=kn(),Kr(mr,Ot),Vr(mr,Sr),Ot.mipmask=1;else if(Yn(Ot,Sr),Array.isArray(Sr.mipmap))for(var Rn=Sr.mipmap,w=0;w<Rn.length;++w)mr=Ot.images[w]=kn(),Kr(mr,Ot),mr.width>>=w,mr.height>>=w,Vr(mr,Rn[w]),Ot.mipmask|=1<<w;else mr=Ot.images[0]=kn(),Kr(mr,Ot),Vr(mr,Sr),Ot.mipmask=1;Kr(Ot,Ot.images[0]),Ot.compressed&&(Ot.internalformat===Jl||Ot.internalformat===Ll||Ot.internalformat===xl||Ot.internalformat===Nc)&&$(Ot.width%4==0&&Ot.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Go(Ot,Sr){for(var mr=Ot.images,Rn=0;Rn<mr.length;++Rn){if(!mr[Rn])return;Nr(mr[Rn],Sr,Rn)}}var Ho=[];function ta(){var Ot=Ho.pop()||new Ci;Ur.call(Ot),Ot.mipmask=0;for(var Sr=0;Sr<16;++Sr)Ot.images[Sr]=null;return Ot}function ho(Ot){for(var Sr=Ot.images,mr=0;mr<Sr.length;++mr)Sr[mr]&&Ni(Sr[mr]),Sr[mr]=null;Ho.push(Ot)}function Ma(){this.minFilter=al,this.magFilter=al,this.wrapS=Sl,this.wrapT=Sl,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=zi}function _s(Ot,Sr){if("min"in Sr){var mr=Sr.min;$.parameter(mr,Qr),Ot.minFilter=Qr[mr],Xu.indexOf(Ot.minFilter)>=0&&!("faces"in Sr)&&(Ot.genMipmaps=!0)}if("mag"in Sr){var Rn=Sr.mag;$.parameter(Rn,en),Ot.magFilter=en[Rn]}var w=Ot.wrapS,p=Ot.wrapT;if("wrap"in Sr){var s=Sr.wrap;typeof s=="string"?($.parameter(s,sn),w=p=sn[s]):Array.isArray(s)&&($.parameter(s[0],sn),$.parameter(s[1],sn),w=sn[s[0]],p=sn[s[1]])}else{if("wrapS"in Sr){var d=Sr.wrapS;$.parameter(d,sn),w=sn[d]}if("wrapT"in Sr){var g=Sr.wrapT;$.parameter(g,sn),p=sn[g]}}if(Ot.wrapS=w,Ot.wrapT=p,"anisotropic"in Sr){var L=Sr.anisotropic;$(typeof L=="number"&&L>=1&&L<=Et.maxAnisotropic,"aniso samples must be between 1 and "),Ot.anisotropic=Sr.anisotropic}if("mipmap"in Sr){var N=!1;switch(typeof Sr.mipmap){case"string":$.parameter(Sr.mipmap,Wr,"invalid mipmap hint"),Ot.mipmapHint=Wr[Sr.mipmap],Ot.genMipmaps=!0,N=!0;break;case"boolean":N=Ot.genMipmaps=Sr.mipmap;break;case"object":$(Array.isArray(Sr.mipmap),"invalid mipmap type"),Ot.genMipmaps=!1,N=!0;break;default:$.raise("invalid mipmap type")}N&&!("min"in Sr)&&(Ot.minFilter=Wu)}}function Qo(Ot,Sr){xe.texParameteri(Sr,Bs,Ot.minFilter),xe.texParameteri(Sr,Cu,Ot.magFilter),xe.texParameteri(Sr,If,Ot.wrapS),xe.texParameteri(Sr,Of,Ot.wrapT),Be.ext_texture_filter_anisotropic&&xe.texParameteri(Sr,Sa,Ot.anisotropic),Ot.genMipmaps&&(xe.hint(sl,Ot.mipmapHint),xe.generateMipmap(Sr))}var ys=0,qo={},Hs=Et.maxTextureUnits,zo=Array(Hs).map(function(){return null});function ui(Ot){Ur.call(this),this.mipmask=0,this.internalformat=yl,this.id=ys++,this.refCount=1,this.target=Ot,this.texture=xe.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ma,xr.profile&&(this.stats={size:0})}function Zs(Ot){xe.activeTexture(pu),xe.bindTexture(Ot.target,Ot.texture)}function Aa(){var Ot=zo[0];Ot?xe.bindTexture(Ot.target,Ot.texture):xe.bindTexture(ps,null)}function bn(Ot){var Sr=Ot.texture;$(Sr,"must not double destroy texture");var mr=Ot.unit,Rn=Ot.target;mr>=0&&(xe.activeTexture(pu+mr),xe.bindTexture(Rn,null),zo[mr]=null),xe.deleteTexture(Sr),Ot.texture=null,Ot.params=null,Ot.pixels=null,Ot.refCount=0,delete qo[Ot.id],Cr.textureCount--}v(ui.prototype,{bind:function(){var Sr=this;Sr.bindCount+=1;var mr=Sr.unit;if(mr<0){for(var Rn=0;Rn<Hs;++Rn){var w=zo[Rn];if(w){if(w.bindCount>0)continue;w.unit=-1}zo[Rn]=Sr,mr=Rn;break}mr>=Hs&&$.raise("insufficient number of texture units"),xr.profile&&Cr.maxTextureUnits<mr+1&&(Cr.maxTextureUnits=mr+1),Sr.unit=mr,xe.activeTexture(pu+mr),xe.bindTexture(Sr.target,Sr.texture)}return mr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&bn(this)}});function Li(Ot,Sr){var mr=new ui(ps);qo[mr.id]=mr,Cr.textureCount++;function Rn(s,d){var g=mr.texInfo;Ma.call(g);var L=ta();return typeof s=="number"?typeof d=="number"?ki(L,s|0,d|0):ki(L,s|0,s|0):s?($.type(s,"object","invalid arguments to regl.texture"),_s(g,s),ca(L,s)):ki(L,1,1),g.genMipmaps&&(L.mipmask=(L.width<<1)-1),mr.mipmask=L.mipmask,Kr(mr,L),$.texture2D(g,L,Et),mr.internalformat=L.internalformat,Rn.width=L.width,Rn.height=L.height,Zs(mr),Go(L,ps),Qo(g,ps),Aa(),ho(L),xr.profile&&(mr.stats.size=Mi(mr.internalformat,mr.type,L.width,L.height,g.genMipmaps,!1)),Rn.format=Xr[mr.internalformat],Rn.type=Pn[mr.type],Rn.mag=Lr[g.magFilter],Rn.min=qn[g.minFilter],Rn.wrapS=Jr[g.wrapS],Rn.wrapT=Jr[g.wrapT],Rn}function w(s,d,g,L){$(!!s,"must specify image data");var N=d|0,K=g|0,ee=L|0,Z=kn();return Kr(Z,mr),Z.width=0,Z.height=0,Vr(Z,s),Z.width=Z.width||(mr.width>>ee)-N,Z.height=Z.height||(mr.height>>ee)-K,$(mr.type===Z.type&&mr.format===Z.format&&mr.internalformat===Z.internalformat,"incompatible format for texture.subimage"),$(N>=0&&K>=0&&N+Z.width<=mr.width&&K+Z.height<=mr.height,"texture.subimage write out of bounds"),$(mr.mipmask&1<<ee,"missing mipmap data"),$(Z.data||Z.element||Z.needsCopy,"missing image data"),Zs(mr),di(Z,ps,N,K,ee),Aa(),Ni(Z),Rn}function p(s,d){var g=s|0,L=d|0||g;if(g===mr.width&&L===mr.height)return Rn;Rn.width=mr.width=g,Rn.height=mr.height=L,Zs(mr);for(var N=0;mr.mipmask>>N;++N){var K=g>>N,ee=L>>N;if(!K||!ee)break;xe.texImage2D(ps,N,mr.format,K,ee,0,mr.format,mr.type,null)}return Aa(),xr.profile&&(mr.stats.size=Mi(mr.internalformat,mr.type,g,L,!1,!1)),Rn}return Rn(Ot,Sr),Rn.subimage=w,Rn.resize=p,Rn._reglType="texture2d",Rn._texture=mr,xr.profile&&(Rn.stats=mr.stats),Rn.destroy=function(){mr.decRef()},Rn}function ji(Ot,Sr,mr,Rn,w,p){var s=new ui(Lc);qo[s.id]=s,Cr.cubeCount++;var d=new Array(6);function g(K,ee,Z,Se,pe,Fe){var mt,Yt=s.texInfo;for(Ma.call(Yt),mt=0;mt<6;++mt)d[mt]=ta();if(typeof K=="number"||!K){var jt=K|0||1;for(mt=0;mt<6;++mt)ki(d[mt],jt,jt)}else if(typeof K=="object")if(ee)ca(d[0],K),ca(d[1],ee),ca(d[2],Z),ca(d[3],Se),ca(d[4],pe),ca(d[5],Fe);else if(_s(Yt,K),Yn(s,K),"faces"in K){var Qt=K.faces;for($(Array.isArray(Qt)&&Qt.length===6,"cube faces must be a length 6 array"),mt=0;mt<6;++mt)$(typeof Qt[mt]=="object"&&!!Qt[mt],"invalid input for cube map face"),Kr(d[mt],s),ca(d[mt],Qt[mt])}else for(mt=0;mt<6;++mt)ca(d[mt],K);else $.raise("invalid arguments to cube map");for(Kr(s,d[0]),Et.npotTextureCube||$(Au(s.width)&&Au(s.height),"your browser does not support non power or two texture dimensions"),Yt.genMipmaps?s.mipmask=(d[0].width<<1)-1:s.mipmask=d[0].mipmask,$.textureCube(s,Yt,d,Et),s.internalformat=d[0].internalformat,g.width=d[0].width,g.height=d[0].height,Zs(s),mt=0;mt<6;++mt)Go(d[mt],mc+mt);for(Qo(Yt,Lc),Aa(),xr.profile&&(s.stats.size=Mi(s.internalformat,s.type,g.width,g.height,Yt.genMipmaps,!0)),g.format=Xr[s.internalformat],g.type=Pn[s.type],g.mag=Lr[Yt.magFilter],g.min=qn[Yt.minFilter],g.wrapS=Jr[Yt.wrapS],g.wrapT=Jr[Yt.wrapT],mt=0;mt<6;++mt)ho(d[mt]);return g}function L(K,ee,Z,Se,pe){$(!!ee,"must specify image data"),$(typeof K=="number"&&K===(K|0)&&K>=0&&K<6,"invalid face");var Fe=Z|0,mt=Se|0,Yt=pe|0,jt=kn();return Kr(jt,s),jt.width=0,jt.height=0,Vr(jt,ee),jt.width=jt.width||(s.width>>Yt)-Fe,jt.height=jt.height||(s.height>>Yt)-mt,$(s.type===jt.type&&s.format===jt.format&&s.internalformat===jt.internalformat,"incompatible format for texture.subimage"),$(Fe>=0&&mt>=0&&Fe+jt.width<=s.width&&mt+jt.height<=s.height,"texture.subimage write out of bounds"),$(s.mipmask&1<<Yt,"missing mipmap data"),$(jt.data||jt.element||jt.needsCopy,"missing image data"),Zs(s),di(jt,mc+K,Fe,mt,Yt),Aa(),Ni(jt),g}function N(K){var ee=K|0;if(ee!==s.width){g.width=s.width=ee,g.height=s.height=ee,Zs(s);for(var Z=0;Z<6;++Z)for(var Se=0;s.mipmask>>Se;++Se)xe.texImage2D(mc+Z,Se,s.format,ee>>Se,ee>>Se,0,s.format,s.type,null);return Aa(),xr.profile&&(s.stats.size=Mi(s.internalformat,s.type,g.width,g.height,!1,!0)),g}}return g(Ot,Sr,mr,Rn,w,p),g.subimage=L,g.resize=N,g._reglType="textureCube",g._texture=s,xr.profile&&(g.stats=s.stats),g.destroy=function(){s.decRef()},g}function es(){for(var Ot=0;Ot<Hs;++Ot)xe.activeTexture(pu+Ot),xe.bindTexture(ps,null),zo[Ot]=null;De(qo).forEach(bn),Cr.cubeCount=0,Cr.textureCount=0}xr.profile&&(Cr.getTotalTextureSize=function(){var Ot=0;return Object.keys(qo).forEach(function(Sr){Ot+=qo[Sr].stats.size}),Ot});function au(){for(var Ot=0;Ot<Hs;++Ot){var Sr=zo[Ot];Sr&&(Sr.bindCount=0,Sr.unit=-1,zo[Ot]=null)}De(qo).forEach(function(mr){mr.texture=xe.createTexture(),xe.bindTexture(mr.target,mr.texture);for(var Rn=0;Rn<32;++Rn)if((mr.mipmask&1<<Rn)!=0)if(mr.target===ps)xe.texImage2D(ps,Rn,mr.internalformat,mr.width>>Rn,mr.height>>Rn,0,mr.internalformat,mr.type,null);else for(var w=0;w<6;++w)xe.texImage2D(mc+w,Rn,mr.internalformat,mr.width>>Rn,mr.height>>Rn,0,mr.internalformat,mr.type,null);Qo(mr.texInfo,mr.target)})}function hc(){for(var Ot=0;Ot<Hs;++Ot){var Sr=zo[Ot];Sr&&(Sr.bindCount=0,Sr.unit=-1,zo[Ot]=null),xe.activeTexture(pu+Ot),xe.bindTexture(ps,null),xe.bindTexture(Lc,null)}}return{create2D:Li,createCube:ji,clear:es,getTexture:function(Sr){return null},restore:au,refresh:hc}}var ka=36161,wo=32854,Al=32855,mu=36194,gu=33189,Es=36168,Ec=34041,$n=35907,Fn=34836,Tc=34842,vs=34843,ko=[];ko[wo]=2,ko[Al]=2,ko[mu]=2,ko[gu]=2,ko[Es]=1,ko[Ec]=4,ko[$n]=4,ko[Fn]=16,ko[Tc]=8,ko[vs]=6;function Po(xe,Be,Et){return ko[xe]*Be*Et}var ru=function(Be,Et,gr,Mr,Cr){var xr={rgba4:wo,rgb565:mu,"rgb5 a1":Al,depth:gu,stencil:Es,"depth stencil":Ec};Et.ext_srgb&&(xr.srgba=$n),Et.ext_color_buffer_half_float&&(xr.rgba16f=Tc,xr.rgb16f=vs),Et.webgl_color_buffer_float&&(xr.rgba32f=Fn);var Wr=[];Object.keys(xr).forEach(function(rn){var yr=xr[rn];Wr[yr]=rn});var sn=0,en={};function Qr(rn){this.id=sn++,this.refCount=1,this.renderbuffer=rn,this.format=wo,this.width=0,this.height=0,Cr.profile&&(this.stats={size:0})}Qr.prototype.decRef=function(){--this.refCount<=0&&fn(this)};function fn(rn){var yr=rn.renderbuffer;$(yr,"must not double destroy renderbuffer"),Be.bindRenderbuffer(ka,null),Be.deleteRenderbuffer(yr),rn.renderbuffer=null,rn.refCount=0,delete en[rn.id],Mr.renderbufferCount--}function Cn(rn,yr){var vr=new Qr(Be.createRenderbuffer());en[vr.id]=vr,Mr.renderbufferCount++;function Xr(Lr,qn){var Jr=0,Br=0,Ur=wo;if(typeof Lr=="object"&&Lr){var Kr=Lr;if("shape"in Kr){var Yn=Kr.shape;$(Array.isArray(Yn)&&Yn.length>=2,"invalid renderbuffer shape"),Jr=Yn[0]|0,Br=Yn[1]|0}else"radius"in Kr&&(Jr=Br=Kr.radius|0),"width"in Kr&&(Jr=Kr.width|0),"height"in Kr&&(Br=Kr.height|0);"format"in Kr&&($.parameter(Kr.format,xr,"invalid renderbuffer format"),Ur=xr[Kr.format])}else typeof Lr=="number"?(Jr=Lr|0,typeof qn=="number"?Br=qn|0:Br=Jr):Lr?$.raise("invalid arguments to renderbuffer constructor"):Jr=Br=1;if($(Jr>0&&Br>0&&Jr<=gr.maxRenderbufferSize&&Br<=gr.maxRenderbufferSize,"invalid renderbuffer size"),!(Jr===vr.width&&Br===vr.height&&Ur===vr.format))return Xr.width=vr.width=Jr,Xr.height=vr.height=Br,vr.format=Ur,Be.bindRenderbuffer(ka,vr.renderbuffer),Be.renderbufferStorage(ka,Ur,Jr,Br),$(Be.getError()===0,"invalid render buffer format"),Cr.profile&&(vr.stats.size=Po(vr.format,vr.width,vr.height)),Xr.format=Wr[vr.format],Xr}function Pn(Lr,qn){var Jr=Lr|0,Br=qn|0||Jr;return Jr===vr.width&&Br===vr.height||($(Jr>0&&Br>0&&Jr<=gr.maxRenderbufferSize&&Br<=gr.maxRenderbufferSize,"invalid renderbuffer size"),Xr.width=vr.width=Jr,Xr.height=vr.height=Br,Be.bindRenderbuffer(ka,vr.renderbuffer),Be.renderbufferStorage(ka,vr.format,Jr,Br),$(Be.getError()===0,"invalid render buffer format"),Cr.profile&&(vr.stats.size=Po(vr.format,vr.width,vr.height))),Xr}return Xr(rn,yr),Xr.resize=Pn,Xr._reglType="renderbuffer",Xr._renderbuffer=vr,Cr.profile&&(Xr.stats=vr.stats),Xr.destroy=function(){vr.decRef()},Xr}Cr.profile&&(Mr.getTotalRenderbufferSize=function(){var rn=0;return Object.keys(en).forEach(function(yr){rn+=en[yr].stats.size}),rn});function cn(){De(en).forEach(function(rn){rn.renderbuffer=Be.createRenderbuffer(),Be.bindRenderbuffer(ka,rn.renderbuffer),Be.renderbufferStorage(ka,rn.format,rn.width,rn.height)}),Be.bindRenderbuffer(ka,null)}return{create:Cn,clear:function(){De(en).forEach(fn)},restore:cn}},Pu=36160,ec=36161,Hi=3553,Za=34069,fl=36064,hl=36096,tc=36128,Mu=33306,Ls=36053,kl=36054,ms=36055,xf=36057,jl=36061,jc=36193,bf=5121,Us=5126,_l=6407,Ul=6408,Iu=6402,Ou=[_l,Ul],Cl=[];Cl[Ul]=4,Cl[_l]=3;var Ku=[];Ku[bf]=1,Ku[Us]=4,Ku[jc]=2;var Rs=32854,Ac=32855,rc=36194,nc=33189,ic=36168,u=34041,i=35907,n=34836,c=34842,x=34843,P=[Rs,Ac,rc,i,c,x,n],O={};O[Ls]="complete",O[kl]="incomplete attachment",O[xf]="incomplete dimensions",O[ms]="incomplete, missing attachment",O[jl]="unsupported";function F(xe,Be,Et,gr,Mr,Cr){var xr={cur:null,next:null,dirty:!1,setFBO:null},Wr=["rgba"],sn=["rgba4","rgb565","rgb5 a1"];Be.ext_srgb&&sn.push("srgba"),Be.ext_color_buffer_half_float&&sn.push("rgba16f","rgb16f"),Be.webgl_color_buffer_float&&sn.push("rgba32f");var en=["uint8"];Be.oes_texture_half_float&&en.push("half float","float16"),Be.oes_texture_float&&en.push("float","float32");function Qr(un,Vr,Nr){this.target=un,this.texture=Vr,this.renderbuffer=Nr;var di=0,pi=0;Vr?(di=Vr.width,pi=Vr.height):Nr&&(di=Nr.width,pi=Nr.height),this.width=di,this.height=pi}function fn(un){un&&(un.texture&&un.texture._texture.decRef(),un.renderbuffer&&un.renderbuffer._renderbuffer.decRef())}function Cn(un,Vr,Nr){if(!!un)if(un.texture){var di=un.texture._texture,pi=Math.max(1,di.width),kn=Math.max(1,di.height);$(pi===Vr&&kn===Nr,"inconsistent width/height for supplied texture"),di.refCount+=1}else{var Ni=un.renderbuffer._renderbuffer;$(Ni.width===Vr&&Ni.height===Nr,"inconsistent width/height for renderbuffer"),Ni.refCount+=1}}function cn(un,Vr){Vr&&(Vr.texture?xe.framebufferTexture2D(Pu,un,Vr.target,Vr.texture._texture.texture,0):xe.framebufferRenderbuffer(Pu,un,ec,Vr.renderbuffer._renderbuffer.renderbuffer))}function rn(un){var Vr=Hi,Nr=null,di=null,pi=un;typeof un=="object"&&(pi=un.data,"target"in un&&(Vr=un.target|0)),$.type(pi,"function","invalid attachment data");var kn=pi._reglType;return kn==="texture2d"?(Nr=pi,$(Vr===Hi)):kn==="textureCube"?(Nr=pi,$(Vr>=Za&&Vr<Za+6,"invalid cube map target")):kn==="renderbuffer"?(di=pi,Vr=ec):$.raise("invalid regl object for attachment"),new Qr(Vr,Nr,di)}function yr(un,Vr,Nr,di,pi){if(Nr){var kn=gr.create2D({width:un,height:Vr,format:di,type:pi});return kn._texture.refCount=0,new Qr(Hi,kn,null)}else{var Ni=Mr.create({width:un,height:Vr,format:di});return Ni._renderbuffer.refCount=0,new Qr(ec,null,Ni)}}function vr(un){return un&&(un.texture||un.renderbuffer)}function Xr(un,Vr,Nr){un&&(un.texture?un.texture.resize(Vr,Nr):un.renderbuffer&&un.renderbuffer.resize(Vr,Nr),un.width=Vr,un.height=Nr)}var Pn=0,Lr={};function qn(){this.id=Pn++,Lr[this.id]=this,this.framebuffer=xe.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Jr(un){un.colorAttachments.forEach(fn),fn(un.depthAttachment),fn(un.stencilAttachment),fn(un.depthStencilAttachment)}function Br(un){var Vr=un.framebuffer;$(Vr,"must not double destroy framebuffer"),xe.deleteFramebuffer(Vr),un.framebuffer=null,Cr.framebufferCount--,delete Lr[un.id]}function Ur(un){var Vr;xe.bindFramebuffer(Pu,un.framebuffer);var Nr=un.colorAttachments;for(Vr=0;Vr<Nr.length;++Vr)cn(fl+Vr,Nr[Vr]);for(Vr=Nr.length;Vr<Et.maxColorAttachments;++Vr)xe.framebufferTexture2D(Pu,fl+Vr,Hi,null,0);xe.framebufferTexture2D(Pu,Mu,Hi,null,0),xe.framebufferTexture2D(Pu,hl,Hi,null,0),xe.framebufferTexture2D(Pu,tc,Hi,null,0),cn(hl,un.depthAttachment),cn(tc,un.stencilAttachment),cn(Mu,un.depthStencilAttachment);var di=xe.checkFramebufferStatus(Pu);!xe.isContextLost()&&di!==Ls&&$.raise("framebuffer configuration not supported, status = "+O[di]),xe.bindFramebuffer(Pu,xr.next?xr.next.framebuffer:null),xr.cur=xr.next,xe.getError()}function Kr(un,Vr){var Nr=new qn;Cr.framebufferCount++;function di(kn,Ni){var Ci;$(xr.next!==Nr,"can not update framebuffer which is currently in use");var ki=0,ca=0,Go=!0,Ho=!0,ta=null,ho=!0,Ma="rgba",_s="uint8",Qo=1,ys=null,qo=null,Hs=null,zo=!1;if(typeof kn=="number")ki=kn|0,ca=Ni|0||ki;else if(!kn)ki=ca=1;else{$.type(kn,"object","invalid arguments for framebuffer");var ui=kn;if("shape"in ui){var Zs=ui.shape;$(Array.isArray(Zs)&&Zs.length>=2,"invalid shape for framebuffer"),ki=Zs[0],ca=Zs[1]}else"radius"in ui&&(ki=ca=ui.radius),"width"in ui&&(ki=ui.width),"height"in ui&&(ca=ui.height);("color"in ui||"colors"in ui)&&(ta=ui.color||ui.colors,Array.isArray(ta)&&$(ta.length===1||Be.webgl_draw_buffers,"multiple render targets not supported")),ta||("colorCount"in ui&&(Qo=ui.colorCount|0,$(Qo>0,"invalid color buffer count")),"colorTexture"in ui&&(ho=!!ui.colorTexture,Ma="rgba4"),"colorType"in ui&&(_s=ui.colorType,ho?($(Be.oes_texture_float||!(_s==="float"||_s==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),$(Be.oes_texture_half_float||!(_s==="half float"||_s==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):_s==="half float"||_s==="float16"?($(Be.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Ma="rgba16f"):(_s==="float"||_s==="float32")&&($(Be.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Ma="rgba32f"),$.oneOf(_s,en,"invalid color type")),"colorFormat"in ui&&(Ma=ui.colorFormat,Wr.indexOf(Ma)>=0?ho=!0:sn.indexOf(Ma)>=0?ho=!1:ho?$.oneOf(ui.colorFormat,Wr,"invalid color format for texture"):$.oneOf(ui.colorFormat,sn,"invalid color format for renderbuffer"))),("depthTexture"in ui||"depthStencilTexture"in ui)&&(zo=!!(ui.depthTexture||ui.depthStencilTexture),$(!zo||Be.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ui&&(typeof ui.depth=="boolean"?Go=ui.depth:(ys=ui.depth,Ho=!1)),"stencil"in ui&&(typeof ui.stencil=="boolean"?Ho=ui.stencil:(qo=ui.stencil,Go=!1)),"depthStencil"in ui&&(typeof ui.depthStencil=="boolean"?Go=Ho=ui.depthStencil:(Hs=ui.depthStencil,Go=!1,Ho=!1))}var Aa=null,bn=null,Li=null,ji=null;if(Array.isArray(ta))Aa=ta.map(rn);else if(ta)Aa=[rn(ta)];else for(Aa=new Array(Qo),Ci=0;Ci<Qo;++Ci)Aa[Ci]=yr(ki,ca,ho,Ma,_s);$(Be.webgl_draw_buffers||Aa.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),$(Aa.length<=Et.maxColorAttachments,"too many color attachments, not supported"),ki=ki||Aa[0].width,ca=ca||Aa[0].height,ys?bn=rn(ys):Go&&!Ho&&(bn=yr(ki,ca,zo,"depth","uint32")),qo?Li=rn(qo):Ho&&!Go&&(Li=yr(ki,ca,!1,"stencil","uint8")),Hs?ji=rn(Hs):!ys&&!qo&&Ho&&Go&&(ji=yr(ki,ca,zo,"depth stencil","depth stencil")),$(!!ys+!!qo+!!Hs<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var es=null;for(Ci=0;Ci<Aa.length;++Ci)if(Cn(Aa[Ci],ki,ca),$(!Aa[Ci]||Aa[Ci].texture&&Ou.indexOf(Aa[Ci].texture._texture.format)>=0||Aa[Ci].renderbuffer&&P.indexOf(Aa[Ci].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Ci+" is invalid"),Aa[Ci]&&Aa[Ci].texture){var au=Cl[Aa[Ci].texture._texture.format]*Ku[Aa[Ci].texture._texture.type];es===null?es=au:$(es===au,"all color attachments much have the same number of bits per pixel.")}return Cn(bn,ki,ca),$(!bn||bn.texture&&bn.texture._texture.format===Iu||bn.renderbuffer&&bn.renderbuffer._renderbuffer.format===nc,"invalid depth attachment for framebuffer object"),Cn(Li,ki,ca),$(!Li||Li.renderbuffer&&Li.renderbuffer._renderbuffer.format===ic,"invalid stencil attachment for framebuffer object"),Cn(ji,ki,ca),$(!ji||ji.texture&&ji.texture._texture.format===u||ji.renderbuffer&&ji.renderbuffer._renderbuffer.format===u,"invalid depth-stencil attachment for framebuffer object"),Jr(Nr),Nr.width=ki,Nr.height=ca,Nr.colorAttachments=Aa,Nr.depthAttachment=bn,Nr.stencilAttachment=Li,Nr.depthStencilAttachment=ji,di.color=Aa.map(vr),di.depth=vr(bn),di.stencil=vr(Li),di.depthStencil=vr(ji),di.width=Nr.width,di.height=Nr.height,Ur(Nr),di}function pi(kn,Ni){$(xr.next!==Nr,"can not resize a framebuffer which is currently in use");var Ci=Math.max(kn|0,1),ki=Math.max(Ni|0||Ci,1);if(Ci===Nr.width&&ki===Nr.height)return di;for(var ca=Nr.colorAttachments,Go=0;Go<ca.length;++Go)Xr(ca[Go],Ci,ki);return Xr(Nr.depthAttachment,Ci,ki),Xr(Nr.stencilAttachment,Ci,ki),Xr(Nr.depthStencilAttachment,Ci,ki),Nr.width=di.width=Ci,Nr.height=di.height=ki,Ur(Nr),di}return di(un,Vr),v(di,{resize:pi,_reglType:"framebuffer",_framebuffer:Nr,destroy:function(){Br(Nr),Jr(Nr)},use:function(Ni){xr.setFBO({framebuffer:di},Ni)}})}function Yn(un){var Vr=Array(6);function Nr(pi){var kn;$(Vr.indexOf(xr.next)<0,"can not update framebuffer which is currently in use");var Ni={color:null},Ci=0,ki=null,ca="rgba",Go="uint8",Ho=1;if(typeof pi=="number")Ci=pi|0;else if(!pi)Ci=1;else{$.type(pi,"object","invalid arguments for framebuffer");var ta=pi;if("shape"in ta){var ho=ta.shape;$(Array.isArray(ho)&&ho.length>=2,"invalid shape for framebuffer"),$(ho[0]===ho[1],"cube framebuffer must be square"),Ci=ho[0]}else"radius"in ta&&(Ci=ta.radius|0),"width"in ta?(Ci=ta.width|0,"height"in ta&&$(ta.height===Ci,"must be square")):"height"in ta&&(Ci=ta.height|0);("color"in ta||"colors"in ta)&&(ki=ta.color||ta.colors,Array.isArray(ki)&&$(ki.length===1||Be.webgl_draw_buffers,"multiple render targets not supported")),ki||("colorCount"in ta&&(Ho=ta.colorCount|0,$(Ho>0,"invalid color buffer count")),"colorType"in ta&&($.oneOf(ta.colorType,en,"invalid color type"),Go=ta.colorType),"colorFormat"in ta&&(ca=ta.colorFormat,$.oneOf(ta.colorFormat,Wr,"invalid color format for texture"))),"depth"in ta&&(Ni.depth=ta.depth),"stencil"in ta&&(Ni.stencil=ta.stencil),"depthStencil"in ta&&(Ni.depthStencil=ta.depthStencil)}var Ma;if(ki)if(Array.isArray(ki))for(Ma=[],kn=0;kn<ki.length;++kn)Ma[kn]=ki[kn];else Ma=[ki];else{Ma=Array(Ho);var _s={radius:Ci,format:ca,type:Go};for(kn=0;kn<Ho;++kn)Ma[kn]=gr.createCube(_s)}for(Ni.color=Array(Ma.length),kn=0;kn<Ma.length;++kn){var Qo=Ma[kn];$(typeof Qo=="function"&&Qo._reglType==="textureCube","invalid cube map"),Ci=Ci||Qo.width,$(Qo.width===Ci&&Qo.height===Ci,"invalid cube map shape"),Ni.color[kn]={target:Za,data:Ma[kn]}}for(kn=0;kn<6;++kn){for(var ys=0;ys<Ma.length;++ys)Ni.color[ys].target=Za+kn;kn>0&&(Ni.depth=Vr[0].depth,Ni.stencil=Vr[0].stencil,Ni.depthStencil=Vr[0].depthStencil),Vr[kn]?Vr[kn](Ni):Vr[kn]=Kr(Ni)}return v(Nr,{width:Ci,height:Ci,color:Ma})}function di(pi){var kn,Ni=pi|0;if($(Ni>0&&Ni<=Et.maxCubeMapSize,"invalid radius for cube fbo"),Ni===Nr.width)return Nr;var Ci=Nr.color;for(kn=0;kn<Ci.length;++kn)Ci[kn].resize(Ni);for(kn=0;kn<6;++kn)Vr[kn].resize(Ni);return Nr.width=Nr.height=Ni,Nr}return Nr(un),v(Nr,{faces:Vr,resize:di,_reglType:"framebufferCube",destroy:function(){Vr.forEach(function(kn){kn.destroy()})}})}function ti(){xr.cur=null,xr.next=null,xr.dirty=!0,De(Lr).forEach(function(un){un.framebuffer=xe.createFramebuffer(),Ur(un)})}return v(xr,{getFramebuffer:function(Vr){if(typeof Vr=="function"&&Vr._reglType==="framebuffer"){var Nr=Vr._framebuffer;if(Nr instanceof qn)return Nr}return null},create:Kr,createCube:Yn,clear:function(){De(Lr).forEach(Br)},restore:ti})}var ue=5126,Ee=34962;function Xe(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ue,this.offset=0,this.stride=0,this.divisor=0}function qe(xe,Be,Et,gr,Mr){for(var Cr=Et.maxAttributes,xr=new Array(Cr),Wr=0;Wr<Cr;++Wr)xr[Wr]=new Xe;var sn=0,en={},Qr={Record:Xe,scope:{},state:xr,currentVAO:null,targetVAO:null,restore:Cn()?Lr:function(){},createVAO:qn,getVAO:rn,destroyBuffer:fn,setVAO:Cn()?yr:vr,clear:Cn()?Xr:function(){}};function fn(Jr){for(var Br=0;Br<xr.length;++Br){var Ur=xr[Br];Ur.buffer===Jr&&(xe.disableVertexAttribArray(Br),Ur.buffer=null)}}function Cn(){return Be.oes_vertex_array_object}function cn(){return Be.angle_instanced_arrays}function rn(Jr){return typeof Jr=="function"&&Jr._vao?Jr._vao:null}function yr(Jr){if(Jr!==Qr.currentVAO){var Br=Cn();Jr?Br.bindVertexArrayOES(Jr.vao):Br.bindVertexArrayOES(null),Qr.currentVAO=Jr}}function vr(Jr){if(Jr!==Qr.currentVAO){if(Jr)Jr.bindAttrs();else for(var Br=cn(),Ur=0;Ur<xr.length;++Ur){var Kr=xr[Ur];Kr.buffer?(xe.enableVertexAttribArray(Ur),xe.vertexAttribPointer(Ur,Kr.size,Kr.type,Kr.normalized,Kr.stride,Kr.offfset),Br&&Kr.divisor&&Br.vertexAttribDivisorANGLE(Ur,Kr.divisor)):(xe.disableVertexAttribArray(Ur),xe.vertexAttrib4f(Ur,Kr.x,Kr.y,Kr.z,Kr.w))}Qr.currentVAO=Jr}}function Xr(){De(en).forEach(function(Jr){Jr.destroy()})}function Pn(){this.id=++sn,this.attributes=[];var Jr=Cn();Jr?this.vao=Jr.createVertexArrayOES():this.vao=null,en[this.id]=this,this.buffers=[]}Pn.prototype.bindAttrs=function(){for(var Jr=cn(),Br=this.attributes,Ur=0;Ur<Br.length;++Ur){var Kr=Br[Ur];Kr.buffer?(xe.enableVertexAttribArray(Ur),xe.bindBuffer(Ee,Kr.buffer.buffer),xe.vertexAttribPointer(Ur,Kr.size,Kr.type,Kr.normalized,Kr.stride,Kr.offset),Jr&&Kr.divisor&&Jr.vertexAttribDivisorANGLE(Ur,Kr.divisor)):(xe.disableVertexAttribArray(Ur),xe.vertexAttrib4f(Ur,Kr.x,Kr.y,Kr.z,Kr.w))}for(var Yn=Br.length;Yn<Cr;++Yn)xe.disableVertexAttribArray(Yn)},Pn.prototype.refresh=function(){var Jr=Cn();Jr&&(Jr.bindVertexArrayOES(this.vao),this.bindAttrs(),Qr.currentVAO=this)},Pn.prototype.destroy=function(){if(this.vao){var Jr=Cn();this===Qr.currentVAO&&(Qr.currentVAO=null,Jr.bindVertexArrayOES(null)),Jr.deleteVertexArrayOES(this.vao),this.vao=null}en[this.id]&&(delete en[this.id],gr.vaoCount-=1)};function Lr(){var Jr=Cn();Jr&&De(en).forEach(function(Br){Br.refresh()})}function qn(Jr){var Br=new Pn;gr.vaoCount+=1;function Ur(Kr){$(Array.isArray(Kr),"arguments to vertex array constructor must be an array"),$(Kr.length<Cr,"too many attributes"),$(Kr.length>0,"must specify at least one attribute");var Yn={},ti=Br.attributes;ti.length=Kr.length;for(var un=0;un<Kr.length;++un){var Vr=Kr[un],Nr=ti[un]=new Xe,di=Vr.data||Vr;if(Array.isArray(di)||S(di)||kt(di)){var pi;Br.buffers[un]&&(pi=Br.buffers[un],S(di)&&pi._buffer.byteLength>=di.byteLength?pi.subdata(di):(pi.destroy(),Br.buffers[un]=null)),Br.buffers[un]||(pi=Br.buffers[un]=Mr.create(Vr,Ee,!1,!0)),Nr.buffer=Mr.getBuffer(pi),Nr.size=Nr.buffer.dimension|0,Nr.normalized=!1,Nr.type=Nr.buffer.dtype,Nr.offset=0,Nr.stride=0,Nr.divisor=0,Nr.state=1,Yn[un]=1}else Mr.getBuffer(Vr)?(Nr.buffer=Mr.getBuffer(Vr),Nr.size=Nr.buffer.dimension|0,Nr.normalized=!1,Nr.type=Nr.buffer.dtype,Nr.offset=0,Nr.stride=0,Nr.divisor=0,Nr.state=1):Mr.getBuffer(Vr.buffer)?(Nr.buffer=Mr.getBuffer(Vr.buffer),Nr.size=(+Vr.size||Nr.buffer.dimension)|0,Nr.normalized=!!Vr.normalized||!1,"type"in Vr?($.parameter(Vr.type,uo,"invalid buffer type"),Nr.type=uo[Vr.type]):Nr.type=Nr.buffer.dtype,Nr.offset=(Vr.offset||0)|0,Nr.stride=(Vr.stride||0)|0,Nr.divisor=(Vr.divisor||0)|0,Nr.state=1,$(Nr.size>=1&&Nr.size<=4,"size must be between 1 and 4"),$(Nr.offset>=0,"invalid offset"),$(Nr.stride>=0&&Nr.stride<=255,"stride must be between 0 and 255"),$(Nr.divisor>=0,"divisor must be positive"),$(!Nr.divisor||!!Be.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Vr?($(un>0,"first attribute must not be a constant"),Nr.x=+Vr.x||0,Nr.y=+Vr.y||0,Nr.z=+Vr.z||0,Nr.w=+Vr.w||0,Nr.state=2):$(!1,"invalid attribute spec for location "+un)}for(var kn=0;kn<Br.buffers.length;++kn)!Yn[kn]&&Br.buffers[kn]&&(Br.buffers[kn].destroy(),Br.buffers[kn]=null);return Br.refresh(),Ur}return Ur.destroy=function(){for(var Kr=0;Kr<Br.buffers.length;++Kr)Br.buffers[Kr]&&Br.buffers[Kr].destroy();Br.buffers.length=0,Br.destroy()},Ur._vao=Br,Ur._reglType="vao",Ur(Jr)}return Qr}var tt=35632,zt=35633,Lt=35718,Xt=35721;function Dt(xe,Be,Et,gr){var Mr={},Cr={};function xr(yr,vr,Xr,Pn){this.name=yr,this.id=vr,this.location=Xr,this.info=Pn}function Wr(yr,vr){for(var Xr=0;Xr<yr.length;++Xr)if(yr[Xr].id===vr.id){yr[Xr].location=vr.location;return}yr.push(vr)}function sn(yr,vr,Xr){var Pn=yr===tt?Mr:Cr,Lr=Pn[vr];if(!Lr){var qn=Be.str(vr);Lr=xe.createShader(yr),xe.shaderSource(Lr,qn),xe.compileShader(Lr),$.shaderError(xe,Lr,qn,yr,Xr),Pn[vr]=Lr}return Lr}var en={},Qr=[],fn=0;function Cn(yr,vr){this.id=fn++,this.fragId=yr,this.vertId=vr,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,gr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function cn(yr,vr,Xr){var Pn,Lr,qn=sn(tt,yr.fragId),Jr=sn(zt,yr.vertId),Br=yr.program=xe.createProgram();if(xe.attachShader(Br,qn),xe.attachShader(Br,Jr),Xr)for(Pn=0;Pn<Xr.length;++Pn){var Ur=Xr[Pn];xe.bindAttribLocation(Br,Ur[0],Ur[1])}xe.linkProgram(Br),$.linkError(xe,Br,Be.str(yr.fragId),Be.str(yr.vertId),vr);var Kr=xe.getProgramParameter(Br,Lt);gr.profile&&(yr.stats.uniformsCount=Kr);var Yn=yr.uniforms;for(Pn=0;Pn<Kr;++Pn)if(Lr=xe.getActiveUniform(Br,Pn),Lr)if(Lr.size>1)for(var ti=0;ti<Lr.size;++ti){var un=Lr.name.replace("[0]","["+ti+"]");Wr(Yn,new xr(un,Be.id(un),xe.getUniformLocation(Br,un),Lr))}else Wr(Yn,new xr(Lr.name,Be.id(Lr.name),xe.getUniformLocation(Br,Lr.name),Lr));var Vr=xe.getProgramParameter(Br,Xt);gr.profile&&(yr.stats.attributesCount=Vr);var Nr=yr.attributes;for(Pn=0;Pn<Vr;++Pn)Lr=xe.getActiveAttrib(Br,Pn),Lr&&Wr(Nr,new xr(Lr.name,Be.id(Lr.name),xe.getAttribLocation(Br,Lr.name),Lr))}gr.profile&&(Et.getMaxUniformsCount=function(){var yr=0;return Qr.forEach(function(vr){vr.stats.uniformsCount>yr&&(yr=vr.stats.uniformsCount)}),yr},Et.getMaxAttributesCount=function(){var yr=0;return Qr.forEach(function(vr){vr.stats.attributesCount>yr&&(yr=vr.stats.attributesCount)}),yr});function rn(){Mr={},Cr={};for(var yr=0;yr<Qr.length;++yr)cn(Qr[yr],null,Qr[yr].attributes.map(function(vr){return[vr.location,vr.name]}))}return{clear:function(){var vr=xe.deleteShader.bind(xe);De(Mr).forEach(vr),Mr={},De(Cr).forEach(vr),Cr={},Qr.forEach(function(Xr){xe.deleteProgram(Xr.program)}),Qr.length=0,en={},Et.shaderCount=0},program:function(vr,Xr,Pn,Lr){$.command(vr>=0,"missing vertex shader",Pn),$.command(Xr>=0,"missing fragment shader",Pn);var qn=en[Xr];qn||(qn=en[Xr]={});var Jr=qn[vr];if(Jr&&(Jr.refCount++,!Lr))return Jr;var Br=new Cn(Xr,vr);return Et.shaderCount++,cn(Br,Pn,Lr),Jr||(qn[vr]=Br),Qr.push(Br),v(Br,{destroy:function(){if(Br.refCount--,Br.refCount<=0){xe.deleteProgram(Br.program);var Kr=Qr.indexOf(Br);Qr.splice(Kr,1),Et.shaderCount--}qn[Br.vertId].refCount<=0&&(xe.deleteShader(Cr[Br.vertId]),delete Cr[Br.vertId],delete en[Br.fragId][Br.vertId]),Object.keys(en[Br.fragId]).length||(xe.deleteShader(Mr[Br.fragId]),delete Mr[Br.fragId],delete en[Br.fragId])}})},restore:rn,shader:sn,frag:-1,vert:-1}}var Ut=6408,er=5121,qt=3333,Ir=5126;function hr(xe,Be,Et,gr,Mr,Cr,xr){function Wr(Qr){var fn;Be.next===null?($(Mr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),fn=er):($(Be.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),fn=Be.next.colorAttachments[0].texture._texture.type,Cr.oes_texture_float?($(fn===er||fn===Ir,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),fn===Ir&&$(xr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):$(fn===er,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Cn=0,cn=0,rn=gr.framebufferWidth,yr=gr.framebufferHeight,vr=null;S(Qr)?vr=Qr:Qr&&($.type(Qr,"object","invalid arguments to regl.read()"),Cn=Qr.x|0,cn=Qr.y|0,$(Cn>=0&&Cn<gr.framebufferWidth,"invalid x offset for regl.read"),$(cn>=0&&cn<gr.framebufferHeight,"invalid y offset for regl.read"),rn=(Qr.width||gr.framebufferWidth-Cn)|0,yr=(Qr.height||gr.framebufferHeight-cn)|0,vr=Qr.data||null),vr&&(fn===er?$(vr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):fn===Ir&&$(vr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),$(rn>0&&rn+Cn<=gr.framebufferWidth,"invalid width for read pixels"),$(yr>0&&yr+cn<=gr.framebufferHeight,"invalid height for read pixels"),Et();var Xr=rn*yr*4;return vr||(fn===er?vr=new Uint8Array(Xr):fn===Ir&&(vr=vr||new Float32Array(Xr))),$.isTypedArray(vr,"data buffer for regl.read() must be a typedarray"),$(vr.byteLength>=Xr,"data buffer for regl.read() too small"),xe.pixelStorei(qt,4),xe.readPixels(Cn,cn,rn,yr,Ut,fn,vr),vr}function sn(Qr){var fn;return Be.setFBO({framebuffer:Qr.framebuffer},function(){fn=Wr(Qr)}),fn}function en(Qr){return!Qr||!("framebuffer"in Qr)?Wr(Qr):sn(Qr)}return en}function Tr(xe){return Array.prototype.slice.call(xe)}function _r(xe){return Tr(xe).join("")}function nn(){var xe=0,Be=[],Et=[];function gr(fn){for(var Cn=0;Cn<Et.length;++Cn)if(Et[Cn]===fn)return Be[Cn];var cn="g"+xe++;return Be.push(cn),Et.push(fn),cn}function Mr(){var fn=[];function Cn(){fn.push.apply(fn,Tr(arguments))}var cn=[];function rn(){var yr="v"+xe++;return cn.push(yr),arguments.length>0&&(fn.push(yr,"="),fn.push.apply(fn,Tr(arguments)),fn.push(";")),yr}return v(Cn,{def:rn,toString:function(){return _r([cn.length>0?"var "+cn.join(",")+";":"",_r(fn)])}})}function Cr(){var fn=Mr(),Cn=Mr(),cn=fn.toString,rn=Cn.toString;function yr(vr,Xr){Cn(vr,Xr,"=",fn.def(vr,Xr),";")}return v(function(){fn.apply(fn,Tr(arguments))},{def:fn.def,entry:fn,exit:Cn,save:yr,set:function(Xr,Pn,Lr){yr(Xr,Pn),fn(Xr,Pn,"=",Lr,";")},toString:function(){return cn()+rn()}})}function xr(){var fn=_r(arguments),Cn=Cr(),cn=Cr(),rn=Cn.toString,yr=cn.toString;return v(Cn,{then:function(){return Cn.apply(Cn,Tr(arguments)),this},else:function(){return cn.apply(cn,Tr(arguments)),this},toString:function(){var Xr=yr();return Xr&&(Xr="else{"+Xr+"}"),_r(["if(",fn,"){",rn(),"}",Xr])}})}var Wr=Mr(),sn={};function en(fn,Cn){var cn=[];function rn(){var Lr="a"+cn.length;return cn.push(Lr),Lr}Cn=Cn||0;for(var yr=0;yr<Cn;++yr)rn();var vr=Cr(),Xr=vr.toString,Pn=sn[fn]=v(vr,{arg:rn,toString:function(){return _r(["function(",cn.join(),"){",Xr(),"}"])}});return Pn}function Qr(){var fn=['"use strict";',Wr,"return {"];Object.keys(sn).forEach(function(rn){fn.push('"',rn,'":',sn[rn].toString(),",")}),fn.push("}");var Cn=_r(fn).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),cn=Function.apply(null,Be.concat(Cn));return cn.apply(null,Et)}return{global:Wr,link:gr,block:Mr,proc:en,scope:Cr,cond:xr,compile:Qr}}var Yr="xyzw".split(""),yn=5121,On=1,Qn=2,oi=0,yi=1,Zi=2,An=3,si=4,xi=5,Wn=6,Ti="dither",ri="blend.enable",Ii="blend.color",Bi="blend.equation",qa="blend.func",Pa="depth.enable",yo="depth.func",Ea="depth.range",Wa="depth.mask",Ds="colorMask",xo="cull.enable",yu="cull.face",xu="frontFace",jo="lineWidth",Ts="polygonOffset.enable",Lu="polygonOffset.offset",ac="sample.alpha",$u="sample.enable",oc="sample.coverage",sc="stencil.enable",Ru="stencil.mask",dl="stencil.func",As="stencil.opFront",co="stencil.opBack",Du="scissor.enable",bu="scissor.box",Mo="viewport",Io="profile",Oo="framebuffer",Jo="vert",bo="frag",Uo="elements",Vs="primitive",wl="count",Uc="offset",Vl="instances",Ju="vao",zu="Width",Nu="Height",Gs=Oo+zu,Lo=Oo+Nu,Vc=Mo+zu,gs=Mo+Nu,of="drawingBuffer",Lf=of+zu,Rf=of+Nu,Uf=[qa,Bi,dl,As,co,oc,Mo,bu,Lu],Qu=34962,Sf=34963,sf=35632,uc=35633,Fu=3553,lc=34067,Vf=2884,_c=3042,Cc=3024,Gf=2960,Hf=2929,ah=3089,Zf=32823,Df=32926,ch=32928,cc=5126,uf=35664,ao=35665,Gl=35666,lf=5124,Gc=35667,nu=35668,Pl=35669,Ef=35670,Tf=35671,Hc=35672,cf=35673,Zc=35674,Hl=35675,ne=35676,se=35678,z=35680,V=4,_e=1028,ut=1029,Ht=2304,ir=2305,tr=32775,Or=32776,an=519,zn=7680,Xn=0,ni=1,ra=32774,Oi=513,la=36160,Yi=36064,ja={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ro=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],So={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Ya={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Vo={frag:sf,vert:uc},ea={cw:Ht,ccw:ir};function fo(xe){return Array.isArray(xe)||S(xe)||kt(xe)}function iu(xe){return xe.sort(function(Be,Et){return Be===Mo?-1:Et===Mo?1:Be<Et?-1:1})}function Ta(xe,Be,Et,gr){this.thisDep=xe,this.contextDep=Be,this.propDep=Et,this.append=gr}function Ua(xe){return xe&&!(xe.thisDep||xe.contextDep||xe.propDep)}function bi(xe){return new Ta(!1,!1,!1,xe)}function Do(xe,Be){var Et=xe.type;if(Et===oi){var gr=xe.data.length;return new Ta(!0,gr>=1,gr>=2,Be)}else if(Et===si){var Mr=xe.data;return new Ta(Mr.thisDep,Mr.contextDep,Mr.propDep,Be)}else{if(Et===xi)return new Ta(!1,!1,!1,Be);if(Et===Wn){for(var Cr=!1,xr=!1,Wr=!1,sn=0;sn<xe.data.length;++sn){var en=xe.data[sn];if(en.type===yi)Wr=!0;else if(en.type===Zi)xr=!0;else if(en.type===An)Cr=!0;else if(en.type===oi){Cr=!0;var Qr=en.data;Qr>=1&&(xr=!0),Qr>=2&&(Wr=!0)}else en.type===si&&(Cr=Cr||en.data.thisDep,xr=xr||en.data.contextDep,Wr=Wr||en.data.propDep)}return new Ta(Cr,xr,Wr,Be)}else return new Ta(Et===An,Et===Zi,Et===yi,Be)}}var fc=new Ta(!1,!1,!1,function(){});function Wf(xe,Be,Et,gr,Mr,Cr,xr,Wr,sn,en,Qr,fn,Cn,cn,rn){var yr=en.Record,vr={add:32774,subtract:32778,"reverse subtract":32779};Et.ext_blend_minmax&&(vr.min=tr,vr.max=Or);var Xr=Et.angle_instanced_arrays,Pn=Et.webgl_draw_buffers,Lr={dirty:!0,profile:rn.profile},qn={},Jr=[],Br={},Ur={};function Kr(p){return p.replace(".","_")}function Yn(p,s,d){var g=Kr(p);Jr.push(p),qn[g]=Lr[g]=!!d,Br[g]=s}function ti(p,s,d){var g=Kr(p);Jr.push(p),Array.isArray(d)?(Lr[g]=d.slice(),qn[g]=d.slice()):Lr[g]=qn[g]=d,Ur[g]=s}Yn(Ti,Cc),Yn(ri,_c),ti(Ii,"blendColor",[0,0,0,0]),ti(Bi,"blendEquationSeparate",[ra,ra]),ti(qa,"blendFuncSeparate",[ni,Xn,ni,Xn]),Yn(Pa,Hf,!0),ti(yo,"depthFunc",Oi),ti(Ea,"depthRange",[0,1]),ti(Wa,"depthMask",!0),ti(Ds,Ds,[!0,!0,!0,!0]),Yn(xo,Vf),ti(yu,"cullFace",ut),ti(xu,xu,ir),ti(jo,jo,1),Yn(Ts,Zf),ti(Lu,"polygonOffset",[0,0]),Yn(ac,Df),Yn($u,ch),ti(oc,"sampleCoverage",[1,!1]),Yn(sc,Gf),ti(Ru,"stencilMask",-1),ti(dl,"stencilFunc",[an,0,-1]),ti(As,"stencilOpSeparate",[_e,zn,zn,zn]),ti(co,"stencilOpSeparate",[ut,zn,zn,zn]),Yn(Du,ah),ti(bu,"scissor",[0,0,xe.drawingBufferWidth,xe.drawingBufferHeight]),ti(Mo,Mo,[0,0,xe.drawingBufferWidth,xe.drawingBufferHeight]);var un={gl:xe,context:Cn,strings:Be,next:qn,current:Lr,draw:fn,elements:Cr,buffer:Mr,shader:Qr,attributes:en.state,vao:en,uniforms:sn,framebuffer:Wr,extensions:Et,timer:cn,isBufferArgs:fo},Vr={primTypes:ha,compareFuncs:So,blendFuncs:ja,blendEquations:vr,stencilOps:Ya,glTypes:uo,orientationType:ea};$.optional(function(){un.isArrayLike=Qa}),Pn&&(Vr.backBuffer=[ut],Vr.drawBuffer=H(gr.maxDrawbuffers,function(p){return p===0?[0]:H(p,function(s){return Yi+s})}));var Nr=0;function di(){var p=nn(),s=p.link,d=p.global;p.id=Nr++,p.batchId="0";var g=s(un),L=p.shared={props:"a0"};Object.keys(un).forEach(function(Se){L[Se]=d.def(g,".",Se)}),$.optional(function(){p.CHECK=s($),p.commandStr=$.guessCommand(),p.command=s(p.commandStr),p.assert=function(Se,pe,Fe){Se("if(!(",pe,"))",this.CHECK,".commandRaise(",s(Fe),",",this.command,");")},Vr.invalidBlendCombinations=Ro});var N=p.next={},K=p.current={};Object.keys(Ur).forEach(function(Se){Array.isArray(Lr[Se])&&(N[Se]=d.def(L.next,".",Se),K[Se]=d.def(L.current,".",Se))});var ee=p.constants={};Object.keys(Vr).forEach(function(Se){ee[Se]=d.def(JSON.stringify(Vr[Se]))}),p.invoke=function(Se,pe){switch(pe.type){case oi:var Fe=["this",L.context,L.props,p.batchId];return Se.def(s(pe.data),".call(",Fe.slice(0,Math.max(pe.data.length+1,4)),")");case yi:return Se.def(L.props,pe.data);case Zi:return Se.def(L.context,pe.data);case An:return Se.def("this",pe.data);case si:return pe.data.append(p,Se),pe.data.ref;case xi:return pe.data.toString();case Wn:return pe.data.map(function(mt){return p.invoke(Se,mt)})}},p.attribCache={};var Z={};return p.scopeAttrib=function(Se){var pe=Be.id(Se);if(pe in Z)return Z[pe];var Fe=en.scope[pe];Fe||(Fe=en.scope[pe]=new yr);var mt=Z[pe]=s(Fe);return mt},p}function pi(p){var s=p.static,d=p.dynamic,g;if(Io in s){var L=!!s[Io];g=bi(function(K,ee){return L}),g.enable=L}else if(Io in d){var N=d[Io];g=Do(N,function(K,ee){return K.invoke(ee,N)})}return g}function kn(p,s){var d=p.static,g=p.dynamic;if(Oo in d){var L=d[Oo];return L?(L=Wr.getFramebuffer(L),$.command(L,"invalid framebuffer object"),bi(function(K,ee){var Z=K.link(L),Se=K.shared;ee.set(Se.framebuffer,".next",Z);var pe=Se.context;return ee.set(pe,"."+Gs,Z+".width"),ee.set(pe,"."+Lo,Z+".height"),Z})):bi(function(K,ee){var Z=K.shared;ee.set(Z.framebuffer,".next","null");var Se=Z.context;return ee.set(Se,"."+Gs,Se+"."+Lf),ee.set(Se,"."+Lo,Se+"."+Rf),"null"})}else if(Oo in g){var N=g[Oo];return Do(N,function(K,ee){var Z=K.invoke(ee,N),Se=K.shared,pe=Se.framebuffer,Fe=ee.def(pe,".getFramebuffer(",Z,")");$.optional(function(){K.assert(ee,"!"+Z+"||"+Fe,"invalid framebuffer object")}),ee.set(pe,".next",Fe);var mt=Se.context;return ee.set(mt,"."+Gs,Fe+"?"+Fe+".width:"+mt+"."+Lf),ee.set(mt,"."+Lo,Fe+"?"+Fe+".height:"+mt+"."+Rf),Fe})}else return null}function Ni(p,s,d){var g=p.static,L=p.dynamic;function N(Z){if(Z in g){var Se=g[Z];$.commandType(Se,"object","invalid "+Z,d.commandStr);var pe=!0,Fe=Se.x|0,mt=Se.y|0,Yt,jt;return"width"in Se?(Yt=Se.width|0,$.command(Yt>=0,"invalid "+Z,d.commandStr)):pe=!1,"height"in Se?(jt=Se.height|0,$.command(jt>=0,"invalid "+Z,d.commandStr)):pe=!1,new Ta(!pe&&s&&s.thisDep,!pe&&s&&s.contextDep,!pe&&s&&s.propDep,function(kr,on){var Gr=kr.shared.context,ln=Yt;"width"in Se||(ln=on.def(Gr,".",Gs,"-",Fe));var wn=jt;return"height"in Se||(wn=on.def(Gr,".",Lo,"-",mt)),[Fe,mt,ln,wn]})}else if(Z in L){var Qt=L[Z],ur=Do(Qt,function(kr,on){var Gr=kr.invoke(on,Qt);$.optional(function(){kr.assert(on,Gr+"&&typeof "+Gr+'==="object"',"invalid "+Z)});var ln=kr.shared.context,wn=on.def(Gr,".x|0"),Gn=on.def(Gr,".y|0"),ii=on.def('"width" in ',Gr,"?",Gr,".width|0:","(",ln,".",Gs,"-",wn,")"),Vi=on.def('"height" in ',Gr,"?",Gr,".height|0:","(",ln,".",Lo,"-",Gn,")");return $.optional(function(){kr.assert(on,ii+">=0&&"+Vi+">=0","invalid "+Z)}),[wn,Gn,ii,Vi]});return s&&(ur.thisDep=ur.thisDep||s.thisDep,ur.contextDep=ur.contextDep||s.contextDep,ur.propDep=ur.propDep||s.propDep),ur}else return s?new Ta(s.thisDep,s.contextDep,s.propDep,function(kr,on){var Gr=kr.shared.context;return[0,0,on.def(Gr,".",Gs),on.def(Gr,".",Lo)]}):null}var K=N(Mo);if(K){var ee=K;K=new Ta(K.thisDep,K.contextDep,K.propDep,function(Z,Se){var pe=ee.append(Z,Se),Fe=Z.shared.context;return Se.set(Fe,"."+Vc,pe[2]),Se.set(Fe,"."+gs,pe[3]),pe})}return{viewport:K,scissor_box:N(bu)}}function Ci(p,s){var d=p.static,g=typeof d[bo]=="string"&&typeof d[Jo]=="string";if(g){if(Object.keys(s.dynamic).length>0)return null;var L=s.static,N=Object.keys(L);if(N.length>0&&typeof L[N[0]]=="number"){for(var K=[],ee=0;ee<N.length;++ee)$(typeof L[N[ee]]=="number","must specify all vertex attribute locations when using vaos"),K.push([L[N[ee]]|0,N[ee]]);return K}}return null}function ki(p,s,d){var g=p.static,L=p.dynamic;function N(pe){if(pe in g){var Fe=Be.id(g[pe]);$.optional(function(){Qr.shader(Vo[pe],Fe,$.guessCommand())});var mt=bi(function(){return Fe});return mt.id=Fe,mt}else if(pe in L){var Yt=L[pe];return Do(Yt,function(jt,Qt){var ur=jt.invoke(Qt,Yt),kr=Qt.def(jt.shared.strings,".id(",ur,")");return $.optional(function(){Qt(jt.shared.shader,".shader(",Vo[pe],",",kr,",",jt.command,");")}),kr})}return null}var K=N(bo),ee=N(Jo),Z=null,Se;return Ua(K)&&Ua(ee)?(Z=Qr.program(ee.id,K.id,null,d),Se=bi(function(pe,Fe){return pe.link(Z)})):Se=new Ta(K&&K.thisDep||ee&&ee.thisDep,K&&K.contextDep||ee&&ee.contextDep,K&&K.propDep||ee&&ee.propDep,function(pe,Fe){var mt=pe.shared.shader,Yt;K?Yt=K.append(pe,Fe):Yt=Fe.def(mt,".",bo);var jt;ee?jt=ee.append(pe,Fe):jt=Fe.def(mt,".",Jo);var Qt=mt+".program("+jt+","+Yt;return $.optional(function(){Qt+=","+pe.command}),Fe.def(Qt+")")}),{frag:K,vert:ee,progVar:Se,program:Z}}function ca(p,s){var d=p.static,g=p.dynamic;function L(){if(Uo in d){var pe=d[Uo];fo(pe)?pe=Cr.getElements(Cr.create(pe,!0)):pe&&(pe=Cr.getElements(pe),$.command(pe,"invalid elements",s.commandStr));var Fe=bi(function(Yt,jt){if(pe){var Qt=Yt.link(pe);return Yt.ELEMENTS=Qt,Qt}return Yt.ELEMENTS=null,null});return Fe.value=pe,Fe}else if(Uo in g){var mt=g[Uo];return Do(mt,function(Yt,jt){var Qt=Yt.shared,ur=Qt.isBufferArgs,kr=Qt.elements,on=Yt.invoke(jt,mt),Gr=jt.def("null"),ln=jt.def(ur,"(",on,")"),wn=Yt.cond(ln).then(Gr,"=",kr,".createStream(",on,");").else(Gr,"=",kr,".getElements(",on,");");return $.optional(function(){Yt.assert(wn.else,"!"+on+"||"+Gr,"invalid elements")}),jt.entry(wn),jt.exit(Yt.cond(ln).then(kr,".destroyStream(",Gr,");")),Yt.ELEMENTS=Gr,Gr})}return null}var N=L();function K(){if(Vs in d){var pe=d[Vs];return $.commandParameter(pe,ha,"invalid primitve",s.commandStr),bi(function(mt,Yt){return ha[pe]})}else if(Vs in g){var Fe=g[Vs];return Do(Fe,function(mt,Yt){var jt=mt.constants.primTypes,Qt=mt.invoke(Yt,Fe);return $.optional(function(){mt.assert(Yt,Qt+" in "+jt,"invalid primitive, must be one of "+Object.keys(ha))}),Yt.def(jt,"[",Qt,"]")})}else if(N)return Ua(N)?N.value?bi(function(mt,Yt){return Yt.def(mt.ELEMENTS,".primType")}):bi(function(){return V}):new Ta(N.thisDep,N.contextDep,N.propDep,function(mt,Yt){var jt=mt.ELEMENTS;return Yt.def(jt,"?",jt,".primType:",V)});return null}function ee(pe,Fe){if(pe in d){var mt=d[pe]|0;return $.command(!Fe||mt>=0,"invalid "+pe,s.commandStr),bi(function(jt,Qt){return Fe&&(jt.OFFSET=mt),mt})}else if(pe in g){var Yt=g[pe];return Do(Yt,function(jt,Qt){var ur=jt.invoke(Qt,Yt);return Fe&&(jt.OFFSET=ur,$.optional(function(){jt.assert(Qt,ur+">=0","invalid "+pe)})),ur})}else if(Fe&&N)return bi(function(jt,Qt){return jt.OFFSET="0",0});return null}var Z=ee(Uc,!0);function Se(){if(wl in d){var pe=d[wl]|0;return $.command(typeof pe=="number"&&pe>=0,"invalid vertex count",s.commandStr),bi(function(){return pe})}else if(wl in g){var Fe=g[wl];return Do(Fe,function(jt,Qt){var ur=jt.invoke(Qt,Fe);return $.optional(function(){jt.assert(Qt,"typeof "+ur+'==="number"&&'+ur+">=0&&"+ur+"===("+ur+"|0)","invalid vertex count")}),ur})}else if(N)if(Ua(N)){if(N)return Z?new Ta(Z.thisDep,Z.contextDep,Z.propDep,function(jt,Qt){var ur=Qt.def(jt.ELEMENTS,".vertCount-",jt.OFFSET);return $.optional(function(){jt.assert(Qt,ur+">=0","invalid vertex offset/element buffer too small")}),ur}):bi(function(jt,Qt){return Qt.def(jt.ELEMENTS,".vertCount")});var mt=bi(function(){return-1});return $.optional(function(){mt.MISSING=!0}),mt}else{var Yt=new Ta(N.thisDep||Z.thisDep,N.contextDep||Z.contextDep,N.propDep||Z.propDep,function(jt,Qt){var ur=jt.ELEMENTS;return jt.OFFSET?Qt.def(ur,"?",ur,".vertCount-",jt.OFFSET,":-1"):Qt.def(ur,"?",ur,".vertCount:-1")});return $.optional(function(){Yt.DYNAMIC=!0}),Yt}return null}return{elements:N,primitive:K(),count:Se(),instances:ee(Vl,!1),offset:Z}}function Go(p,s){var d=p.static,g=p.dynamic,L={};return Jr.forEach(function(N){var K=Kr(N);function ee(Z,Se){if(N in d){var pe=Z(d[N]);L[K]=bi(function(){return pe})}else if(N in g){var Fe=g[N];L[K]=Do(Fe,function(mt,Yt){return Se(mt,Yt,mt.invoke(Yt,Fe))})}}switch(N){case xo:case ri:case Ti:case sc:case Pa:case Du:case Ts:case ac:case $u:case Wa:return ee(function(Z){return $.commandType(Z,"boolean",N,s.commandStr),Z},function(Z,Se,pe){return $.optional(function(){Z.assert(Se,"typeof "+pe+'==="boolean"',"invalid flag "+N,Z.commandStr)}),pe});case yo:return ee(function(Z){return $.commandParameter(Z,So,"invalid "+N,s.commandStr),So[Z]},function(Z,Se,pe){var Fe=Z.constants.compareFuncs;return $.optional(function(){Z.assert(Se,pe+" in "+Fe,"invalid "+N+", must be one of "+Object.keys(So))}),Se.def(Fe,"[",pe,"]")});case Ea:return ee(function(Z){return $.command(Qa(Z)&&Z.length===2&&typeof Z[0]=="number"&&typeof Z[1]=="number"&&Z[0]<=Z[1],"depth range is 2d array",s.commandStr),Z},function(Z,Se,pe){$.optional(function(){Z.assert(Se,Z.shared.isArrayLike+"("+pe+")&&"+pe+".length===2&&typeof "+pe+'[0]==="number"&&typeof '+pe+'[1]==="number"&&'+pe+"[0]<="+pe+"[1]","depth range must be a 2d array")});var Fe=Se.def("+",pe,"[0]"),mt=Se.def("+",pe,"[1]");return[Fe,mt]});case qa:return ee(function(Z){$.commandType(Z,"object","blend.func",s.commandStr);var Se="srcRGB"in Z?Z.srcRGB:Z.src,pe="srcAlpha"in Z?Z.srcAlpha:Z.src,Fe="dstRGB"in Z?Z.dstRGB:Z.dst,mt="dstAlpha"in Z?Z.dstAlpha:Z.dst;return $.commandParameter(Se,ja,K+".srcRGB",s.commandStr),$.commandParameter(pe,ja,K+".srcAlpha",s.commandStr),$.commandParameter(Fe,ja,K+".dstRGB",s.commandStr),$.commandParameter(mt,ja,K+".dstAlpha",s.commandStr),$.command(Ro.indexOf(Se+", "+Fe)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Se+", "+Fe+")",s.commandStr),[ja[Se],ja[Fe],ja[pe],ja[mt]]},function(Z,Se,pe){var Fe=Z.constants.blendFuncs;$.optional(function(){Z.assert(Se,pe+"&&typeof "+pe+'==="object"',"invalid blend func, must be an object")});function mt(Gr,ln){var wn=Se.def('"',Gr,ln,'" in ',pe,"?",pe,".",Gr,ln,":",pe,".",Gr);return $.optional(function(){Z.assert(Se,wn+" in "+Fe,"invalid "+N+"."+Gr+ln+", must be one of "+Object.keys(ja))}),wn}var Yt=mt("src","RGB"),jt=mt("dst","RGB");$.optional(function(){var Gr=Z.constants.invalidBlendCombinations;Z.assert(Se,Gr+".indexOf("+Yt+'+", "+'+jt+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Qt=Se.def(Fe,"[",Yt,"]"),ur=Se.def(Fe,"[",mt("src","Alpha"),"]"),kr=Se.def(Fe,"[",jt,"]"),on=Se.def(Fe,"[",mt("dst","Alpha"),"]");return[Qt,kr,ur,on]});case Bi:return ee(function(Z){if(typeof Z=="string")return $.commandParameter(Z,vr,"invalid "+N,s.commandStr),[vr[Z],vr[Z]];if(typeof Z=="object")return $.commandParameter(Z.rgb,vr,N+".rgb",s.commandStr),$.commandParameter(Z.alpha,vr,N+".alpha",s.commandStr),[vr[Z.rgb],vr[Z.alpha]];$.commandRaise("invalid blend.equation",s.commandStr)},function(Z,Se,pe){var Fe=Z.constants.blendEquations,mt=Se.def(),Yt=Se.def(),jt=Z.cond("typeof ",pe,'==="string"');return $.optional(function(){function Qt(ur,kr,on){Z.assert(ur,on+" in "+Fe,"invalid "+kr+", must be one of "+Object.keys(vr))}Qt(jt.then,N,pe),Z.assert(jt.else,pe+"&&typeof "+pe+'==="object"',"invalid "+N),Qt(jt.else,N+".rgb",pe+".rgb"),Qt(jt.else,N+".alpha",pe+".alpha")}),jt.then(mt,"=",Yt,"=",Fe,"[",pe,"];"),jt.else(mt,"=",Fe,"[",pe,".rgb];",Yt,"=",Fe,"[",pe,".alpha];"),Se(jt),[mt,Yt]});case Ii:return ee(function(Z){return $.command(Qa(Z)&&Z.length===4,"blend.color must be a 4d array",s.commandStr),H(4,function(Se){return+Z[Se]})},function(Z,Se,pe){return $.optional(function(){Z.assert(Se,Z.shared.isArrayLike+"("+pe+")&&"+pe+".length===4","blend.color must be a 4d array")}),H(4,function(Fe){return Se.def("+",pe,"[",Fe,"]")})});case Ru:return ee(function(Z){return $.commandType(Z,"number",K,s.commandStr),Z|0},function(Z,Se,pe){return $.optional(function(){Z.assert(Se,"typeof "+pe+'==="number"',"invalid stencil.mask")}),Se.def(pe,"|0")});case dl:return ee(function(Z){$.commandType(Z,"object",K,s.commandStr);var Se=Z.cmp||"keep",pe=Z.ref||0,Fe="mask"in Z?Z.mask:-1;return $.commandParameter(Se,So,N+".cmp",s.commandStr),$.commandType(pe,"number",N+".ref",s.commandStr),$.commandType(Fe,"number",N+".mask",s.commandStr),[So[Se],pe,Fe]},function(Z,Se,pe){var Fe=Z.constants.compareFuncs;$.optional(function(){function Qt(){Z.assert(Se,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Qt(pe+"&&typeof ",pe,'==="object"'),Qt('!("cmp" in ',pe,")||(",pe,".cmp in ",Fe,")")});var mt=Se.def('"cmp" in ',pe,"?",Fe,"[",pe,".cmp]",":",zn),Yt=Se.def(pe,".ref|0"),jt=Se.def('"mask" in ',pe,"?",pe,".mask|0:-1");return[mt,Yt,jt]});case As:case co:return ee(function(Z){$.commandType(Z,"object",K,s.commandStr);var Se=Z.fail||"keep",pe=Z.zfail||"keep",Fe=Z.zpass||"keep";return $.commandParameter(Se,Ya,N+".fail",s.commandStr),$.commandParameter(pe,Ya,N+".zfail",s.commandStr),$.commandParameter(Fe,Ya,N+".zpass",s.commandStr),[N===co?ut:_e,Ya[Se],Ya[pe],Ya[Fe]]},function(Z,Se,pe){var Fe=Z.constants.stencilOps;$.optional(function(){Z.assert(Se,pe+"&&typeof "+pe+'==="object"',"invalid "+N)});function mt(Yt){return $.optional(function(){Z.assert(Se,'!("'+Yt+'" in '+pe+")||("+pe+"."+Yt+" in "+Fe+")","invalid "+N+"."+Yt+", must be one of "+Object.keys(Ya))}),Se.def('"',Yt,'" in ',pe,"?",Fe,"[",pe,".",Yt,"]:",zn)}return[N===co?ut:_e,mt("fail"),mt("zfail"),mt("zpass")]});case Lu:return ee(function(Z){$.commandType(Z,"object",K,s.commandStr);var Se=Z.factor|0,pe=Z.units|0;return $.commandType(Se,"number",K+".factor",s.commandStr),$.commandType(pe,"number",K+".units",s.commandStr),[Se,pe]},function(Z,Se,pe){$.optional(function(){Z.assert(Se,pe+"&&typeof "+pe+'==="object"',"invalid "+N)});var Fe=Se.def(pe,".factor|0"),mt=Se.def(pe,".units|0");return[Fe,mt]});case yu:return ee(function(Z){var Se=0;return Z==="front"?Se=_e:Z==="back"&&(Se=ut),$.command(!!Se,K,s.commandStr),Se},function(Z,Se,pe){return $.optional(function(){Z.assert(Se,pe+'==="front"||'+pe+'==="back"',"invalid cull.face")}),Se.def(pe,'==="front"?',_e,":",ut)});case jo:return ee(function(Z){return $.command(typeof Z=="number"&&Z>=gr.lineWidthDims[0]&&Z<=gr.lineWidthDims[1],"invalid line width, must be a positive number between "+gr.lineWidthDims[0]+" and "+gr.lineWidthDims[1],s.commandStr),Z},function(Z,Se,pe){return $.optional(function(){Z.assert(Se,"typeof "+pe+'==="number"&&'+pe+">="+gr.lineWidthDims[0]+"&&"+pe+"<="+gr.lineWidthDims[1],"invalid line width")}),pe});case xu:return ee(function(Z){return $.commandParameter(Z,ea,K,s.commandStr),ea[Z]},function(Z,Se,pe){return $.optional(function(){Z.assert(Se,pe+'==="cw"||'+pe+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Se.def(pe+'==="cw"?'+Ht+":"+ir)});case Ds:return ee(function(Z){return $.command(Qa(Z)&&Z.length===4,"color.mask must be length 4 array",s.commandStr),Z.map(function(Se){return!!Se})},function(Z,Se,pe){return $.optional(function(){Z.assert(Se,Z.shared.isArrayLike+"("+pe+")&&"+pe+".length===4","invalid color.mask")}),H(4,function(Fe){return"!!"+pe+"["+Fe+"]"})});case oc:return ee(function(Z){$.command(typeof Z=="object"&&Z,K,s.commandStr);var Se="value"in Z?Z.value:1,pe=!!Z.invert;return $.command(typeof Se=="number"&&Se>=0&&Se<=1,"sample.coverage.value must be a number between 0 and 1",s.commandStr),[Se,pe]},function(Z,Se,pe){$.optional(function(){Z.assert(Se,pe+"&&typeof "+pe+'==="object"',"invalid sample.coverage")});var Fe=Se.def('"value" in ',pe,"?+",pe,".value:1"),mt=Se.def("!!",pe,".invert");return[Fe,mt]})}}),L}function Ho(p,s){var d=p.static,g=p.dynamic,L={};return Object.keys(d).forEach(function(N){var K=d[N],ee;if(typeof K=="number"||typeof K=="boolean")ee=bi(function(){return K});else if(typeof K=="function"){var Z=K._reglType;Z==="texture2d"||Z==="textureCube"?ee=bi(function(Se){return Se.link(K)}):Z==="framebuffer"||Z==="framebufferCube"?($.command(K.color.length>0,'missing color attachment for framebuffer sent to uniform "'+N+'"',s.commandStr),ee=bi(function(Se){return Se.link(K.color[0])})):$.commandRaise('invalid data for uniform "'+N+'"',s.commandStr)}else Qa(K)?ee=bi(function(Se){var pe=Se.global.def("[",H(K.length,function(Fe){return $.command(typeof K[Fe]=="number"||typeof K[Fe]=="boolean","invalid uniform "+N,Se.commandStr),K[Fe]}),"]");return pe}):$.commandRaise('invalid or missing data for uniform "'+N+'"',s.commandStr);ee.value=K,L[N]=ee}),Object.keys(g).forEach(function(N){var K=g[N];L[N]=Do(K,function(ee,Z){return ee.invoke(Z,K)})}),L}function ta(p,s){var d=p.static,g=p.dynamic,L={};return Object.keys(d).forEach(function(N){var K=d[N],ee=Be.id(N),Z=new yr;if(fo(K))Z.state=On,Z.buffer=Mr.getBuffer(Mr.create(K,Qu,!1,!0)),Z.type=0;else{var Se=Mr.getBuffer(K);if(Se)Z.state=On,Z.buffer=Se,Z.type=0;else if($.command(typeof K=="object"&&K,"invalid data for attribute "+N,s.commandStr),"constant"in K){var pe=K.constant;Z.buffer="null",Z.state=Qn,typeof pe=="number"?Z.x=pe:($.command(Qa(pe)&&pe.length>0&&pe.length<=4,"invalid constant for attribute "+N,s.commandStr),Yr.forEach(function(kr,on){on<pe.length&&(Z[kr]=pe[on])}))}else{fo(K.buffer)?Se=Mr.getBuffer(Mr.create(K.buffer,Qu,!1,!0)):Se=Mr.getBuffer(K.buffer),$.command(!!Se,'missing buffer for attribute "'+N+'"',s.commandStr);var Fe=K.offset|0;$.command(Fe>=0,'invalid offset for attribute "'+N+'"',s.commandStr);var mt=K.stride|0;$.command(mt>=0&&mt<256,'invalid stride for attribute "'+N+'", must be integer betweeen [0, 255]',s.commandStr);var Yt=K.size|0;$.command(!("size"in K)||Yt>0&&Yt<=4,'invalid size for attribute "'+N+'", must be 1,2,3,4',s.commandStr);var jt=!!K.normalized,Qt=0;"type"in K&&($.commandParameter(K.type,uo,"invalid type for attribute "+N,s.commandStr),Qt=uo[K.type]);var ur=K.divisor|0;"divisor"in K&&($.command(ur===0||Xr,'cannot specify divisor for attribute "'+N+'", instancing not supported',s.commandStr),$.command(ur>=0,'invalid divisor for attribute "'+N+'"',s.commandStr)),$.optional(function(){var kr=s.commandStr,on=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(K).forEach(function(Gr){$.command(on.indexOf(Gr)>=0,'unknown parameter "'+Gr+'" for attribute pointer "'+N+'" (valid parameters are '+on+")",kr)})}),Z.buffer=Se,Z.state=On,Z.size=Yt,Z.normalized=jt,Z.type=Qt||Se.dtype,Z.offset=Fe,Z.stride=mt,Z.divisor=ur}}L[N]=bi(function(kr,on){var Gr=kr.attribCache;if(ee in Gr)return Gr[ee];var ln={isStream:!1};return Object.keys(Z).forEach(function(wn){ln[wn]=Z[wn]}),Z.buffer&&(ln.buffer=kr.link(Z.buffer),ln.type=ln.type||ln.buffer+".dtype"),Gr[ee]=ln,ln})}),Object.keys(g).forEach(function(N){var K=g[N];function ee(Z,Se){var pe=Z.invoke(Se,K),Fe=Z.shared,mt=Z.constants,Yt=Fe.isBufferArgs,jt=Fe.buffer;$.optional(function(){Z.assert(Se,pe+"&&(typeof "+pe+'==="object"||typeof '+pe+'==="function")&&('+Yt+"("+pe+")||"+jt+".getBuffer("+pe+")||"+jt+".getBuffer("+pe+".buffer)||"+Yt+"("+pe+'.buffer)||("constant" in '+pe+"&&(typeof "+pe+'.constant==="number"||'+Fe.isArrayLike+"("+pe+".constant))))",'invalid dynamic attribute "'+N+'"')});var Qt={isStream:Se.def(!1)},ur=new yr;ur.state=On,Object.keys(ur).forEach(function(ln){Qt[ln]=Se.def(""+ur[ln])});var kr=Qt.buffer,on=Qt.type;Se("if(",Yt,"(",pe,")){",Qt.isStream,"=true;",kr,"=",jt,".createStream(",Qu,",",pe,");",on,"=",kr,".dtype;","}else{",kr,"=",jt,".getBuffer(",pe,");","if(",kr,"){",on,"=",kr,".dtype;",'}else if("constant" in ',pe,"){",Qt.state,"=",Qn,";","if(typeof "+pe+'.constant === "number"){',Qt[Yr[0]],"=",pe,".constant;",Yr.slice(1).map(function(ln){return Qt[ln]}).join("="),"=0;","}else{",Yr.map(function(ln,wn){return Qt[ln]+"="+pe+".constant.length>"+wn+"?"+pe+".constant["+wn+"]:0;"}).join(""),"}}else{","if(",Yt,"(",pe,".buffer)){",kr,"=",jt,".createStream(",Qu,",",pe,".buffer);","}else{",kr,"=",jt,".getBuffer(",pe,".buffer);","}",on,'="type" in ',pe,"?",mt.glTypes,"[",pe,".type]:",kr,".dtype;",Qt.normalized,"=!!",pe,".normalized;");function Gr(ln){Se(Qt[ln],"=",pe,".",ln,"|0;")}return Gr("size"),Gr("offset"),Gr("stride"),Gr("divisor"),Se("}}"),Se.exit("if(",Qt.isStream,"){",jt,".destroyStream(",kr,");","}"),Qt}L[N]=Do(K,ee)}),L}function ho(p,s){var d=p.static,g=p.dynamic;if(Ju in d){var L=d[Ju];return L!==null&&en.getVAO(L)===null&&(L=en.createVAO(L)),bi(function(K){return K.link(en.getVAO(L))})}else if(Ju in g){var N=g[Ju];return Do(N,function(K,ee){var Z=K.invoke(ee,N);return ee.def(K.shared.vao+".getVAO("+Z+")")})}return null}function Ma(p){var s=p.static,d=p.dynamic,g={};return Object.keys(s).forEach(function(L){var N=s[L];g[L]=bi(function(K,ee){return typeof N=="number"||typeof N=="boolean"?""+N:K.link(N)})}),Object.keys(d).forEach(function(L){var N=d[L];g[L]=Do(N,function(K,ee){return K.invoke(ee,N)})}),g}function _s(p,s,d,g,L){var N=p.static,K=p.dynamic;$.optional(function(){var Gr=[Oo,Jo,bo,Uo,Vs,Uc,wl,Vl,Io,Ju].concat(Jr);function ln(wn){Object.keys(wn).forEach(function(Gn){$.command(Gr.indexOf(Gn)>=0,'unknown parameter "'+Gn+'"',L.commandStr)})}ln(N),ln(K)});var ee=Ci(p,s),Z=kn(p,L),Se=Ni(p,Z,L),pe=ca(p,L),Fe=Go(p,L),mt=ki(p,L,ee);function Yt(Gr){var ln=Se[Gr];ln&&(Fe[Gr]=ln)}Yt(Mo),Yt(Kr(bu));var jt=Object.keys(Fe).length>0,Qt={framebuffer:Z,draw:pe,shader:mt,state:Fe,dirty:jt,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Qt.profile=pi(p,L),Qt.uniforms=Ho(d,L),Qt.drawVAO=Qt.scopeVAO=ho(p,L),!Qt.drawVAO&&mt.program&&!ee&&Et.angle_instanced_arrays){var ur=!0,kr=mt.program.attributes.map(function(Gr){var ln=s.static[Gr];return ur=ur&&!!ln,ln});if(ur&&kr.length>0){var on=en.getVAO(en.createVAO(kr));Qt.drawVAO=new Ta(null,null,null,function(Gr,ln){return Gr.link(on)}),Qt.useVAO=!0}}return ee?Qt.useVAO=!0:Qt.attributes=ta(s,L),Qt.context=Ma(g,L),Qt}function Qo(p,s,d){var g=p.shared,L=g.context,N=p.scope();Object.keys(d).forEach(function(K){s.save(L,"."+K);var ee=d[K],Z=ee.append(p,s);Array.isArray(Z)?N(L,".",K,"=[",Z.join(),"];"):N(L,".",K,"=",Z,";")}),s(N)}function ys(p,s,d,g){var L=p.shared,N=L.gl,K=L.framebuffer,ee;Pn&&(ee=s.def(L.extensions,".webgl_draw_buffers"));var Z=p.constants,Se=Z.drawBuffer,pe=Z.backBuffer,Fe;d?Fe=d.append(p,s):Fe=s.def(K,".next"),g||s("if(",Fe,"!==",K,".cur){"),s("if(",Fe,"){",N,".bindFramebuffer(",la,",",Fe,".framebuffer);"),Pn&&s(ee,".drawBuffersWEBGL(",Se,"[",Fe,".colorAttachments.length]);"),s("}else{",N,".bindFramebuffer(",la,",null);"),Pn&&s(ee,".drawBuffersWEBGL(",pe,");"),s("}",K,".cur=",Fe,";"),g||s("}")}function qo(p,s,d){var g=p.shared,L=g.gl,N=p.current,K=p.next,ee=g.current,Z=g.next,Se=p.cond(ee,".dirty");Jr.forEach(function(pe){var Fe=Kr(pe);if(!(Fe in d.state)){var mt,Yt;if(Fe in K){mt=K[Fe],Yt=N[Fe];var jt=H(Lr[Fe].length,function(ur){return Se.def(mt,"[",ur,"]")});Se(p.cond(jt.map(function(ur,kr){return ur+"!=="+Yt+"["+kr+"]"}).join("||")).then(L,".",Ur[Fe],"(",jt,");",jt.map(function(ur,kr){return Yt+"["+kr+"]="+ur}).join(";"),";"))}else{mt=Se.def(Z,".",Fe);var Qt=p.cond(mt,"!==",ee,".",Fe);Se(Qt),Fe in Br?Qt(p.cond(mt).then(L,".enable(",Br[Fe],");").else(L,".disable(",Br[Fe],");"),ee,".",Fe,"=",mt,";"):Qt(L,".",Ur[Fe],"(",mt,");",ee,".",Fe,"=",mt,";")}}}),Object.keys(d.state).length===0&&Se(ee,".dirty=false;"),s(Se)}function Hs(p,s,d,g){var L=p.shared,N=p.current,K=L.current,ee=L.gl;iu(Object.keys(d)).forEach(function(Z){var Se=d[Z];if(!(g&&!g(Se))){var pe=Se.append(p,s);if(Br[Z]){var Fe=Br[Z];Ua(Se)?pe?s(ee,".enable(",Fe,");"):s(ee,".disable(",Fe,");"):s(p.cond(pe).then(ee,".enable(",Fe,");").else(ee,".disable(",Fe,");")),s(K,".",Z,"=",pe,";")}else if(Qa(pe)){var mt=N[Z];s(ee,".",Ur[Z],"(",pe,");",pe.map(function(Yt,jt){return mt+"["+jt+"]="+Yt}).join(";"),";")}else s(ee,".",Ur[Z],"(",pe,");",K,".",Z,"=",pe,";")}})}function zo(p,s){Xr&&(p.instancing=s.def(p.shared.extensions,".angle_instanced_arrays"))}function ui(p,s,d,g,L){var N=p.shared,K=p.stats,ee=N.current,Z=N.timer,Se=d.profile;function pe(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Fe,mt;function Yt(Gr){Fe=s.def(),Gr(Fe,"=",pe(),";"),typeof L=="string"?Gr(K,".count+=",L,";"):Gr(K,".count++;"),cn&&(g?(mt=s.def(),Gr(mt,"=",Z,".getNumPendingQueries();")):Gr(Z,".beginQuery(",K,");"))}function jt(Gr){Gr(K,".cpuTime+=",pe(),"-",Fe,";"),cn&&(g?Gr(Z,".pushScopeStats(",mt,",",Z,".getNumPendingQueries(),",K,");"):Gr(Z,".endQuery();"))}function Qt(Gr){var ln=s.def(ee,".profile");s(ee,".profile=",Gr,";"),s.exit(ee,".profile=",ln,";")}var ur;if(Se){if(Ua(Se)){Se.enable?(Yt(s),jt(s.exit),Qt("true")):Qt("false");return}ur=Se.append(p,s),Qt(ur)}else ur=s.def(ee,".profile");var kr=p.block();Yt(kr),s("if(",ur,"){",kr,"}");var on=p.block();jt(on),s.exit("if(",ur,"){",on,"}")}function Zs(p,s,d,g,L){var N=p.shared;function K(Z){switch(Z){case uf:case Gc:case Tf:return 2;case ao:case nu:case Hc:return 3;case Gl:case Pl:case cf:return 4;default:return 1}}function ee(Z,Se,pe){var Fe=N.gl,mt=s.def(Z,".location"),Yt=s.def(N.attributes,"[",mt,"]"),jt=pe.state,Qt=pe.buffer,ur=[pe.x,pe.y,pe.z,pe.w],kr=["buffer","normalized","offset","stride"];function on(){s("if(!",Yt,".buffer){",Fe,".enableVertexAttribArray(",mt,");}");var ln=pe.type,wn;if(pe.size?wn=s.def(pe.size,"||",Se):wn=Se,s("if(",Yt,".type!==",ln,"||",Yt,".size!==",wn,"||",kr.map(function(ii){return Yt+"."+ii+"!=="+pe[ii]}).join("||"),"){",Fe,".bindBuffer(",Qu,",",Qt,".buffer);",Fe,".vertexAttribPointer(",[mt,wn,ln,pe.normalized,pe.stride,pe.offset],");",Yt,".type=",ln,";",Yt,".size=",wn,";",kr.map(function(ii){return Yt+"."+ii+"="+pe[ii]+";"}).join(""),"}"),Xr){var Gn=pe.divisor;s("if(",Yt,".divisor!==",Gn,"){",p.instancing,".vertexAttribDivisorANGLE(",[mt,Gn],");",Yt,".divisor=",Gn,";}")}}function Gr(){s("if(",Yt,".buffer){",Fe,".disableVertexAttribArray(",mt,");",Yt,".buffer=null;","}if(",Yr.map(function(ln,wn){return Yt+"."+ln+"!=="+ur[wn]}).join("||"),"){",Fe,".vertexAttrib4f(",mt,",",ur,");",Yr.map(function(ln,wn){return Yt+"."+ln+"="+ur[wn]+";"}).join(""),"}")}jt===On?on():jt===Qn?Gr():(s("if(",jt,"===",On,"){"),on(),s("}else{"),Gr(),s("}"))}g.forEach(function(Z){var Se=Z.name,pe=d.attributes[Se],Fe;if(pe){if(!L(pe))return;Fe=pe.append(p,s)}else{if(!L(fc))return;var mt=p.scopeAttrib(Se);$.optional(function(){p.assert(s,mt+".state","missing attribute "+Se)}),Fe={},Object.keys(new yr).forEach(function(Yt){Fe[Yt]=s.def(mt,".",Yt)})}ee(p.link(Z),K(Z.info.type),Fe)})}function Aa(p,s,d,g,L){for(var N=p.shared,K=N.gl,ee,Z=0;Z<g.length;++Z){var Se=g[Z],pe=Se.name,Fe=Se.info.type,mt=d.uniforms[pe],Yt=p.link(Se),jt=Yt+".location",Qt;if(mt){if(!L(mt))continue;if(Ua(mt)){var ur=mt.value;if($.command(ur!==null&&typeof ur!="undefined",'missing uniform "'+pe+'"',p.commandStr),Fe===se||Fe===z){$.command(typeof ur=="function"&&(Fe===se&&(ur._reglType==="texture2d"||ur._reglType==="framebuffer")||Fe===z&&(ur._reglType==="textureCube"||ur._reglType==="framebufferCube")),"invalid texture for uniform "+pe,p.commandStr);var kr=p.link(ur._texture||ur.color[0]._texture);s(K,".uniform1i(",jt,",",kr+".bind());"),s.exit(kr,".unbind();")}else if(Fe===Zc||Fe===Hl||Fe===ne){$.optional(function(){$.command(Qa(ur),"invalid matrix for uniform "+pe,p.commandStr),$.command(Fe===Zc&&ur.length===4||Fe===Hl&&ur.length===9||Fe===ne&&ur.length===16,"invalid length for matrix uniform "+pe,p.commandStr)});var on=p.global.def("new Float32Array(["+Array.prototype.slice.call(ur)+"])"),Gr=2;Fe===Hl?Gr=3:Fe===ne&&(Gr=4),s(K,".uniformMatrix",Gr,"fv(",jt,",false,",on,");")}else{switch(Fe){case cc:$.commandType(ur,"number","uniform "+pe,p.commandStr),ee="1f";break;case uf:$.command(Qa(ur)&&ur.length===2,"uniform "+pe,p.commandStr),ee="2f";break;case ao:$.command(Qa(ur)&&ur.length===3,"uniform "+pe,p.commandStr),ee="3f";break;case Gl:$.command(Qa(ur)&&ur.length===4,"uniform "+pe,p.commandStr),ee="4f";break;case Ef:$.commandType(ur,"boolean","uniform "+pe,p.commandStr),ee="1i";break;case lf:$.commandType(ur,"number","uniform "+pe,p.commandStr),ee="1i";break;case Tf:$.command(Qa(ur)&&ur.length===2,"uniform "+pe,p.commandStr),ee="2i";break;case Gc:$.command(Qa(ur)&&ur.length===2,"uniform "+pe,p.commandStr),ee="2i";break;case Hc:$.command(Qa(ur)&&ur.length===3,"uniform "+pe,p.commandStr),ee="3i";break;case nu:$.command(Qa(ur)&&ur.length===3,"uniform "+pe,p.commandStr),ee="3i";break;case cf:$.command(Qa(ur)&&ur.length===4,"uniform "+pe,p.commandStr),ee="4i";break;case Pl:$.command(Qa(ur)&&ur.length===4,"uniform "+pe,p.commandStr),ee="4i";break}s(K,".uniform",ee,"(",jt,",",Qa(ur)?Array.prototype.slice.call(ur):ur,");")}continue}else Qt=mt.append(p,s)}else{if(!L(fc))continue;Qt=s.def(N.uniforms,"[",Be.id(pe),"]")}Fe===se?($(!Array.isArray(Qt),"must specify a scalar prop for textures"),s("if(",Qt,"&&",Qt,'._reglType==="framebuffer"){',Qt,"=",Qt,".color[0];","}")):Fe===z&&($(!Array.isArray(Qt),"must specify a scalar prop for cube maps"),s("if(",Qt,"&&",Qt,'._reglType==="framebufferCube"){',Qt,"=",Qt,".color[0];","}")),$.optional(function(){function Vi(ts,us){p.assert(s,ts,'bad data or missing for uniform "'+pe+'".  '+us)}function va(ts){$(!Array.isArray(Qt),"must not specify an array type for uniform"),Vi("typeof "+Qt+'==="'+ts+'"',"invalid type, expected "+ts)}function Ia(ts,us){Array.isArray(Qt)?$(Qt.length===ts,"must have length "+ts):Vi(N.isArrayLike+"("+Qt+")&&"+Qt+".length==="+ts,"invalid vector, should have length "+ts,p.commandStr)}function qu(ts){$(!Array.isArray(Qt),"must not specify a value type"),Vi("typeof "+Qt+'==="function"&&'+Qt+'._reglType==="texture'+(ts===Fu?"2d":"Cube")+'"',"invalid texture type",p.commandStr)}switch(Fe){case lf:va("number");break;case Gc:Ia(2,"number");break;case nu:Ia(3,"number");break;case Pl:Ia(4,"number");break;case cc:va("number");break;case uf:Ia(2,"number");break;case ao:Ia(3,"number");break;case Gl:Ia(4,"number");break;case Ef:va("boolean");break;case Tf:Ia(2,"boolean");break;case Hc:Ia(3,"boolean");break;case cf:Ia(4,"boolean");break;case Zc:Ia(4,"number");break;case Hl:Ia(9,"number");break;case ne:Ia(16,"number");break;case se:qu(Fu);break;case z:qu(lc);break}});var ln=1;switch(Fe){case se:case z:var wn=s.def(Qt,"._texture");s(K,".uniform1i(",jt,",",wn,".bind());"),s.exit(wn,".unbind();");continue;case lf:case Ef:ee="1i";break;case Gc:case Tf:ee="2i",ln=2;break;case nu:case Hc:ee="3i",ln=3;break;case Pl:case cf:ee="4i",ln=4;break;case cc:ee="1f";break;case uf:ee="2f",ln=2;break;case ao:ee="3f",ln=3;break;case Gl:ee="4f",ln=4;break;case Zc:ee="Matrix2fv";break;case Hl:ee="Matrix3fv";break;case ne:ee="Matrix4fv";break}if(s(K,".uniform",ee,"(",jt,","),ee.charAt(0)==="M"){var Gn=Math.pow(Fe-Zc+2,2),ii=p.global.def("new Float32Array(",Gn,")");Array.isArray(Qt)?s("false,(",H(Gn,function(Vi){return ii+"["+Vi+"]="+Qt[Vi]}),",",ii,")"):s("false,(Array.isArray(",Qt,")||",Qt," instanceof Float32Array)?",Qt,":(",H(Gn,function(Vi){return ii+"["+Vi+"]="+Qt+"["+Vi+"]"}),",",ii,")")}else ln>1?s(H(ln,function(Vi){return Array.isArray(Qt)?Qt[Vi]:Qt+"["+Vi+"]"})):($(!Array.isArray(Qt),"uniform value must not be an array"),s(Qt));s(");")}}function bn(p,s,d,g){var L=p.shared,N=L.gl,K=L.draw,ee=g.draw;function Z(){var wn=ee.elements,Gn,ii=s;return wn?((wn.contextDep&&g.contextDynamic||wn.propDep)&&(ii=d),Gn=wn.append(p,ii)):Gn=ii.def(K,".",Uo),Gn&&ii("if("+Gn+")"+N+".bindBuffer("+Sf+","+Gn+".buffer.buffer);"),Gn}function Se(){var wn=ee.count,Gn,ii=s;return wn?((wn.contextDep&&g.contextDynamic||wn.propDep)&&(ii=d),Gn=wn.append(p,ii),$.optional(function(){wn.MISSING&&p.assert(s,"false","missing vertex count"),wn.DYNAMIC&&p.assert(ii,Gn+">=0","missing vertex count")})):(Gn=ii.def(K,".",wl),$.optional(function(){p.assert(ii,Gn+">=0","missing vertex count")})),Gn}var pe=Z();function Fe(wn){var Gn=ee[wn];return Gn?Gn.contextDep&&g.contextDynamic||Gn.propDep?Gn.append(p,d):Gn.append(p,s):s.def(K,".",wn)}var mt=Fe(Vs),Yt=Fe(Uc),jt=Se();if(typeof jt=="number"){if(jt===0)return}else d("if(",jt,"){"),d.exit("}");var Qt,ur;Xr&&(Qt=Fe(Vl),ur=p.instancing);var kr=pe+".type",on=ee.elements&&Ua(ee.elements);function Gr(){function wn(){d(ur,".drawElementsInstancedANGLE(",[mt,jt,kr,Yt+"<<(("+kr+"-"+yn+")>>1)",Qt],");")}function Gn(){d(ur,".drawArraysInstancedANGLE(",[mt,Yt,jt,Qt],");")}pe?on?wn():(d("if(",pe,"){"),wn(),d("}else{"),Gn(),d("}")):Gn()}function ln(){function wn(){d(N+".drawElements("+[mt,jt,kr,Yt+"<<(("+kr+"-"+yn+")>>1)"]+");")}function Gn(){d(N+".drawArrays("+[mt,Yt,jt]+");")}pe?on?wn():(d("if(",pe,"){"),wn(),d("}else{"),Gn(),d("}")):Gn()}Xr&&(typeof Qt!="number"||Qt>=0)?typeof Qt=="string"?(d("if(",Qt,">0){"),Gr(),d("}else if(",Qt,"<0){"),ln(),d("}")):Gr():ln()}function Li(p,s,d,g,L){var N=di(),K=N.proc("body",L);return $.optional(function(){N.commandStr=s.commandStr,N.command=N.link(s.commandStr)}),Xr&&(N.instancing=K.def(N.shared.extensions,".angle_instanced_arrays")),p(N,K,d,g),N.compile().body}function ji(p,s,d,g){zo(p,s),d.useVAO?d.drawVAO?s(p.shared.vao,".setVAO(",d.drawVAO.append(p,s),");"):s(p.shared.vao,".setVAO(",p.shared.vao,".targetVAO);"):(s(p.shared.vao,".setVAO(null);"),Zs(p,s,d,g.attributes,function(){return!0})),Aa(p,s,d,g.uniforms,function(){return!0}),bn(p,s,s,d)}function es(p,s){var d=p.proc("draw",1);zo(p,d),Qo(p,d,s.context),ys(p,d,s.framebuffer),qo(p,d,s),Hs(p,d,s.state),ui(p,d,s,!1,!0);var g=s.shader.progVar.append(p,d);if(d(p.shared.gl,".useProgram(",g,".program);"),s.shader.program)ji(p,d,s,s.shader.program);else{d(p.shared.vao,".setVAO(null);");var L=p.global.def("{}"),N=d.def(g,".id"),K=d.def(L,"[",N,"]");d(p.cond(K).then(K,".call(this,a0);").else(K,"=",L,"[",N,"]=",p.link(function(ee){return Li(ji,p,s,ee,1)}),"(",g,");",K,".call(this,a0);"))}Object.keys(s.state).length>0&&d(p.shared.current,".dirty=true;")}function au(p,s,d,g){p.batchId="a1",zo(p,s);function L(){return!0}Zs(p,s,d,g.attributes,L),Aa(p,s,d,g.uniforms,L),bn(p,s,s,d)}function hc(p,s,d,g){zo(p,s);var L=d.contextDep,N=s.def(),K="a0",ee="a1",Z=s.def();p.shared.props=Z,p.batchId=N;var Se=p.scope(),pe=p.scope();s(Se.entry,"for(",N,"=0;",N,"<",ee,";++",N,"){",Z,"=",K,"[",N,"];",pe,"}",Se.exit);function Fe(kr){return kr.contextDep&&L||kr.propDep}function mt(kr){return!Fe(kr)}if(d.needsContext&&Qo(p,pe,d.context),d.needsFramebuffer&&ys(p,pe,d.framebuffer),Hs(p,pe,d.state,Fe),d.profile&&Fe(d.profile)&&ui(p,pe,d,!1,!0),g)d.useVAO?d.drawVAO?Fe(d.drawVAO)?pe(p.shared.vao,".setVAO(",d.drawVAO.append(p,pe),");"):Se(p.shared.vao,".setVAO(",d.drawVAO.append(p,Se),");"):Se(p.shared.vao,".setVAO(",p.shared.vao,".targetVAO);"):(Se(p.shared.vao,".setVAO(null);"),Zs(p,Se,d,g.attributes,mt),Zs(p,pe,d,g.attributes,Fe)),Aa(p,Se,d,g.uniforms,mt),Aa(p,pe,d,g.uniforms,Fe),bn(p,Se,pe,d);else{var Yt=p.global.def("{}"),jt=d.shader.progVar.append(p,pe),Qt=pe.def(jt,".id"),ur=pe.def(Yt,"[",Qt,"]");pe(p.shared.gl,".useProgram(",jt,".program);","if(!",ur,"){",ur,"=",Yt,"[",Qt,"]=",p.link(function(kr){return Li(au,p,d,kr,2)}),"(",jt,");}",ur,".call(this,a0[",N,"],",N,");")}}function Ot(p,s){var d=p.proc("batch",2);p.batchId="0",zo(p,d);var g=!1,L=!0;Object.keys(s.context).forEach(function(Yt){g=g||s.context[Yt].propDep}),g||(Qo(p,d,s.context),L=!1);var N=s.framebuffer,K=!1;N?(N.propDep?g=K=!0:N.contextDep&&g&&(K=!0),K||ys(p,d,N)):ys(p,d,null),s.state.viewport&&s.state.viewport.propDep&&(g=!0);function ee(Yt){return Yt.contextDep&&g||Yt.propDep}qo(p,d,s),Hs(p,d,s.state,function(Yt){return!ee(Yt)}),(!s.profile||!ee(s.profile))&&ui(p,d,s,!1,"a1"),s.contextDep=g,s.needsContext=L,s.needsFramebuffer=K;var Z=s.shader.progVar;if(Z.contextDep&&g||Z.propDep)hc(p,d,s,null);else{var Se=Z.append(p,d);if(d(p.shared.gl,".useProgram(",Se,".program);"),s.shader.program)hc(p,d,s,s.shader.program);else{d(p.shared.vao,".setVAO(null);");var pe=p.global.def("{}"),Fe=d.def(Se,".id"),mt=d.def(pe,"[",Fe,"]");d(p.cond(mt).then(mt,".call(this,a0,a1);").else(mt,"=",pe,"[",Fe,"]=",p.link(function(Yt){return Li(hc,p,s,Yt,2)}),"(",Se,");",mt,".call(this,a0,a1);"))}}Object.keys(s.state).length>0&&d(p.shared.current,".dirty=true;")}function Sr(p,s){var d=p.proc("scope",3);p.batchId="a2";var g=p.shared,L=g.current;Qo(p,d,s.context),s.framebuffer&&s.framebuffer.append(p,d),iu(Object.keys(s.state)).forEach(function(K){var ee=s.state[K],Z=ee.append(p,d);Qa(Z)?Z.forEach(function(Se,pe){d.set(p.next[K],"["+pe+"]",Se)}):d.set(g.next,"."+K,Z)}),ui(p,d,s,!0,!0),[Uo,Uc,wl,Vl,Vs].forEach(function(K){var ee=s.draw[K];!ee||d.set(g.draw,"."+K,""+ee.append(p,d))}),Object.keys(s.uniforms).forEach(function(K){var ee=s.uniforms[K].append(p,d);Array.isArray(ee)&&(ee="["+ee.join()+"]"),d.set(g.uniforms,"["+Be.id(K)+"]",ee)}),Object.keys(s.attributes).forEach(function(K){var ee=s.attributes[K].append(p,d),Z=p.scopeAttrib(K);Object.keys(new yr).forEach(function(Se){d.set(Z,"."+Se,ee[Se])})}),s.scopeVAO&&d.set(g.vao,".targetVAO",s.scopeVAO.append(p,d));function N(K){var ee=s.shader[K];ee&&d.set(g.shader,"."+K,ee.append(p,d))}N(Jo),N(bo),Object.keys(s.state).length>0&&(d(L,".dirty=true;"),d.exit(L,".dirty=true;")),d("a1(",p.shared.context,",a0,",p.batchId,");")}function mr(p){if(!(typeof p!="object"||Qa(p))){for(var s=Object.keys(p),d=0;d<s.length;++d)if(Qe.isDynamic(p[s[d]]))return!0;return!1}}function Rn(p,s,d){var g=s.static[d];if(!g||!mr(g))return;var L=p.global,N=Object.keys(g),K=!1,ee=!1,Z=!1,Se=p.global.def("{}");N.forEach(function(Fe){var mt=g[Fe];if(Qe.isDynamic(mt)){typeof mt=="function"&&(mt=g[Fe]=Qe.unbox(mt));var Yt=Do(mt,null);K=K||Yt.thisDep,Z=Z||Yt.propDep,ee=ee||Yt.contextDep}else{switch(L(Se,".",Fe,"="),typeof mt){case"number":L(mt);break;case"string":L('"',mt,'"');break;case"object":Array.isArray(mt)&&L("[",mt.join(),"]");break;default:L(p.link(mt));break}L(";")}});function pe(Fe,mt){N.forEach(function(Yt){var jt=g[Yt];if(!!Qe.isDynamic(jt)){var Qt=Fe.invoke(mt,jt);mt(Se,".",Yt,"=",Qt,";")}})}s.dynamic[d]=new Qe.DynamicVariable(si,{thisDep:K,contextDep:ee,propDep:Z,ref:Se,append:pe}),delete s.static[d]}function w(p,s,d,g,L){var N=di();N.stats=N.link(L),Object.keys(s.static).forEach(function(ee){Rn(N,s,ee)}),Uf.forEach(function(ee){Rn(N,p,ee)});var K=_s(p,s,d,g,N);return es(N,K),Sr(N,K),Ot(N,K),v(N.compile(),{destroy:function(){K.shader.program.destroy()}})}return{next:qn,current:Lr,procs:function(){var p=di(),s=p.proc("poll"),d=p.proc("refresh"),g=p.block();s(g),d(g);var L=p.shared,N=L.gl,K=L.next,ee=L.current;g(ee,".dirty=false;"),ys(p,s),ys(p,d,null,!0);var Z;Xr&&(Z=p.link(Xr)),Et.oes_vertex_array_object&&d(p.link(Et.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Se=0;Se<gr.maxAttributes;++Se){var pe=d.def(L.attributes,"[",Se,"]"),Fe=p.cond(pe,".buffer");Fe.then(N,".enableVertexAttribArray(",Se,");",N,".bindBuffer(",Qu,",",pe,".buffer.buffer);",N,".vertexAttribPointer(",Se,",",pe,".size,",pe,".type,",pe,".normalized,",pe,".stride,",pe,".offset);").else(N,".disableVertexAttribArray(",Se,");",N,".vertexAttrib4f(",Se,",",pe,".x,",pe,".y,",pe,".z,",pe,".w);",pe,".buffer=null;"),d(Fe),Xr&&d(Z,".vertexAttribDivisorANGLE(",Se,",",pe,".divisor);")}return d(p.shared.vao,".currentVAO=null;",p.shared.vao,".setVAO(",p.shared.vao,".targetVAO);"),Object.keys(Br).forEach(function(mt){var Yt=Br[mt],jt=g.def(K,".",mt),Qt=p.block();Qt("if(",jt,"){",N,".enable(",Yt,")}else{",N,".disable(",Yt,")}",ee,".",mt,"=",jt,";"),d(Qt),s("if(",jt,"!==",ee,".",mt,"){",Qt,"}")}),Object.keys(Ur).forEach(function(mt){var Yt=Ur[mt],jt=Lr[mt],Qt,ur,kr=p.block();if(kr(N,".",Yt,"("),Qa(jt)){var on=jt.length;Qt=p.global.def(K,".",mt),ur=p.global.def(ee,".",mt),kr(H(on,function(Gr){return Qt+"["+Gr+"]"}),");",H(on,function(Gr){return ur+"["+Gr+"]="+Qt+"["+Gr+"];"}).join("")),s("if(",H(on,function(Gr){return Qt+"["+Gr+"]!=="+ur+"["+Gr+"]"}).join("||"),"){",kr,"}")}else Qt=g.def(K,".",mt),ur=g.def(ee,".",mt),kr(Qt,");",ee,".",mt,"=",Qt,";"),s("if(",Qt,"!==",ur,"){",kr,"}");d(kr)}),p.compile()}(),compile:w}}function fh(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Xf=34918,Bu=34919,Yf=35007,ff=function(Be,Et){if(!Et.ext_disjoint_timer_query)return null;var gr=[];function Mr(){return gr.pop()||Et.ext_disjoint_timer_query.createQueryEXT()}function Cr(Pn){gr.push(Pn)}var xr=[];function Wr(Pn){var Lr=Mr();Et.ext_disjoint_timer_query.beginQueryEXT(Yf,Lr),xr.push(Lr),rn(xr.length-1,xr.length,Pn)}function sn(){Et.ext_disjoint_timer_query.endQueryEXT(Yf)}function en(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Qr=[];function fn(){return Qr.pop()||new en}function Cn(Pn){Qr.push(Pn)}var cn=[];function rn(Pn,Lr,qn){var Jr=fn();Jr.startQueryIndex=Pn,Jr.endQueryIndex=Lr,Jr.sum=0,Jr.stats=qn,cn.push(Jr)}var yr=[],vr=[];function Xr(){var Pn,Lr,qn=xr.length;if(qn!==0){vr.length=Math.max(vr.length,qn+1),yr.length=Math.max(yr.length,qn+1),yr[0]=0,vr[0]=0;var Jr=0;for(Pn=0,Lr=0;Lr<xr.length;++Lr){var Br=xr[Lr];Et.ext_disjoint_timer_query.getQueryObjectEXT(Br,Bu)?(Jr+=Et.ext_disjoint_timer_query.getQueryObjectEXT(Br,Xf),Cr(Br)):xr[Pn++]=Br,yr[Lr+1]=Jr,vr[Lr+1]=Pn}for(xr.length=Pn,Pn=0,Lr=0;Lr<cn.length;++Lr){var Ur=cn[Lr],Kr=Ur.startQueryIndex,Yn=Ur.endQueryIndex;Ur.sum+=yr[Yn]-yr[Kr];var ti=vr[Kr],un=vr[Yn];un===ti?(Ur.stats.gpuTime+=Ur.sum/1e6,Cn(Ur)):(Ur.startQueryIndex=ti,Ur.endQueryIndex=un,cn[Pn++]=Ur)}cn.length=Pn}}return{beginQuery:Wr,endQuery:sn,pushScopeStats:rn,update:Xr,getNumPendingQueries:function(){return xr.length},clear:function(){gr.push.apply(gr,xr);for(var Lr=0;Lr<gr.length;Lr++)Et.ext_disjoint_timer_query.deleteQueryEXT(gr[Lr]);xr.length=0,gr.length=0},restore:function(){xr.length=0,gr.length=0}}},Kf=16384,Th=256,hh=1024,Af=34962,oh="webglcontextlost",$f="webglcontextrestored",dh=1,Fh=2,_f=3;function zf(xe,Be){for(var Et=0;Et<xe.length;++Et)if(xe[Et]===Be)return Et;return-1}function Ah(xe){var Be=Hn(xe);if(!Be)return null;var Et=Be.gl,gr=Et.getContextAttributes(),Mr=Et.isContextLost(),Cr=k(Et,Be);if(!Cr)return null;var xr=Zr(),Wr=fh(),sn=Cr.extensions,en=ff(Et,sn),Qr=pr(),fn=Et.drawingBufferWidth,Cn=Et.drawingBufferHeight,cn={tick:0,time:0,viewportWidth:fn,viewportHeight:Cn,framebufferWidth:fn,framebufferHeight:Cn,drawingBufferWidth:fn,drawingBufferHeight:Cn,pixelRatio:Be.pixelRatio},rn={},yr={elements:null,primitive:4,count:-1,offset:0,instances:-1},vr=_o(Et,sn),Xr=Ji(Et,Wr,Be,Lr),Pn=qe(Et,sn,vr,Wr,Xr);function Lr(bn){return Pn.destroyBuffer(bn)}var qn=Oc(Et,sn,Xr,Wr),Jr=Dt(Et,xr,Wr,Be),Br=Yu(Et,sn,vr,function(){Yn.procs.poll()},cn,Wr,Be),Ur=ru(Et,sn,vr,Wr,Be),Kr=F(Et,sn,vr,Br,Ur,Wr),Yn=Wf(Et,xr,sn,vr,Xr,qn,Br,Kr,rn,Pn,Jr,yr,cn,en,Be),ti=hr(Et,Kr,Yn.procs.poll,cn,gr,sn,vr),un=Yn.next,Vr=Et.canvas,Nr=[],di=[],pi=[],kn=[Be.onDestroy],Ni=null;function Ci(){if(Nr.length===0){en&&en.update(),Ni=null;return}Ni=Vt.next(Ci),Hs();for(var bn=Nr.length-1;bn>=0;--bn){var Li=Nr[bn];Li&&Li(cn,null,0)}Et.flush(),en&&en.update()}function ki(){!Ni&&Nr.length>0&&(Ni=Vt.next(Ci))}function ca(){Ni&&(Vt.cancel(Ci),Ni=null)}function Go(bn){bn.preventDefault(),Mr=!0,ca(),di.forEach(function(Li){Li()})}function Ho(bn){Et.getError(),Mr=!1,Cr.restore(),Jr.restore(),Xr.restore(),Br.restore(),Ur.restore(),Kr.restore(),Pn.restore(),en&&en.restore(),Yn.procs.refresh(),ki(),pi.forEach(function(Li){Li()})}Vr&&(Vr.addEventListener(oh,Go,!1),Vr.addEventListener($f,Ho,!1));function ta(){Nr.length=0,ca(),Vr&&(Vr.removeEventListener(oh,Go),Vr.removeEventListener($f,Ho)),Jr.clear(),Kr.clear(),Ur.clear(),Br.clear(),qn.clear(),Xr.clear(),Pn.clear(),en&&en.clear(),kn.forEach(function(bn){bn()})}function ho(bn){$(!!bn,"invalid args to regl({...})"),$.type(bn,"object","invalid args to regl({...})");function Li(L){var N=v({},L);delete N.uniforms,delete N.attributes,delete N.context,delete N.vao,"stencil"in N&&N.stencil.op&&(N.stencil.opBack=N.stencil.opFront=N.stencil.op,delete N.stencil.op);function K(ee){if(ee in N){var Z=N[ee];delete N[ee],Object.keys(Z).forEach(function(Se){N[ee+"."+Se]=Z[Se]})}}return K("blend"),K("depth"),K("cull"),K("stencil"),K("polygonOffset"),K("scissor"),K("sample"),"vao"in L&&(N.vao=L.vao),N}function ji(L,N){var K={},ee={};return Object.keys(L).forEach(function(Z){var Se=L[Z];if(Qe.isDynamic(Se)){ee[Z]=Qe.unbox(Se,Z);return}else if(N&&Array.isArray(Se)){for(var pe=0;pe<Se.length;++pe)if(Qe.isDynamic(Se[pe])){ee[Z]=Qe.unbox(Se,Z);return}}K[Z]=Se}),{dynamic:ee,static:K}}var es=ji(bn.context||{},!0),au=ji(bn.uniforms||{},!0),hc=ji(bn.attributes||{},!1),Ot=ji(Li(bn),!1),Sr={gpuTime:0,cpuTime:0,count:0},mr=Yn.compile(Ot,hc,au,es,Sr),Rn=mr.draw,w=mr.batch,p=mr.scope,s=[];function d(L){for(;s.length<L;)s.push(null);return s}function g(L,N){var K;if(Mr&&$.raise("context lost"),typeof L=="function")return p.call(this,null,L,0);if(typeof N=="function")if(typeof L=="number")for(K=0;K<L;++K)p.call(this,null,N,K);else if(Array.isArray(L))for(K=0;K<L.length;++K)p.call(this,L[K],N,K);else return p.call(this,L,N,0);else if(typeof L=="number"){if(L>0)return w.call(this,d(L|0),L|0)}else if(Array.isArray(L)){if(L.length)return w.call(this,L,L.length)}else return Rn.call(this,L)}return v(g,{stats:Sr,destroy:function(){mr.destroy()}})}var Ma=Kr.setFBO=ho({framebuffer:Qe.define.call(null,dh,"framebuffer")});function _s(bn,Li){var ji=0;Yn.procs.poll();var es=Li.color;es&&(Et.clearColor(+es[0]||0,+es[1]||0,+es[2]||0,+es[3]||0),ji|=Kf),"depth"in Li&&(Et.clearDepth(+Li.depth),ji|=Th),"stencil"in Li&&(Et.clearStencil(Li.stencil|0),ji|=hh),$(!!ji,"called regl.clear with no buffer specified"),Et.clear(ji)}function Qo(bn){if($(typeof bn=="object"&&bn,"regl.clear() takes an object as input"),"framebuffer"in bn)if(bn.framebuffer&&bn.framebuffer_reglType==="framebufferCube")for(var Li=0;Li<6;++Li)Ma(v({framebuffer:bn.framebuffer.faces[Li]},bn),_s);else Ma(bn,_s);else _s(null,bn)}function ys(bn){$.type(bn,"function","regl.frame() callback must be a function"),Nr.push(bn);function Li(){var ji=zf(Nr,bn);$(ji>=0,"cannot cancel a frame twice");function es(){var au=zf(Nr,es);Nr[au]=Nr[Nr.length-1],Nr.length-=1,Nr.length<=0&&ca()}Nr[ji]=es}return ki(),{cancel:Li}}function qo(){var bn=un.viewport,Li=un.scissor_box;bn[0]=bn[1]=Li[0]=Li[1]=0,cn.viewportWidth=cn.framebufferWidth=cn.drawingBufferWidth=bn[2]=Li[2]=Et.drawingBufferWidth,cn.viewportHeight=cn.framebufferHeight=cn.drawingBufferHeight=bn[3]=Li[3]=Et.drawingBufferHeight}function Hs(){cn.tick+=1,cn.time=ui(),qo(),Yn.procs.poll()}function zo(){Br.refresh(),qo(),Yn.procs.refresh(),en&&en.update()}function ui(){return(pr()-Qr)/1e3}zo();function Zs(bn,Li){$.type(Li,"function","listener callback must be a function");var ji;switch(bn){case"frame":return ys(Li);case"lost":ji=di;break;case"restore":ji=pi;break;case"destroy":ji=kn;break;default:$.raise("invalid event, must be one of frame,lost,restore,destroy")}return ji.push(Li),{cancel:function(){for(var au=0;au<ji.length;++au)if(ji[au]===Li){ji[au]=ji[ji.length-1],ji.pop();return}}}}var Aa=v(ho,{clear:Qo,prop:Qe.define.bind(null,dh),context:Qe.define.bind(null,Fh),this:Qe.define.bind(null,_f),draw:ho({}),buffer:function(Li){return Xr.create(Li,Af,!1,!1)},elements:function(Li){return qn.create(Li,!1)},texture:Br.create2D,cube:Br.createCube,renderbuffer:Ur.create,framebuffer:Kr.create,framebufferCube:Kr.createCube,vao:Pn.createVAO,attributes:gr,frame:ys,on:Zs,limits:vr,hasExtension:function(Li){return vr.extensions.indexOf(Li.toLowerCase())>=0},read:ti,destroy:ta,_gl:Et,_refresh:zo,poll:function(){Hs(),en&&en.update()},now:ui,stats:Wr});return Be.onDone(null,Aa),Aa}return Ah})},fdMe:function(Re,y,o){"use strict";o.d(y,"a",function(){return S});function S(v,X){var B=X.callback;return B&&(v.dataArray=v.dataArray.map(B)),v}},fo6e:function(Re,y){var o=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function S(v){return o.test(v)}Re.exports=S},g4R6:function(Re,y){function o(S,v,X){return S===S&&(X!==void 0&&(S=S<=X?S:X),v!==void 0&&(S=S>=v?S:v)),S}Re.exports=o},gFfm:function(Re,y){function o(S,v){for(var X=-1,B=S==null?0:S.length;++X<B&&v(S[X],X,S)!==!1;);return S}Re.exports=o},gMG2:function(Re,y,o){"use strict";o.d(y,"a",function(){return St});var S={},v={},X=34,B=10,a=13;function W(bt){return new Function("d","return {"+bt.map(function(Ne,ze){return JSON.stringify(Ne)+": d["+ze+'] || ""'}).join(",")+"}")}function D(bt,Ne){var ze=W(bt);return function(Ue,lt){return Ne(ze(Ue),lt,bt)}}function J(bt){var Ne=Object.create(null),ze=[];return bt.forEach(function(Ue){for(var lt in Ue)lt in Ne||ze.push(Ne[lt]=lt)}),ze}function te(bt,Ne){var ze=bt+"",Ue=ze.length;return Ue<Ne?new Array(Ne-Ue+1).join(0)+ze:ze}function ce(bt){return bt<0?"-"+te(-bt,6):bt>9999?"+"+te(bt,6):te(bt,4)}function Y(bt){var Ne=bt.getUTCHours(),ze=bt.getUTCMinutes(),Ue=bt.getUTCSeconds(),lt=bt.getUTCMilliseconds();return isNaN(bt)?"Invalid Date":ce(bt.getUTCFullYear(),4)+"-"+te(bt.getUTCMonth()+1,2)+"-"+te(bt.getUTCDate(),2)+(lt?"T"+te(Ne,2)+":"+te(ze,2)+":"+te(Ue,2)+"."+te(lt,3)+"Z":Ue?"T"+te(Ne,2)+":"+te(ze,2)+":"+te(Ue,2)+"Z":ze||Ne?"T"+te(Ne,2)+":"+te(ze,2)+"Z":"")}var ke=function(bt){var Ne=new RegExp('["'+bt+`
\r]`),ze=bt.charCodeAt(0);function Ue(Q,G){var Ce,be,Te=lt(Q,function(me,rt){if(Ce)return Ce(me,rt-1);be=me,Ce=G?D(me,G):W(me)});return Te.columns=be||[],Te}function lt(Q,G){var Ce=[],be=Q.length,Te=0,me=0,rt,Kt=be<=0,_t=!1;Q.charCodeAt(be-1)===B&&--be,Q.charCodeAt(be-1)===a&&--be;function ge(){if(Kt)return v;if(_t)return _t=!1,S;var Ve,ft=Te,Ie;if(Q.charCodeAt(ft)===X){for(;Te++<be&&Q.charCodeAt(Te)!==X||Q.charCodeAt(++Te)===X;);return(Ve=Te)>=be?Kt=!0:(Ie=Q.charCodeAt(Te++))===B?_t=!0:Ie===a&&(_t=!0,Q.charCodeAt(Te)===B&&++Te),Q.slice(ft+1,Ve-1).replace(/""/g,'"')}for(;Te<be;){if((Ie=Q.charCodeAt(Ve=Te++))===B)_t=!0;else if(Ie===a)_t=!0,Q.charCodeAt(Te)===B&&++Te;else if(Ie!==ze)continue;return Q.slice(ft,Ve)}return Kt=!0,Q.slice(ft,be)}for(;(rt=ge())!==v;){for(var ye=[];rt!==S&&rt!==v;)ye.push(rt),rt=ge();G&&(ye=G(ye,me++))==null||Ce.push(ye)}return Ce}function Me(Q,G){return Q.map(function(Ce){return G.map(function(be){return oe(Ce[be])}).join(bt)})}function ct(Q,G){return G==null&&(G=J(Q)),[G.map(oe).join(bt)].concat(Me(Q,G)).join(`
`)}function Gt(Q,G){return G==null&&(G=J(Q)),Me(Q,G).join(`
`)}function $t(Q){return Q.map(ar).join(`
`)}function ar(Q){return Q.map(oe).join(bt)}function oe(Q){return Q==null?"":Q instanceof Date?Y(Q):Ne.test(Q+="")?'"'+Q.replace(/"/g,'""')+'"':Q}return{parse:Ue,parseRows:lt,format:ct,formatBody:Gt,formatRows:$t,formatRow:ar,formatValue:oe}},Ke=ke(","),We=Ke.parse,Oe=Ke.parseRows,st=Ke.format,Le=Ke.formatBody,xt=Ke.formatRows,it=Ke.formatRow,$e=Ke.formatValue,Ze=o("5zYK");function St(bt,Ne){var ze=We(bt);return Object(Ze.a)(ze,Ne)}},gQMU:function(Re,y,o){var S=o("0ZTe"),v=S("toUpperCase");Re.exports=v},gzZq:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingToSyntax=void 0;var S=o("MON2"),v=o("FV85"),X=o("D9lx"),B=o("LKzl"),a=function(){function W(D){this._binding=D}return W.prototype.to=function(D){return this._binding.type=v.BindingTypeEnum.Instance,this._binding.implementationType=D,new X.BindingInWhenOnSyntax(this._binding)},W.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+S.INVALID_TO_SELF_VALUE);var D=this._binding.serviceIdentifier;return this.to(D)},W.prototype.toConstantValue=function(D){return this._binding.type=v.BindingTypeEnum.ConstantValue,this._binding.cache=D,this._binding.dynamicValue=null,this._binding.implementationType=null,new B.BindingWhenOnSyntax(this._binding)},W.prototype.toDynamicValue=function(D){return this._binding.type=v.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=D,this._binding.implementationType=null,new X.BindingInWhenOnSyntax(this._binding)},W.prototype.toConstructor=function(D){return this._binding.type=v.BindingTypeEnum.Constructor,this._binding.implementationType=D,new B.BindingWhenOnSyntax(this._binding)},W.prototype.toFactory=function(D){return this._binding.type=v.BindingTypeEnum.Factory,this._binding.factory=D,new B.BindingWhenOnSyntax(this._binding)},W.prototype.toFunction=function(D){if(typeof D!="function")throw new Error(S.INVALID_FUNCTION_BINDING);var J=this.toConstantValue(D);return this._binding.type=v.BindingTypeEnum.Function,J},W.prototype.toAutoFactory=function(D){return this._binding.type=v.BindingTypeEnum.Factory,this._binding.factory=function(J){var te=function(){return J.container.get(D)};return te},new B.BindingWhenOnSyntax(this._binding)},W.prototype.toProvider=function(D){return this._binding.type=v.BindingTypeEnum.Provider,this._binding.provider=D,new B.BindingWhenOnSyntax(this._binding)},W.prototype.toService=function(D){this.toDynamicValue(function(J){return J.container.get(D)})},W}();y.BindingToSyntax=a},h1nZ:function(Re,y,o){"use strict";var S=o("fX6N");o.d(y,"container",function(){return S.c}),o.d(y,"createSceneContainer",function(){return S.b}),o.d(y,"createLayerContainer",function(){return S.a}),o.d(y,"lazyInject",function(){return S.d});var v=o("+em5"),X=o("bB6j");o.d(y,"TYPES",function(){return X.a});var B=o("8/Fi"),a=o("PUg6");o.d(y,"BlendType",function(){return a.a});var W=o("cZlC");o.d(y,"AttributeType",function(){return W.a}),o.d(y,"ScaleTypes",function(){return W.b}),o.d(y,"StyleScaleType",function(){return W.c});var D=o("O1je"),J=o.n(D);o.o(D,"CameraUniform")&&o.d(y,"CameraUniform",function(){return D.CameraUniform}),o.o(D,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return D.CityBuildingLayer}),o.o(D,"Control")&&o.d(y,"Control",function(){return D.Control}),o.o(D,"CoordinateSystem")&&o.d(y,"CoordinateSystem",function(){return D.CoordinateSystem}),o.o(D,"CoordinateUniform")&&o.d(y,"CoordinateUniform",function(){return D.CoordinateUniform}),o.o(D,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return D.HeatmapLayer}),o.o(D,"ImageLayer")&&o.d(y,"ImageLayer",function(){return D.ImageLayer}),o.o(D,"LineLayer")&&o.d(y,"LineLayer",function(){return D.LineLayer}),o.o(D,"Logo")&&o.d(y,"Logo",function(){return D.Logo}),o.o(D,"MapServiceEvent")&&o.d(y,"MapServiceEvent",function(){return D.MapServiceEvent}),o.o(D,"Marker")&&o.d(y,"Marker",function(){return D.Marker}),o.o(D,"PointLayer")&&o.d(y,"PointLayer",function(){return D.PointLayer}),o.o(D,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return D.PolygonLayer}),o.o(D,"Popup")&&o.d(y,"Popup",function(){return D.Popup}),o.o(D,"PositionType")&&o.d(y,"PositionType",function(){return D.PositionType}),o.o(D,"RasterLayer")&&o.d(y,"RasterLayer",function(){return D.RasterLayer}),o.o(D,"Scale")&&o.d(y,"Scale",function(){return D.Scale}),o.o(D,"Scene")&&o.d(y,"Scene",function(){return D.Scene}),o.o(D,"SceneEventList")&&o.d(y,"SceneEventList",function(){return D.SceneEventList}),o.o(D,"Zoom")&&o.d(y,"Zoom",function(){return D.Zoom}),o.o(D,"gl")&&o.d(y,"gl",function(){return D.gl});var te=o("L56e");o.d(y,"MapServiceEvent",function(){return te.a});var ce=o("HthE");o.d(y,"CoordinateSystem",function(){return ce.a}),o.d(y,"CoordinateUniform",function(){return ce.b});var Y=o("/33/"),ke=o.n(Y);o.o(Y,"CameraUniform")&&o.d(y,"CameraUniform",function(){return Y.CameraUniform}),o.o(Y,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return Y.CityBuildingLayer}),o.o(Y,"Control")&&o.d(y,"Control",function(){return Y.Control}),o.o(Y,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return Y.HeatmapLayer}),o.o(Y,"ImageLayer")&&o.d(y,"ImageLayer",function(){return Y.ImageLayer}),o.o(Y,"LineLayer")&&o.d(y,"LineLayer",function(){return Y.LineLayer}),o.o(Y,"Logo")&&o.d(y,"Logo",function(){return Y.Logo}),o.o(Y,"Marker")&&o.d(y,"Marker",function(){return Y.Marker}),o.o(Y,"PointLayer")&&o.d(y,"PointLayer",function(){return Y.PointLayer}),o.o(Y,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return Y.PolygonLayer}),o.o(Y,"Popup")&&o.d(y,"Popup",function(){return Y.Popup}),o.o(Y,"PositionType")&&o.d(y,"PositionType",function(){return Y.PositionType}),o.o(Y,"RasterLayer")&&o.d(y,"RasterLayer",function(){return Y.RasterLayer}),o.o(Y,"Scale")&&o.d(y,"Scale",function(){return Y.Scale}),o.o(Y,"Scene")&&o.d(y,"Scene",function(){return Y.Scene}),o.o(Y,"SceneEventList")&&o.d(y,"SceneEventList",function(){return Y.SceneEventList}),o.o(Y,"Zoom")&&o.d(y,"Zoom",function(){return Y.Zoom}),o.o(Y,"gl")&&o.d(y,"gl",function(){return Y.gl});var Ke=o("EfZ0");o.d(y,"CameraUniform",function(){return Ke.a});var We=o("riiI"),Oe=o.n(We);o.o(We,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return We.CityBuildingLayer}),o.o(We,"Control")&&o.d(y,"Control",function(){return We.Control}),o.o(We,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return We.HeatmapLayer}),o.o(We,"ImageLayer")&&o.d(y,"ImageLayer",function(){return We.ImageLayer}),o.o(We,"LineLayer")&&o.d(y,"LineLayer",function(){return We.LineLayer}),o.o(We,"Logo")&&o.d(y,"Logo",function(){return We.Logo}),o.o(We,"Marker")&&o.d(y,"Marker",function(){return We.Marker}),o.o(We,"PointLayer")&&o.d(y,"PointLayer",function(){return We.PointLayer}),o.o(We,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return We.PolygonLayer}),o.o(We,"Popup")&&o.d(y,"Popup",function(){return We.Popup}),o.o(We,"PositionType")&&o.d(y,"PositionType",function(){return We.PositionType}),o.o(We,"RasterLayer")&&o.d(y,"RasterLayer",function(){return We.RasterLayer}),o.o(We,"Scale")&&o.d(y,"Scale",function(){return We.Scale}),o.o(We,"Scene")&&o.d(y,"Scene",function(){return We.Scene}),o.o(We,"SceneEventList")&&o.d(y,"SceneEventList",function(){return We.SceneEventList}),o.o(We,"Zoom")&&o.d(y,"Zoom",function(){return We.Zoom}),o.o(We,"gl")&&o.d(y,"gl",function(){return We.gl});var st=o("eg+a");o.d(y,"SceneEventList",function(){return st.a});var Le=o("bYl4"),xt=o.n(Le);o.o(Le,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return Le.CityBuildingLayer}),o.o(Le,"Control")&&o.d(y,"Control",function(){return Le.Control}),o.o(Le,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return Le.HeatmapLayer}),o.o(Le,"ImageLayer")&&o.d(y,"ImageLayer",function(){return Le.ImageLayer}),o.o(Le,"LineLayer")&&o.d(y,"LineLayer",function(){return Le.LineLayer}),o.o(Le,"Logo")&&o.d(y,"Logo",function(){return Le.Logo}),o.o(Le,"Marker")&&o.d(y,"Marker",function(){return Le.Marker}),o.o(Le,"PointLayer")&&o.d(y,"PointLayer",function(){return Le.PointLayer}),o.o(Le,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return Le.PolygonLayer}),o.o(Le,"Popup")&&o.d(y,"Popup",function(){return Le.Popup}),o.o(Le,"PositionType")&&o.d(y,"PositionType",function(){return Le.PositionType}),o.o(Le,"RasterLayer")&&o.d(y,"RasterLayer",function(){return Le.RasterLayer}),o.o(Le,"Scale")&&o.d(y,"Scale",function(){return Le.Scale}),o.o(Le,"Scene")&&o.d(y,"Scene",function(){return Le.Scene}),o.o(Le,"Zoom")&&o.d(y,"Zoom",function(){return Le.Zoom}),o.o(Le,"gl")&&o.d(y,"gl",function(){return Le.gl});var it=o("FI6e"),$e=o.n(it);o.o(it,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return it.CityBuildingLayer}),o.o(it,"Control")&&o.d(y,"Control",function(){return it.Control}),o.o(it,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return it.HeatmapLayer}),o.o(it,"ImageLayer")&&o.d(y,"ImageLayer",function(){return it.ImageLayer}),o.o(it,"LineLayer")&&o.d(y,"LineLayer",function(){return it.LineLayer}),o.o(it,"Logo")&&o.d(y,"Logo",function(){return it.Logo}),o.o(it,"Marker")&&o.d(y,"Marker",function(){return it.Marker}),o.o(it,"PointLayer")&&o.d(y,"PointLayer",function(){return it.PointLayer}),o.o(it,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return it.PolygonLayer}),o.o(it,"Popup")&&o.d(y,"Popup",function(){return it.Popup}),o.o(it,"PositionType")&&o.d(y,"PositionType",function(){return it.PositionType}),o.o(it,"RasterLayer")&&o.d(y,"RasterLayer",function(){return it.RasterLayer}),o.o(it,"Scale")&&o.d(y,"Scale",function(){return it.Scale}),o.o(it,"Scene")&&o.d(y,"Scene",function(){return it.Scene}),o.o(it,"Zoom")&&o.d(y,"Zoom",function(){return it.Zoom}),o.o(it,"gl")&&o.d(y,"gl",function(){return it.gl});var Ze=o("D+ow"),St=o.n(Ze);o.o(Ze,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return Ze.CityBuildingLayer}),o.o(Ze,"Control")&&o.d(y,"Control",function(){return Ze.Control}),o.o(Ze,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return Ze.HeatmapLayer}),o.o(Ze,"ImageLayer")&&o.d(y,"ImageLayer",function(){return Ze.ImageLayer}),o.o(Ze,"LineLayer")&&o.d(y,"LineLayer",function(){return Ze.LineLayer}),o.o(Ze,"Logo")&&o.d(y,"Logo",function(){return Ze.Logo}),o.o(Ze,"Marker")&&o.d(y,"Marker",function(){return Ze.Marker}),o.o(Ze,"PointLayer")&&o.d(y,"PointLayer",function(){return Ze.PointLayer}),o.o(Ze,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return Ze.PolygonLayer}),o.o(Ze,"Popup")&&o.d(y,"Popup",function(){return Ze.Popup}),o.o(Ze,"PositionType")&&o.d(y,"PositionType",function(){return Ze.PositionType}),o.o(Ze,"RasterLayer")&&o.d(y,"RasterLayer",function(){return Ze.RasterLayer}),o.o(Ze,"Scale")&&o.d(y,"Scale",function(){return Ze.Scale}),o.o(Ze,"Scene")&&o.d(y,"Scene",function(){return Ze.Scene}),o.o(Ze,"Zoom")&&o.d(y,"Zoom",function(){return Ze.Zoom}),o.o(Ze,"gl")&&o.d(y,"gl",function(){return Ze.gl});var bt=o("AFH1");o.d(y,"PositionType",function(){return bt.a});var Ne=o("8uyu"),ze=o.n(Ne);o.o(Ne,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return Ne.CityBuildingLayer}),o.o(Ne,"Control")&&o.d(y,"Control",function(){return Ne.Control}),o.o(Ne,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return Ne.HeatmapLayer}),o.o(Ne,"ImageLayer")&&o.d(y,"ImageLayer",function(){return Ne.ImageLayer}),o.o(Ne,"LineLayer")&&o.d(y,"LineLayer",function(){return Ne.LineLayer}),o.o(Ne,"Logo")&&o.d(y,"Logo",function(){return Ne.Logo}),o.o(Ne,"Marker")&&o.d(y,"Marker",function(){return Ne.Marker}),o.o(Ne,"PointLayer")&&o.d(y,"PointLayer",function(){return Ne.PointLayer}),o.o(Ne,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return Ne.PolygonLayer}),o.o(Ne,"Popup")&&o.d(y,"Popup",function(){return Ne.Popup}),o.o(Ne,"RasterLayer")&&o.d(y,"RasterLayer",function(){return Ne.RasterLayer}),o.o(Ne,"Scale")&&o.d(y,"Scale",function(){return Ne.Scale}),o.o(Ne,"Scene")&&o.d(y,"Scene",function(){return Ne.Scene}),o.o(Ne,"Zoom")&&o.d(y,"Zoom",function(){return Ne.Zoom}),o.o(Ne,"gl")&&o.d(y,"gl",function(){return Ne.gl});var Ue=o("J7lC"),lt=o.n(Ue);o.o(Ue,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return Ue.CityBuildingLayer}),o.o(Ue,"Control")&&o.d(y,"Control",function(){return Ue.Control}),o.o(Ue,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return Ue.HeatmapLayer}),o.o(Ue,"ImageLayer")&&o.d(y,"ImageLayer",function(){return Ue.ImageLayer}),o.o(Ue,"LineLayer")&&o.d(y,"LineLayer",function(){return Ue.LineLayer}),o.o(Ue,"Logo")&&o.d(y,"Logo",function(){return Ue.Logo}),o.o(Ue,"Marker")&&o.d(y,"Marker",function(){return Ue.Marker}),o.o(Ue,"PointLayer")&&o.d(y,"PointLayer",function(){return Ue.PointLayer}),o.o(Ue,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return Ue.PolygonLayer}),o.o(Ue,"Popup")&&o.d(y,"Popup",function(){return Ue.Popup}),o.o(Ue,"RasterLayer")&&o.d(y,"RasterLayer",function(){return Ue.RasterLayer}),o.o(Ue,"Scale")&&o.d(y,"Scale",function(){return Ue.Scale}),o.o(Ue,"Scene")&&o.d(y,"Scene",function(){return Ue.Scene}),o.o(Ue,"Zoom")&&o.d(y,"Zoom",function(){return Ue.Zoom}),o.o(Ue,"gl")&&o.d(y,"gl",function(){return Ue.gl});var Me=o("QGbF"),ct=o.n(Me);o.o(Me,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return Me.CityBuildingLayer}),o.o(Me,"Control")&&o.d(y,"Control",function(){return Me.Control}),o.o(Me,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return Me.HeatmapLayer}),o.o(Me,"ImageLayer")&&o.d(y,"ImageLayer",function(){return Me.ImageLayer}),o.o(Me,"LineLayer")&&o.d(y,"LineLayer",function(){return Me.LineLayer}),o.o(Me,"Logo")&&o.d(y,"Logo",function(){return Me.Logo}),o.o(Me,"Marker")&&o.d(y,"Marker",function(){return Me.Marker}),o.o(Me,"PointLayer")&&o.d(y,"PointLayer",function(){return Me.PointLayer}),o.o(Me,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return Me.PolygonLayer}),o.o(Me,"Popup")&&o.d(y,"Popup",function(){return Me.Popup}),o.o(Me,"RasterLayer")&&o.d(y,"RasterLayer",function(){return Me.RasterLayer}),o.o(Me,"Scale")&&o.d(y,"Scale",function(){return Me.Scale}),o.o(Me,"Scene")&&o.d(y,"Scene",function(){return Me.Scene}),o.o(Me,"Zoom")&&o.d(y,"Zoom",function(){return Me.Zoom}),o.o(Me,"gl")&&o.d(y,"gl",function(){return Me.gl});var Gt=o("V1cb"),$t=o("bzyH"),ar=o.n($t);o.o($t,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return $t.CityBuildingLayer}),o.o($t,"Control")&&o.d(y,"Control",function(){return $t.Control}),o.o($t,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return $t.HeatmapLayer}),o.o($t,"ImageLayer")&&o.d(y,"ImageLayer",function(){return $t.ImageLayer}),o.o($t,"LineLayer")&&o.d(y,"LineLayer",function(){return $t.LineLayer}),o.o($t,"Logo")&&o.d(y,"Logo",function(){return $t.Logo}),o.o($t,"Marker")&&o.d(y,"Marker",function(){return $t.Marker}),o.o($t,"PointLayer")&&o.d(y,"PointLayer",function(){return $t.PointLayer}),o.o($t,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return $t.PolygonLayer}),o.o($t,"Popup")&&o.d(y,"Popup",function(){return $t.Popup}),o.o($t,"RasterLayer")&&o.d(y,"RasterLayer",function(){return $t.RasterLayer}),o.o($t,"Scale")&&o.d(y,"Scale",function(){return $t.Scale}),o.o($t,"Scene")&&o.d(y,"Scene",function(){return $t.Scene}),o.o($t,"Zoom")&&o.d(y,"Zoom",function(){return $t.Zoom}),o.o($t,"gl")&&o.d(y,"gl",function(){return $t.gl});var oe=o("0eqD"),Q=o.n(oe);o.o(oe,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return oe.CityBuildingLayer}),o.o(oe,"Control")&&o.d(y,"Control",function(){return oe.Control}),o.o(oe,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return oe.HeatmapLayer}),o.o(oe,"ImageLayer")&&o.d(y,"ImageLayer",function(){return oe.ImageLayer}),o.o(oe,"LineLayer")&&o.d(y,"LineLayer",function(){return oe.LineLayer}),o.o(oe,"Logo")&&o.d(y,"Logo",function(){return oe.Logo}),o.o(oe,"Marker")&&o.d(y,"Marker",function(){return oe.Marker}),o.o(oe,"PointLayer")&&o.d(y,"PointLayer",function(){return oe.PointLayer}),o.o(oe,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return oe.PolygonLayer}),o.o(oe,"Popup")&&o.d(y,"Popup",function(){return oe.Popup}),o.o(oe,"RasterLayer")&&o.d(y,"RasterLayer",function(){return oe.RasterLayer}),o.o(oe,"Scale")&&o.d(y,"Scale",function(){return oe.Scale}),o.o(oe,"Scene")&&o.d(y,"Scene",function(){return oe.Scene}),o.o(oe,"Zoom")&&o.d(y,"Zoom",function(){return oe.Zoom}),o.o(oe,"gl")&&o.d(y,"gl",function(){return oe.gl});var G=o("/Uc5"),Ce=o.n(G);o.o(G,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return G.CityBuildingLayer}),o.o(G,"Control")&&o.d(y,"Control",function(){return G.Control}),o.o(G,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return G.HeatmapLayer}),o.o(G,"ImageLayer")&&o.d(y,"ImageLayer",function(){return G.ImageLayer}),o.o(G,"LineLayer")&&o.d(y,"LineLayer",function(){return G.LineLayer}),o.o(G,"Logo")&&o.d(y,"Logo",function(){return G.Logo}),o.o(G,"Marker")&&o.d(y,"Marker",function(){return G.Marker}),o.o(G,"PointLayer")&&o.d(y,"PointLayer",function(){return G.PointLayer}),o.o(G,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return G.PolygonLayer}),o.o(G,"Popup")&&o.d(y,"Popup",function(){return G.Popup}),o.o(G,"RasterLayer")&&o.d(y,"RasterLayer",function(){return G.RasterLayer}),o.o(G,"Scale")&&o.d(y,"Scale",function(){return G.Scale}),o.o(G,"Scene")&&o.d(y,"Scene",function(){return G.Scene}),o.o(G,"Zoom")&&o.d(y,"Zoom",function(){return G.Zoom}),o.o(G,"gl")&&o.d(y,"gl",function(){return G.gl});var be=o("RMtq"),Te=o.n(be);o.o(be,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return be.CityBuildingLayer}),o.o(be,"Control")&&o.d(y,"Control",function(){return be.Control}),o.o(be,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return be.HeatmapLayer}),o.o(be,"ImageLayer")&&o.d(y,"ImageLayer",function(){return be.ImageLayer}),o.o(be,"LineLayer")&&o.d(y,"LineLayer",function(){return be.LineLayer}),o.o(be,"Logo")&&o.d(y,"Logo",function(){return be.Logo}),o.o(be,"Marker")&&o.d(y,"Marker",function(){return be.Marker}),o.o(be,"PointLayer")&&o.d(y,"PointLayer",function(){return be.PointLayer}),o.o(be,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return be.PolygonLayer}),o.o(be,"Popup")&&o.d(y,"Popup",function(){return be.Popup}),o.o(be,"RasterLayer")&&o.d(y,"RasterLayer",function(){return be.RasterLayer}),o.o(be,"Scale")&&o.d(y,"Scale",function(){return be.Scale}),o.o(be,"Scene")&&o.d(y,"Scene",function(){return be.Scene}),o.o(be,"Zoom")&&o.d(y,"Zoom",function(){return be.Zoom}),o.o(be,"gl")&&o.d(y,"gl",function(){return be.gl});var me=o("1jvM"),rt=o.n(me);o.o(me,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return me.CityBuildingLayer}),o.o(me,"Control")&&o.d(y,"Control",function(){return me.Control}),o.o(me,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return me.HeatmapLayer}),o.o(me,"ImageLayer")&&o.d(y,"ImageLayer",function(){return me.ImageLayer}),o.o(me,"LineLayer")&&o.d(y,"LineLayer",function(){return me.LineLayer}),o.o(me,"Logo")&&o.d(y,"Logo",function(){return me.Logo}),o.o(me,"Marker")&&o.d(y,"Marker",function(){return me.Marker}),o.o(me,"PointLayer")&&o.d(y,"PointLayer",function(){return me.PointLayer}),o.o(me,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return me.PolygonLayer}),o.o(me,"Popup")&&o.d(y,"Popup",function(){return me.Popup}),o.o(me,"RasterLayer")&&o.d(y,"RasterLayer",function(){return me.RasterLayer}),o.o(me,"Scale")&&o.d(y,"Scale",function(){return me.Scale}),o.o(me,"Scene")&&o.d(y,"Scene",function(){return me.Scene}),o.o(me,"Zoom")&&o.d(y,"Zoom",function(){return me.Zoom}),o.o(me,"gl")&&o.d(y,"gl",function(){return me.gl});var Kt=o("bPkA"),_t=o("PSsN"),ge=o.n(_t);o.o(_t,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return _t.CityBuildingLayer}),o.o(_t,"Control")&&o.d(y,"Control",function(){return _t.Control}),o.o(_t,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return _t.HeatmapLayer}),o.o(_t,"ImageLayer")&&o.d(y,"ImageLayer",function(){return _t.ImageLayer}),o.o(_t,"LineLayer")&&o.d(y,"LineLayer",function(){return _t.LineLayer}),o.o(_t,"Logo")&&o.d(y,"Logo",function(){return _t.Logo}),o.o(_t,"Marker")&&o.d(y,"Marker",function(){return _t.Marker}),o.o(_t,"PointLayer")&&o.d(y,"PointLayer",function(){return _t.PointLayer}),o.o(_t,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return _t.PolygonLayer}),o.o(_t,"Popup")&&o.d(y,"Popup",function(){return _t.Popup}),o.o(_t,"RasterLayer")&&o.d(y,"RasterLayer",function(){return _t.RasterLayer}),o.o(_t,"Scale")&&o.d(y,"Scale",function(){return _t.Scale}),o.o(_t,"Scene")&&o.d(y,"Scene",function(){return _t.Scene}),o.o(_t,"Zoom")&&o.d(y,"Zoom",function(){return _t.Zoom}),o.o(_t,"gl")&&o.d(y,"gl",function(){return _t.gl});var ye=o("6NqC"),Ve=o.n(ye);o.o(ye,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return ye.CityBuildingLayer}),o.o(ye,"Control")&&o.d(y,"Control",function(){return ye.Control}),o.o(ye,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return ye.HeatmapLayer}),o.o(ye,"ImageLayer")&&o.d(y,"ImageLayer",function(){return ye.ImageLayer}),o.o(ye,"LineLayer")&&o.d(y,"LineLayer",function(){return ye.LineLayer}),o.o(ye,"Logo")&&o.d(y,"Logo",function(){return ye.Logo}),o.o(ye,"Marker")&&o.d(y,"Marker",function(){return ye.Marker}),o.o(ye,"PointLayer")&&o.d(y,"PointLayer",function(){return ye.PointLayer}),o.o(ye,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return ye.PolygonLayer}),o.o(ye,"Popup")&&o.d(y,"Popup",function(){return ye.Popup}),o.o(ye,"RasterLayer")&&o.d(y,"RasterLayer",function(){return ye.RasterLayer}),o.o(ye,"Scale")&&o.d(y,"Scale",function(){return ye.Scale}),o.o(ye,"Scene")&&o.d(y,"Scene",function(){return ye.Scene}),o.o(ye,"Zoom")&&o.d(y,"Zoom",function(){return ye.Zoom}),o.o(ye,"gl")&&o.d(y,"gl",function(){return ye.gl});var ft=o("bTtR"),Ie=o.n(ft);o.o(ft,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return ft.CityBuildingLayer}),o.o(ft,"Control")&&o.d(y,"Control",function(){return ft.Control}),o.o(ft,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return ft.HeatmapLayer}),o.o(ft,"ImageLayer")&&o.d(y,"ImageLayer",function(){return ft.ImageLayer}),o.o(ft,"LineLayer")&&o.d(y,"LineLayer",function(){return ft.LineLayer}),o.o(ft,"Logo")&&o.d(y,"Logo",function(){return ft.Logo}),o.o(ft,"Marker")&&o.d(y,"Marker",function(){return ft.Marker}),o.o(ft,"PointLayer")&&o.d(y,"PointLayer",function(){return ft.PointLayer}),o.o(ft,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return ft.PolygonLayer}),o.o(ft,"Popup")&&o.d(y,"Popup",function(){return ft.Popup}),o.o(ft,"RasterLayer")&&o.d(y,"RasterLayer",function(){return ft.RasterLayer}),o.o(ft,"Scale")&&o.d(y,"Scale",function(){return ft.Scale}),o.o(ft,"Scene")&&o.d(y,"Scene",function(){return ft.Scene}),o.o(ft,"Zoom")&&o.d(y,"Zoom",function(){return ft.Zoom}),o.o(ft,"gl")&&o.d(y,"gl",function(){return ft.gl});var pt=o("o+pz");o.d(y,"gl",function(){return pt.a})},h7MG:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.getBindingDictionary=y.createMockRequest=y.plan=void 0;var S=o("doU7"),v=o("MON2"),X=o("FV85"),B=o("xfSm"),a=o("qK8v"),W=o("ujMp"),D=o("oy+k"),J=o("GXnB"),te=o("yMAV"),ce=o("fbrv"),Y=o("xiII"),ke=o("dX1H");function Ke(Ze){return Ze._bindingDictionary}y.getBindingDictionary=Ke;function We(Ze,St,bt,Ne,ze,Ue){var lt=Ze?B.MULTI_INJECT_TAG:B.INJECT_TAG,Me=new J.Metadata(lt,bt),ct=new ke.Target(St,Ne,bt,Me);if(ze!==void 0){var Gt=new J.Metadata(ze,Ue);ct.metadata.push(Gt)}return ct}function Oe(Ze,St,bt,Ne,ze){var Ue=xt(bt.container,ze.serviceIdentifier),lt=[];return Ue.length===S.BindingCount.NoBindingsAvailable&&bt.container.options.autoBindInjectable&&typeof ze.serviceIdentifier=="function"&&Ze.getConstructorMetadata(ze.serviceIdentifier).compilerGeneratedMetadata&&(bt.container.bind(ze.serviceIdentifier).toSelf(),Ue=xt(bt.container,ze.serviceIdentifier)),St?lt=Ue:lt=Ue.filter(function(Me){var ct=new Y.Request(Me.serviceIdentifier,bt,Ne,Me,ze);return Me.constraint(ct)}),st(ze.serviceIdentifier,lt,ze,bt.container),lt}function st(Ze,St,bt,Ne){switch(St.length){case S.BindingCount.NoBindingsAvailable:if(bt.isOptional())return St;var ze=W.getServiceIdentifierAsString(Ze),Ue=v.NOT_REGISTERED;throw Ue+=W.listMetadataForTarget(ze,bt),Ue+=W.listRegisteredBindingsForServiceIdentifier(Ne,ze,xt),new Error(Ue);case S.BindingCount.OnlyOneBindingAvailable:if(!bt.isArray())return St;case S.BindingCount.MultipleBindingsAvailable:default:if(bt.isArray())return St;var ze=W.getServiceIdentifierAsString(Ze),Ue=v.AMBIGUOUS_MATCH+" "+ze;throw Ue+=W.listRegisteredBindingsForServiceIdentifier(Ne,ze,xt),new Error(Ue)}}function Le(Ze,St,bt,Ne,ze,Ue){var lt,Me;if(ze===null){lt=Oe(Ze,St,Ne,null,Ue),Me=new Y.Request(bt,Ne,null,lt,Ue);var ct=new te.Plan(Ne,Me);Ne.addPlan(ct)}else lt=Oe(Ze,St,Ne,ze,Ue),Me=ze.addChildRequest(Ue.serviceIdentifier,lt,Ue);lt.forEach(function(Gt){var $t=null;if(Ue.isArray())$t=Me.addChildRequest(Gt.serviceIdentifier,Gt,Ue);else{if(Gt.cache)return;$t=Me}if(Gt.type===X.BindingTypeEnum.Instance&&Gt.implementationType!==null){var ar=ce.getDependencies(Ze,Gt.implementationType);if(!Ne.container.options.skipBaseClassChecks){var oe=ce.getBaseClassDependencyCount(Ze,Gt.implementationType);if(ar.length<oe){var Q=v.ARGUMENTS_LENGTH_MISMATCH(ce.getFunctionName(Gt.implementationType));throw new Error(Q)}}ar.forEach(function(G){Le(Ze,!1,G.serviceIdentifier,Ne,$t,G)})}})}function xt(Ze,St){var bt=[],Ne=Ke(Ze);return Ne.hasKey(St)?bt=Ne.get(St):Ze.parent!==null&&(bt=xt(Ze.parent,St)),bt}function it(Ze,St,bt,Ne,ze,Ue,lt,Me){Me===void 0&&(Me=!1);var ct=new D.Context(St),Gt=We(bt,Ne,ze,"",Ue,lt);try{return Le(Ze,Me,ze,ct,null,Gt),ct}catch($t){throw a.isStackOverflowExeption($t)&&ct.plan&&W.circularDependencyToException(ct.plan.rootRequest),$t}}y.plan=it;function $e(Ze,St,bt,Ne){var ze=new ke.Target(X.TargetTypeEnum.Variable,"",St,new J.Metadata(bt,Ne)),Ue=new D.Context(Ze),lt=new Y.Request(St,Ue,null,[],ze);return lt}y.createMockRequest=$e},heNW:function(Re,y){function o(S,v,X){switch(X.length){case 0:return S.call(v);case 1:return S.call(v,X[0]);case 2:return S.call(v,X[0],X[1]);case 3:return S.call(v,X[0],X[1],X[2])}return S.apply(v,X)}Re.exports=o},hi0z:function(Re,y,o){"use strict";(function(S,v){Re.exports=v()})(this,function(){function S(ce){var Y=[];return ce.AMapUI&&Y.push(v(ce.AMapUI)),ce.Loca&&Y.push(X(ce.Loca)),Promise.all(Y)}function v(ce){return new Promise(function(Y,ke){var Ke=[];if(ce.plugins)for(var We=0;We<ce.plugins.length;We+=1)a.AMapUI.plugins.indexOf(ce.plugins[We])==-1&&Ke.push(ce.plugins[We]);if(W.AMapUI===B.failed)ke("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(W.AMapUI===B.notload){W.AMapUI=B.loading,a.AMapUI.version=ce.version||a.AMapUI.version,We=a.AMapUI.version;var Oe=document.body||document.head,st=document.createElement("script");st.type="text/javascript",st.src="https://webapi.amap.com/ui/"+We+"/main.js",st.onerror=function(Le){W.AMapUI=B.failed,ke("\u8BF7\u6C42 AMapUI \u5931\u8D25")},st.onload=function(){if(W.AMapUI=B.loaded,Ke.length)window.AMapUI.loadUI(Ke,function(){for(var Le=0,xt=Ke.length;Le<xt;Le++){var it=Ke[Le].split("/").slice(-1)[0];window.AMapUI[it]=arguments[Le]}for(Y();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()});else for(Y();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()},Oe.appendChild(st)}else W.AMapUI===B.loaded?ce.version&&ce.version!==a.AMapUI.version?ke("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):Ke.length?window.AMapUI.loadUI(Ke,function(){for(var Le=0,xt=Ke.length;Le<xt;Le++){var it=Ke[Le].split("/").slice(-1)[0];window.AMapUI[it]=arguments[Le]}Y()}):Y():ce.version&&ce.version!==a.AMapUI.version?ke("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):D.AMapUI.push(function(Le){Le?ke(Le):Ke.length?window.AMapUI.loadUI(Ke,function(){for(var xt=0,it=Ke.length;xt<it;xt++){var $e=Ke[xt].split("/").slice(-1)[0];window.AMapUI[$e]=arguments[xt]}Y()}):Y()})})}function X(ce){return new Promise(function(Y,ke){if(a.AMap.version.startsWith("2.0"))ke("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(W.Loca===B.failed)ke("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(W.Loca===B.notload){W.Loca=B.loading,a.Loca.version=ce.version||a.Loca.version;var Ke=a.Loca.version,We=a.key,Oe=document.body||document.head,st=document.createElement("script");st.type="text/javascript",st.src="https://webapi.amap.com/loca?v="+Ke+"&key="+We,st.onerror=function(Le){W.Loca=B.failed,ke("\u8BF7\u6C42 AMapUI \u5931\u8D25")},st.onload=function(){for(W.Loca=B.loaded,Y();D.Loca.length;)D.Loca.splice(0,1)[0]()},Oe.appendChild(st)}else W.Loca===B.loaded?ce.version&&ce.version!==a.Loca.version?ke("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):Y():ce.version&&ce.version!==a.Loca.version?ke("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):D.Loca.push(function(Le){Le?ke(Le):ke()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var B;(function(ce){ce.notload="notload",ce.loading="loading",ce.loaded="loaded",ce.failed="failed"})(B||(B={}));var a={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},W={AMap:B.notload,AMapUI:B.notload,Loca:B.notload},D={AMap:[],AMapUI:[],Loca:[]},J=[],te=function(Y){typeof Y=="function"&&(W.AMap===B.loaded?Y(window.AMap):J.push(Y))};return{load:function(Y){return new Promise(function(ke,Ke){if(W.AMap==B.failed)Ke("");else if(W.AMap==B.notload){var We=Y.key,Oe=Y.version,st=Y.plugins;We?(window.AMap&&location.host!=="lbs.amap.com"&&Ke("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),a.key=We,a.AMap.version=Oe||a.AMap.version,a.AMap.plugins=st||a.AMap.plugins,W.AMap=B.loading,Oe=document.body||document.head,window.___onAPILoaded=function(xt){if(delete window.___onAPILoaded,xt)W.AMap=B.failed,Ke(xt);else for(W.AMap=B.loaded,S(Y).then(function(){ke(window.AMap)}).catch(Ke);J.length;)J.splice(0,1)[0]()},st=document.createElement("script"),st.type="text/javascript",st.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+a.AMap.version+"&key="+We+"&plugin="+a.AMap.plugins.join(","),st.onerror=function(xt){W.AMap=B.failed,Ke(xt)},Oe.appendChild(st)):Ke("\u8BF7\u586B\u5199key")}else if(W.AMap==B.loaded)if(Y.key&&Y.key!==a.key)Ke("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(Y.version&&Y.version!==a.AMap.version)Ke("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(We=[],Y.plugins)for(Oe=0;Oe<Y.plugins.length;Oe+=1)a.AMap.plugins.indexOf(Y.plugins[Oe])==-1&&We.push(Y.plugins[Oe]);We.length?window.AMap.plugin(We,function(){S(Y).then(function(){ke(window.AMap)}).catch(Ke)}):S(Y).then(function(){ke(window.AMap)}).catch(Ke)}else if(Y.key&&Y.key!==a.key)Ke("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(Y.version&&Y.version!==a.AMap.version)Ke("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var Le=[];if(Y.plugins)for(Oe=0;Oe<Y.plugins.length;Oe+=1)a.AMap.plugins.indexOf(Y.plugins[Oe])==-1&&Le.push(Y.plugins[Oe]);te(function(){Le.length?window.AMap.plugin(Le,function(){S(Y).then(function(){ke(window.AMap)}).catch(Ke)}):S(Y).then(function(){ke(window.AMap)}).catch(Ke)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,a={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},W={AMap:B.notload,AMapUI:B.notload,Loca:B.notload},D={AMap:[],AMapUI:[],Loca:[]}}}})},hypo:function(Re,y,o){var S=o("O0oS");function v(X,B,a){B=="__proto__"&&S?S(X,B,{configurable:!0,enumerable:!0,value:a,writable:!0}):X[B]=a}Re.exports=v},iWIM:function(Re,y,o){var S=o("n3AX");function v(X,B,a){return typeof Reflect!="undefined"&&Reflect.get?Re.exports=v=Reflect.get:Re.exports=v=function(D,J,te){var ce=S(D,J);if(!!ce){var Y=Object.getOwnPropertyDescriptor(ce,J);return Y.get?Y.get.call(te):Y.value}},v(X,B,a||X)}Re.exports=v},iegG:function(Re,y){function o(S){var v=S.target||S.srcElement;v.__resizeRAF__&&cancelAnimationFrame(v.__resizeRAF__),v.__resizeRAF__=requestAnimationFrame(function(){var X=v.__resizeTrigger__,B=X&&X.__resizeListeners__;B&&B.forEach(function(a){a.call(X,S)})})}var y=function(v,X){var B=this,a=B.document,W,D=a.attachEvent;typeof navigator!="undefined"&&(W=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function J(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",o)}if(!v.__resizeListeners__)if(v.__resizeListeners__=[],D)v.__resizeTrigger__=v,v.attachEvent("onresize",o);else{getComputedStyle(v).position==="static"&&(v.style.position="relative");var te=v.__resizeTrigger__=a.createElement("object");te.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),te.setAttribute("class","resize-sensor"),te.setAttribute("tabindex","-1"),te.__resizeElement__=v,te.onload=J,te.type="text/html",W&&v.appendChild(te),te.data="about:blank",W||v.appendChild(te)}v.__resizeListeners__.push(X)};Re.exports=typeof window=="undefined"?y:y.bind(window),Re.exports.unbind=function(S,v){var X=document.attachEvent,B=S.__resizeListeners__||[];if(v){var a=B.indexOf(v);a!==-1&&B.splice(a,1)}else B=S.__resizeListeners__=[];if(!B.length){if(X)S.detachEvent("onresize",o);else if(S.__resizeTrigger__){var W=S.__resizeTrigger__.contentDocument,D=W&&W.defaultView;D&&(D.removeEventListener("resize",o),delete D.__resizeTrigger__),S.__resizeTrigger__=!S.removeChild(S.__resizeTrigger__)}delete S.__resizeListeners__}}},itsj:function(Re,y){function o(S,v){if(!(v==="constructor"&&typeof S[v]=="function")&&v!="__proto__")return S[v]}Re.exports=o},"iz+Y":function(Re,y,o){Re.exports={miniChart:"antd-pro-pages-dashboard-monitor-components-charts-index-miniChart",chartContent:"antd-pro-pages-dashboard-monitor-components-charts-index-chartContent",chartLoading:"antd-pro-pages-dashboard-monitor-components-charts-index-chartLoading"}},jCWc:function(Re,y,o){"use strict";var S=o("cIOH"),v=o.n(S),X=o("1GLa")},"jIg/":function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.multiInject=void 0;var S=o("xfSm"),v=o("GXnB"),X=o("Ztfv");function B(a){return function(W,D,J){var te=new v.Metadata(S.MULTI_INJECT_TAG,a);typeof J=="number"?X.tagParameter(W,D,J,te):X.tagProperty(W,D,te)}}y.multiInject=B},jYQm:function(Re,y,o){"use strict";var S=o("q1tI"),v=o.n(S),X=Object(S.createContext)({});y.a=X},jYx5:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.optional=void 0;var S=o("xfSm"),v=o("GXnB"),X=o("Ztfv");function B(){return function(a,W,D){var J=new v.Metadata(S.OPTIONAL_TAG,!0);typeof D=="number"?X.tagParameter(a,W,D,J):X.tagProperty(a,W,J)}}y.optional=B},"jbM+":function(Re,y,o){var S=o("R/W3");function v(X,B){var a=X==null?0:X.length;return!!a&&S(X,B,0)>-1}Re.exports=v},jeLo:function(Re,y,o){var S=o("juv8"),v=o("mTTR");function X(B){return S(B,v(B))}Re.exports=X},juv8:function(Re,y,o){var S=o("MrPd"),v=o("hypo");function X(B,a,W,D){var J=!W;W||(W={});for(var te=-1,ce=a.length;++te<ce;){var Y=a[te],ke=D?D(W[Y],B[Y],Y,W,B):void 0;ke===void 0&&(ke=B[Y]),J?v(W,Y,ke):S(W,Y,ke)}return W}Re.exports=X},"k5/I":function(Re,y,o){"use strict";o.d(y,"a",function(){return St}),o.d(y,"b",function(){return Gt}),o.d(y,"e",function(){return oe}),o.d(y,"f",function(){return Ce}),o.d(y,"c",function(){return Kt}),o.d(y,"d",function(){return yt});var S=o("lSNA"),v=o.n(S),X=o("lwsE"),B=o.n(X),a=o("W8MJ"),W=o.n(a),D=o("7W2i"),J=o.n(D),te=o("a1gu"),ce=o.n(te),Y=o("Nsbk"),ke=o.n(Y),Ke=o("h1nZ"),We=o("Hel2"),Oe=o("uhBA");function st(nt,Nt){var $=Object.keys(nt);if(Object.getOwnPropertySymbols){var Ye=Object.getOwnPropertySymbols(nt);Nt&&(Ye=Ye.filter(function(ie){return Object.getOwnPropertyDescriptor(nt,ie).enumerable})),$.push.apply($,Ye)}return $}function Le(nt){for(var Nt=1;Nt<arguments.length;Nt++){var $=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?st(Object($),!0).forEach(function(Ye){v()(nt,Ye,$[Ye])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors($)):st(Object($)).forEach(function(Ye){Object.defineProperty(nt,Ye,Object.getOwnPropertyDescriptor($,Ye))})}return nt}function xt(nt){var Nt=it();return function(){var Ye=ke()(nt),ie;if(Nt){var et=ke()(this).constructor;ie=Reflect.construct(Ye,arguments,et)}else ie=Ye.apply(this,arguments);return ce()(this,ie)}}function it(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var $e;(function(nt){nt.TOPRIGHT="topright",nt.TOPLEFT="topleft",nt.BOTTOMRIGHT="bottomright",nt.BOTTOMLEFT="bottomleft"})($e||($e={}));var Ze=0,St=function(nt){J()($,nt);var Nt=xt($);function $(Ye){var ie;return B()(this,$),ie=Nt.call(this),ie.controlOption=void 0,ie.container=void 0,ie.sceneContainer=void 0,ie.mapsService=void 0,ie.renderService=void 0,ie.layerService=void 0,ie.controlService=void 0,ie.isShow=void 0,ie.controlOption=Le(Le({},ie.getDefault()),Ye||{}),ie}return W()($,[{key:"getDefault",value:function(){return{position:$e.TOPRIGHT,name:"".concat(Ze++)}}},{key:"setPosition",value:function(ie){var et=this.controlService;return et&&et.removeControl(this),this.controlOption.position=ie,et&&et.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(ie){this.mapsService=ie.get(Ke.TYPES.IMapService),this.renderService=ie.get(Ke.TYPES.IRendererService),this.layerService=ie.get(Ke.TYPES.ILayerService),this.controlService=ie.get(Ke.TYPES.IControlService),this.sceneContainer=ie,this.isShow=!0,this.container=this.onAdd();var et=this.container,Bt=this.controlOption.position,lr=this.controlService.controlCorners[Bt];return We.a.addClass(et,"l7-control"),Bt.indexOf("bottom")!==-1?lr.insertBefore(et,lr.firstChild):lr.appendChild(et),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var ie=this.container;We.a.addClass(ie,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var ie=this.container;We.a.removeClass(ie,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;We.a.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(ie){if(this.mapsService&&ie&&ie.screenX>0&&ie.screenY>0){var et=this.mapsService.getContainer();et!==null&&et.focus()}}}]),$}(Oe.EventEmitter),bt=o("PJYZ"),Ne=o.n(bt);function ze(nt){var Nt=Ue();return function(){var Ye=ke()(nt),ie;if(Nt){var et=ke()(this).constructor;ie=Reflect.construct(Ye,arguments,et)}else ie=Ye.apply(this,arguments);return ce()(this,ie)}}function Ue(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var lt=function(nt){J()($,nt);var Nt=ze($);function $(Ye){var ie;return B()(this,$),ie=Nt.call(this,Ye),ie.layerControlInputs=void 0,ie.layers=void 0,ie.lastZIndex=void 0,ie.handlingClick=void 0,ie.layersLink=void 0,ie.baseLayersList=void 0,ie.separator=void 0,ie.overlaysList=void 0,ie.form=void 0,ie.layerControlInputs=[],ie.layers=[],ie.lastZIndex=0,ie.handlingClick=!1,ie.initLayers(),Object(We.i)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],Ne()(ie)),ie}return W()($,[{key:"getDefault",value:function(){return{collapsed:!0,position:Ke.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var ie=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(et){et.layer.on("remove",ie.onLayerChange),et.layer.on("add",ie.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(ie,et){return this.addLayer(ie,et,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var ie=this.renderService.getViewportSize(),et=ie.height;We.a.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var Bt=et-(this.container.offsetTop+50);return Bt<this.form.clientHeight?(We.a.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=Bt+"px"):We.a.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return We.a.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var ie=this;!this.mapsService||(this.mapsService.off("click",this.collapse),this.layers.forEach(function(et){et.layer.off("remove",ie.onLayerChange),et.layer.off("add",ie.onLayerChange)}))}},{key:"initLayout",value:function(){var ie="l7-control-layers",et=this.container=We.a.create("div",ie),Bt=this.controlOption.collapsed;et.setAttribute("aria-haspopup","true");var lr=this.form=We.a.create("form",ie+"-list");Bt&&(this.mapsService.on("click",this.collapse),et.addEventListener("mouseenter",this.expand),et.addEventListener("mouseleave",this.collapse)),this.layersLink=We.a.create("a",ie+"-toggle",et);var dt=this.layersLink;dt.title="Layers",Bt||this.expand(),this.baseLayersList=We.a.create("div",ie+"-base",lr),this.separator=We.a.create("div",ie+"-separator",lr),this.overlaysList=We.a.create("div",ie+"-overlays",lr),et.appendChild(lr)}},{key:"initLayers",value:function(){var ie=this,et=this.controlOption,Bt=et.baseLayers,lr=Bt===void 0?{}:Bt,dt=et.overlayers,vt=dt===void 0?{}:dt;Object.keys(lr).forEach(function(Ct,gt){ie.addLayer(lr[Ct],Ct,!1)}),Object.keys(vt).forEach(function(Ct,gt){ie.addLayer(vt[Ct],Ct,!0)})}},{key:"update",value:function(){if(!this.container)return this;We.a.empty(this.baseLayersList),We.a.empty(this.overlaysList),this.layerControlInputs=[];var ie,et,Bt,lr,dt=0;for(Bt=0;Bt<this.layers.length;Bt++)lr=this.layers[Bt],this.addItem(lr),et=et||lr.overlay,ie=ie||!lr.overlay,dt+=lr.overlay?0:1;return this.controlOption.hideSingleBase&&(ie=ie&&dt>1,this.baseLayersList.style.display=ie?"":"none"),this.separator.style.display=et&&ie?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var ie=this.layerControlInputs,et,Bt,lr=this.mapsService.getZoom(),dt=ie.length-1;dt>=0;dt--)if(et=ie[dt],Bt=this.layerService.getLayer(et.layerId),Bt&&Bt.inited){var vt=Bt.getMinZoom(),Ct=Bt.getMaxZoom();et.disabled=lr<vt||lr>Ct}}},{key:"addLayer",value:function(ie,et,Bt){this.mapsService&&(ie.on("add",this.onLayerChange),ie.on("remove",this.onLayerChange)),this.layers.push({layer:ie,name:et,overlay:Bt});var lr=this.controlOption,dt=lr.sortLayers,vt=lr.sortFunction,Ct=lr.autoZIndex;dt&&this.layers.sort(function(gt,we){return vt(gt.layer,we.layer,gt.name,we.name)}),Ct&&ie.setZIndex&&(this.lastZIndex++,ie.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(ie){this.handlingClick||this.update();var et=this.layerService.getLayer(ie.target.layerId),Bt=(et==null?void 0:et.overlay)?ie.type==="add"?"overlayadd":"overlayremove":ie.type==="add"?"baselayerchange":null;Bt&&this.emit(Bt,et)}},{key:"createRadioElement",value:function(ie,et){var Bt='<input type="radio" class="l7-control-layers-selector" name="'+ie+'"'+(et?' checked="checked"':"")+"/>",lr=document.createElement("div");return lr.innerHTML=Bt,lr.firstChild}},{key:"addItem",value:function(ie){var et=document.createElement("label"),Bt=this.layerService.getLayer(ie.layer.id),lr=Bt&&Bt.inited&&ie.layer.isVisible(),dt;ie.overlay?(dt=document.createElement("input"),dt.type="checkbox",dt.className="l7-control-layers-selector",dt.defaultChecked=lr):dt=this.createRadioElement("l7-base-layers",lr),this.layerControlInputs.push(dt),dt.layerId=ie.layer.id,dt.addEventListener("click",this.onInputClick);var vt=document.createElement("span");vt.innerHTML=" "+ie.name;var Ct=document.createElement("div");et.appendChild(Ct),Ct.appendChild(dt),Ct.appendChild(vt);var gt=ie.overlay?this.overlaysList:this.baseLayersList;return gt.appendChild(et),this.checkDisabledLayers(),et}},{key:"onInputClick",value:function(){var ie=this.layerControlInputs,et,Bt,lr=[],dt=[];this.handlingClick=!0;for(var vt=ie.length-1;vt>=0;vt--)et=ie[vt],Bt=this.layerService.getLayer(et.layerId),et.checked?lr.push(Bt):et.checked||dt.push(Bt);dt.forEach(function(Ct){Ct.hide()}),lr.forEach(function(Ct){Ct.show()}),this.handlingClick=!1}}]),$}(St);function Me(nt){var Nt=ct();return function(){var Ye=ke()(nt),ie;if(Nt){var et=ke()(this).constructor;ie=Reflect.construct(Ye,arguments,et)}else ie=Ye.apply(this,arguments);return ce()(this,ie)}}function ct(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var Gt=function(nt){J()($,nt);var Nt=Me($);function $(){return B()(this,$),Nt.apply(this,arguments)}return W()($,[{key:"getDefault",value:function(){return{position:$e.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var ie="l7-control-logo",et=We.a.create("div",ie),Bt=We.a.create("a","l7-ctrl-logo");return Bt.target="_blank",Bt.rel="noopener nofollow",Bt.href="https://antv.alipay.com/l7",Bt.setAttribute("aria-label","AntV logo"),Bt.setAttribute("rel","noopener nofollow"),et.appendChild(Bt),et}},{key:"onRemove",value:function(){return null}}]),$}(St);function $t(nt){var Nt=ar();return function(){var Ye=ke()(nt),ie;if(Nt){var et=ke()(this).constructor;ie=Reflect.construct(Ye,arguments,et)}else ie=Ye.apply(this,arguments);return ce()(this,ie)}}function ar(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var oe=function(nt){J()($,nt);var Nt=$t($);function $(Ye){var ie;return B()(this,$),ie=Nt.call(this,Ye),ie.mScale=void 0,ie.iScale=void 0,Object(We.i)(["update"],Ne()(ie)),ie}return W()($,[{key:"getDefault",value:function(){return{position:$e.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var ie="l7-control-scale",et=We.a.create("div",ie);this.addScales(ie+"-line",et);var Bt=this.controlOption.updateWhenIdle;return this.mapsService.on(Bt?"moveend":"mapmove",this.update),this.mapsService.on(Bt?"zoomend":"zoomchange",this.update),this.update(),et}},{key:"onRemove",value:function(){var ie=this.controlOption.updateWhenIdle;this.mapsService.off(ie?"zoomend":"zoomchange",this.update),this.mapsService.off(ie?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var ie=this.mapsService,et=this.controlOption.maxWidth,Bt=ie.getSize()[1]/2,lr=ie.containerToLngLat([0,Bt]),dt=ie.containerToLngLat([et,Bt]),vt=Object(We.q)([lr.lng,lr.lat],[dt.lng,dt.lat]);this.updateScales(vt)}},{key:"updateScales",value:function(ie){var et=this.controlOption,Bt=et.metric,lr=et.imperial;Bt&&ie&&this.updateMetric(ie),lr&&ie&&this.updateImperial(ie)}},{key:"updateMetric",value:function(ie){var et=this.getRoundNum(ie),Bt=et<1e3?et+" m":et/1e3+" km";this.updateScale(this.mScale,Bt,et/ie)}},{key:"updateImperial",value:function(ie){var et=ie*3.2808399,Bt,lr,dt;et>5280?(Bt=et/5280,lr=this.getRoundNum(Bt),this.updateScale(this.iScale,lr+" mi",lr/Bt)):(dt=this.getRoundNum(et),this.updateScale(this.iScale,dt+" ft",dt/et))}},{key:"updateScale",value:function(ie,et,Bt){var lr=this.controlOption.maxWidth;ie.style.width=Math.round(lr*Bt)+"px",ie.innerHTML=et}},{key:"getRoundNum",value:function(ie){var et=Math.pow(10,(Math.floor(ie)+"").length-1),Bt=ie/et;return Bt=Bt>=10?10:Bt>=5?5:Bt>=3?3:Bt>=2?2:1,et*Bt}},{key:"addScales",value:function(ie,et){var Bt=this.controlOption,lr=Bt.metric,dt=Bt.imperial;lr&&(this.mScale=We.a.create("div",ie,et)),dt&&(this.iScale=We.a.create("div",ie,et))}}]),$}(St);function Q(nt){var Nt=G();return function(){var Ye=ke()(nt),ie;if(Nt){var et=ke()(this).constructor;ie=Reflect.construct(Ye,arguments,et)}else ie=Ye.apply(this,arguments);return ce()(this,ie)}}function G(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var Ce=function(nt){J()($,nt);var Nt=Q($);function $(Ye){var ie;return B()(this,$),ie=Nt.call(this,Ye),ie.disabled=void 0,ie.zoomInButton=void 0,ie.zoomOutButton=void 0,Object(We.i)(["updateDisabled","zoomIn","zoomOut"],Ne()(ie)),ie}return W()($,[{key:"getDefault",value:function(){return{position:$e.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var ie="l7-control-zoom",et=We.a.create("div",ie+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,ie+"-in",et,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,ie+"-out",et,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),et}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(ie,et,Bt,lr,dt){var vt=We.a.create("a",Bt,lr);return vt.innerHTML=ie,vt.title=et,vt.href="javascript:void(0)",vt.addEventListener("click",dt),vt}},{key:"updateDisabled",value:function(){var ie=this.mapsService,et="l7-disabled";We.a.removeClass(this.zoomInButton,et),We.a.removeClass(this.zoomOutButton,et),(this.disabled||ie.getZoom()<=ie.getMinZoom())&&We.a.addClass(this.zoomOutButton,et),(this.disabled||ie.getZoom()>=ie.getMaxZoom())&&We.a.addClass(this.zoomInButton,et)}}]),$}(St);function be(nt,Nt){var $=Object.keys(nt);if(Object.getOwnPropertySymbols){var Ye=Object.getOwnPropertySymbols(nt);Nt&&(Ye=Ye.filter(function(ie){return Object.getOwnPropertyDescriptor(nt,ie).enumerable})),$.push.apply($,Ye)}return $}function Te(nt){for(var Nt=1;Nt<arguments.length;Nt++){var $=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?be(Object($),!0).forEach(function(Ye){v()(nt,Ye,$[Ye])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors($)):be(Object($)).forEach(function(Ye){Object.defineProperty(nt,Ye,Object.getOwnPropertyDescriptor($,Ye))})}return nt}function me(nt){var Nt=rt();return function(){var Ye=ke()(nt),ie;if(Nt){var et=ke()(this).constructor;ie=Reflect.construct(Ye,arguments,et)}else ie=Ye.apply(this,arguments);return ce()(this,ie)}}function rt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var Kt=function(nt){J()($,nt);var Nt=me($);function $(Ye){var ie;return B()(this,$),ie=Nt.call(this),ie.markerOption=void 0,ie.defaultMarker=void 0,ie.popup=void 0,ie.mapsService=void 0,ie.sceneSerive=void 0,ie.lngLat=void 0,ie.scene=void 0,ie.added=!1,ie.eventHandle=function(et){ie.emit(et.type,{target:et,data:ie.markerOption.extData,lngLat:ie.lngLat})},ie.markerOption=Te(Te({},ie.getDefault()),Ye),Object(We.i)(["update","onMove","onUp","addDragHandler","onMapClick"],Ne()(ie)),ie.init(),ie}return W()($,[{key:"getDefault",value:function(){return{element:void 0,anchor:We.f.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(ie){this.scene=ie,this.mapsService=ie.get(Ke.TYPES.IMapService),this.sceneSerive=ie.get(Ke.TYPES.ISceneService);var et=this.markerOption,Bt=et.element,lr=et.draggable;return this.mapsService.getMarkerContainer().appendChild(Bt),this.registerMarkerEvent(Bt),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var ie=this.markerOption.element;return ie&&We.a.remove(ie),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(ie){return this.lngLat=ie,Array.isArray(ie)&&(this.lngLat={lng:ie[0],lat:ie[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(ie){var et=this;if(!this.added)return this.once("added",function(){et.setElement(ie)}),this;var Bt=this.markerOption.element;return Bt&&We.a.remove(Bt),this.markerOption.element=ie,this.init(),this.mapsService.getMarkerContainer().appendChild(ie),this.registerMarkerEvent(ie),this.update(),this}},{key:"openPopup",value:function(){var ie=this;if(!this.added)return this.once("added",function(){ie.openPopup()}),this;var et=this.popup;return et?(et.isOpen()||et.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var ie=this;this.added||this.once("added",function(){ie.closePopup()});var et=this.popup;return et&&et.remove(),this}},{key:"setPopup",value:function(ie){return this.popup=ie,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var ie=this.popup;if(ie)ie.isOpen()?ie.remove():ie.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(ie){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(ie){this.markerOption.extData=ie}},{key:"update",value:function(){if(!!this.mapsService){var ie=this.markerOption,et=ie.element,Bt=ie.anchor;this.updatePosition(),We.a.setTransform(et,"".concat(We.e[Bt]))}}},{key:"onMapClick",value:function(ie){var et=this.markerOption.element;this.popup&&et&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!!this.mapsService){var ie=this.markerOption,et=ie.element,Bt=ie.offsets,lr=this.lngLat,dt=lr.lng,vt=lr.lat,Ct=this.mapsService.getBounds(),gt=this.mapsService.getZoom();if((dt<Ct[0][0]||dt>Ct[1][0]||vt<Ct[0][1]||vt>Ct[1][1])&&gt>3){et&&(et.style.display="none");return}var we=this.mapsService.lngLatToContainer([dt,vt]);et&&(et.style.display="block",et.style.left=we.x+Bt[0]+"px",et.style.top=we.y-Bt[1]+"px")}}},{key:"init",value:function(){var ie=this,et=this.markerOption.element,Bt=this.markerOption,lr=Bt.color,dt=Bt.anchor;if(!et){this.defaultMarker=!0,et=We.a.create("div"),this.markerOption.element=et;var vt=document.createElementNS("http://www.w3.org/2000/svg","svg");vt.setAttributeNS(null,"display","block"),vt.setAttributeNS(null,"height","48px"),vt.setAttributeNS(null,"width","48px"),vt.setAttributeNS(null,"viewBox","0 0 1024 1024");var Ct=document.createElementNS("http://www.w3.org/2000/svg","path");Ct.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),Ct.setAttributeNS(null,"fill",lr),vt.appendChild(Ct),et.appendChild(vt)}We.a.addClass(et,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(gt){var we,ht,Qe=((we=ie.markerOption)===null||we===void 0?void 0:we.style)&&((ht=ie.markerOption)===null||ht===void 0?void 0:ht.style[gt]);et&&(et.style[gt]=Qe)}),et.addEventListener("click",function(gt){ie.onMapClick(gt)}),et.addEventListener("click",this.eventHandle),Object(We.g)(et,dt,"marker")}},{key:"registerMarkerEvent",value:function(ie){ie.addEventListener("mousemove",this.eventHandle),ie.addEventListener("click",this.eventHandle),ie.addEventListener("mousedown",this.eventHandle),ie.addEventListener("mouseup",this.eventHandle),ie.addEventListener("dblclick",this.eventHandle),ie.addEventListener("contextmenu",this.eventHandle),ie.addEventListener("mouseover",this.eventHandle),ie.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var ie=this.getElement();ie.removeEventListener("mousemove",this.eventHandle),ie.removeEventListener("click",this.eventHandle),ie.removeEventListener("mousedown",this.eventHandle),ie.removeEventListener("mouseup",this.eventHandle),ie.removeEventListener("dblclick",this.eventHandle),ie.removeEventListener("contextmenu",this.eventHandle),ie.removeEventListener("mouseover",this.eventHandle),ie.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(ie){throw new Error("Method not implemented.")}},{key:"onUp",value:function(ie){throw new Error("Method not implemented.")}}]),$}(Oe.EventEmitter),_t=o("QkVN"),ge=o.n(_t),ye=o("mpbz"),Ve=o.n(ye);function ft(nt,Nt){var $=Object.keys(nt);if(Object.getOwnPropertySymbols){var Ye=Object.getOwnPropertySymbols(nt);Nt&&(Ye=Ye.filter(function(ie){return Object.getOwnPropertyDescriptor(nt,ie).enumerable})),$.push.apply($,Ye)}return $}function Ie(nt){for(var Nt=1;Nt<arguments.length;Nt++){var $=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?ft(Object($),!0).forEach(function(Ye){v()(nt,Ye,$[Ye])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors($)):ft(Object($)).forEach(function(Ye){Object.defineProperty(nt,Ye,Object.getOwnPropertyDescriptor($,Ye))})}return nt}function pt(nt){var Nt=C();return function(){var Ye=ke()(nt),ie;if(Nt){var et=ke()(this).constructor;ie=Reflect.construct(Ye,arguments,et)}else ie=Ye.apply(this,arguments);return ce()(this,ie)}}function C(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var R=function(nt){J()($,nt);var Nt=pt($);function $(Ye){var ie,et;return B()(this,$),et=Nt.call(this),et.markers=[],et.markerLayerOption=void 0,et.clusterIndex=void 0,et.points=[],et.clusterMarkers=[],et.mapsService=void 0,et.scene=void 0,et.zoom=void 0,et.bbox=void 0,et.markerLayerOption=ge()(et.getDefault(),Ye),Object(We.i)(["update"],Ne()(et)),et.zoom=((ie=et.markerLayerOption.clusterOption)===null||ie===void 0?void 0:ie.zoom)||-99,et}return W()($,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(ie){return this.scene=ie,this.mapsService=ie.get(Ke.TYPES.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(ie){var et=this.markerLayerOption.cluster;et&&this.addPoint(ie,this.markers.length),this.markers.push(ie)}},{key:"removeMarker",value:function(ie){this.markers.indexOf(ie);var et=this.markers.indexOf(ie);et>-1&&this.markers.splice(et,1)}},{key:"getMarkers",value:function(){var ie=this.markerLayerOption.cluster;return ie?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var ie=this;this.getMarkers().forEach(function(et){et.addTo(ie.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(ie){ie.remove()}),this.clusterMarkers.forEach(function(ie){ie.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(ie,et){var Bt=ie.getLnglat(),lr=Bt.lng,dt=Bt.lat,vt={geometry:{type:"Point",coordinates:[lr,dt]},properties:Ie(Ie({},ie.getExtData()),{},{marker_id:et})};this.points.push(vt)}},{key:"initCluster",value:function(){if(!!this.markerLayerOption.cluster){var ie=this.markerLayerOption.clusterOption,et=ie.radius,Bt=ie.minZoom,lr=Bt===void 0?0:Bt,dt=ie.maxZoom;this.clusterIndex=new Ve.a({radius:et,minZoom:lr,maxZoom:dt}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(ie,et){var Bt=this,lr=ie[0].concat(ie[1]),dt=this.clusterIndex.getClusters(lr,et);this.clusterMarkers.forEach(function(vt){vt.remove()}),this.clusterMarkers=[],dt.forEach(function(vt){var Ct,gt=Bt.markerLayerOption.clusterOption,we=gt.field,ht=gt.method;if(vt.properties&&((Ct=vt.properties)===null||Ct===void 0?void 0:Ct.cluster_id)){var Qe,Vt=Bt.getLeaves((Qe=vt.properties)===null||Qe===void 0?void 0:Qe.cluster_id);if(vt.properties.clusterData=Vt,we&&ht){var pr=Vt==null?void 0:Vt.map(function(ai){var fi=v()({},we,ai.properties[we]);return fi}),Zr=We.c.getColumn(pr,we),cr=We.c.getSatByColumn(ht,Zr),jn="point_"+ht;vt.properties[jn]=cr.toFixed(2)}}var Sn=Bt.clusterMarker(vt);Bt.clusterMarkers.push(Sn),Sn.addTo(Bt.scene)})}},{key:"getLeaves",value:function(ie){var et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,Bt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ie?this.clusterIndex.getLeaves(ie,et,Bt):null}},{key:"clusterMarker",value:function(ie){var et=this.markerLayerOption.clusterOption,Bt=et,lr=Bt.element,dt=lr===void 0?this.generateElement.bind(this):lr,vt=new Kt({element:dt(ie)}).setLnglat({lng:ie.geometry.coordinates[0],lat:ie.geometry.coordinates[1]});return vt}},{key:"normalMarker",value:function(ie){var et=ie.properties.marker_id;return this.markers[et]}},{key:"update",value:function(){var ie=this.mapsService.getZoom(),et=this.mapsService.getBounds();(!this.bbox||Math.abs(ie-this.zoom)>=1||!Object(We.j)(this.bbox,et))&&(this.bbox=Object(We.r)(et,.5),this.zoom=Math.floor(ie),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(ie){var et=We.a.create("div","l7-marker-cluster"),Bt=We.a.create("div","",et),lr=We.a.create("span","",Bt),dt=this.markerLayerOption.clusterOption,vt=dt.field,Ct=dt.method;ie.properties.point_count=ie.properties.point_count||1;var gt=vt&&Ct?ie.properties["point_"+Ct]||ie.properties[vt]:ie.properties.point_count;return lr.textContent=gt,et}}]),$}(Oe.EventEmitter);function q(nt,Nt){var $=Object.keys(nt);if(Object.getOwnPropertySymbols){var Ye=Object.getOwnPropertySymbols(nt);Nt&&(Ye=Ye.filter(function(ie){return Object.getOwnPropertyDescriptor(nt,ie).enumerable})),$.push.apply($,Ye)}return $}function fe(nt){for(var Nt=1;Nt<arguments.length;Nt++){var $=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?q(Object($),!0).forEach(function(Ye){v()(nt,Ye,$[Ye])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors($)):q(Object($)).forEach(function(Ye){Object.defineProperty(nt,Ye,Object.getOwnPropertyDescriptor($,Ye))})}return nt}function Ge(nt){var Nt=Je();return function(){var Ye=ke()(nt),ie;if(Nt){var et=ke()(this).constructor;ie=Reflect.construct(Ye,arguments,et)}else ie=Ye.apply(this,arguments);return ce()(this,ie)}}function Je(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var yt=function(nt){J()($,nt);var Nt=Ge($);function $(Ye){var ie;return B()(this,$),ie=Nt.call(this),ie.popupOption=void 0,ie.mapsService=void 0,ie.sceneSerive=void 0,ie.lngLat=void 0,ie.content=void 0,ie.closeButton=void 0,ie.timeoutInstance=void 0,ie.container=void 0,ie.tip=void 0,ie.scene=void 0,ie.popupOption=fe(fe({},ie.getdefault()),Ye),Object(We.i)(["update","onClickClose","remove"],Ne()(ie)),ie}return W()($,[{key:"addTo",value:function(ie){var et=this;return this.mapsService=ie.get(Ke.TYPES.IMapService),this.sceneSerive=ie.get(Ke.TYPES.ISceneService),this.mapsService.on("camerachange",this.update),this.scene=ie,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){et.mapsService.on("click",et.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(ie){var et=window.document.createDocumentFragment(),Bt=window.document.createElement("body"),lr;for(Bt.innerHTML=ie;lr=Bt.firstChild,!!lr;)et.appendChild(lr);return this.setDOMContent(et)}},{key:"setLnglat",value:function(ie){return this.lngLat=ie,Array.isArray(ie)&&(this.lngLat={lng:ie[0],lat:ie[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(ie){return this.setDOMContent(window.document.createTextNode(ie))}},{key:"setMaxWidth",value:function(ie){return this.popupOption.maxWidth=ie,this.update(),this}},{key:"setDOMContent",value:function(ie){return this.createContent(),this.content.appendChild(ie),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&We.a.remove(this.content),this.content=We.a.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=We.a.create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(ie,et,Bt){var lr=window.document.createElement(ie);return et!==void 0&&(lr.className=et),Bt&&Bt.appendChild(lr),lr}},{key:"removeDom",value:function(ie){ie.parentNode&&ie.parentNode.removeChild(ie)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:We.f.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(ie){ie.stopPropagation&&ie.stopPropagation(),this.remove()}},{key:"update",value:function(){var ie=this,et=this.lngLat,Bt=this.popupOption,lr=Bt.className,dt=Bt.maxWidth,vt=Bt.anchor;if(!(!this.mapsService||!et||!this.content)){var Ct=this.mapsService.getMarkerContainer();if(!this.container&&Ct){this.container=this.creatDom("div","l7-popup",Ct),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),lr&&lr.split(" ").forEach(function(we){return ie.container.classList.add(we)});var gt=this.popupOption.stopPropagation;gt&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(we){ie.container.addEventListener(we,function(ht){ht.stopPropagation()})})}dt&&this.container.style.maxWidth!==dt&&(this.container.style.maxWidth=dt),this.updatePosition(),We.a.setTransform(this.container,"".concat(We.e[vt])),Object(We.g)(this.container,vt,"popup")}}},{key:"updatePosition",value:function(){if(!!this.mapsService){var ie=this.lngLat,et=ie.lng,Bt=ie.lat,lr=this.popupOption.offsets,dt=this.mapsService.lngLatToContainer([et,Bt]);this.container.style.left=dt.x+lr[0]+"px",this.container.style.top=dt.y-lr[1]+"px"}}}]),$}(Oe.EventEmitter);o("BGjm")(`/* @antv/l7-component */
.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
 }

.l7-marker {
	position: absolute !important;
	top: 0;
	left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
    -webkit-flex-direction: column-reverse;
    -webkit-box-orient: vertical;
    -webkit-box-direction: reverse;
        -ms-flex-direction: column-reverse;
            flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 5px;
	}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
    -webkit-flex-direction: column;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}


.l7-popup-anchor-left {
    -webkit-flex-direction: row;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
        -ms-flex-direction: row;
            flex-direction: row;
}

.l7-popup-anchor-right {
    -webkit-flex-direction: row-reverse;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: reverse;
        -ms-flex-direction: row-reverse;
            flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-flex;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-top: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-top: none;
	border-left: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-top: none;
	border-right: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-bottom: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-bottom: none;
	border-left: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-bottom: none;
	border-right: none;
	border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-left: none;
	border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-right: none;
	border-left-color: #fff;
}

.l7-popup-close-button {
	position: absolute;
	right: 0;
	top: 0;
	border: 0;
	padding: 0;
	font-size: 25px;
	line-height: 20px;
	border-radius: 0 3px 0 0;
	cursor: pointer;
	background-color: transparent;
}

.l7-popup-close-button:hover {
	background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
	position: relative;
	background: #fff;
	border-radius: 3px;
	-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	padding: 10px 10px 15px;
	pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
	border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
	border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
	border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
	border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
	display: none;
}

.l7-popup-track-pointer * {
	pointer-events: none;
	-webkit-user-select: none;
	   -moz-user-select: none;
	    -ms-user-select: none;
	        user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
	display: -webkit-box;
	display: -webkit-flex;
	display: -ms-flexbox;
	display: flex;
}

.l7-map:active .l7-popup-track-pointer {
	display: none;
}


.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	border-radius: 4px;
	}
.l7-bar a,
.l7-bar a:hover {
	background-color: #fff;
	width: 30px;
	height: 30px;
  font-size: 20px;
	display: block;
	text-align: center;
	text-decoration: none;
	color: #8E9DAB;
	}
.l7-bar a,
.l7-control-layers-toggle {
	background-position: 50% 50%;
	background-repeat: no-repeat;
	display: block;
	}
.l7-bar a:hover {
	background-color: #f4f4f4;
	}
.l7-bar a:first-child {
	border-top-left-radius: 2px;
	border-top-right-radius: 2px;
	}
.l7-bar a:last-child {
	border-bottom-left-radius: 2px;
	border-bottom-right-radius: 2px;
	border-bottom: none;
	}
.l7-bar a.l7-disabled {
	cursor: default;
	background-color: #f4f4f4;
	color: #bbb;
	}


/* control positioning */

.l7-control-container {
	font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
}
.l7-control-hide {
	display: none;
}
.l7-control {
	position: relative;
	z-index: 800;
	pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
	pointer-events: auto;
	}
.l7-control {
	float: left;
	clear: both;
	}.l7-top,
  .l7-bottom {
    position: absolute;
    z-index: 1000;
    pointer-events: none;
    }
  .l7-top {
    top: 0;
    }
  .l7-right {
    right: 0;
    }
  .l7-bottom {
    bottom: 0;
    }
  .l7-left {
    left: 0;
    }

  .l7-control {
    float: left;
    clear: both;
    }
  .l7-right .l7-control {
    float: right;
    }
  .l7-top .l7-control {
    margin-top: 10px;
    }
  .l7-bottom .l7-control {
    margin-bottom: 10px;
    }
  .l7-left .l7-control {
    margin-left: 10px;
    }
  .l7-right .l7-control {
    margin-right: 10px;
    }

  /* attribution and scale controls */

.l7-control-container .l7-control-attribution {
	background: #fff;
	background: rgba(255, 255, 255, 0.7);
	margin: 0;
	}
.l7-control-attribution,
.l7-control-scale-line {
	padding: 0 5px;
  color: #333;
	}
.l7-control-attribution a {
	text-decoration: none;
	}
.l7-control-attribution a:hover {
	text-decoration: underline;
	}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
	}
.l7-left .l7-control-scale {
	margin-left: 5px;
	}
.l7-bottom .l7-control-scale {
	margin-bottom: 5px;
	}
.l7-control-scale-line {
	border: 2px solid #000;
  border-top: none;
  color: #000;
	line-height: 1.1;
	padding: 2px 5px 1px;
	font-size: 11px;
	white-space: nowrap;
	overflow: hidden;
	-webkit-box-sizing: border-box;
	        box-sizing: border-box;

	background: #fff;
	}
.l7-control-scale-line:not(:first-child) {
	border-top: 2px solid #777;
	border-bottom: none;
	margin-top: -2px;
	}
.l7-control-scale-line:not(:first-child):not(:last-child) {
	border-bottom: 2px solid #777;
	}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	-webkit-box-shadow: none;
	        box-shadow: none;
	}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	border: 2px solid rgba(0,0,0,0.2);
	background-clip: padding-box;
  }
  /*logo */

  .l7-ctrl-logo {
    background-size: 100% 100%;
    width: 89px;
    height: 16px;
    margin: 0 0 -3px -3px;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    background-repeat: no-repeat;
    cursor: pointer;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}


	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 2px;
	}
.l7-control-layers-toggle {
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
	width: 30px;
  height: 30px;
  background-size: 20px 20px;
	}

.l7-touch .l7-control-layers-toggle {
	width: 44px;
	height: 44px;
	}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
	display: none;
	}
.l7-control-layers-expanded .l7-control-layers-list {
	display: block;
	position: relative;
	}
.l7-control-layers-expanded {
	padding: 6px 10px 6px 6px;
	color: #59626B;
	background: #fff;
	}
.l7-control-layers-scrollbar {
	overflow-y: scroll;
	overflow-x: hidden;
	padding-right: 5px;
	}
.l7-control-layers-selector {
	margin-top: 2px;
	position: relative;
	top: 1px;
	}
.l7-control-layers label {
  display: block;
  padding: 8px;
  }
  .l7-control-layers label input[type="radio"],
  .l7-control-layers label input[type="checkbox"] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
	height: 0;
	border-top: 1px solid #D8D8D8;
	margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
 }
 .amap-logo{
  display: none !important;
 }


`)},kPKH:function(Re,y,o){"use strict";var S=o("/kpp");y.a=S.a},"kQ+U":function(Re,y,o){"use strict";o.d(y,"a",function(){return vt});var S=o("lSNA"),v=o.n(S),X=o("lwsE"),B=o.n(X),a=o("W8MJ"),W=o.n(a),D=o("k5/I"),J=o("h1nZ"),te=o("o0o1"),ce=o.n(te),Y=o("yXPU"),ke=o.n(Y),Ke=o("4cb6"),We=o("fbvF"),Oe=o.n(We),st=function(){function Ct(gt,we){B()(this,Ct),this.attribute=void 0,this.buffer=void 0;var ht=we.buffer,Qe=we.offset,Vt=we.stride,pr=we.normalized,Zr=we.size,cr=we.divisor;this.buffer=ht,this.attribute={buffer:ht.get(),offset:Qe||0,stride:Vt||0,normalized:pr||!1,divisor:cr||0},Zr&&(this.attribute.size=Zr)}return W()(Ct,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(we){this.buffer.subData(we)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),Ct}(),Le,xt,it,$e,Ze,St,bt,Ne,ze,Ue,lt,Me,ct,Gt,$t=(Le={},v()(Le,J.gl.POINTS,"points"),v()(Le,J.gl.LINES,"lines"),v()(Le,J.gl.LINE_LOOP,"line loop"),v()(Le,J.gl.LINE_STRIP,"line strip"),v()(Le,J.gl.TRIANGLES,"triangles"),v()(Le,J.gl.TRIANGLE_FAN,"triangle fan"),v()(Le,J.gl.TRIANGLE_STRIP,"triangle strip"),Le),ar=(xt={},v()(xt,J.gl.STATIC_DRAW,"static"),v()(xt,J.gl.DYNAMIC_DRAW,"dynamic"),v()(xt,J.gl.STREAM_DRAW,"stream"),xt),oe=(it={},v()(it,J.gl.BYTE,"int8"),v()(it,J.gl.UNSIGNED_INT,"int16"),v()(it,J.gl.INT,"int32"),v()(it,J.gl.UNSIGNED_BYTE,"uint8"),v()(it,J.gl.UNSIGNED_SHORT,"uint16"),v()(it,J.gl.UNSIGNED_INT,"uint32"),v()(it,J.gl.FLOAT,"float"),it),Q=($e={},v()($e,J.gl.ALPHA,"alpha"),v()($e,J.gl.LUMINANCE,"luminance"),v()($e,J.gl.LUMINANCE_ALPHA,"luminance alpha"),v()($e,J.gl.RGB,"rgb"),v()($e,J.gl.RGBA,"rgba"),v()($e,J.gl.RGBA4,"rgba4"),v()($e,J.gl.RGB5_A1,"rgb5 a1"),v()($e,J.gl.RGB565,"rgb565"),v()($e,J.gl.DEPTH_COMPONENT,"depth"),v()($e,J.gl.DEPTH_STENCIL,"depth stencil"),$e),G=(Ze={},v()(Ze,J.gl.DONT_CARE,"dont care"),v()(Ze,J.gl.NICEST,"nice"),v()(Ze,J.gl.FASTEST,"fast"),Ze),Ce=(St={},v()(St,J.gl.NEAREST,"nearest"),v()(St,J.gl.LINEAR,"linear"),v()(St,J.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),v()(St,J.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),v()(St,J.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),v()(St,J.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),St),be=(bt={},v()(bt,J.gl.REPEAT,"repeat"),v()(bt,J.gl.CLAMP_TO_EDGE,"clamp"),v()(bt,J.gl.MIRRORED_REPEAT,"mirror"),bt),Te=(Ne={},v()(Ne,J.gl.NONE,"none"),v()(Ne,J.gl.BROWSER_DEFAULT_WEBGL,"browser"),Ne),me=(ze={},v()(ze,J.gl.NEVER,"never"),v()(ze,J.gl.ALWAYS,"always"),v()(ze,J.gl.LESS,"less"),v()(ze,J.gl.LEQUAL,"lequal"),v()(ze,J.gl.GREATER,"greater"),v()(ze,J.gl.GEQUAL,"gequal"),v()(ze,J.gl.EQUAL,"equal"),v()(ze,J.gl.NOTEQUAL,"notequal"),ze),rt=(Ue={},v()(Ue,J.gl.FUNC_ADD,"add"),v()(Ue,J.gl.MIN_EXT,"min"),v()(Ue,J.gl.MAX_EXT,"max"),v()(Ue,J.gl.FUNC_SUBTRACT,"subtract"),v()(Ue,J.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Ue),Kt=(lt={},v()(lt,J.gl.ZERO,"zero"),v()(lt,J.gl.ONE,"one"),v()(lt,J.gl.SRC_COLOR,"src color"),v()(lt,J.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),v()(lt,J.gl.SRC_ALPHA,"src alpha"),v()(lt,J.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),v()(lt,J.gl.DST_COLOR,"dst color"),v()(lt,J.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),v()(lt,J.gl.DST_ALPHA,"dst alpha"),v()(lt,J.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),v()(lt,J.gl.CONSTANT_COLOR,"constant color"),v()(lt,J.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),v()(lt,J.gl.CONSTANT_ALPHA,"constant alpha"),v()(lt,J.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),v()(lt,J.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),lt),_t=(Me={},v()(Me,J.gl.NEVER,"never"),v()(Me,J.gl.ALWAYS,"always"),v()(Me,J.gl.LESS,"less"),v()(Me,J.gl.LEQUAL,"lequal"),v()(Me,J.gl.GREATER,"greater"),v()(Me,J.gl.GEQUAL,"gequal"),v()(Me,J.gl.EQUAL,"equal"),v()(Me,J.gl.NOTEQUAL,"notequal"),Me),ge=(ct={},v()(ct,J.gl.ZERO,"zero"),v()(ct,J.gl.KEEP,"keep"),v()(ct,J.gl.REPLACE,"replace"),v()(ct,J.gl.INVERT,"invert"),v()(ct,J.gl.INCR,"increment"),v()(ct,J.gl.DECR,"decrement"),v()(ct,J.gl.INCR_WRAP,"increment wrap"),v()(ct,J.gl.DECR_WRAP,"decrement wrap"),ct),ye=(Gt={},v()(Gt,J.gl.FRONT,"front"),v()(Gt,J.gl.BACK,"back"),Gt),Ve=function(){function Ct(gt,we){B()(this,Ct),this.buffer=void 0;var ht=we.data,Qe=we.usage,Vt=we.type;this.buffer=gt.buffer({data:ht,usage:ar[Qe||J.gl.STATIC_DRAW],type:oe[Vt||J.gl.UNSIGNED_BYTE]})}return W()(Ct,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(we){var ht=we.data,Qe=we.offset;this.buffer.subdata(ht,Qe)}}]),Ct}(),ft=function(){function Ct(gt,we){B()(this,Ct),this.elements=void 0;var ht=we.data,Qe=we.usage,Vt=we.type,pr=we.count;this.elements=gt.elements({data:ht,usage:ar[Qe||J.gl.STATIC_DRAW],type:oe[Vt||J.gl.UNSIGNED_BYTE],count:pr})}return W()(Ct,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(we){var ht=we.data;this.elements.subdata(ht)}},{key:"destroy",value:function(){}}]),Ct}(),Ie=function(){function Ct(gt,we){B()(this,Ct),this.framebuffer=void 0;var ht=we.width,Qe=we.height,Vt=we.color,pr=we.colors,Zr=we.depth,cr=we.stencil,jn={width:ht,height:Qe};Array.isArray(pr)&&(jn.colors=pr.map(function(Sn){return Sn.get()})),Vt&&typeof Vt!="boolean"&&(jn.color=Vt.get()),this.framebuffer=gt.framebuffer(jn)}return W()(Ct,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(we){var ht=we.width,Qe=we.height;this.framebuffer.resize(ht,Qe)}}]),Ct}(),pt=o("cDf5"),C=o.n(pt),R=o("c6wG"),q=o.n(R),fe=o("YO3V"),Ge=o.n(fe);function Je(Ct,gt){var we=Object.keys(Ct);if(Object.getOwnPropertySymbols){var ht=Object.getOwnPropertySymbols(Ct);gt&&(ht=ht.filter(function(Qe){return Object.getOwnPropertyDescriptor(Ct,Qe).enumerable})),we.push.apply(we,ht)}return we}function yt(Ct){for(var gt=1;gt<arguments.length;gt++){var we=arguments[gt]!=null?arguments[gt]:{};gt%2?Je(Object(we),!0).forEach(function(ht){v()(Ct,ht,we[ht])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ct,Object.getOwnPropertyDescriptors(we)):Je(Object(we)).forEach(function(ht){Object.defineProperty(Ct,ht,Object.getOwnPropertyDescriptor(we,ht))})}return Ct}var nt=function(){function Ct(gt,we){B()(this,Ct),this.reGl=void 0,this.destroyed=!1,this.drawCommand=void 0,this.drawParams=void 0,this.options=void 0,this.uniforms={},this.reGl=gt;var ht=we.vs,Qe=we.fs,Vt=we.attributes,pr=we.uniforms,Zr=we.primitive,cr=we.count,jn=we.elements,Sn=we.depth,ai=we.blend,fi=we.stencil,Zn=we.cull,Hn=we.instances,k={};this.options=we,pr&&(this.uniforms=this.extractUniforms(pr),Object.keys(pr).forEach(function(de){k[de]=gt.prop(de)}));var H={};Object.keys(Vt).forEach(function(de){H[de]=Vt[de].get()});var le={attributes:H,frag:Qe,uniforms:k,vert:ht,primitive:$t[Zr===void 0?J.gl.TRIANGLES:Zr]};Hn&&(le.instances=Hn),cr&&(le.count=cr),jn&&(le.elements=jn.get()),this.initDepthDrawParams({depth:Sn},le),this.initBlendDrawParams({blend:ai},le),this.initStencilDrawParams({stencil:fi},le),this.initCullDrawParams({cull:Zn},le),this.drawCommand=gt(le),this.drawParams=le}return W()(Ct,[{key:"addUniforms",value:function(we){this.uniforms=yt(yt({},this.uniforms),this.extractUniforms(we))}},{key:"draw",value:function(we){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var ht=yt(yt({},this.uniforms),this.extractUniforms(we.uniforms||{})),Qe={};Object.keys(ht).forEach(function(Vt){var pr=C()(ht[Vt]);pr==="boolean"||pr==="number"||Array.isArray(ht[Vt])||ht[Vt].BYTES_PER_ELEMENT?Qe[Vt]=ht[Vt]:Qe[Vt]=ht[Vt].get()}),this.drawCommand(Qe)}}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(we){we.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(we,ht){var Qe=we.depth;Qe&&(ht.depth={enable:Qe.enable===void 0?!0:!!Qe.enable,mask:Qe.mask===void 0?!0:!!Qe.mask,func:me[Qe.func||J.gl.LESS],range:Qe.range||[0,1]})}},{key:"initBlendDrawParams",value:function(we,ht){var Qe=we.blend;if(Qe){var Vt=Qe.enable,pr=Qe.func,Zr=Qe.equation,cr=Qe.color,jn=cr===void 0?[0,0,0,0]:cr;ht.blend={enable:!!Vt,func:{srcRGB:Kt[pr&&pr.srcRGB||J.gl.SRC_ALPHA],srcAlpha:Kt[pr&&pr.srcAlpha||J.gl.SRC_ALPHA],dstRGB:Kt[pr&&pr.dstRGB||J.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Kt[pr&&pr.dstAlpha||J.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:rt[Zr&&Zr.rgb||J.gl.FUNC_ADD],alpha:rt[Zr&&Zr.alpha||J.gl.FUNC_ADD]},color:jn}}}},{key:"initStencilDrawParams",value:function(we,ht){var Qe=we.stencil;if(Qe){var Vt=Qe.enable,pr=Qe.mask,Zr=pr===void 0?-1:pr,cr=Qe.func,jn=cr===void 0?{cmp:J.gl.ALWAYS,ref:0,mask:-1}:cr,Sn=Qe.opFront,ai=Sn===void 0?{fail:J.gl.KEEP,zfail:J.gl.KEEP,zpass:J.gl.KEEP}:Sn,fi=Qe.opBack,Zn=fi===void 0?{fail:J.gl.KEEP,zfail:J.gl.KEEP,zpass:J.gl.KEEP}:fi;ht.stencil={enable:!!Vt,mask:Zr,func:yt(yt({},jn),{},{cmp:_t[jn.cmp]}),opFront:{fail:ge[ai.fail],zfail:ge[ai.zfail],zpass:ge[ai.zpass]},opBack:{fail:ge[Zn.fail],zfail:ge[Zn.zfail],zpass:ge[Zn.zpass]}}}}},{key:"initCullDrawParams",value:function(we,ht){var Qe=we.cull;if(Qe){var Vt=Qe.enable,pr=Qe.face,Zr=pr===void 0?J.gl.BACK:pr;ht.cull={enable:!!Vt,face:ye[Zr]}}}},{key:"extractUniforms",value:function(we){var ht=this,Qe={};return Object.keys(we).forEach(function(Vt){ht.extractUniformsRecursively(Vt,we[Vt],Qe,"")}),Qe}},{key:"extractUniformsRecursively",value:function(we,ht,Qe,Vt){var pr=this;if(ht===null||typeof ht=="number"||typeof ht=="boolean"||Array.isArray(ht)&&typeof ht[0]=="number"||q()(ht)||ht===""||"resize"in ht){Qe["".concat(Vt&&Vt+".").concat(we)]=ht;return}Ge()(ht)&&Object.keys(ht).forEach(function(Zr){pr.extractUniformsRecursively(Zr,ht[Zr],Qe,"".concat(Vt&&Vt+".").concat(we))}),Array.isArray(ht)&&ht.forEach(function(Zr,cr){Object.keys(Zr).forEach(function(jn){pr.extractUniformsRecursively(jn,Zr[jn],Qe,"".concat(Vt&&Vt+".").concat(we,"[").concat(cr,"]"))})})}}]),Ct}(),Nt=function(){function Ct(gt,we){B()(this,Ct),this.texture=void 0,this.width=void 0,this.height=void 0;var ht=we.data,Qe=we.type,Vt=Qe===void 0?J.gl.UNSIGNED_BYTE:Qe,pr=we.width,Zr=we.height,cr=we.flipY,jn=cr===void 0?!1:cr,Sn=we.format,ai=Sn===void 0?J.gl.RGBA:Sn,fi=we.mipmap,Zn=fi===void 0?!1:fi,Hn=we.wrapS,k=Hn===void 0?J.gl.CLAMP_TO_EDGE:Hn,H=we.wrapT,le=H===void 0?J.gl.CLAMP_TO_EDGE:H,de=we.aniso,at=de===void 0?0:de,At=we.alignment,Ft=At===void 0?1:At,He=we.premultiplyAlpha,Pt=He===void 0?!1:He,or=we.mag,jr=or===void 0?J.gl.NEAREST:or,Hr=we.min,sr=Hr===void 0?J.gl.NEAREST:Hr,Fr=we.colorSpace,_n=Fr===void 0?J.gl.BROWSER_DEFAULT_WEBGL:Fr;this.width=pr,this.height=Zr;var dn={width:pr,height:Zr,type:oe[Vt],format:Q[ai],wrapS:be[k],wrapT:be[le],mag:Ce[jr],min:Ce[sr],alignment:Ft,flipY:jn,colorSpace:Te[_n],premultiplyAlpha:Pt,aniso:at};ht&&(dn.data=ht),typeof Zn=="number"?dn.mipmap=G[Zn]:typeof Zn=="boolean"&&(dn.mipmap=Zn),this.texture=gt.texture(dn)}return W()(Ct,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var we=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(we)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(we){var ht=we.width,Qe=we.height;this.texture.resize(ht,Qe),this.width=ht,this.height=Qe}},{key:"destroy",value:function(){this.texture.destroy()}}]),Ct}(),$,Ye,ie,et=($=Object(Ke.injectable)(),$(Ye=(ie=function(){function Ct(){var gt=this;B()(this,Ct),this.gl=void 0,this.$container=void 0,this.canvas=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(we){return new nt(gt.gl,we)},this.createAttribute=function(we){return new st(gt.gl,we)},this.createBuffer=function(we){return new Ve(gt.gl,we)},this.createElements=function(we){return new ft(gt.gl,we)},this.createTexture2D=function(we){return new Nt(gt.gl,we)},this.createFramebuffer=function(we){return new Ie(gt.gl,we)},this.useFramebuffer=function(we,ht){gt.gl({framebuffer:we?we.get():null})(ht)},this.clear=function(we){var ht=we.color,Qe=we.depth,Vt=we.stencil,pr=we.framebuffer,Zr=pr===void 0?null:pr,cr={color:ht,depth:Qe,stencil:Vt};cr.framebuffer=Zr===null?Zr:Zr.get(),gt.gl.clear(cr)},this.viewport=function(we){var ht=we.x,Qe=we.y,Vt=we.width,pr=we.height;gt.gl._gl.viewport(ht,Qe,Vt,pr),gt.width=Vt,gt.height=pr,gt.gl._refresh()},this.readPixels=function(we){var ht=we.framebuffer,Qe=we.x,Vt=we.y,pr=we.width,Zr=we.height,cr={x:Qe,y:Vt,width:pr,height:Zr};return ht&&(cr.framebuffer=ht.get()),gt.gl.read(cr)},this.getViewportSize=function(){return{width:gt.gl._gl.drawingBufferWidth,height:gt.gl._gl.drawingBufferHeight}},this.getContainer=function(){var we;return(we=gt.canvas)===null||we===void 0?void 0:we.parentElement},this.getCanvas=function(){return gt.canvas},this.getGLContext=function(){return gt.gl._gl},this.destroy=function(){gt.gl.destroy()}}return W()(Ct,[{key:"init",value:function(){var gt=ke()(ce.a.mark(function ht(Qe,Vt){var pr=this;return ce.a.wrap(function(cr){for(;;)switch(cr.prev=cr.next){case 0:return this.canvas=Qe,cr.next=3,new Promise(function(jn,Sn){Oe()({canvas:pr.canvas,attributes:{alpha:!0,antialias:Vt.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:Vt.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(fi,Zn){(fi||!Zn)&&Sn(fi),jn(Zn)}})});case 3:this.gl=cr.sent;case 4:case"end":return cr.stop()}},ht,this)}));function we(ht,Qe){return gt.apply(this,arguments)}return we}()},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var we=this.getGLContext();we.disable(we.CULL_FACE)}},{key:"setDirty",value:function(we){this.isDirty=we}},{key:"getDirty",value:function(){return this.isDirty}}]),Ct}(),ie))||Ye),Bt=o("Hel2");function lr(Ct,gt){var we=Object.keys(Ct);if(Object.getOwnPropertySymbols){var ht=Object.getOwnPropertySymbols(Ct);gt&&(ht=ht.filter(function(Qe){return Object.getOwnPropertyDescriptor(Ct,Qe).enumerable})),we.push.apply(we,ht)}return we}function dt(Ct){for(var gt=1;gt<arguments.length;gt++){var we=arguments[gt]!=null?arguments[gt]:{};gt%2?lr(Object(we),!0).forEach(function(ht){v()(Ct,ht,we[ht])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ct,Object.getOwnPropertyDescriptors(we)):lr(Object(we)).forEach(function(ht){Object.defineProperty(Ct,ht,Object.getOwnPropertyDescriptor(we,ht))})}return Ct}var vt=function(){function Ct(gt){B()(this,Ct),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var we=gt.id,ht=gt.map,Qe=Object(J.createSceneContainer)();this.container=Qe,ht.setContainer(Qe,we),Qe.bind(J.TYPES.IRendererService).to(et).inSingletonScope(),this.sceneService=Qe.get(J.TYPES.ISceneService),this.mapService=Qe.get(J.TYPES.IMapService),this.iconService=Qe.get(J.TYPES.IIconService),this.fontService=Qe.get(J.TYPES.IFontService),this.controlService=Qe.get(J.TYPES.IControlService),this.layerService=Qe.get(J.TYPES.ILayerService),this.markerService=Qe.get(J.TYPES.IMarkerService),this.interactionService=Qe.get(J.TYPES.IInteractionService),this.popupService=Qe.get(J.TYPES.IPopupService),this.initComponent(we),this.sceneService.init(gt),this.initControl()}return W()(Ct,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(we){return this.sceneService.exportPng(we)}},{key:"exportMap",value:function(we){return this.sceneService.exportPng(we)}},{key:"registerRenderService",value:function(we){var ht=this;if(this.sceneService.loaded){var Qe=new we(this);Qe.init()}else this.on("loaded",function(){var Vt=new we(ht);Vt.init()})}},{key:"addLayer",value:function(we){var ht=Object(J.createLayerContainer)(this.container);we.setContainer(ht),this.sceneService.addLayer(we)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(we){return this.layerService.getLayer(we)}},{key:"getLayerByName",value:function(we){return this.layerService.getLayerByName(we)}},{key:"removeLayer",value:function(we){this.layerService.remove(we)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addImage",value:function(we,ht){this.iconService.addImage(we,ht)}},{key:"hasImage",value:function(we){return this.iconService.hasImage(we)}},{key:"removeImage",value:function(we){this.iconService.removeImage(we)}},{key:"addIconFontGlyphs",value:function(we,ht){this.fontService.addIconGlyphs(ht)}},{key:"addControl",value:function(we){this.controlService.addControl(we,this.container)}},{key:"removeControl",value:function(we){this.controlService.removeControl(we)}},{key:"getControlByName",value:function(we){return this.controlService.getControlByName(we)}},{key:"addMarker",value:function(we){this.markerService.addMarker(we)}},{key:"addMarkerLayer",value:function(we){this.markerService.addMarkerLayer(we)}},{key:"removeMarkerLayer",value:function(we){this.markerService.removeMarkerLayer(we)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(we){this.popupService.addPopup(we)}},{key:"on",value:function(we,ht){J.SceneEventList.indexOf(we)===-1?this.mapService.on(we,ht):this.sceneService.on(we,ht)}},{key:"off",value:function(we,ht){J.SceneEventList.indexOf(we)===-1?this.mapService.off(we,ht):this.sceneService.off(we,ht)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(){return this.mapService.getCenter()}},{key:"setCenter",value:function(we){return this.mapService.setCenter(we)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(we){return this.mapService.setPitch(we)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(we){this.mapService.setRotation(we)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(we){this.mapService.panTo(we)}},{key:"panBy",value:function(we){this.mapService.panBy(we)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(we){this.mapService.setZoom(we)}},{key:"fitBounds",value:function(we,ht){var Qe=this.sceneService.getSceneConfig(),Vt=Qe.fitBoundsOptions,pr=Qe.animate;this.mapService.fitBounds(we,ht||dt(dt({},Vt),{},{animate:pr}))}},{key:"setZoomAndCenter",value:function(we,ht){this.mapService.setZoomAndCenter(we,ht)}},{key:"setMapStyle",value:function(we){this.mapService.setMapStyle(we)}},{key:"setMapStatus",value:function(we){this.mapService.setMapStatus(we)}},{key:"pixelToLngLat",value:function(we){return this.mapService.pixelToLngLat(we)}},{key:"lngLatToPixel",value:function(we){return this.mapService.lngLatToPixel(we)}},{key:"containerToLngLat",value:function(we){return this.mapService.containerToLngLat(we)}},{key:"lngLatToContainer",value:function(we){return this.mapService.lngLatToContainer(we)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(we,ht){this.container.bind(J.TYPES.IPostProcessingPass).to(we).whenTargetNamed(ht)}},{key:"initComponent",value:function(we){this.controlService.init({container:Bt.a.getContainer(we)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var we=this.sceneService.getSceneConfig(),ht=we.logoVisible,Qe=we.logoPosition;ht&&this.addControl(new D.b({position:Qe}))}},{key:"map",get:function(){return this.mapService.map}}]),Ct}()},l94r:function(Re,y,o){"use strict";o.d(y,"a",function(){return Q});var S=o("lSNA"),v=o.n(S),X=o("lwsE"),B=o.n(X),a=o("W8MJ"),W=o.n(a),D=o("7W2i"),J=o.n(D),te=o("a1gu"),ce=o.n(te),Y=o("Nsbk"),ke=o.n(Y),Ke=o("4qC0"),We=o.n(Ke),Oe=o("lSCD"),st=o.n(Oe),Le=o("BkRI"),xt=o.n(Le),it=o("xp6e"),$e=o("Hel2"),Ze=o("uhBA"),St=o("rlAn"),bt=o("qxNg");function Ne(G){if(G.length===0)throw new Error("max requires at least one data point");for(var Ce=G[0],be=1;be<G.length;be++)G[be]>Ce&&(Ce=G[be]);return Ce}function ze(G){if(G.length===0)throw new Error("min requires at least one data point");for(var Ce=G[0],be=1;be<G.length;be++)G[be]<Ce&&(Ce=G[be]);return Ce}function Ue(G){if(G.length===0)return 0;for(var Ce=G[0],be=0,Te,me=1;me<G.length;me++)Te=Ce+G[me]*1,Math.abs(Ce)>=Math.abs(G[me])?be+=Ce-Te+G[me]:be+=G[me]-Te+Ce,Ce=Te;return Ce+be*1}function lt(G){if(G.length===0)throw new Error("mean requires at least one data point");return Ue(G)/G.length}var Me={min:ze,max:Ne,mean:lt,sum:Ue};function ct(G,Ce){return G.map(function(be){return be[Ce]*1})}function Gt(G,Ce){var be=Object.keys(G);if(Object.getOwnPropertySymbols){var Te=Object.getOwnPropertySymbols(G);Ce&&(Te=Te.filter(function(me){return Object.getOwnPropertyDescriptor(G,me).enumerable})),be.push.apply(be,Te)}return be}function $t(G){for(var Ce=1;Ce<arguments.length;Ce++){var be=arguments[Ce]!=null?arguments[Ce]:{};Ce%2?Gt(Object(be),!0).forEach(function(Te){v()(G,Te,be[Te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(G,Object.getOwnPropertyDescriptors(be)):Gt(Object(be)).forEach(function(Te){Object.defineProperty(G,Te,Object.getOwnPropertyDescriptor(be,Te))})}return G}function ar(G){var Ce=oe();return function(){var Te=ke()(G),me;if(Ce){var rt=ke()(this).constructor;me=Reflect.construct(Te,arguments,rt)}else me=Te.apply(this,arguments);return ce()(this,me)}}function oe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(G){return!1}}var Q=function(G){J()(be,G);var Ce=ar(be);function be(Te,me){var rt;return B()(this,be),rt=Ce.call(this),rt.data=void 0,rt.extent=void 0,rt.hooks={init:new it.c},rt.parser={type:"geojson"},rt.transforms=[],rt.cluster=!1,rt.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},rt.originData=void 0,rt.rawData=void 0,rt.clusterIndex=void 0,rt.originData=Te,rt.initCfg(me),rt.hooks.init.tap("parser",function(){rt.excuteParser()}),rt.hooks.init.tap("cluster",function(){rt.initCluster()}),rt.hooks.init.tap("transform",function(){rt.executeTrans()}),rt.init(),rt}return W()(be,[{key:"setData",value:function(me,rt){this.rawData=me,this.originData=me,this.initCfg(rt),this.init(),this.emit("update")}},{key:"getClusters",value:function(me){return this.clusterIndex.getClusters(this.extent,me)}},{key:"getClustersLeaves",value:function(me){return this.clusterIndex.getLeaves(me,Infinity)}},{key:"updateClusterData",value:function(me){var rt=this,Kt=this.clusterOptions,_t=Kt.method,ge=_t===void 0?"sum":_t,ye=Kt.field,Ve=Object($e.r)(Object($e.h)(this.extent),2),ft=this.clusterIndex.getClusters(Ve[0].concat(Ve[1]),Math.floor(me));this.clusterOptions.zoom=me,ft.forEach(function(Ie){Ie.id||(Ie.properties.point_count=1)}),(ye||st()(ge))&&(ft=ft.map(function(Ie){var pt=Ie.id;if(pt){var C=rt.clusterIndex.getLeaves(pt,Infinity),R=C.map(function(Ge){return Ge.properties}),q;if(We()(ge)&&ye){var fe=ct(R,ye);q=Me[ge](fe)}st()(ge)&&(q=ge(R)),Ie.properties.stat=q}else Ie.properties.point_count=1;return Ie})),this.data=Object(St.getParser)("geojson")({type:"FeatureCollection",features:ft}),this.executeTrans()}},{key:"getFeatureById",value:function(me){var rt=this.parser.type,Kt=rt===void 0?"geojson":rt;if(Kt==="geojson"&&!this.cluster){var _t=me<this.originData.features.length?this.originData.features[me]:"null",ge=xt()(_t);if(this.transforms.length!==0){var ye=this.data.dataArray.find(function(Ve){return Ve._id===me});ge.properties=ye}return ge}else return me<this.data.dataArray.length?this.data.dataArray[me]:"null"}},{key:"getFeatureId",value:function(me,rt){var Kt=this.data.dataArray.find(function(_t){return _t[me]===name});return Kt==null?void 0:Kt._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"initCfg",value:function(me){me&&(me.parser&&(this.parser=me.parser),me.transforms&&(this.transforms=me.transforms),this.cluster=me.cluster||!1,me.clusterOptions&&(this.cluster=!0,this.clusterOptions=$t($t({},this.clusterOptions),me.clusterOptions)))}},{key:"excuteParser",value:function(){var me=this.parser,rt=me.type||"geojson",Kt=Object(St.getParser)(rt);this.data=Kt(this.originData,me),this.extent=Object($e.m)(this.data.dataArray)}},{key:"executeTrans",value:function(){var me=this,rt=this.transforms;rt.forEach(function(Kt){var _t=Kt.type,ge=Object(St.getTransform)(_t)(me.data,Kt);Object.assign(me.data,ge)})}},{key:"initCluster",value:function(){if(!!this.cluster){var me=this.clusterOptions||{};this.clusterIndex=Object(bt.a)(this.data,me)}}},{key:"init",value:function(){this.hooks.init.call(this)}}]),be}(Ze.EventEmitter)},lJbI:function(Re,y,o){"use strict";o.d(y,"a",function(){return S});function S(v,X){var B=X.extent,a=X.width,W=X.height,D=X.min,J=X.max,te={_id:1,dataArray:[{_id:1,data:Array.from(v),width:a,height:W,min:D,max:J,coordinates:[[B[0],B[1]],[B[2],B[3]]]}]};return te}},mNvP:function(Re,y,o){(function(S,v){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var X;(function(B){(function(a){var W=typeof v=="object"?v:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),D=J(B);typeof W.Reflect=="undefined"?W.Reflect=B:D=J(W.Reflect,D),a(D);function J(te,ce){return function(Y,ke){typeof te[Y]!="function"&&Object.defineProperty(te,Y,{configurable:!0,writable:!0,value:ke}),ce&&ce(Y,ke)}}})(function(a){var W=Object.prototype.hasOwnProperty,D=typeof Symbol=="function",J=D&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",te=D&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",ce=typeof Object.create=="function",Y={__proto__:[]}instanceof Array,ke=!ce&&!Y,Ke={create:ce?function(){return lr(Object.create(null))}:Y?function(){return lr({__proto__:null})}:function(){return lr({})},has:ke?function(dt,vt){return W.call(dt,vt)}:function(dt,vt){return vt in dt},get:ke?function(dt,vt){return W.call(dt,vt)?dt[vt]:void 0}:function(dt,vt){return dt[vt]}},We=Object.getPrototypeOf(Function),Oe=typeof S=="object"&&Object({NODE_ENV:"production"})&&Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL==="true",st=!Oe&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ie(),Le=!Oe&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:et(),xt=!Oe&&typeof WeakMap=="function"?WeakMap:Bt(),it=new xt;function $e(dt,vt,Ct,gt){if(Kt(Ct)){if(!R(dt))throw new TypeError;if(!fe(vt))throw new TypeError;return Gt(dt,vt)}else{if(!R(dt))throw new TypeError;if(!ye(vt))throw new TypeError;if(!ye(gt)&&!Kt(gt)&&!_t(gt))throw new TypeError;return _t(gt)&&(gt=void 0),Ct=C(Ct),$t(dt,vt,Ct,gt)}}a("decorate",$e);function Ze(dt,vt){function Ct(gt,we){if(!ye(gt))throw new TypeError;if(!Kt(we)&&!Ge(we))throw new TypeError;be(dt,vt,gt,we)}return Ct}a("metadata",Ze);function St(dt,vt,Ct,gt){if(!ye(Ct))throw new TypeError;return Kt(gt)||(gt=C(gt)),be(dt,vt,Ct,gt)}a("defineMetadata",St);function bt(dt,vt,Ct){if(!ye(vt))throw new TypeError;return Kt(Ct)||(Ct=C(Ct)),oe(dt,vt,Ct)}a("hasMetadata",bt);function Ne(dt,vt,Ct){if(!ye(vt))throw new TypeError;return Kt(Ct)||(Ct=C(Ct)),Q(dt,vt,Ct)}a("hasOwnMetadata",Ne);function ze(dt,vt,Ct){if(!ye(vt))throw new TypeError;return Kt(Ct)||(Ct=C(Ct)),G(dt,vt,Ct)}a("getMetadata",ze);function Ue(dt,vt,Ct){if(!ye(vt))throw new TypeError;return Kt(Ct)||(Ct=C(Ct)),Ce(dt,vt,Ct)}a("getOwnMetadata",Ue);function lt(dt,vt){if(!ye(dt))throw new TypeError;return Kt(vt)||(vt=C(vt)),Te(dt,vt)}a("getMetadataKeys",lt);function Me(dt,vt){if(!ye(dt))throw new TypeError;return Kt(vt)||(vt=C(vt)),me(dt,vt)}a("getOwnMetadataKeys",Me);function ct(dt,vt,Ct){if(!ye(vt))throw new TypeError;Kt(Ct)||(Ct=C(Ct));var gt=ar(vt,Ct,!1);if(Kt(gt)||!gt.delete(dt))return!1;if(gt.size>0)return!0;var we=it.get(vt);return we.delete(Ct),we.size>0||it.delete(vt),!0}a("deleteMetadata",ct);function Gt(dt,vt){for(var Ct=dt.length-1;Ct>=0;--Ct){var gt=dt[Ct],we=gt(vt);if(!Kt(we)&&!_t(we)){if(!fe(we))throw new TypeError;vt=we}}return vt}function $t(dt,vt,Ct,gt){for(var we=dt.length-1;we>=0;--we){var ht=dt[we],Qe=ht(vt,Ct,gt);if(!Kt(Qe)&&!_t(Qe)){if(!ye(Qe))throw new TypeError;gt=Qe}}return gt}function ar(dt,vt,Ct){var gt=it.get(dt);if(Kt(gt)){if(!Ct)return;gt=new st,it.set(dt,gt)}var we=gt.get(vt);if(Kt(we)){if(!Ct)return;we=new st,gt.set(vt,we)}return we}function oe(dt,vt,Ct){var gt=Q(dt,vt,Ct);if(gt)return!0;var we=Ye(vt);return _t(we)?!1:oe(dt,we,Ct)}function Q(dt,vt,Ct){var gt=ar(vt,Ct,!1);return Kt(gt)?!1:Ie(gt.has(dt))}function G(dt,vt,Ct){var gt=Q(dt,vt,Ct);if(gt)return Ce(dt,vt,Ct);var we=Ye(vt);if(!_t(we))return G(dt,we,Ct)}function Ce(dt,vt,Ct){var gt=ar(vt,Ct,!1);if(!Kt(gt))return gt.get(dt)}function be(dt,vt,Ct,gt){var we=ar(Ct,gt,!0);we.set(dt,vt)}function Te(dt,vt){var Ct=me(dt,vt),gt=Ye(dt);if(gt===null)return Ct;var we=Te(gt,vt);if(we.length<=0)return Ct;if(Ct.length<=0)return we;for(var ht=new Le,Qe=[],Vt=0,pr=Ct;Vt<pr.length;Vt++){var Zr=pr[Vt],cr=ht.has(Zr);cr||(ht.add(Zr),Qe.push(Zr))}for(var jn=0,Sn=we;jn<Sn.length;jn++){var Zr=Sn[jn],cr=ht.has(Zr);cr||(ht.add(Zr),Qe.push(Zr))}return Qe}function me(dt,vt){var Ct=[],gt=ar(dt,vt,!1);if(Kt(gt))return Ct;for(var we=gt.keys(),ht=yt(we),Qe=0;;){var Vt=Nt(ht);if(!Vt)return Ct.length=Qe,Ct;var pr=nt(Vt);try{Ct[Qe]=pr}catch(Zr){try{$(ht)}finally{throw Zr}}Qe++}}function rt(dt){if(dt===null)return 1;switch(typeof dt){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return dt===null?1:6;default:return 6}}function Kt(dt){return dt===void 0}function _t(dt){return dt===null}function ge(dt){return typeof dt=="symbol"}function ye(dt){return typeof dt=="object"?dt!==null:typeof dt=="function"}function Ve(dt,vt){switch(rt(dt)){case 0:return dt;case 1:return dt;case 2:return dt;case 3:return dt;case 4:return dt;case 5:return dt}var Ct=vt===3?"string":vt===5?"number":"default",gt=Je(dt,J);if(gt!==void 0){var we=gt.call(dt,Ct);if(ye(we))throw new TypeError;return we}return ft(dt,Ct==="default"?"number":Ct)}function ft(dt,vt){if(vt==="string"){var Ct=dt.toString;if(q(Ct)){var gt=Ct.call(dt);if(!ye(gt))return gt}var we=dt.valueOf;if(q(we)){var gt=we.call(dt);if(!ye(gt))return gt}}else{var we=dt.valueOf;if(q(we)){var gt=we.call(dt);if(!ye(gt))return gt}var ht=dt.toString;if(q(ht)){var gt=ht.call(dt);if(!ye(gt))return gt}}throw new TypeError}function Ie(dt){return!!dt}function pt(dt){return""+dt}function C(dt){var vt=Ve(dt,3);return ge(vt)?vt:pt(vt)}function R(dt){return Array.isArray?Array.isArray(dt):dt instanceof Object?dt instanceof Array:Object.prototype.toString.call(dt)==="[object Array]"}function q(dt){return typeof dt=="function"}function fe(dt){return typeof dt=="function"}function Ge(dt){switch(rt(dt)){case 3:return!0;case 4:return!0;default:return!1}}function Je(dt,vt){var Ct=dt[vt];if(Ct!=null){if(!q(Ct))throw new TypeError;return Ct}}function yt(dt){var vt=Je(dt,te);if(!q(vt))throw new TypeError;var Ct=vt.call(dt);if(!ye(Ct))throw new TypeError;return Ct}function nt(dt){return dt.value}function Nt(dt){var vt=dt.next();return vt.done?!1:vt}function $(dt){var vt=dt.return;vt&&vt.call(dt)}function Ye(dt){var vt=Object.getPrototypeOf(dt);if(typeof dt!="function"||dt===We||vt!==We)return vt;var Ct=dt.prototype,gt=Ct&&Object.getPrototypeOf(Ct);if(gt==null||gt===Object.prototype)return vt;var we=gt.constructor;return typeof we!="function"||we===dt?vt:we}function ie(){var dt={},vt=[],Ct=function(){function Qe(Vt,pr,Zr){this._index=0,this._keys=Vt,this._values=pr,this._selector=Zr}return Qe.prototype["@@iterator"]=function(){return this},Qe.prototype[te]=function(){return this},Qe.prototype.next=function(){var Vt=this._index;if(Vt>=0&&Vt<this._keys.length){var pr=this._selector(this._keys[Vt],this._values[Vt]);return Vt+1>=this._keys.length?(this._index=-1,this._keys=vt,this._values=vt):this._index++,{value:pr,done:!1}}return{value:void 0,done:!0}},Qe.prototype.throw=function(Vt){throw this._index>=0&&(this._index=-1,this._keys=vt,this._values=vt),Vt},Qe.prototype.return=function(Vt){return this._index>=0&&(this._index=-1,this._keys=vt,this._values=vt),{value:Vt,done:!0}},Qe}();return function(){function Qe(){this._keys=[],this._values=[],this._cacheKey=dt,this._cacheIndex=-2}return Object.defineProperty(Qe.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Qe.prototype.has=function(Vt){return this._find(Vt,!1)>=0},Qe.prototype.get=function(Vt){var pr=this._find(Vt,!1);return pr>=0?this._values[pr]:void 0},Qe.prototype.set=function(Vt,pr){var Zr=this._find(Vt,!0);return this._values[Zr]=pr,this},Qe.prototype.delete=function(Vt){var pr=this._find(Vt,!1);if(pr>=0){for(var Zr=this._keys.length,cr=pr+1;cr<Zr;cr++)this._keys[cr-1]=this._keys[cr],this._values[cr-1]=this._values[cr];return this._keys.length--,this._values.length--,Vt===this._cacheKey&&(this._cacheKey=dt,this._cacheIndex=-2),!0}return!1},Qe.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=dt,this._cacheIndex=-2},Qe.prototype.keys=function(){return new Ct(this._keys,this._values,gt)},Qe.prototype.values=function(){return new Ct(this._keys,this._values,we)},Qe.prototype.entries=function(){return new Ct(this._keys,this._values,ht)},Qe.prototype["@@iterator"]=function(){return this.entries()},Qe.prototype[te]=function(){return this.entries()},Qe.prototype._find=function(Vt,pr){return this._cacheKey!==Vt&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Vt)),this._cacheIndex<0&&pr&&(this._cacheIndex=this._keys.length,this._keys.push(Vt),this._values.push(void 0)),this._cacheIndex},Qe}();function gt(Qe,Vt){return Qe}function we(Qe,Vt){return Vt}function ht(Qe,Vt){return[Qe,Vt]}}function et(){return function(){function dt(){this._map=new st}return Object.defineProperty(dt.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),dt.prototype.has=function(vt){return this._map.has(vt)},dt.prototype.add=function(vt){return this._map.set(vt,vt),this},dt.prototype.delete=function(vt){return this._map.delete(vt)},dt.prototype.clear=function(){this._map.clear()},dt.prototype.keys=function(){return this._map.keys()},dt.prototype.values=function(){return this._map.values()},dt.prototype.entries=function(){return this._map.entries()},dt.prototype["@@iterator"]=function(){return this.keys()},dt.prototype[te]=function(){return this.keys()},dt}()}function Bt(){var dt=16,vt=Ke.create(),Ct=gt();return function(){function pr(){this._key=gt()}return pr.prototype.has=function(Zr){var cr=we(Zr,!1);return cr!==void 0?Ke.has(cr,this._key):!1},pr.prototype.get=function(Zr){var cr=we(Zr,!1);return cr!==void 0?Ke.get(cr,this._key):void 0},pr.prototype.set=function(Zr,cr){var jn=we(Zr,!0);return jn[this._key]=cr,this},pr.prototype.delete=function(Zr){var cr=we(Zr,!1);return cr!==void 0?delete cr[this._key]:!1},pr.prototype.clear=function(){this._key=gt()},pr}();function gt(){var pr;do pr="@@WeakMap@@"+Vt();while(Ke.has(vt,pr));return vt[pr]=!0,pr}function we(pr,Zr){if(!W.call(pr,Ct)){if(!Zr)return;Object.defineProperty(pr,Ct,{value:Ke.create()})}return pr[Ct]}function ht(pr,Zr){for(var cr=0;cr<Zr;++cr)pr[cr]=Math.random()*255|0;return pr}function Qe(pr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(pr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(pr)):ht(new Uint8Array(pr),pr):ht(new Array(pr),pr)}function Vt(){var pr=Qe(dt);pr[6]=pr[6]&79|64,pr[8]=pr[8]&191|128;for(var Zr="",cr=0;cr<dt;++cr){var jn=pr[cr];(cr===4||cr===6||cr===8)&&(Zr+="-"),jn<16&&(Zr+="0"),Zr+=jn.toString(16).toLowerCase()}return Zr}}function lr(dt){return dt.__=void 0,delete dt.__,dt}})})(X||(X={}))}).call(this,o("Q2Ig"),o("yLpj"))},mTTR:function(Re,y,o){var S=o("b80T"),v=o("QcOe"),X=o("MMmD");function B(a){return X(a)?S(a,!0):v(a)}Re.exports=B},mc0g:function(Re,y){function o(S){return function(v,X,B){for(var a=-1,W=Object(v),D=B(v),J=D.length;J--;){var te=D[S?J:++a];if(X(W[te],te,W)===!1)break}return v}}Re.exports=o},mhV4:function(Re,y,o){var S=o("ZK94");Re.exports.geometry=v,Re.exports.ring=B;function v(W){var D=0,J;switch(W.type){case"Polygon":return X(W.coordinates);case"MultiPolygon":for(J=0;J<W.coordinates.length;J++)D+=X(W.coordinates[J]);return D;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(J=0;J<W.geometries.length;J++)D+=v(W.geometries[J]);return D}}function X(W){var D=0;if(W&&W.length>0){D+=Math.abs(B(W[0]));for(var J=1;J<W.length;J++)D-=Math.abs(B(W[J]))}return D}function B(W){var D,J,te,ce,Y,ke,Ke,We=0,Oe=W.length;if(Oe>2){for(Ke=0;Ke<Oe;Ke++)Ke===Oe-2?(ce=Oe-2,Y=Oe-1,ke=0):Ke===Oe-1?(ce=Oe-1,Y=0,ke=1):(ce=Ke,Y=Ke+1,ke=Ke+2),D=W[ce],J=W[Y],te=W[ke],We+=(a(te[0])-a(D[0]))*Math.sin(a(J[1]));We=We*S.RADIUS*S.RADIUS/2}return We}function a(W){return W*Math.PI/180}},mpbz:function(Re,y,o){(function(S,v){Re.exports=v()})(this,function(){"use strict";function S(Ne,ze,Ue,lt,Me,ct){if(!(Me-lt<=Ue)){var Gt=lt+Me>>1;v(Ne,ze,Gt,lt,Me,ct%2),S(Ne,ze,Ue,lt,Gt-1,ct+1),S(Ne,ze,Ue,Gt+1,Me,ct+1)}}function v(Ne,ze,Ue,lt,Me,ct){for(;Me>lt;){if(Me-lt>600){var Gt=Me-lt+1,$t=Ue-lt+1,ar=Math.log(Gt),oe=.5*Math.exp(2*ar/3),Q=.5*Math.sqrt(ar*oe*(Gt-oe)/Gt)*($t-Gt/2<0?-1:1),G=Math.max(lt,Math.floor(Ue-$t*oe/Gt+Q)),Ce=Math.min(Me,Math.floor(Ue+(Gt-$t)*oe/Gt+Q));v(Ne,ze,Ue,G,Ce,ct)}var be=ze[2*Ue+ct],Te=lt,me=Me;for(X(Ne,ze,lt,Ue),ze[2*Me+ct]>be&&X(Ne,ze,lt,Me);Te<me;){for(X(Ne,ze,Te,me),Te++,me--;ze[2*Te+ct]<be;)Te++;for(;ze[2*me+ct]>be;)me--}ze[2*lt+ct]===be?X(Ne,ze,lt,me):(me++,X(Ne,ze,me,Me)),me<=Ue&&(lt=me+1),Ue<=me&&(Me=me-1)}}function X(Ne,ze,Ue,lt){B(Ne,Ue,lt),B(ze,2*Ue,2*lt),B(ze,2*Ue+1,2*lt+1)}function B(Ne,ze,Ue){var lt=Ne[ze];Ne[ze]=Ne[Ue],Ne[Ue]=lt}function a(Ne,ze,Ue,lt,Me,ct,Gt){for(var $t=[0,Ne.length-1,0],ar=[],oe,Q;$t.length;){var G=$t.pop(),Ce=$t.pop(),be=$t.pop();if(Ce-be<=Gt){for(var Te=be;Te<=Ce;Te++)oe=ze[2*Te],Q=ze[2*Te+1],oe>=Ue&&oe<=Me&&Q>=lt&&Q<=ct&&ar.push(Ne[Te]);continue}var me=Math.floor((be+Ce)/2);oe=ze[2*me],Q=ze[2*me+1],oe>=Ue&&oe<=Me&&Q>=lt&&Q<=ct&&ar.push(Ne[me]);var rt=(G+1)%2;(G===0?Ue<=oe:lt<=Q)&&($t.push(be),$t.push(me-1),$t.push(rt)),(G===0?Me>=oe:ct>=Q)&&($t.push(me+1),$t.push(Ce),$t.push(rt))}return ar}function W(Ne,ze,Ue,lt,Me,ct){for(var Gt=[0,Ne.length-1,0],$t=[],ar=Me*Me;Gt.length;){var oe=Gt.pop(),Q=Gt.pop(),G=Gt.pop();if(Q-G<=ct){for(var Ce=G;Ce<=Q;Ce++)D(ze[2*Ce],ze[2*Ce+1],Ue,lt)<=ar&&$t.push(Ne[Ce]);continue}var be=Math.floor((G+Q)/2),Te=ze[2*be],me=ze[2*be+1];D(Te,me,Ue,lt)<=ar&&$t.push(Ne[be]);var rt=(oe+1)%2;(oe===0?Ue-Me<=Te:lt-Me<=me)&&(Gt.push(G),Gt.push(be-1),Gt.push(rt)),(oe===0?Ue+Me>=Te:lt+Me>=me)&&(Gt.push(be+1),Gt.push(Q),Gt.push(rt))}return $t}function D(Ne,ze,Ue,lt){var Me=Ne-Ue,ct=ze-lt;return Me*Me+ct*ct}var J=function(ze){return ze[0]},te=function(ze){return ze[1]},ce=function(ze,Ue,lt,Me,ct){Ue===void 0&&(Ue=J),lt===void 0&&(lt=te),Me===void 0&&(Me=64),ct===void 0&&(ct=Float64Array),this.nodeSize=Me,this.points=ze;for(var Gt=ze.length<65536?Uint16Array:Uint32Array,$t=this.ids=new Gt(ze.length),ar=this.coords=new ct(ze.length*2),oe=0;oe<ze.length;oe++)$t[oe]=oe,ar[2*oe]=Ue(ze[oe]),ar[2*oe+1]=lt(ze[oe]);S($t,ar,Me,0,$t.length-1,0)};ce.prototype.range=function(ze,Ue,lt,Me){return a(this.ids,this.coords,ze,Ue,lt,Me,this.nodeSize)},ce.prototype.within=function(ze,Ue,lt){return W(this.ids,this.coords,ze,Ue,lt,this.nodeSize)};var Y={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ze){return ze}},ke=function(ze){this.options=Ze(Object.create(Y),ze),this.trees=new Array(this.options.maxZoom+1)};ke.prototype.load=function(ze){var Ue=this.options,lt=Ue.log,Me=Ue.minZoom,ct=Ue.maxZoom,Gt=Ue.nodeSize;lt&&console.time("total time");var $t="prepare "+ze.length+" points";lt&&console.time($t),this.points=ze;for(var ar=[],oe=0;oe<ze.length;oe++)!ze[oe].geometry||ar.push(We(ze[oe],oe));this.trees[ct+1]=new ce(ar,St,bt,Gt,Float32Array),lt&&console.timeEnd($t);for(var Q=ct;Q>=Me;Q--){var G=+Date.now();ar=this._cluster(ar,Q),this.trees[Q]=new ce(ar,St,bt,Gt,Float32Array),lt&&console.log("z%d: %d clusters in %dms",Q,ar.length,+Date.now()-G)}return lt&&console.timeEnd("total time"),this},ke.prototype.getClusters=function(ze,Ue){var lt=((ze[0]+180)%360+360)%360-180,Me=Math.max(-90,Math.min(90,ze[1])),ct=ze[2]===180?180:((ze[2]+180)%360+360)%360-180,Gt=Math.max(-90,Math.min(90,ze[3]));if(ze[2]-ze[0]>=360)lt=-180,ct=180;else if(lt>ct){var $t=this.getClusters([lt,Me,180,Gt],Ue),ar=this.getClusters([-180,Me,ct,Gt],Ue);return $t.concat(ar)}for(var oe=this.trees[this._limitZoom(Ue)],Q=oe.range(Le(lt),xt(Gt),Le(ct),xt(Me)),G=[],Ce=0,be=Q;Ce<be.length;Ce+=1){var Te=be[Ce],me=oe.points[Te];G.push(me.numPoints?Oe(me):this.points[me.index])}return G},ke.prototype.getChildren=function(ze){var Ue=this._getOriginId(ze),lt=this._getOriginZoom(ze),Me="No cluster with the specified id.",ct=this.trees[lt];if(!ct)throw new Error(Me);var Gt=ct.points[Ue];if(!Gt)throw new Error(Me);for(var $t=this.options.radius/(this.options.extent*Math.pow(2,lt-1)),ar=ct.within(Gt.x,Gt.y,$t),oe=[],Q=0,G=ar;Q<G.length;Q+=1){var Ce=G[Q],be=ct.points[Ce];be.parentId===ze&&oe.push(be.numPoints?Oe(be):this.points[be.index])}if(oe.length===0)throw new Error(Me);return oe},ke.prototype.getLeaves=function(ze,Ue,lt){Ue=Ue||10,lt=lt||0;var Me=[];return this._appendLeaves(Me,ze,Ue,lt,0),Me},ke.prototype.getTile=function(ze,Ue,lt){var Me=this.trees[this._limitZoom(ze)],ct=Math.pow(2,ze),Gt=this.options,$t=Gt.extent,ar=Gt.radius,oe=ar/$t,Q=(lt-oe)/ct,G=(lt+1+oe)/ct,Ce={features:[]};return this._addTileFeatures(Me.range((Ue-oe)/ct,Q,(Ue+1+oe)/ct,G),Me.points,Ue,lt,ct,Ce),Ue===0&&this._addTileFeatures(Me.range(1-oe/ct,Q,1,G),Me.points,ct,lt,ct,Ce),Ue===ct-1&&this._addTileFeatures(Me.range(0,Q,oe/ct,G),Me.points,-1,lt,ct,Ce),Ce.features.length?Ce:null},ke.prototype.getClusterExpansionZoom=function(ze){for(var Ue=this._getOriginZoom(ze)-1;Ue<=this.options.maxZoom;){var lt=this.getChildren(ze);if(Ue++,lt.length!==1)break;ze=lt[0].properties.cluster_id}return Ue},ke.prototype._appendLeaves=function(ze,Ue,lt,Me,ct){for(var Gt=this.getChildren(Ue),$t=0,ar=Gt;$t<ar.length;$t+=1){var oe=ar[$t],Q=oe.properties;if(Q&&Q.cluster?ct+Q.point_count<=Me?ct+=Q.point_count:ct=this._appendLeaves(ze,Q.cluster_id,lt,Me,ct):ct<Me?ct++:ze.push(oe),ze.length===lt)break}return ct},ke.prototype._addTileFeatures=function(ze,Ue,lt,Me,ct,Gt){for(var $t=0,ar=ze;$t<ar.length;$t+=1){var oe=ar[$t],Q=Ue[oe],G=Q.numPoints,Ce={type:1,geometry:[[Math.round(this.options.extent*(Q.x*ct-lt)),Math.round(this.options.extent*(Q.y*ct-Me))]],tags:G?st(Q):this.points[Q.index].properties},be=void 0;G?be=Q.id:this.options.generateId?be=Q.index:this.points[Q.index].id&&(be=this.points[Q.index].id),be!==void 0&&(Ce.id=be),Gt.features.push(Ce)}},ke.prototype._limitZoom=function(ze){return Math.max(this.options.minZoom,Math.min(+ze,this.options.maxZoom+1))},ke.prototype._cluster=function(ze,Ue){for(var lt=[],Me=this.options,ct=Me.radius,Gt=Me.extent,$t=Me.reduce,ar=Me.minPoints,oe=ct/(Gt*Math.pow(2,Ue)),Q=0;Q<ze.length;Q++){var G=ze[Q];if(!(G.zoom<=Ue)){G.zoom=Ue;for(var Ce=this.trees[Ue+1],be=Ce.within(G.x,G.y,oe),Te=G.numPoints||1,me=Te,rt=0,Kt=be;rt<Kt.length;rt+=1){var _t=Kt[rt],ge=Ce.points[_t];ge.zoom>Ue&&(me+=ge.numPoints||1)}if(me>=ar){for(var ye=G.x*Te,Ve=G.y*Te,ft=$t&&Te>1?this._map(G,!0):null,Ie=(Q<<5)+(Ue+1)+this.points.length,pt=0,C=be;pt<C.length;pt+=1){var R=C[pt],q=Ce.points[R];if(!(q.zoom<=Ue)){q.zoom=Ue;var fe=q.numPoints||1;ye+=q.x*fe,Ve+=q.y*fe,q.parentId=Ie,$t&&(ft||(ft=this._map(G,!0)),$t(ft,this._map(q)))}}G.parentId=Ie,lt.push(Ke(ye/me,Ve/me,Ie,me,ft))}else if(lt.push(G),me>1)for(var Ge=0,Je=be;Ge<Je.length;Ge+=1){var yt=Je[Ge],nt=Ce.points[yt];nt.zoom<=Ue||(nt.zoom=Ue,lt.push(nt))}}}return lt},ke.prototype._getOriginId=function(ze){return ze-this.points.length>>5},ke.prototype._getOriginZoom=function(ze){return(ze-this.points.length)%32},ke.prototype._map=function(ze,Ue){if(ze.numPoints)return Ue?Ze({},ze.properties):ze.properties;var lt=this.points[ze.index].properties,Me=this.options.map(lt);return Ue&&Me===lt?Ze({},Me):Me};function Ke(Ne,ze,Ue,lt,Me){return{x:Ne,y:ze,zoom:Infinity,id:Ue,parentId:-1,numPoints:lt,properties:Me}}function We(Ne,ze){var Ue=Ne.geometry.coordinates,lt=Ue[0],Me=Ue[1];return{x:Le(lt),y:xt(Me),zoom:Infinity,index:ze,parentId:-1}}function Oe(Ne){return{type:"Feature",id:Ne.id,properties:st(Ne),geometry:{type:"Point",coordinates:[it(Ne.x),$e(Ne.y)]}}}function st(Ne){var ze=Ne.numPoints,Ue=ze>=1e4?Math.round(ze/1e3)+"k":ze>=1e3?Math.round(ze/100)/10+"k":ze;return Ze(Ze({},Ne.properties),{cluster:!0,cluster_id:Ne.id,point_count:ze,point_count_abbreviated:Ue})}function Le(Ne){return Ne/360+.5}function xt(Ne){var ze=Math.sin(Ne*Math.PI/180),Ue=.5-.25*Math.log((1+ze)/(1-ze))/Math.PI;return Ue<0?0:Ue>1?1:Ue}function it(Ne){return(Ne-.5)*360}function $e(Ne){var ze=(180-Ne*360)*Math.PI/180;return 360*Math.atan(Math.exp(ze))/Math.PI-90}function Ze(Ne,ze){for(var Ue in ze)Ne[Ue]=ze[Ue];return Ne}function St(Ne){return Ne.x}function bt(Ne){return Ne.y}return ke})},"mv/X":function(Re,y,o){var S=o("ljhN"),v=o("MMmD"),X=o("wJg7"),B=o("GoyQ");function a(W,D,J){if(!B(J))return!1;var te=typeof D;return(te=="number"?v(J)&&X(D,J.length):te=="string"&&D in J)?S(J[D],W):!1}Re.exports=a},"n+fv":function(Re,y,o){"use strict";o.r(y),o.d(y,"create",function(){return v}),o.d(y,"clone",function(){return X}),o.d(y,"length",function(){return B}),o.d(y,"fromValues",function(){return a}),o.d(y,"copy",function(){return W}),o.d(y,"set",function(){return D}),o.d(y,"add",function(){return J}),o.d(y,"subtract",function(){return te}),o.d(y,"multiply",function(){return ce}),o.d(y,"divide",function(){return Y}),o.d(y,"ceil",function(){return ke}),o.d(y,"floor",function(){return Ke}),o.d(y,"min",function(){return We}),o.d(y,"max",function(){return Oe}),o.d(y,"round",function(){return st}),o.d(y,"scale",function(){return Le}),o.d(y,"scaleAndAdd",function(){return xt}),o.d(y,"distance",function(){return it}),o.d(y,"squaredDistance",function(){return $e}),o.d(y,"squaredLength",function(){return Ze}),o.d(y,"negate",function(){return St}),o.d(y,"inverse",function(){return bt}),o.d(y,"normalize",function(){return Ne}),o.d(y,"dot",function(){return ze}),o.d(y,"cross",function(){return Ue}),o.d(y,"lerp",function(){return lt}),o.d(y,"hermite",function(){return Me}),o.d(y,"bezier",function(){return ct}),o.d(y,"random",function(){return Gt}),o.d(y,"transformMat4",function(){return $t}),o.d(y,"transformMat3",function(){return ar}),o.d(y,"transformQuat",function(){return oe}),o.d(y,"rotateX",function(){return Q}),o.d(y,"rotateY",function(){return G}),o.d(y,"rotateZ",function(){return Ce}),o.d(y,"angle",function(){return be}),o.d(y,"zero",function(){return Te}),o.d(y,"str",function(){return me}),o.d(y,"exactEquals",function(){return rt}),o.d(y,"equals",function(){return Kt}),o.d(y,"sub",function(){return _t}),o.d(y,"mul",function(){return ge}),o.d(y,"div",function(){return ye}),o.d(y,"dist",function(){return Ve}),o.d(y,"sqrDist",function(){return ft}),o.d(y,"len",function(){return Ie}),o.d(y,"sqrLen",function(){return pt}),o.d(y,"forEach",function(){return C});var S=o("yU0y");function v(){var R=new S.a(3);return S.a!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function X(R){var q=new S.a(3);return q[0]=R[0],q[1]=R[1],q[2]=R[2],q}function B(R){var q=R[0],fe=R[1],Ge=R[2];return Math.hypot(q,fe,Ge)}function a(R,q,fe){var Ge=new S.a(3);return Ge[0]=R,Ge[1]=q,Ge[2]=fe,Ge}function W(R,q){return R[0]=q[0],R[1]=q[1],R[2]=q[2],R}function D(R,q,fe,Ge){return R[0]=q,R[1]=fe,R[2]=Ge,R}function J(R,q,fe){return R[0]=q[0]+fe[0],R[1]=q[1]+fe[1],R[2]=q[2]+fe[2],R}function te(R,q,fe){return R[0]=q[0]-fe[0],R[1]=q[1]-fe[1],R[2]=q[2]-fe[2],R}function ce(R,q,fe){return R[0]=q[0]*fe[0],R[1]=q[1]*fe[1],R[2]=q[2]*fe[2],R}function Y(R,q,fe){return R[0]=q[0]/fe[0],R[1]=q[1]/fe[1],R[2]=q[2]/fe[2],R}function ke(R,q){return R[0]=Math.ceil(q[0]),R[1]=Math.ceil(q[1]),R[2]=Math.ceil(q[2]),R}function Ke(R,q){return R[0]=Math.floor(q[0]),R[1]=Math.floor(q[1]),R[2]=Math.floor(q[2]),R}function We(R,q,fe){return R[0]=Math.min(q[0],fe[0]),R[1]=Math.min(q[1],fe[1]),R[2]=Math.min(q[2],fe[2]),R}function Oe(R,q,fe){return R[0]=Math.max(q[0],fe[0]),R[1]=Math.max(q[1],fe[1]),R[2]=Math.max(q[2],fe[2]),R}function st(R,q){return R[0]=Math.round(q[0]),R[1]=Math.round(q[1]),R[2]=Math.round(q[2]),R}function Le(R,q,fe){return R[0]=q[0]*fe,R[1]=q[1]*fe,R[2]=q[2]*fe,R}function xt(R,q,fe,Ge){return R[0]=q[0]+fe[0]*Ge,R[1]=q[1]+fe[1]*Ge,R[2]=q[2]+fe[2]*Ge,R}function it(R,q){var fe=q[0]-R[0],Ge=q[1]-R[1],Je=q[2]-R[2];return Math.hypot(fe,Ge,Je)}function $e(R,q){var fe=q[0]-R[0],Ge=q[1]-R[1],Je=q[2]-R[2];return fe*fe+Ge*Ge+Je*Je}function Ze(R){var q=R[0],fe=R[1],Ge=R[2];return q*q+fe*fe+Ge*Ge}function St(R,q){return R[0]=-q[0],R[1]=-q[1],R[2]=-q[2],R}function bt(R,q){return R[0]=1/q[0],R[1]=1/q[1],R[2]=1/q[2],R}function Ne(R,q){var fe=q[0],Ge=q[1],Je=q[2],yt=fe*fe+Ge*Ge+Je*Je;return yt>0&&(yt=1/Math.sqrt(yt)),R[0]=q[0]*yt,R[1]=q[1]*yt,R[2]=q[2]*yt,R}function ze(R,q){return R[0]*q[0]+R[1]*q[1]+R[2]*q[2]}function Ue(R,q,fe){var Ge=q[0],Je=q[1],yt=q[2],nt=fe[0],Nt=fe[1],$=fe[2];return R[0]=Je*$-yt*Nt,R[1]=yt*nt-Ge*$,R[2]=Ge*Nt-Je*nt,R}function lt(R,q,fe,Ge){var Je=q[0],yt=q[1],nt=q[2];return R[0]=Je+Ge*(fe[0]-Je),R[1]=yt+Ge*(fe[1]-yt),R[2]=nt+Ge*(fe[2]-nt),R}function Me(R,q,fe,Ge,Je,yt){var nt=yt*yt,Nt=nt*(2*yt-3)+1,$=nt*(yt-2)+yt,Ye=nt*(yt-1),ie=nt*(3-2*yt);return R[0]=q[0]*Nt+fe[0]*$+Ge[0]*Ye+Je[0]*ie,R[1]=q[1]*Nt+fe[1]*$+Ge[1]*Ye+Je[1]*ie,R[2]=q[2]*Nt+fe[2]*$+Ge[2]*Ye+Je[2]*ie,R}function ct(R,q,fe,Ge,Je,yt){var nt=1-yt,Nt=nt*nt,$=yt*yt,Ye=Nt*nt,ie=3*yt*Nt,et=3*$*nt,Bt=$*yt;return R[0]=q[0]*Ye+fe[0]*ie+Ge[0]*et+Je[0]*Bt,R[1]=q[1]*Ye+fe[1]*ie+Ge[1]*et+Je[1]*Bt,R[2]=q[2]*Ye+fe[2]*ie+Ge[2]*et+Je[2]*Bt,R}function Gt(R,q){q=q||1;var fe=S.c()*2*Math.PI,Ge=S.c()*2-1,Je=Math.sqrt(1-Ge*Ge)*q;return R[0]=Math.cos(fe)*Je,R[1]=Math.sin(fe)*Je,R[2]=Ge*q,R}function $t(R,q,fe){var Ge=q[0],Je=q[1],yt=q[2],nt=fe[3]*Ge+fe[7]*Je+fe[11]*yt+fe[15];return nt=nt||1,R[0]=(fe[0]*Ge+fe[4]*Je+fe[8]*yt+fe[12])/nt,R[1]=(fe[1]*Ge+fe[5]*Je+fe[9]*yt+fe[13])/nt,R[2]=(fe[2]*Ge+fe[6]*Je+fe[10]*yt+fe[14])/nt,R}function ar(R,q,fe){var Ge=q[0],Je=q[1],yt=q[2];return R[0]=Ge*fe[0]+Je*fe[3]+yt*fe[6],R[1]=Ge*fe[1]+Je*fe[4]+yt*fe[7],R[2]=Ge*fe[2]+Je*fe[5]+yt*fe[8],R}function oe(R,q,fe){var Ge=fe[0],Je=fe[1],yt=fe[2],nt=fe[3],Nt=q[0],$=q[1],Ye=q[2],ie=Je*Ye-yt*$,et=yt*Nt-Ge*Ye,Bt=Ge*$-Je*Nt,lr=Je*Bt-yt*et,dt=yt*ie-Ge*Bt,vt=Ge*et-Je*ie,Ct=nt*2;return ie*=Ct,et*=Ct,Bt*=Ct,lr*=2,dt*=2,vt*=2,R[0]=Nt+ie+lr,R[1]=$+et+dt,R[2]=Ye+Bt+vt,R}function Q(R,q,fe,Ge){var Je=[],yt=[];return Je[0]=q[0]-fe[0],Je[1]=q[1]-fe[1],Je[2]=q[2]-fe[2],yt[0]=Je[0],yt[1]=Je[1]*Math.cos(Ge)-Je[2]*Math.sin(Ge),yt[2]=Je[1]*Math.sin(Ge)+Je[2]*Math.cos(Ge),R[0]=yt[0]+fe[0],R[1]=yt[1]+fe[1],R[2]=yt[2]+fe[2],R}function G(R,q,fe,Ge){var Je=[],yt=[];return Je[0]=q[0]-fe[0],Je[1]=q[1]-fe[1],Je[2]=q[2]-fe[2],yt[0]=Je[2]*Math.sin(Ge)+Je[0]*Math.cos(Ge),yt[1]=Je[1],yt[2]=Je[2]*Math.cos(Ge)-Je[0]*Math.sin(Ge),R[0]=yt[0]+fe[0],R[1]=yt[1]+fe[1],R[2]=yt[2]+fe[2],R}function Ce(R,q,fe,Ge){var Je=[],yt=[];return Je[0]=q[0]-fe[0],Je[1]=q[1]-fe[1],Je[2]=q[2]-fe[2],yt[0]=Je[0]*Math.cos(Ge)-Je[1]*Math.sin(Ge),yt[1]=Je[0]*Math.sin(Ge)+Je[1]*Math.cos(Ge),yt[2]=Je[2],R[0]=yt[0]+fe[0],R[1]=yt[1]+fe[1],R[2]=yt[2]+fe[2],R}function be(R,q){var fe=R[0],Ge=R[1],Je=R[2],yt=q[0],nt=q[1],Nt=q[2],$=Math.sqrt(fe*fe+Ge*Ge+Je*Je),Ye=Math.sqrt(yt*yt+nt*nt+Nt*Nt),ie=$*Ye,et=ie&&ze(R,q)/ie;return Math.acos(Math.min(Math.max(et,-1),1))}function Te(R){return R[0]=0,R[1]=0,R[2]=0,R}function me(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"}function rt(R,q){return R[0]===q[0]&&R[1]===q[1]&&R[2]===q[2]}function Kt(R,q){var fe=R[0],Ge=R[1],Je=R[2],yt=q[0],nt=q[1],Nt=q[2];return Math.abs(fe-yt)<=S.b*Math.max(1,Math.abs(fe),Math.abs(yt))&&Math.abs(Ge-nt)<=S.b*Math.max(1,Math.abs(Ge),Math.abs(nt))&&Math.abs(Je-Nt)<=S.b*Math.max(1,Math.abs(Je),Math.abs(Nt))}var _t=te,ge=ce,ye=Y,Ve=it,ft=$e,Ie=B,pt=Ze,C=function(){var R=v();return function(q,fe,Ge,Je,yt,nt){var Nt,$;for(fe||(fe=3),Ge||(Ge=0),Je?$=Math.min(Je*fe+Ge,q.length):$=q.length,Nt=Ge;Nt<$;Nt+=fe)R[0]=q[Nt],R[1]=q[Nt+1],R[2]=q[Nt+2],yt(R,R,nt),q[Nt]=R[0],q[Nt+1]=R[1],q[Nt+2]=R[2];return q}}()},n2J3:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.unmanaged=void 0;var S=o("xfSm"),v=o("GXnB"),X=o("Ztfv");function B(){return function(a,W,D){var J=new v.Metadata(S.UNMANAGED_TAG,!0);X.tagParameter(a,W,D,J)}}y.unmanaged=B},n3AX:function(Re,y,o){var S=o("Nsbk");function v(X,B){for(;!Object.prototype.hasOwnProperty.call(X,B)&&(X=S(X),X!==null););return X}Re.exports=v},"o+pz":function(Re,y,o){"use strict";o.d(y,"a",function(){return S});var S;(function(v){v[v.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",v[v.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",v[v.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",v[v.POINTS=0]="POINTS",v[v.LINES=1]="LINES",v[v.LINE_LOOP=2]="LINE_LOOP",v[v.LINE_STRIP=3]="LINE_STRIP",v[v.TRIANGLES=4]="TRIANGLES",v[v.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",v[v.TRIANGLE_FAN=6]="TRIANGLE_FAN",v[v.ZERO=0]="ZERO",v[v.ONE=1]="ONE",v[v.SRC_COLOR=768]="SRC_COLOR",v[v.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",v[v.SRC_ALPHA=770]="SRC_ALPHA",v[v.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",v[v.DST_ALPHA=772]="DST_ALPHA",v[v.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",v[v.DST_COLOR=774]="DST_COLOR",v[v.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",v[v.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",v[v.FUNC_ADD=32774]="FUNC_ADD",v[v.BLEND_EQUATION=32777]="BLEND_EQUATION",v[v.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",v[v.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",v[v.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",v[v.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",v[v.MAX_EXT=32776]="MAX_EXT",v[v.MIN_EXT=32775]="MIN_EXT",v[v.BLEND_DST_RGB=32968]="BLEND_DST_RGB",v[v.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",v[v.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",v[v.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",v[v.CONSTANT_COLOR=32769]="CONSTANT_COLOR",v[v.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",v[v.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",v[v.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",v[v.BLEND_COLOR=32773]="BLEND_COLOR",v[v.ARRAY_BUFFER=34962]="ARRAY_BUFFER",v[v.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",v[v.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",v[v.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",v[v.STREAM_DRAW=35040]="STREAM_DRAW",v[v.STATIC_DRAW=35044]="STATIC_DRAW",v[v.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",v[v.BUFFER_SIZE=34660]="BUFFER_SIZE",v[v.BUFFER_USAGE=34661]="BUFFER_USAGE",v[v.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",v[v.FRONT=1028]="FRONT",v[v.BACK=1029]="BACK",v[v.FRONT_AND_BACK=1032]="FRONT_AND_BACK",v[v.CULL_FACE=2884]="CULL_FACE",v[v.BLEND=3042]="BLEND",v[v.DITHER=3024]="DITHER",v[v.STENCIL_TEST=2960]="STENCIL_TEST",v[v.DEPTH_TEST=2929]="DEPTH_TEST",v[v.SCISSOR_TEST=3089]="SCISSOR_TEST",v[v.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",v[v.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",v[v.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",v[v.NO_ERROR=0]="NO_ERROR",v[v.INVALID_ENUM=1280]="INVALID_ENUM",v[v.INVALID_VALUE=1281]="INVALID_VALUE",v[v.INVALID_OPERATION=1282]="INVALID_OPERATION",v[v.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",v[v.CW=2304]="CW",v[v.CCW=2305]="CCW",v[v.LINE_WIDTH=2849]="LINE_WIDTH",v[v.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",v[v.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",v[v.CULL_FACE_MODE=2885]="CULL_FACE_MODE",v[v.FRONT_FACE=2886]="FRONT_FACE",v[v.DEPTH_RANGE=2928]="DEPTH_RANGE",v[v.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",v[v.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",v[v.DEPTH_FUNC=2932]="DEPTH_FUNC",v[v.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",v[v.STENCIL_FUNC=2962]="STENCIL_FUNC",v[v.STENCIL_FAIL=2964]="STENCIL_FAIL",v[v.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",v[v.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",v[v.STENCIL_REF=2967]="STENCIL_REF",v[v.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",v[v.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",v[v.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",v[v.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",v[v.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",v[v.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",v[v.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",v[v.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",v[v.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",v[v.VIEWPORT=2978]="VIEWPORT",v[v.SCISSOR_BOX=3088]="SCISSOR_BOX",v[v.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",v[v.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",v[v.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",v[v.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",v[v.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",v[v.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",v[v.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",v[v.RED_BITS=3410]="RED_BITS",v[v.GREEN_BITS=3411]="GREEN_BITS",v[v.BLUE_BITS=3412]="BLUE_BITS",v[v.ALPHA_BITS=3413]="ALPHA_BITS",v[v.DEPTH_BITS=3414]="DEPTH_BITS",v[v.STENCIL_BITS=3415]="STENCIL_BITS",v[v.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",v[v.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",v[v.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",v[v.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",v[v.SAMPLES=32937]="SAMPLES",v[v.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",v[v.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",v[v.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",v[v.DONT_CARE=4352]="DONT_CARE",v[v.FASTEST=4353]="FASTEST",v[v.NICEST=4354]="NICEST",v[v.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",v[v.BYTE=5120]="BYTE",v[v.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",v[v.SHORT=5122]="SHORT",v[v.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",v[v.INT=5124]="INT",v[v.UNSIGNED_INT=5125]="UNSIGNED_INT",v[v.FLOAT=5126]="FLOAT",v[v.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",v[v.ALPHA=6406]="ALPHA",v[v.RGB=6407]="RGB",v[v.RGBA=6408]="RGBA",v[v.LUMINANCE=6409]="LUMINANCE",v[v.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",v[v.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",v[v.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",v[v.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",v[v.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",v[v.VERTEX_SHADER=35633]="VERTEX_SHADER",v[v.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",v[v.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",v[v.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",v[v.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",v[v.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",v[v.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",v[v.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",v[v.SHADER_TYPE=35663]="SHADER_TYPE",v[v.DELETE_STATUS=35712]="DELETE_STATUS",v[v.LINK_STATUS=35714]="LINK_STATUS",v[v.VALIDATE_STATUS=35715]="VALIDATE_STATUS",v[v.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",v[v.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",v[v.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",v[v.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",v[v.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",v[v.NEVER=512]="NEVER",v[v.LESS=513]="LESS",v[v.EQUAL=514]="EQUAL",v[v.LEQUAL=515]="LEQUAL",v[v.GREATER=516]="GREATER",v[v.NOTEQUAL=517]="NOTEQUAL",v[v.GEQUAL=518]="GEQUAL",v[v.ALWAYS=519]="ALWAYS",v[v.KEEP=7680]="KEEP",v[v.REPLACE=7681]="REPLACE",v[v.INCR=7682]="INCR",v[v.DECR=7683]="DECR",v[v.INVERT=5386]="INVERT",v[v.INCR_WRAP=34055]="INCR_WRAP",v[v.DECR_WRAP=34056]="DECR_WRAP",v[v.VENDOR=7936]="VENDOR",v[v.RENDERER=7937]="RENDERER",v[v.VERSION=7938]="VERSION",v[v.NEAREST=9728]="NEAREST",v[v.LINEAR=9729]="LINEAR",v[v.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",v[v.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",v[v.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",v[v.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",v[v.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",v[v.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",v[v.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",v[v.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",v[v.TEXTURE_2D=3553]="TEXTURE_2D",v[v.TEXTURE=5890]="TEXTURE",v[v.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",v[v.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",v[v.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",v[v.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",v[v.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",v[v.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",v[v.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",v[v.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",v[v.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",v[v.TEXTURE0=33984]="TEXTURE0",v[v.TEXTURE1=33985]="TEXTURE1",v[v.TEXTURE2=33986]="TEXTURE2",v[v.TEXTURE3=33987]="TEXTURE3",v[v.TEXTURE4=33988]="TEXTURE4",v[v.TEXTURE5=33989]="TEXTURE5",v[v.TEXTURE6=33990]="TEXTURE6",v[v.TEXTURE7=33991]="TEXTURE7",v[v.TEXTURE8=33992]="TEXTURE8",v[v.TEXTURE9=33993]="TEXTURE9",v[v.TEXTURE10=33994]="TEXTURE10",v[v.TEXTURE11=33995]="TEXTURE11",v[v.TEXTURE12=33996]="TEXTURE12",v[v.TEXTURE13=33997]="TEXTURE13",v[v.TEXTURE14=33998]="TEXTURE14",v[v.TEXTURE15=33999]="TEXTURE15",v[v.TEXTURE16=34e3]="TEXTURE16",v[v.TEXTURE17=34001]="TEXTURE17",v[v.TEXTURE18=34002]="TEXTURE18",v[v.TEXTURE19=34003]="TEXTURE19",v[v.TEXTURE20=34004]="TEXTURE20",v[v.TEXTURE21=34005]="TEXTURE21",v[v.TEXTURE22=34006]="TEXTURE22",v[v.TEXTURE23=34007]="TEXTURE23",v[v.TEXTURE24=34008]="TEXTURE24",v[v.TEXTURE25=34009]="TEXTURE25",v[v.TEXTURE26=34010]="TEXTURE26",v[v.TEXTURE27=34011]="TEXTURE27",v[v.TEXTURE28=34012]="TEXTURE28",v[v.TEXTURE29=34013]="TEXTURE29",v[v.TEXTURE30=34014]="TEXTURE30",v[v.TEXTURE31=34015]="TEXTURE31",v[v.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",v[v.REPEAT=10497]="REPEAT",v[v.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",v[v.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",v[v.FLOAT_VEC2=35664]="FLOAT_VEC2",v[v.FLOAT_VEC3=35665]="FLOAT_VEC3",v[v.FLOAT_VEC4=35666]="FLOAT_VEC4",v[v.INT_VEC2=35667]="INT_VEC2",v[v.INT_VEC3=35668]="INT_VEC3",v[v.INT_VEC4=35669]="INT_VEC4",v[v.BOOL=35670]="BOOL",v[v.BOOL_VEC2=35671]="BOOL_VEC2",v[v.BOOL_VEC3=35672]="BOOL_VEC3",v[v.BOOL_VEC4=35673]="BOOL_VEC4",v[v.FLOAT_MAT2=35674]="FLOAT_MAT2",v[v.FLOAT_MAT3=35675]="FLOAT_MAT3",v[v.FLOAT_MAT4=35676]="FLOAT_MAT4",v[v.SAMPLER_2D=35678]="SAMPLER_2D",v[v.SAMPLER_CUBE=35680]="SAMPLER_CUBE",v[v.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",v[v.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",v[v.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",v[v.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",v[v.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",v[v.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",v[v.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",v[v.COMPILE_STATUS=35713]="COMPILE_STATUS",v[v.LOW_FLOAT=36336]="LOW_FLOAT",v[v.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",v[v.HIGH_FLOAT=36338]="HIGH_FLOAT",v[v.LOW_INT=36339]="LOW_INT",v[v.MEDIUM_INT=36340]="MEDIUM_INT",v[v.HIGH_INT=36341]="HIGH_INT",v[v.FRAMEBUFFER=36160]="FRAMEBUFFER",v[v.RENDERBUFFER=36161]="RENDERBUFFER",v[v.RGBA4=32854]="RGBA4",v[v.RGB5_A1=32855]="RGB5_A1",v[v.RGB565=36194]="RGB565",v[v.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",v[v.STENCIL_INDEX=6401]="STENCIL_INDEX",v[v.STENCIL_INDEX8=36168]="STENCIL_INDEX8",v[v.DEPTH_STENCIL=34041]="DEPTH_STENCIL",v[v.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",v[v.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",v[v.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",v[v.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",v[v.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",v[v.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",v[v.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",v[v.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",v[v.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",v[v.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",v[v.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",v[v.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",v[v.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",v[v.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",v[v.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",v[v.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",v[v.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",v[v.NONE=0]="NONE",v[v.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",v[v.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",v[v.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",v[v.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",v[v.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",v[v.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",v[v.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",v[v.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",v[v.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",v[v.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",v[v.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",v[v.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",v[v.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",v[v.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(S||(S={}))},"oCl/":function(Re,y,o){var S=o("CH3K"),v=o("LcsW"),X=o("MvSz"),B=o("0ycA"),a=Object.getOwnPropertySymbols,W=a?function(D){for(var J=[];D;)S(J,X(D)),D=v(D);return J}:B;Re.exports=W},oIFs:function(Re,y,o){Re.exports={"ant-skeleton":"ant-skeleton","ant-skeleton-header":"ant-skeleton-header","ant-skeleton-avatar":"ant-skeleton-avatar","ant-skeleton-avatar-circle":"ant-skeleton-avatar-circle","ant-skeleton-avatar-lg":"ant-skeleton-avatar-lg","ant-skeleton-avatar-sm":"ant-skeleton-avatar-sm","ant-skeleton-content":"ant-skeleton-content","ant-skeleton-title":"ant-skeleton-title","ant-skeleton-paragraph":"ant-skeleton-paragraph","ant-skeleton-with-avatar":"ant-skeleton-with-avatar","ant-skeleton-round":"ant-skeleton-round","ant-skeleton-active":"ant-skeleton-active","ant-skeleton-loading":"ant-skeleton-loading","ant-skeleton-button":"ant-skeleton-button","ant-skeleton-input":"ant-skeleton-input","ant-skeleton-image":"ant-skeleton-image","ant-skeleton-element":"ant-skeleton-element","ant-skeleton-button-circle":"ant-skeleton-button-circle","ant-skeleton-button-round":"ant-skeleton-button-round","ant-skeleton-button-lg":"ant-skeleton-button-lg","ant-skeleton-button-sm":"ant-skeleton-button-sm","ant-skeleton-input-lg":"ant-skeleton-input-lg","ant-skeleton-input-sm":"ant-skeleton-input-sm","ant-skeleton-image-circle":"ant-skeleton-image-circle","ant-skeleton-image-path":"ant-skeleton-image-path","ant-skeleton-image-svg":"ant-skeleton-image-svg","ant-skeleton-rtl":"ant-skeleton-rtl","ant-skeleton-loading-rtl":"ant-skeleton-loading-rtl"}},oShl:function(Re,y,o){var S=o("Nsbk"),v=o("SksO"),X=o("xfeJ"),B=o("sXyB");function a(W){var D=typeof Map=="function"?new Map:void 0;return Re.exports=a=function(te){if(te===null||!X(te))return te;if(typeof te!="function")throw new TypeError("Super expression must either be null or a function");if(typeof D!="undefined"){if(D.has(te))return D.get(te);D.set(te,ce)}function ce(){return B(te,arguments,S(this).constructor)}return ce.prototype=Object.create(te.prototype,{constructor:{value:ce,enumerable:!1,writable:!0,configurable:!0}}),v(ce,te)},a(W)}Re.exports=a},oaX6:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.targetName=void 0;var S=o("xfSm"),v=o("GXnB"),X=o("Ztfv");function B(a){return function(W,D,J){var te=new v.Metadata(S.NAME_TAG,a);X.tagParameter(W,D,J,te)}}y.targetName=B},"otv/":function(Re,y,o){var S=o("nmnc"),v=S?S.prototype:void 0,X=v?v.valueOf:void 0;function B(a){return X?Object(X.call(a)):{}}Re.exports=B},"oy+k":function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Context=void 0;var S=o("d9O0"),v=function(){function X(B){this.id=S.id(),this.container=B}return X.prototype.addPlan=function(B){this.plan=B},X.prototype.setCurrentRequest=function(B){this.currentRequest=B},X}();y.Context=v},pFRH:function(Re,y,o){var S=o("cvCv"),v=o("O0oS"),X=o("zZ0H"),B=v?function(a,W){return v(a,"toString",{configurable:!0,enumerable:!1,value:S(W),writable:!0})}:X;Re.exports=B},q4HE:function(Re,y){var o="\\ud800-\\udfff",S="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",B=S+v+X,a="\\ufe0e\\ufe0f",W="["+o+"]",D="["+B+"]",J="\\ud83c[\\udffb-\\udfff]",te="(?:"+D+"|"+J+")",ce="[^"+o+"]",Y="(?:\\ud83c[\\udde6-\\uddff]){2}",ke="[\\ud800-\\udbff][\\udc00-\\udfff]",Ke="\\u200d",We=te+"?",Oe="["+a+"]?",st="(?:"+Ke+"(?:"+[ce,Y,ke].join("|")+")"+Oe+We+")*",Le=Oe+We+st,xt="(?:"+[ce+D+"?",D,Y,ke,W].join("|")+")",it=RegExp(J+"(?="+J+")|"+xt+Le,"g");function $e(Ze){for(var St=it.lastIndex=0;it.test(Ze);)++St;return St}Re.exports=$e},qK8v:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.isStackOverflowExeption=void 0;var S=o("MON2");function v(X){return X instanceof RangeError||X.message===S.STACK_OVERFLOW}y.isStackOverflowExeption=v},qRkn:function(Re,y,o){var S=o("3cYt"),v={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},X=S(v);Re.exports=X},qd8s:function(Re,y,o){(function(S,v){var X=200,B="__lodash_hash_undefined__",a=800,W=16,D=9007199254740991,J="[object Arguments]",te="[object Array]",ce="[object AsyncFunction]",Y="[object Boolean]",ke="[object Date]",Ke="[object Error]",We="[object Function]",Oe="[object GeneratorFunction]",st="[object Map]",Le="[object Number]",xt="[object Null]",it="[object Object]",$e="[object Proxy]",Ze="[object RegExp]",St="[object Set]",bt="[object String]",Ne="[object Undefined]",ze="[object WeakMap]",Ue="[object ArrayBuffer]",lt="[object DataView]",Me="[object Float32Array]",ct="[object Float64Array]",Gt="[object Int8Array]",$t="[object Int16Array]",ar="[object Int32Array]",oe="[object Uint8Array]",Q="[object Uint8ClampedArray]",G="[object Uint16Array]",Ce="[object Uint32Array]",be=/[\\^$.*+?()[\]{}|]/g,Te=/^\[object .+?Constructor\]$/,me=/^(?:0|[1-9]\d*)$/,rt={};rt[Me]=rt[ct]=rt[Gt]=rt[$t]=rt[ar]=rt[oe]=rt[Q]=rt[G]=rt[Ce]=!0,rt[J]=rt[te]=rt[Ue]=rt[Y]=rt[lt]=rt[ke]=rt[Ke]=rt[We]=rt[st]=rt[Le]=rt[it]=rt[Ze]=rt[St]=rt[bt]=rt[ze]=!1;var Kt=typeof S=="object"&&S&&S.Object===Object&&S,_t=typeof self=="object"&&self&&self.Object===Object&&self,ge=Kt||_t||Function("return this")(),ye=y&&!y.nodeType&&y,Ve=ye&&typeof v=="object"&&v&&!v.nodeType&&v,ft=Ve&&Ve.exports===ye,Ie=ft&&Kt.process,pt=function(){try{var Mt=Ve&&Ve.require&&Ve.require("util").types;return Mt||Ie&&Ie.binding&&Ie.binding("util")}catch(rr){}}(),C=pt&&pt.isTypedArray;function R(Mt,rr,Pr){switch(Pr.length){case 0:return Mt.call(rr);case 1:return Mt.call(rr,Pr[0]);case 2:return Mt.call(rr,Pr[0],Pr[1]);case 3:return Mt.call(rr,Pr[0],Pr[1],Pr[2])}return Mt.apply(rr,Pr)}function q(Mt,rr){for(var Pr=-1,Vn=Array(Mt);++Pr<Mt;)Vn[Pr]=rr(Pr);return Vn}function fe(Mt){return function(rr){return Mt(rr)}}function Ge(Mt,rr){return Mt==null?void 0:Mt[rr]}function Je(Mt,rr){return function(Pr){return Mt(rr(Pr))}}var yt=Array.prototype,nt=Function.prototype,Nt=Object.prototype,$=ge["__core-js_shared__"],Ye=nt.toString,ie=Nt.hasOwnProperty,et=function(){var Mt=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||"");return Mt?"Symbol(src)_1."+Mt:""}(),Bt=Nt.toString,lr=Ye.call(Object),dt=RegExp("^"+Ye.call(ie).replace(be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),vt=ft?ge.Buffer:void 0,Ct=ge.Symbol,gt=ge.Uint8Array,we=vt?vt.allocUnsafe:void 0,ht=Je(Object.getPrototypeOf,Object),Qe=Object.create,Vt=Nt.propertyIsEnumerable,pr=yt.splice,Zr=Ct?Ct.toStringTag:void 0,cr=function(){try{var Mt=Ys(Object,"defineProperty");return Mt({},"",{}),Mt}catch(rr){}}(),jn=vt?vt.isBuffer:void 0,Sn=Math.max,ai=Date.now,fi=Ys(ge,"Map"),Zn=Ys(Object,"create"),Hn=function(){function Mt(){}return function(rr){if(!uo(rr))return{};if(Qe)return Qe(rr);Mt.prototype=rr;var Pr=new Mt;return Mt.prototype=void 0,Pr}}();function k(Mt){var rr=-1,Pr=Mt==null?0:Mt.length;for(this.clear();++rr<Pr;){var Vn=Mt[rr];this.set(Vn[0],Vn[1])}}function H(){this.__data__=Zn?Zn(null):{},this.size=0}function le(Mt){var rr=this.has(Mt)&&delete this.__data__[Mt];return this.size-=rr?1:0,rr}function de(Mt){var rr=this.__data__;if(Zn){var Pr=rr[Mt];return Pr===B?void 0:Pr}return ie.call(rr,Mt)?rr[Mt]:void 0}function at(Mt){var rr=this.__data__;return Zn?rr[Mt]!==void 0:ie.call(rr,Mt)}function At(Mt,rr){var Pr=this.__data__;return this.size+=this.has(Mt)?0:1,Pr[Mt]=Zn&&rr===void 0?B:rr,this}k.prototype.clear=H,k.prototype.delete=le,k.prototype.get=de,k.prototype.has=at,k.prototype.set=At;function Ft(Mt){var rr=-1,Pr=Mt==null?0:Mt.length;for(this.clear();++rr<Pr;){var Vn=Mt[rr];this.set(Vn[0],Vn[1])}}function He(){this.__data__=[],this.size=0}function Pt(Mt){var rr=this.__data__,Pr=Ka(rr,Mt);if(Pr<0)return!1;var Vn=rr.length-1;return Pr==Vn?rr.pop():pr.call(rr,Pr,1),--this.size,!0}function or(Mt){var rr=this.__data__,Pr=Ka(rr,Mt);return Pr<0?void 0:rr[Pr][1]}function jr(Mt){return Ka(this.__data__,Mt)>-1}function Hr(Mt,rr){var Pr=this.__data__,Vn=Ka(Pr,Mt);return Vn<0?(++this.size,Pr.push([Mt,rr])):Pr[Vn][1]=rr,this}Ft.prototype.clear=He,Ft.prototype.delete=Pt,Ft.prototype.get=or,Ft.prototype.has=jr,Ft.prototype.set=Hr;function sr(Mt){var rr=-1,Pr=Mt==null?0:Mt.length;for(this.clear();++rr<Pr;){var Vn=Mt[rr];this.set(Vn[0],Vn[1])}}function Fr(){this.size=0,this.__data__={hash:new k,map:new(fi||Ft),string:new k}}function _n(Mt){var rr=so(this,Mt).delete(Mt);return this.size-=rr?1:0,rr}function dn(Mt){return so(this,Mt).get(Mt)}function Er(Mt){return so(this,Mt).has(Mt)}function Tn(Mt,rr){var Pr=so(this,Mt),Vn=Pr.size;return Pr.set(Mt,rr),this.size+=Pr.size==Vn?0:1,this}sr.prototype.clear=Fr,sr.prototype.delete=_n,sr.prototype.get=dn,sr.prototype.has=Er,sr.prototype.set=Tn;function vn(Mt){var rr=this.__data__=new Ft(Mt);this.size=rr.size}function gn(){this.__data__=new Ft,this.size=0}function Ar(Mt){var rr=this.__data__,Pr=rr.delete(Mt);return this.size=rr.size,Pr}function $r(Mt){return this.__data__.get(Mt)}function Mn(Mt){return this.__data__.has(Mt)}function Xi(Mt,rr){var Pr=this.__data__;if(Pr instanceof Ft){var Vn=Pr.__data__;if(!fi||Vn.length<X-1)return Vn.push([Mt,rr]),this.size=++Pr.size,this;Pr=this.__data__=new sr(Vn)}return Pr.set(Mt,rr),this.size=Pr.size,this}vn.prototype.clear=gn,vn.prototype.delete=Ar,vn.prototype.get=$r,vn.prototype.has=Mn,vn.prototype.set=Xi;function vi(Mt,rr){var Pr=Wl(Mt),Vn=!Pr&&Vu(Mt),Ji=!Pr&&!Vn&&Il(Mt),Ra=!Pr&&!Vn&&!Ji&&lu(Mt),Ha=Pr||Vn||Ji||Ra,Qi=Ha?q(Mt.length,String):[],xa=Qi.length;for(var Co in Mt)(rr||ie.call(Mt,Co))&&!(Ha&&(Co=="length"||Ji&&(Co=="offset"||Co=="parent")||Ra&&(Co=="buffer"||Co=="byteLength"||Co=="byteOffset")||Ks(Co,xa)))&&Qi.push(Co);return Qi}function wi(Mt,rr,Pr){(Pr!==void 0&&!No(Mt[rr],Pr)||Pr===void 0&&!(rr in Mt))&&hi(Mt,rr,Pr)}function Di(Mt,rr,Pr){var Vn=Mt[rr];(!(ie.call(Mt,rr)&&No(Vn,Pr))||Pr===void 0&&!(rr in Mt))&&hi(Mt,rr,Pr)}function Ka(Mt,rr){for(var Pr=Mt.length;Pr--;)if(No(Mt[Pr][0],rr))return Pr;return-1}function hi(Mt,rr,Pr){rr=="__proto__"&&cr?cr(Mt,rr,{configurable:!0,enumerable:!0,value:Pr,writable:!0}):Mt[rr]=Pr}var ga=oo();function Pi(Mt){return Mt==null?Mt===void 0?Ne:xt:Zr&&Zr in Object(Mt)?Ao(Mt):tn(Mt)}function gi(Mt){return hs(Mt)&&Pi(Mt)==J}function ci(Mt){if(!uo(Mt)||De(Mt))return!1;var rr=fs(Mt)?dt:Te;return rr.test(go(Mt))}function Oa(Mt){return hs(Mt)&&zs(Mt.length)&&!!rt[Pi(Mt)]}function mo(Mt){if(!uo(Mt))return fr(Mt);var rr=It(Mt),Pr=[];for(var Vn in Mt)Vn=="constructor"&&(rr||!ie.call(Mt,Vn))||Pr.push(Vn);return Pr}function $a(Mt,rr,Pr,Vn,Ji){Mt!==rr&&ga(rr,function(Ra,Ha){if(Ji||(Ji=new vn),uo(Ra))Ko(Mt,rr,Ha,Pr,$a,Vn,Ji);else{var Qi=Vn?Vn(Un(Mt,Ha),Ra,Ha+"",Mt,rr,Ji):void 0;Qi===void 0&&(Qi=Ra),wi(Mt,Ha,Qi)}},ya)}function Ko(Mt,rr,Pr,Vn,Ji,Ra,Ha){var Qi=Un(Mt,Pr),xa=Un(rr,Pr),Co=Ha.get(xa);if(Co){wi(Mt,Pr,Co);return}var Fs=Ra?Ra(Qi,xa,Pr+"",Mt,rr,Ha):void 0,ha=Fs===void 0;if(ha){var Yl=Wl(xa),cu=!Yl&&Il(xa),ws=!Yl&&!cu&&lu(xa);Fs=xa,Yl||cu||ws?Wl(Qi)?Fs=Qi:Ic(Qi)?Fs=Ja(Qi):cu?(ha=!1,Fs=Ca(xa,!0)):ws?(ha=!1,Fs=na(xa,!0)):Fs=[]:Js(xa)||Vu(xa)?(Fs=Qi,Vu(Qi)?Fs=Xl(Qi):(!uo(Qi)||fs(Qi))&&(Fs=Zl(xa))):ha=!1}ha&&(Ha.set(xa,Fs),Ji(Fs,xa,Vn,Ra,Ha),Ha.delete(xa)),wi(Mt,Pr,Fs)}function Uu(Mt,rr){return La(En(Mt,rr,Ns),Mt+"")}var Ui=cr?function(Mt,rr){return cr(Mt,"toString",{configurable:!0,enumerable:!1,value:ml(rr),writable:!0})}:Ns;function Ca(Mt,rr){if(rr)return Mt.slice();var Pr=Mt.length,Vn=we?we(Pr):new Mt.constructor(Pr);return Mt.copy(Vn),Vn}function ns(Mt){var rr=new Mt.constructor(Mt.byteLength);return new gt(rr).set(new gt(Mt)),rr}function na(Mt,rr){var Pr=rr?ns(Mt.buffer):Mt.buffer;return new Mt.constructor(Pr,Mt.byteOffset,Mt.length)}function Ja(Mt,rr){var Pr=-1,Vn=Mt.length;for(rr||(rr=Array(Vn));++Pr<Vn;)rr[Pr]=Mt[Pr];return rr}function is(Mt,rr,Pr,Vn){var Ji=!Pr;Pr||(Pr={});for(var Ra=-1,Ha=rr.length;++Ra<Ha;){var Qi=rr[Ra],xa=Vn?Vn(Pr[Qi],Mt[Qi],Qi,Pr,Mt):void 0;xa===void 0&&(xa=Mt[Qi]),Ji?hi(Pr,Qi,xa):Di(Pr,Qi,xa)}return Pr}function $i(Mt){return Uu(function(rr,Pr){var Vn=-1,Ji=Pr.length,Ra=Ji>1?Pr[Ji-1]:void 0,Ha=Ji>2?Pr[2]:void 0;for(Ra=Mt.length>3&&typeof Ra=="function"?(Ji--,Ra):void 0,Ha&&_o(Pr[0],Pr[1],Ha)&&(Ra=Ji<3?void 0:Ra,Ji=1),rr=Object(rr);++Vn<Ji;){var Qi=Pr[Vn];Qi&&Mt(rr,Qi,Vn,Ra)}return rr})}function oo(Mt){return function(rr,Pr,Vn){for(var Ji=-1,Ra=Object(rr),Ha=Vn(rr),Qi=Ha.length;Qi--;){var xa=Ha[Mt?Qi:++Ji];if(Pr(Ra[xa],xa,Ra)===!1)break}return rr}}function so(Mt,rr){var Pr=Mt.__data__;return kt(rr)?Pr[typeof rr=="string"?"string":"hash"]:Pr.map}function Ys(Mt,rr){var Pr=Ge(Mt,rr);return ci(Pr)?Pr:void 0}function Ao(Mt){var rr=ie.call(Mt,Zr),Pr=Mt[Zr];try{Mt[Zr]=void 0;var Vn=!0}catch(Ra){}var Ji=Bt.call(Mt);return Vn&&(rr?Mt[Zr]=Pr:delete Mt[Zr]),Ji}function Zl(Mt){return typeof Mt.constructor=="function"&&!It(Mt)?Hn(ht(Mt)):{}}function Ks(Mt,rr){var Pr=typeof Mt;return rr=rr==null?D:rr,!!rr&&(Pr=="number"||Pr!="symbol"&&me.test(Mt))&&Mt>-1&&Mt%1==0&&Mt<rr}function _o(Mt,rr,Pr){if(!uo(Pr))return!1;var Vn=typeof rr;return(Vn=="number"?$s(Pr)&&Ks(rr,Pr.length):Vn=="string"&&rr in Pr)?No(Pr[rr],Mt):!1}function kt(Mt){var rr=typeof Mt;return rr=="string"||rr=="number"||rr=="symbol"||rr=="boolean"?Mt!=="__proto__":Mt===null}function De(Mt){return!!et&&et in Mt}function It(Mt){var rr=Mt&&Mt.constructor,Pr=typeof rr=="function"&&rr.prototype||Nt;return Mt===Pr}function fr(Mt){var rr=[];if(Mt!=null)for(var Pr in Object(Mt))rr.push(Pr);return rr}function tn(Mt){return Bt.call(Mt)}function En(Mt,rr,Pr){return rr=Sn(rr===void 0?Mt.length-1:rr,0),function(){for(var Vn=arguments,Ji=-1,Ra=Sn(Vn.length-rr,0),Ha=Array(Ra);++Ji<Ra;)Ha[Ji]=Vn[rr+Ji];Ji=-1;for(var Qi=Array(rr+1);++Ji<rr;)Qi[Ji]=Vn[Ji];return Qi[rr]=Pr(Ha),R(Mt,this,Qi)}}function Un(Mt,rr){if(!(rr==="constructor"&&typeof Mt[rr]=="function")&&rr!="__proto__")return Mt[rr]}var La=no(Ui);function no(Mt){var rr=0,Pr=0;return function(){var Vn=ai(),Ji=W-(Vn-Pr);if(Pr=Vn,Ji>0){if(++rr>=a)return arguments[0]}else rr=0;return Mt.apply(void 0,arguments)}}function go(Mt){if(Mt!=null){try{return Ye.call(Mt)}catch(rr){}try{return Mt+""}catch(rr){}}return""}function No(Mt,rr){return Mt===rr||Mt!==Mt&&rr!==rr}var Vu=gi(function(){return arguments}())?gi:function(Mt){return hs(Mt)&&ie.call(Mt,"callee")&&!Vt.call(Mt,"callee")},Wl=Array.isArray;function $s(Mt){return Mt!=null&&zs(Mt.length)&&!fs(Mt)}function Ic(Mt){return hs(Mt)&&$s(Mt)}var Il=jn||ds;function fs(Mt){if(!uo(Mt))return!1;var rr=Pi(Mt);return rr==We||rr==Oe||rr==ce||rr==$e}function zs(Mt){return typeof Mt=="number"&&Mt>-1&&Mt%1==0&&Mt<=D}function uo(Mt){var rr=typeof Mt;return Mt!=null&&(rr=="object"||rr=="function")}function hs(Mt){return Mt!=null&&typeof Mt=="object"}function Js(Mt){if(!hs(Mt)||Pi(Mt)!=it)return!1;var rr=ht(Mt);if(rr===null)return!0;var Pr=ie.call(rr,"constructor")&&rr.constructor;return typeof Pr=="function"&&Pr instanceof Pr&&Ye.call(Pr)==lr}var lu=C?fe(C):Oa;function Xl(Mt){return is(Mt,ya(Mt))}function ya(Mt){return $s(Mt)?vi(Mt,!0):mo(Mt)}var Na=$i(function(Mt,rr,Pr,Vn){$a(Mt,rr,Pr,Vn)});function ml(Mt){return function(){return Mt}}function Ns(Mt){return Mt}function ds(){return!1}v.exports=Na}).call(this,o("yLpj"),o("YuTi")(Re))},quyA:function(Re,y){var o="\\ud800-\\udfff",S="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",B=S+v+X,a="\\ufe0e\\ufe0f",W="\\u200d",D=RegExp("["+W+o+B+a+"]");function J(te){return D.test(te)}Re.exports=J},qxNg:function(Re,y,o){"use strict";o.d(y,"a",function(){return D});var S=o("lSNA"),v=o.n(S),X=o("mpbz"),B=o.n(X);function a(te,ce){var Y=Object.keys(te);if(Object.getOwnPropertySymbols){var ke=Object.getOwnPropertySymbols(te);ce&&(ke=ke.filter(function(Ke){return Object.getOwnPropertyDescriptor(te,Ke).enumerable})),Y.push.apply(Y,ke)}return Y}function W(te){for(var ce=1;ce<arguments.length;ce++){var Y=arguments[ce]!=null?arguments[ce]:{};ce%2?a(Object(Y),!0).forEach(function(ke){v()(te,ke,Y[ke])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(Y)):a(Object(Y)).forEach(function(ke){Object.defineProperty(te,ke,Object.getOwnPropertyDescriptor(Y,ke))})}return te}function D(te,ce){var Y=ce.radius,ke=Y===void 0?40:Y,Ke=ce.maxZoom,We=Ke===void 0?18:Ke,Oe=ce.minZoom,st=Oe===void 0?0:Oe,Le=ce.zoom,xt=Le===void 0?2:Le;if(te.pointIndex){var it=te.pointIndex.getClusters(te.extent,Math.floor(xt));return te.dataArray=J(it),te}var $e=new B.a({radius:ke,minZoom:st,maxZoom:We}),Ze={type:"FeatureCollection",features:[]};return Ze.features=te.dataArray.map(function(St){return{type:"Feature",geometry:{type:"Point",coordinates:St.coordinates},properties:W({},St)}}),$e.load(Ze.features),$e}function J(te){return te.map(function(ce,Y){return W({coordinates:ce.geometry.coordinates,_id:Y+1},ce.properties)})}},riiI:function(Re,y){},rlAn:function(Re,y,o){"use strict";var S=o("ISu3"),v=o("gMG2"),X=o("5gLl"),B=o("BpBL"),a=o("5zYK"),W=o("lJbI"),D=o("l94r"),J=o("qxNg"),te=o("Y8BV"),ce=o("VIsB"),Y=o("+VLl"),ke=o("aF1E"),Ke=o("fdMe");o.d(y,"getTransform",function(){return S.b}),o.d(y,"getParser",function(){return S.a});var We=o("U1ZX"),Oe=o.n(We);y.default=D.a,Object(S.c)("geojson",X.a),Object(S.c)("image",B.a),Object(S.c)("csv",v.a),Object(S.c)("json",a.a),Object(S.c)("raster",W.a),Object(S.d)("cluster",J.a),Object(S.d)("filter",te.a),Object(S.d)("join",ke.a),Object(S.d)("map",Ke.a),Object(S.d)("grid",ce.a),Object(S.d)("hexagon",Y.a)},rxlC:function(Re,y,o){"use strict";Re.exports=v,Re.exports.default=v;var S=1e20;function v(a,W,D,J,te,ce){this.fontSize=a||24,this.buffer=W===void 0?3:W,this.cutoff=J||.25,this.fontFamily=te||"sans-serif",this.fontWeight=ce||"normal",this.radius=D||8;var Y=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Y,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Y*Y),this.gridInner=new Float64Array(Y*Y),this.f=new Float64Array(Y),this.d=new Float64Array(Y),this.z=new Float64Array(Y+1),this.v=new Int16Array(Y),this.middle=Math.round(Y/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}v.prototype.draw=function(a){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(a,this.buffer,this.middle);for(var W=this.ctx.getImageData(0,0,this.size,this.size),D=new Uint8ClampedArray(this.size*this.size),J=0;J<this.size*this.size;J++){var te=W.data[J*4+3]/255;this.gridOuter[J]=te===1?0:te===0?S:Math.pow(Math.max(0,.5-te),2),this.gridInner[J]=te===1?S:te===0?0:Math.pow(Math.max(0,te-.5),2)}for(X(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),X(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),J=0;J<this.size*this.size;J++){var ce=this.gridOuter[J]-this.gridInner[J];D[J]=Math.max(0,Math.min(255,Math.round(255-255*(ce/this.radius+this.cutoff))))}return D};function X(a,W,D,J,te,ce,Y){for(var ke=0;ke<W;ke++){for(var Ke=0;Ke<D;Ke++)J[Ke]=a[Ke*W+ke];for(B(J,te,ce,Y,D),Ke=0;Ke<D;Ke++)a[Ke*W+ke]=te[Ke]}for(Ke=0;Ke<D;Ke++){for(ke=0;ke<W;ke++)J[ke]=a[Ke*W+ke];for(B(J,te,ce,Y,W),ke=0;ke<W;ke++)a[Ke*W+ke]=Math.sqrt(te[ke])}}function B(a,W,D,J,te){D[0]=0,J[0]=-S,J[1]=+S;for(var ce=1,Y=0;ce<te;ce++){for(var ke=(a[ce]+ce*ce-(a[D[Y]]+D[Y]*D[Y]))/(2*ce-2*D[Y]);ke<=J[Y];)Y--,ke=(a[ce]+ce*ce-(a[D[Y]]+D[Y]*D[Y]))/(2*ce-2*D[Y]);Y++,D[Y]=ce,J[Y]=ke,J[Y+1]=+S}for(ce=0,Y=0;ce<te;ce++){for(;J[Y+1]<ce;)Y++;W[ce]=(ce-D[Y])*(ce-D[Y])+a[D[Y]]}}},sGsY:function(Re,y,o){"use strict";var S=o("lSNA"),v=o.n(S),X=o("pVnL"),B=o.n(X),a=o("q1tI"),W=o("TSYQ"),D=o.n(W),J=o("H84U"),te=o("/ezw"),ce=o("B6l+"),Y=o.n(ce),ke=function(me){var rt=me.value,Kt=me.formatter,_t=me.precision,ge=me.decimalSeparator,ye=me.groupSeparator,Ve=ye===void 0?"":ye,ft=me.prefixCls,Ie;if(typeof Kt=="function")Ie=Kt(rt);else{var pt=String(rt),C=pt.match(/^(-?)(\d*)(\.(\d+))?$/);if(!C||pt==="-")Ie=pt;else{var R=C[1],q=C[2]||"0",fe=C[4]||"";q=q.replace(/\B(?=(\d{3})+(?!\d))/g,Ve),typeof _t=="number"&&(fe=Y()(fe,_t,"0").slice(0,_t)),fe&&(fe="".concat(ge).concat(fe)),Ie=[a.createElement("span",{key:"int",className:"".concat(ft,"-content-value-int")},R,q),fe&&a.createElement("span",{key:"decimal",className:"".concat(ft,"-content-value-decimal")},fe)]}}return a.createElement("span",{className:"".concat(ft,"-content-value")},Ie)},Ke=ke,We=function(me){var rt=me.prefixCls,Kt=me.className,_t=me.style,ge=me.valueStyle,ye=me.value,Ve=ye===void 0?0:ye,ft=me.title,Ie=me.valueRender,pt=me.prefix,C=me.suffix,R=me.loading,q=me.direction,fe=me.onMouseEnter,Ge=me.onMouseLeave,Je=a.createElement(Ke,B()({},me,{value:Ve})),yt=D()(rt,v()({},"".concat(rt,"-rtl"),q==="rtl"),Kt);return a.createElement("div",{className:yt,style:_t,onMouseEnter:fe,onMouseLeave:Ge},ft&&a.createElement("div",{className:"".concat(rt,"-title")},ft),a.createElement(te.a,{paragraph:!1,loading:R},a.createElement("div",{style:ge,className:"".concat(rt,"-content")},pt&&a.createElement("span",{className:"".concat(rt,"-content-prefix")},pt),Ie?Ie(Je):Je,C&&a.createElement("span",{className:"".concat(rt,"-content-suffix")},C))))};We.defaultProps={decimalSeparator:".",groupSeparator:",",loading:!1};var Oe=Object(J.c)({prefixCls:"statistic"})(We),st=Oe,Le=o("lwsE"),xt=o.n(Le),it=o("W8MJ"),$e=o.n(it),Ze=o("7W2i"),St=o.n(Ze),bt=o("LQ03"),Ne=o.n(bt),ze=o("J4zp"),Ue=o.n(ze),lt=o("QQZ/"),Me=o.n(lt),ct=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Gt(Te,me){var rt=Te,Kt=/\[[^\]]*]/g,_t=(me.match(Kt)||[]).map(function(ft){return ft.slice(1,-1)}),ge=me.replace(Kt,"[]"),ye=ct.reduce(function(ft,Ie){var pt=Ue()(Ie,2),C=pt[0],R=pt[1];if(ft.indexOf(C)!==-1){var q=Math.floor(rt/R);return rt-=q*R,ft.replace(new RegExp("".concat(C,"+"),"g"),function(fe){var Ge=fe.length;return Me()(q.toString(),Ge,"0")})}return ft},ge),Ve=0;return ye.replace(Kt,function(){var ft=_t[Ve];return Ve+=1,ft})}function $t(Te,me){var rt=me.format,Kt=rt===void 0?"":rt,_t=new Date(Te).getTime(),ge=Date.now(),ye=Math.max(_t-ge,0);return Gt(ye,Kt)}var ar=o("0n0R"),oe=1e3/30;function Q(Te){return new Date(Te).getTime()}var G=function(Te){St()(rt,Te);var me=Ne()(rt);function rt(){var Kt;return xt()(this,rt),Kt=me.apply(this,arguments),Kt.syncTimer=function(){var _t=Kt.props.value,ge=Q(_t);ge>=Date.now()?Kt.startTimer():Kt.stopTimer()},Kt.startTimer=function(){Kt.countdownId||(Kt.countdownId=window.setInterval(function(){Kt.forceUpdate()},oe))},Kt.stopTimer=function(){var _t=Kt.props,ge=_t.onFinish,ye=_t.value;if(Kt.countdownId){clearInterval(Kt.countdownId),Kt.countdownId=void 0;var Ve=Q(ye);ge&&Ve<Date.now()&&ge()}},Kt.formatCountdown=function(_t,ge){var ye=Kt.props.format;return $t(_t,B()(B()({},ge),{format:ye}))},Kt.valueRender=function(_t){return Object(ar.a)(_t,{title:void 0})},Kt}return $e()(rt,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return a.createElement(st,B()({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),rt}(a.Component);G.defaultProps={format:"HH:mm:ss"};var Ce=G;st.Countdown=Ce;var be=y.a=st},sKgW:function(Re,y){var o=9007199254740991,S=Math.floor;function v(X,B){var a="";if(!X||B<1||B>o)return a;do B%2&&(a+=X),B=S(B/2),B&&(X+=X);while(B);return a}Re.exports=v},sXyB:function(Re,y,o){var S=o("SksO"),v=o("b48C");function X(B,a,W){return v()?Re.exports=X=Reflect.construct:Re.exports=X=function(J,te,ce){var Y=[null];Y.push.apply(Y,te);var ke=Function.bind.apply(J,Y),Ke=new ke;return ce&&S(Ke,ce.prototype),Ke},X.apply(null,arguments)}Re.exports=X},sgoq:function(Re,y,o){var S=o("asDA"),v=o("TKrE"),X=o("6nK8"),B="['\u2019]",a=RegExp(B,"g");function W(D){return function(J){return S(X(v(J).replace(a,"")),D,"")}}Re.exports=W},sxDa:function(Re,y,o){"use strict";o.d(y,"e",function(){return Xu}),o.d(y,"f",function(){return ll}),o.d(y,"d",function(){return gc}),o.d(y,"a",function(){return so}),o.d(y,"c",function(){return xa}),o.d(y,"g",function(){return Bl}),o.d(y,"b",function(){return Ns});var S=o("h1nZ"),v=o("lwsE"),X=o.n(v),B=o("W8MJ"),a=o.n(B),W=o("7W2i"),D=o.n(W),J=o("a1gu"),te=o.n(J),ce=o("Nsbk"),Y=o.n(ce),ke=o("QILm"),Ke=o.n(ke),We=o("lSNA"),Oe=o.n(We),st=o("yG8O"),Le=o.n(st),xt=o("PJYZ"),it=o.n(xt),$e=o("U+yc"),Ze=o.n($e),St=o("1ABj"),bt=o("GoyQ"),Ne=o.n(bt),ze=o("lSCD"),Ue=o.n(ze),lt=o("xp6e"),Me=o("Hel2"),ct=o("uhBA"),Gt=o("4U9+"),$t=o.n(Gt),ar=o("4cb6"),oe,Q,G,Ce,be,Te;function me(h){return h.map(function(T){return typeof T=="string"&&(T=[T,{}]),T})}var rt=(oe=Object(ar.injectable)(),Q=Object(ar.inject)(S.TYPES.IGlobalConfigService),oe(G=(Ce=(Te=function(){function h(){X()(this,h),Le()(this,"configService",be,this),this.enabled=void 0}return a()(h,[{key:"apply",value:function(E,b){var _=this,M=b.rendererService,j=b.postProcessingPassFactory,ae=b.normalPassFactory;E.hooks.init.tap("MultiPassRendererPlugin",function(){var ve=E.getLayerConfig(),je=ve.enableMultiPassRenderer,Rt=ve.passes,Jt=Rt===void 0?[]:Rt;_.enabled=!!je&&E.getLayerConfig().enableMultiPassRenderer!==!1,_.enabled&&(E.multiPassRenderer=_.createMultiPassRenderer(E,Jt,j,ae),E.multiPassRenderer.setRenderFlag(!0))}),E.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(E,b,_,M){var j=E.multiPassRenderer,ae=E.getLayerConfig(),ve=ae.enablePicking,je=ae.enableTAA;return ve&&j.add(M("pixelPicking")),j}}]),h}(),Te),be=Ze()(Ce.prototype,"configService",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ce))||G),Kt,_t=(Kt={},Oe()(Kt,S.BlendType.additive,{enable:!0,func:{srcRGB:S.gl.ONE,dstRGB:S.gl.ONE,srcAlpha:1,dstAlpha:1}}),Oe()(Kt,S.BlendType.none,{enable:!1}),Oe()(Kt,S.BlendType.normal,{enable:!0,func:{srcRGB:S.gl.SRC_ALPHA,dstRGB:S.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),Oe()(Kt,S.BlendType.subtractive,{enable:!0,func:{srcRGB:S.gl.ONE,dstRGB:S.gl.ONE,srcAlpha:S.gl.ZERO,dstAlpha:S.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:S.gl.FUNC_SUBTRACT,alpha:S.gl.FUNC_SUBTRACT}}),Oe()(Kt,S.BlendType.max,{enable:!0,func:{srcRGB:S.gl.ONE,dstRGB:S.gl.ONE},equation:{rgb:S.gl.MAX_EXT}}),Oe()(Kt,S.BlendType.min,{enable:!0,func:{srcRGB:S.gl.ONE,dstRGB:S.gl.ONE},equation:{rgb:S.gl.MIN_EXT}}),Kt),ge={properties:{enablePicking:{type:"boolean"},enableHighlight:{type:"boolean"},highlightColor:{oneOf:[{type:"array",items:{type:"number",minimum:0,maximum:1}},{type:"string"}]}}},ye,Ve,ft,Ie,pt,C,R,q;function fe(h,T){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=Ge(h))||T&&h&&typeof h.length=="number"){E&&(h=E);var b=0,_=function(){};return{s:_,n:function(){return b>=h.length?{done:!0}:{done:!1,value:h[b++]}},e:function(je){throw je},f:_}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,j=!1,ae;return{s:function(){E=h[Symbol.iterator]()},n:function(){var je=E.next();return M=je.done,je},e:function(je){j=!0,ae=je},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(j)throw ae}}}}function Ge(h,T){if(!!h){if(typeof h=="string")return Je(h,T);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return Je(h,T)}}function Je(h,T){(T==null||T>h.length)&&(T=h.length);for(var E=0,b=new Array(T);E<T;E++)b[E]=h[E];return b}function yt(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);T&&(b=b.filter(function(_){return Object.getOwnPropertyDescriptor(h,_).enumerable})),E.push.apply(E,b)}return E}function nt(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?yt(Object(E),!0).forEach(function(b){Oe()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):yt(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}function Nt(h){var T=$();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function $(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ye=0,ie=(ye=Object(S.lazyInject)(S.TYPES.ILogService),Ve=Object(S.lazyInject)(S.TYPES.IGlobalConfigService),ft=Object(S.lazyInject)(S.TYPES.IShaderModuleService),Ie=(q=function(h){D()(E,h);var T=Nt(E);function E(){var b,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return X()(this,E),b=T.call(this),b.id="".concat(Ye++),b.name="".concat(Ye),b.type=void 0,b.visible=!0,b.zIndex=0,b.minZoom=void 0,b.maxZoom=void 0,b.inited=!1,b.layerModelNeedUpdate=!1,b.pickedFeatureID=null,b.selectedFeatureID=null,b.styleNeedUpdate=!1,b.dataState={dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1},b.hooks={init:new lt.b,afterInit:new lt.b,beforeRender:new lt.b,beforeRenderData:new lt.d,afterRender:new lt.c,beforePickingEncode:new lt.c,afterPickingEncode:new lt.c,beforeHighlight:new lt.c(["pickedColor"]),afterHighlight:new lt.c,beforeSelect:new lt.c(["pickedColor"]),afterSelect:new lt.c,beforeDestroy:new lt.c,afterDestroy:new lt.c},b.models=[],b.multiPassRenderer=void 0,b.plugins=void 0,b.sourceOption=void 0,b.layerModel=void 0,Le()(b,"logger",pt,it()(b)),Le()(b,"configService",C,it()(b)),Le()(b,"shaderModuleService",R,it()(b)),b.cameraService=void 0,b.coordinateService=void 0,b.iconService=void 0,b.fontService=void 0,b.rendererService=void 0,b.layerService=void 0,b.interactionService=void 0,b.mapService=void 0,b.styleAttributeService=void 0,b.layerSource=void 0,b.postProcessingPassFactory=void 0,b.normalPassFactory=void 0,b.animateOptions={enable:!1},b.container=void 0,b.encodedData=void 0,b.configSchema=void 0,b.currentPickId=null,b.rawConfig=void 0,b.needUpdateConfig=void 0,b.pendingStyleAttributes=[],b.scaleOptions={},b.animateStartTime=void 0,b.aniamateStatus=!1,b.sourceEvent=function(){b.dataState.dataSourceNeedUpdate=!0;var M=b.getLayerConfig(),j=M.autoFit,ae=M.fitBoundsOptions;j&&b.fitBounds(ae),b.emit("dataUpdate"),b.reRender()},b.name=_.name||b.id,b.zIndex=_.zIndex||0,b.rawConfig=_,b}return a()(E,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(_){if(!this.inited)this.needUpdateConfig=nt(nt({},this.needUpdateConfig),_);else{var M=this.container.get(S.TYPES.SceneID);this.configService.setLayerConfig(M,this.id,nt(nt(nt({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),_)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(_){this.container=_}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(_){return this.plugins.push(_),this}},{key:"init",value:function(){var _=this,M=this.container.get(S.TYPES.SceneID),j=this.rawConfig.enableMultiPassRenderer,ae=j===void 0?!1:j;this.configService.setLayerConfig(M,this.id,{enableMultiPassRenderer:ae}),this.iconService=this.container.get(S.TYPES.IIconService),this.fontService=this.container.get(S.TYPES.IFontService),this.rendererService=this.container.get(S.TYPES.IRendererService),this.layerService=this.container.get(S.TYPES.ILayerService),this.interactionService=this.container.get(S.TYPES.IInteractionService),this.mapService=this.container.get(S.TYPES.IMapService),this.cameraService=this.container.get(S.TYPES.ICameraService),this.coordinateService=this.container.get(S.TYPES.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(S.TYPES.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(S.TYPES.IFactoryNormalPass),this.styleAttributeService=this.container.get(S.TYPES.IStyleAttributeService),this.multiPassRenderer=this.container.get(S.TYPES.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(Jt){var wr=Jt.attributeName,Dr=Jt.attributeField,xn=Jt.attributeValues,mn=Jt.updateOptions;_.styleAttributeService.updateStyleAttribute(wr,{scale:nt({field:Dr},_.splitValuesAndCallbackInAttribute(xn,_.getLayerConfig()[wr]))},mn)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(S.TYPES.ILayerPlugin);var ve=fe(this.plugins),je;try{for(ve.s();!(je=ve.n()).done;){var Rt=je.value;Rt.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(Jt){ve.e(Jt)}finally{ve.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(nt(nt({},this.getDefaultConfig()),this.rawConfig));var _=this.getLayerConfig(),M=_.animateOption;(M==null?void 0:M.enable)&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(_,M,j){return this.updateStyleAttribute("color",_,M,j),this}},{key:"rotate",value:function(_,M,j){return this.updateStyleAttribute("rotate",_,M,j),this}},{key:"size",value:function(_,M,j){return this.updateStyleAttribute("size",_,M,j),this}},{key:"filter",value:function(_,M,j){return this.updateStyleAttribute("filter",_,M,j),this}},{key:"shape",value:function(_,M,j){return this.updateStyleAttribute("shape",_,M,j),this}},{key:"label",value:function(_,M,j){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:_,attributeValues:M,updateOptions:j}),this}},{key:"animate",value:function(_){var M={};return Ne()(_)?(M.enable=!0,M=nt(nt({},M),_)):M.enable=_,this.updateLayerConfig({animateOption:M}),this}},{key:"source",value:function(_,M){return this.sourceOption={data:_,options:M},this}},{key:"setData",value:function(_,M){var j=this;return this.inited?this.layerSource.setData(_,M):this.on("inited",function(){j.layerSource.setData(_,M)}),this}},{key:"style",value:function(_){var M=this,j=_.passes,ae=Ke()(_,["passes"]);return j&&me(j).forEach(function(ve){var je=M.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(ve[0]);je&&je.updateOptions(ve[1])}),this.rawConfig=nt(nt({},this.rawConfig),ae),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(_,M){return Ne()(_)?this.scaleOptions=nt(nt({},this.scaleOptions),_):this.scaleOptions[_]=M,this}},{key:"render",value:function(){return this.renderModels(),this}},{key:"active",value:function(_){var M={};return M.enableHighlight=Ne()(_)?!0:_,Ne()(_)?(M.enableHighlight=!0,_.color&&(M.highlightColor=_.color)):M.enableHighlight=!!_,this.updateLayerConfig(M),this}},{key:"setActive",value:function(_,M){var j=this;if(Ne()(_)){var ae=_.x,ve=ae===void 0?0:ae,je=_.y,Rt=je===void 0?0:je;this.updateLayerConfig({highlightColor:Ne()(M)?M.color:this.getLayerConfig().highlightColor}),this.pick({x:ve,y:Rt})}else this.updateLayerConfig({pickedFeatureID:_,highlightColor:Ne()(M)?M.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call(Object(Me.l)(_)).then(function(){setTimeout(function(){j.reRender()},1)})}},{key:"select",value:function(_){var M={};return M.enableSelect=Ne()(_)?!0:_,Ne()(_)?(M.enableSelect=!0,_.color&&(M.selectColor=_.color)):M.enableSelect=!!_,this.updateLayerConfig(M),this}},{key:"setSelect",value:function(_,M){var j=this;if(Ne()(_)){var ae=_.x,ve=ae===void 0?0:ae,je=_.y,Rt=je===void 0?0:je;this.updateLayerConfig({selectColor:Ne()(M)?M.color:this.getLayerConfig().selectColor}),this.pick({x:ve,y:Rt})}else this.updateLayerConfig({pickedFeatureID:_,selectColor:Ne()(M)?M.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call(Object(Me.l)(_)).then(function(){setTimeout(function(){j.reRender()},1)})}},{key:"setBlend",value:function(_){this.updateLayerConfig({blend:_}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(_){return this.zIndex=_,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(_){this.currentPickId=_}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(_){this.selectedFeatureID=_}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var _=this.mapService.getZoom(),M=this.getLayerConfig(),j=M.visible,ae=M.minZoom,ve=ae===void 0?-Infinity:ae,je=M.maxZoom,Rt=je===void 0?Infinity:je;return!!j&&_>=ve&&_<=Rt}},{key:"setMinZoom",value:function(_){return this.updateLayerConfig({minZoom:_}),this}},{key:"getMinZoom",value:function(){var _=this.getLayerConfig(),M=_.minZoom;return M}},{key:"getMaxZoom",value:function(){var _=this.getLayerConfig(),M=_.maxZoom;return M}},{key:"get",value:function(_){var M=this.getLayerConfig();return M[_]}},{key:"setMaxZoom",value:function(_){return this.updateLayerConfig({maxZoom:_}),this}},{key:"fitBounds",value:function(_){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var M=this.getSource(),j=M.extent,ae=j.some(function(ve){return Math.abs(ve)===Infinity});return ae?this:(this.mapService.fitBounds([[j[0],j[1]],[j[2],j[3]]],_),this)}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(_){return _.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(_){return _.needRescale||_.needRemapping||_.needRegenerateVertices}).length}},{key:"setSource",value:function(_){this.layerSource=_;var M=this.mapService.getZoom();this.layerSource.cluster&&this.layerSource.updateClusterData(M),this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(_){this.encodedData=_}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getConfigSchemaForValidation",value:function(){return this.configSchema||(this.configSchema=$t()([ge,this.getConfigSchema()])),this.configSchema}},{key:"getLegendItems",value:function(_){var M=this.styleAttributeService.getLayerAttributeScale(_);if(M){if(M.ticks){var j=M.ticks().map(function(ve){return Oe()({value:ve},_,M(ve))});return j}else if(M.invertExtent){var ae=M.range().map(function(ve){return Oe()({value:M.invertExtent(ve)},_,ve)});return ae}}else return[]}},{key:"pick",value:function(_){var M=_.x,j=_.y;this.interactionService.triggerHover({x:M,y:j})}},{key:"buildLayerModel",value:function(_){var M=_.moduleName,j=_.vertexShader,ae=_.fragmentShader,ve=_.triangulation,je=Ke()(_,["moduleName","vertexShader","fragmentShader","triangulation"]);this.shaderModuleService.registerModule(M,{vs:j,fs:ae});var Rt=this.shaderModuleService.getModule(M),Jt=Rt.vs,wr=Rt.fs,Dr=Rt.uniforms,xn=this.rendererService.createModel,mn=this.styleAttributeService.createAttributesAndIndices(this.encodedData,ve),Bn=mn.attributes,Ei=mn.elements;return xn(nt({attributes:Bn,uniforms:Dr,fs:wr,vs:Jt,elements:Ei,blend:_t[S.BlendType.normal]},je))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(_){var M=this.getLayerConfig(),j=M.enableHighlight,ae=j===void 0?!0:j,ve=M.enableSelect,je=ve===void 0?!0:ve,Rt=this.eventNames().indexOf(_)!==-1||this.eventNames().indexOf("un"+_)!==-1;return(_==="click"||_==="dblclick")&&je&&(Rt=!0),_==="mousemove"&&(ae||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(Rt=!0),this.isVisible()&&Rt}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var _=this;return this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(M){M.draw({uniforms:_.layerModel.getUninforms()})}),this}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(_,M){return{values:Ue()(_)?void 0:_||M,callback:Ue()(_)?_:void 0}}},{key:"updateStyleAttribute",value:function(_,M,j,ae){this.inited?this.styleAttributeService.updateStyleAttribute(_,{scale:nt({field:M},this.splitValuesAndCallbackInAttribute(j,this.getLayerConfig()[M]))},ae):this.pendingStyleAttributes.push({attributeName:_,attributeField:M,attributeValues:j,updateOptions:ae})}}]),E}(ct.EventEmitter),q),pt=Ze()(Ie.prototype,"logger",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=Ze()(Ie.prototype,"configService",[Ve],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Ze()(Ie.prototype,"shaderModuleService",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ie),et,Bt,lr,dt,vt,Ct,gt=(et=Object(S.lazyInject)(S.TYPES.IGlobalConfigService),Bt=Object(S.lazyInject)(S.TYPES.IShaderModuleService),lr=(Ct=function(){function h(T){X()(this,h),this.triangulation=void 0,this.layer=void 0,Le()(this,"configService",dt,this),Le()(this,"shaderModuleService",vt,this),this.rendererService=void 0,this.iconService=void 0,this.fontService=void 0,this.styleAttributeService=void 0,this.mapService=void 0,this.cameraService=void 0,this.layerService=void 0,this.layer=T,this.rendererService=T.getContainer().get(S.TYPES.IRendererService),this.styleAttributeService=T.getContainer().get(S.TYPES.IStyleAttributeService),this.mapService=T.getContainer().get(S.TYPES.IMapService),this.iconService=T.getContainer().get(S.TYPES.IIconService),this.fontService=T.getContainer().get(S.TYPES.IFontService),this.cameraService=T.getContainer().get(S.TYPES.ICameraService),this.layerService=T.getContainer().get(S.TYPES.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate()}return a()(h,[{key:"getBlend",value:function(){var E=this.layer.getLayerConfig(),b=E.blend,_=b===void 0?"normal":b;return _t[S.BlendType[_]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(E){return[E.enable?0:1,E.duration||4,E.interval||.2,E.trailLength||.1]}},{key:"startModelAnimate",value:function(){var E=this.layer.getLayerConfig(),b=E.animateOption;b.enable&&this.layer.setAnimateStartTime()}}]),h}(),Ct),dt=Ze()(lr.prototype,"configService",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vt=Ze()(lr.prototype,"shaderModuleService",[Bt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lr),we=o("J4zp"),ht=o.n(we),Qe=o("RIqP"),Vt=o.n(Qe),pr=o("VmRL"),Zr=o.n(pr),cr=o("IOcx"),jn=cr.c.create(),Sn=cr.c.create(),ai=cr.c.create(),fi=cr.c.create(),Zn=cr.c.create();function Hn(h,T,E,b,_){cr.c.add(h,E,b),cr.c.normalize(h,h),T=cr.c.fromValues(-h[1],h[0]);var M=cr.c.fromValues(-E[1],E[0]);return[_/cr.c.dot(T,M),T]}function k(h,T){return cr.c.set(h,-T[1],T[0])}function H(h,T,E){return cr.c.sub(h,T,E),cr.c.normalize(h,h),h}function le(h,T){return h[0]===T[0]&&h[1]===T[1]}function de(h){for(var T=new Map,E=0;E<h.length;E++){var b=h[0].toString()+"-"+h[1].toString();T.get(b)?(h.splice(E,1),E++):T.set(b,b)}return h}var at=function(){function h(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};X()(this,h),this.complex=void 0,this.join=void 0,this.cap=void 0,this.miterLimit=void 0,this.thickness=void 0,this.normal=void 0,this.lastFlip=-1,this.miter=cr.c.fromValues(0,0),this.started=!1,this.dash=!1,this.totalDistance=0,this.join=T.join||"miter",this.cap=T.cap||"butt",this.miterLimit=T.miterLimit||10,this.thickness=T.thickness||1,this.dash=T.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return a()(h,[{key:"extrude",value:function(E){var b=this.complex;if(E.length<=1)return b;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var _=E.length,M=b.startIndex,j=1;j<_;j++){var ae=E[j-1],ve=E[j],je=j<E.length-1?E[j+1]:null,Rt=this.segment(b,M,ae,ve,je);M+=Rt}if(this.dash)for(var Jt=0;Jt<b.positions.length/6;Jt++)b.positions[Jt*6+5]=this.totalDistance;return b.startIndex=b.positions.length/6,b}},{key:"segment",value:function(E,b,_,M,j){var ae=0,ve=E.indices,je=E.positions,Rt=E.normals,Jt=this.cap==="square",wr=this.join==="bevel",Dr=Object(Me.d)([M[0],M[1]]),xn=Object(Me.d)([_[0],_[1]]);H(ai,Dr,xn);var mn=0;if(this.dash&&(mn=this.lineSegmentDistance(Dr,xn),this.totalDistance+=mn),this.normal||(this.normal=cr.c.create(),k(this.normal,ai)),!this.started)if(this.started=!0,Jt){var Bn=cr.c.create(),Ei=cr.c.create();cr.c.add(Bn,this.normal,ai),cr.c.add(Ei,this.normal,ai),Rt.push(Ei[0],Ei[1],0),Rt.push(Bn[0],Bn[1],0),je.push(_[0],_[1],0,this.totalDistance-mn,-this.thickness,0),je.push(_[0],_[1],0,this.totalDistance-mn,this.thickness,0)}else this.extrusions(je,Rt,_,this.normal,this.thickness,this.totalDistance-mn);if(ve.push(b+0,b+1,b+2),j){var oa=Object(Me.d)([j[0],j[1]]);le(Dr,oa)&&cr.c.add(oa,Dr,cr.c.normalize(oa,cr.c.subtract(oa,Dr,xn))),H(fi,oa,Dr);var sa=Hn(Zn,cr.c.create(),ai,fi,this.thickness),to=ht()(sa,2),_i=to[0],ro=to[1],To=cr.c.dot(Zn,this.normal)<0?-1:1,Xs=wr;if(!Xs&&this.join==="miter"){var Wi=_i;Wi>this.miterLimit&&(Xs=!0)}Xs?(Rt.push(this.normal[0],this.normal[1],0),Rt.push(ro[0],ro[1],0),je.push(M[0],M[1],0,this.totalDistance,-this.thickness*To,0),je.push(M[0],M[1],0,this.totalDistance,this.thickness*To,0),ve.push.apply(ve,Vt()(this.lastFlip!==-To?[b,b+2,b+3]:[b+2,b+1,b+3])),ve.push(b+2,b+3,b+4),k(jn,fi),cr.c.copy(this.normal,jn),Rt.push(this.normal[0],this.normal[1],0),je.push(M[0],M[1],0,this.totalDistance,-this.thickness*To,0),ae+=3):(this.extrusions(je,Rt,M,ro,_i,this.totalDistance),ve.push.apply(ve,Vt()(this.lastFlip===1?[b,b+2,b+3]:[b+2,b+1,b+3])),To=-1,cr.c.copy(this.normal,ro),ae+=2),this.lastFlip=To}else{if(k(this.normal,ai),Jt){var Ai=cr.c.create(),za=cr.c.create();cr.c.sub(za,ai,this.normal),cr.c.add(Ai,ai,this.normal),Rt.push(za[0],za[1],0),Rt.push(Ai[0],Ai[1],0),je.push(M[0],M[1],0,this.totalDistance,this.thickness,0),je.push(M[0],M[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(je,Rt,M,this.normal,this.thickness,this.totalDistance);ve.push.apply(ve,Vt()(this.lastFlip===1?[b,b+2,b+3]:[b+2,b+1,b+3])),ae+=2}return ae}},{key:"extrusions",value:function(E,b,_,M,j,ae){b.push(M[0],M[1],0),b.push(M[0],M[1],0),E.push(_[0],_[1],0,ae,-j,0),E.push(_[0],_[1],0,ae,j,0)}},{key:"lineSegmentDistance",value:function(E,b){var _=b[0]-E[0],M=b[1]-E[1];return Math.sqrt(_*_+M*M)}}]),h}(),At=o("UB5X"),Ft=o.n(At);function He(h){if(Ft()(h[0]))return h;if(Ft()(h[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Ft()(h[0][0][0])){var T=h,E=0,b=0,_=0;return T.forEach(function(M){M.forEach(function(j){E+=j[0],b+=j[1],_++})}),[E/_,b/_,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Pt(h){var T=h[0][0],E=h[0][h[0].length-1];T[0]===E[0]&&T[1]===E[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var b=h[0].length,_=Zr.a.flatten(h),M=_.vertices,j=_.dimensions,ae=[],ve=[],je=0;je<M.length/j;je++)j===2?ae.push(M[je*2],M[je*2+1],1):ae.push(M[je*3],M[je*3+1],1);var Rt=Zr()(_.vertices,_.holes,_.dimensions);ve.push.apply(ve,Vt()(Rt));for(var Jt=function(xn){var mn=_.vertices.slice(xn*j,(xn+1)*j),Bn=_.vertices.slice((xn+1)*j,(xn+2)*j);Bn.length===0&&(Bn=_.vertices.slice(0,j));var Ei=ae.length/3;ae.push(mn[0],mn[1],1,Bn[0],Bn[1],1,mn[0],mn[1],0,Bn[0],Bn[1],0),ve.push.apply(ve,Vt()([0,2,1,2,3,1].map(function(Ai){return Ai+Ei})))},wr=0;wr<b;wr++)Jt(wr);return{positions:ae,index:ve}}function or(h){var T=Zr.a.flatten(h),E=Zr()(T.vertices,T.holes,T.dimensions);return{positions:T.vertices,index:E}}function jr(h){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,E=h[0][0],b=h[0][h[0].length-1];E[0]===b[0]&&E[1]===b[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var _=h[0].length,M=Zr.a.flatten(h),j=M.vertices,ae=M.dimensions,ve=[],je=[],Rt=[],Jt=0;Jt<j.length/ae;Jt++)ae===2?ve.push(j[Jt*2],j[Jt*2+1],1,-1,-1):ve.push(j[Jt*3],j[Jt*3+1],1,-1,-1),Rt.push(0,0,1);var wr=Zr()(M.vertices,M.holes,M.dimensions);je.push.apply(je,Vt()(wr));for(var Dr=function(Bn){var Ei=M.vertices.slice(Bn*ae,(Bn+1)*ae),Ai=M.vertices.slice((Bn+1)*ae,(Bn+2)*ae);Ai.length===0&&(Ai=M.vertices.slice(0,ae));var za=ve.length/5;ve.push(Ei[0],Ei[1],1,0,0,Ai[0],Ai[1],1,.1,0,Ei[0],Ei[1],0,0,.8,Ai[0],Ai[1],0,.1,.8);var oa=Hr([Ai[0],Ai[1],1],[Ei[0],Ei[1],0],[Ei[0],Ei[1],1],T);Rt.push.apply(Rt,Vt()(oa).concat(Vt()(oa),Vt()(oa),Vt()(oa))),je.push.apply(je,Vt()([1,2,0,3,2,1].map(function(sa){return sa+za})))},xn=0;xn<_;xn++)Dr(xn);return{positions:ve,index:je,normals:Rt}}function Hr(h,T,E){var b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,_=cr.d.create(),M=cr.d.create(),j=cr.d.create();b&&(h=Object(Me.p)(h),T=Object(Me.p)(T),E=Object(Me.p)(E));var ae=cr.d.fromValues.apply(cr.d,Vt()(h)),ve=cr.d.fromValues.apply(cr.d,Vt()(T)),je=cr.d.fromValues.apply(cr.d,Vt()(E));cr.d.sub(_,je,ve),cr.d.sub(M,ae,ve),cr.d.cross(j,_,M);var Rt=cr.d.create();return cr.d.normalize(Rt,j),Rt}var sr,Fr;(function(h){h.CYLINDER="cylinder",h.SQUARECOLUMN="squareColumn",h.TRIANGLECOLUMN="triangleColumn",h.HEXAGONCOLUMN="hexagonColumn",h.PENTAGONCOLUMN="pentagonColumn"})(Fr||(Fr={}));var _n;(function(h){h.CIRCLE="circle",h.SQUARE="square",h.TRIANGLE="triangle",h.HEXAGON="hexagon",h.PENTAGON="pentagon"})(_n||(_n={}));function dn(h){for(var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=Math.PI*2/h,b=[],_=0;_<h;_++)b.push(E*_+T*Math.PI/12);var M=b.map(function(j){var ae=Math.sin(j+Math.PI/4),ve=Math.cos(j+Math.PI/4);return[ae,ve,0]});return M}function Er(){return dn(30)}function Tn(){return dn(4)}function vn(){return dn(3)}function gn(){return dn(6,1)}function Ar(){return dn(5)}var $r=(sr={},Oe()(sr,_n.CIRCLE,Er),Oe()(sr,_n.HEXAGON,gn),Oe()(sr,_n.TRIANGLE,vn),Oe()(sr,_n.SQUARE,Tn),Oe()(sr,_n.PENTAGON,Ar),Oe()(sr,Fr.CYLINDER,Er),Oe()(sr,Fr.HEXAGONCOLUMN,gn),Oe()(sr,Fr.TRIANGLECOLUMN,vn),Oe()(sr,Fr.SQUARECOLUMN,Tn),Oe()(sr,Fr.PENTAGONCOLUMN,Ar),sr),Mn={};function Xi(h){var T=He(h.coordinates);return{vertices:[].concat(Vt()(T),Vt()(T),Vt()(T),Vt()(T)),indices:[0,1,2,2,3,0],size:T.length}}function vi(h){var T=h.shape,E=Oa(T,!1),b=E.positions,_=E.index,M=E.normals;return{vertices:b,indices:_,normals:M,size:5}}function wi(h){var T=He(h.coordinates);return{vertices:Vt()(T),indices:[0],size:T.length}}function Di(h){var T=h.coordinates,E=T;Array.isArray(E[0][0])||(E=[T]);var b=new at({dash:!0,join:"bevel"});E.forEach(function(M){b.extrude(M)});var _=b.complex;return{vertices:_.positions,indices:_.indices,normals:_.normals,size:6}}function Ka(h){var T=h.coordinates,E=Zr.a.flatten(T),b=E.vertices,_=E.dimensions,M=E.holes;return{indices:Zr()(b,M,_),vertices:b,size:_}}function hi(h){var T=h.coordinates,E=jr(T,!0),b=E.positions,_=E.index,M=E.normals;return{vertices:b,indices:_,normals:M,size:5}}function ga(h){var T=h.shape,E=Uu(T),b=E.positions,_=E.index;return{vertices:b,indices:_,size:3}}function Pi(h){var T=h.coordinates,E=[].concat(Vt()(T[0]),[0,0,1,T[1][0],T[0][1],0,1,1],Vt()(T[1]),[0,1,0],Vt()(T[0]),[0,0,1],Vt()(T[1]),[0,1,0,T[0][0],T[1][1],0,0,0]),b=[0,1,2,3,4,5];return{vertices:E,indices:b,size:5}}function gi(h){for(var T=30,E=h.coordinates,b=[],_=[],M=function(ve){b.push(ve,1,ve,E[0][0],E[0][1],E[1][0],E[1][1],ve,-1,ve,E[0][0],E[0][1],E[1][0],E[1][1]),ve!==T-1&&_.push.apply(_,Vt()([0,1,2,1,3,2].map(function(je){return ve*2+je})))},j=0;j<T;j++)M(j);return{vertices:b,indices:_,size:7}}function ci(h){var T=h.coordinates;T.length===2&&T.push(0);var E=h.size,b=Ui(-1,1),_=Ui(1,1),M=Ui(-1,-1),j=Ui(1,-1),ae=[].concat(Vt()(T),Vt()(b),Vt()(T),Vt()(M),Vt()(T),Vt()(j),Vt()(T),Vt()(_)),ve=[0,1,2,3,0,2];return{vertices:ae,indices:ve,size:5}}function Oa(h){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Mn&&Mn[h])return Mn[h];var E=$r[h]?$r[h]():$r.cylinder(),b=jr([E],T);return Mn[h]=b,b}function mo(h,T){for(var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,_=new Float32Array(h.length/E*3),M,j,ae,ve=cr.d.create(),je=cr.d.create(),Rt=cr.d.create(),Jt=0,wr=T.length;Jt<wr;Jt+=3){M=T[Jt+0]*3,j=T[Jt+1]*3,ae=T[Jt+2]*3;var Dr=[h[M],h[M+1]],xn=[h[j],h[j+1]],mn=[h[ae],h[ae+1]];b&&(Dr=Object(Me.p)(Dr),xn=Object(Me.p)(xn),mn=Object(Me.p)(mn));var Bn=Dr,Ei=ht()(Bn,2),Ai=Ei[0],za=Ei[1],oa=cr.d.fromValues(Ai,za,h[M+2]),sa=xn,to=ht()(sa,2),_i=to[0],ro=to[1],To=cr.d.fromValues(_i,ro,h[j+2]),Xs=mn,Wi=ht()(Xs,2),Cs=Wi[0],rs=Wi[1],vf=cr.d.fromValues(Cs,rs,h[ae+2]);cr.d.sub(ve,vf,To),cr.d.sub(je,oa,To),cr.d.cross(Rt,ve,je),_[M]+=ve[0],_[M+1]+=ve[1],_[M+2]+=ve[2],_[j]+=ve[0],_[j+1]+=ve[1],_[j+2]+=ve[2],_[ae]+=ve[0],_[ae+1]+=ve[1],_[ae+2]+=ve[2]}return $a(_),_}function $a(h){for(var T=0,E=h.length;T<E;T+=3){var b=cr.d.fromValues(h[T],h[T+1],h[T+2]),_=cr.d.create();cr.d.normalize(_,b),h.set(_,T)}}function Ko(h){var T=h[0][0],E=h[0][h[0].length-1];return T[0]===E[0]&&T[1]===E[1]}function Uu(h){var T=["cylinder","triangleColumn","hexagonColumn","squareColumn"],E=$r[h]?$r[h]():$r.circle(),b=T.indexOf(h)===-1?or([E]):Pt([E]);return b}function Ui(h,T){var E=(h+1)/2,b=(T+1)/2;return[E,b]}function Ca(h){var T=ns();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function ns(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var na=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Ja=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);
   v_texCoord = a_Uv;
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,is=function(h){D()(E,h);var T=Ca(E);function E(){return X()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=M===void 0?1:M,ae=_.baseColor,ve=ae===void 0?"rgb(16,16,16)":ae,je=_.brightColor,Rt=je===void 0?"rgb(255,176,38)":je,Jt=_.windowColor,wr=Jt===void 0?"rgb(30,60,89)":Jt,Dr=_.time,xn=Dr===void 0?0:Dr;return{u_opacity:j,u_baseColor:Object(Me.s)(ve),u_brightColor:Object(Me.s)(Rt),u_windowColor:Object(Me.s)(wr),u_time:this.layer.getLayerAnimateTime()||xn}}},{key:"initModels",value:function(){return this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:Ja,fragmentShader:na,triangulation:hi})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(M,j,ae,ve,je){return je}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(M,j,ae,ve){var je=M.size,Rt=je===void 0?10:je;return Array.isArray(Rt)?[Rt[0]]:[Rt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(M,j,ae,ve){var je=M.size;return[ae[3],ae[4]]}}})}}]),E}(gt);function $i(h){var T=oo();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function oo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var so=function(h){D()(E,h);var T=$i(E);function E(){var b;X()(this,E);for(var _=arguments.length,M=new Array(_),j=0;j<_;j++)M[j]=arguments[j];return b=T.call.apply(T,[this].concat(M)),b.type="PolygonLayer",b}return a()(E,[{key:"buildModels",value:function(){this.layerModel=new is(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(_){this.updateLayerConfig({time:_})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),E}(ie);function Ys(h){var T=Ao();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function Ao(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Zl=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
varying vec4 v_color;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,Ks=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,_o=function(h){D()(E,h);var T=Ys(E);function E(){return X()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=_.coverage,ae=_.angle;return{u_opacity:M||1,u_coverage:j||.9,u_angle:ae||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:Zl,fragmentShader:Ks,triangulation:ga,depth:{enable:!1},primitive:S.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:S.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(M,j){var ae=M.coordinates;return[ae[0],ae[1],0]}}})}}]),E}(gt);function kt(h){var T=De();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function De(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var It=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"

void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(project_pos);
  setPickingColor(a_PickingColor);
}
`,fr=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,tn=function(h){D()(E,h);var T=kt(E);function E(){return X()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=_.coverage,ae=_.angle;return{u_opacity:M||1,u_coverage:j||1,u_angle:ae||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:It,fragmentShader:fr,triangulation:vi,depth:{enable:!0},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(M,j,ae,ve){var je=M.size;return Array.isArray(je)?[je[0]]:[je]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(M,j,ae,ve,je){return je}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:S.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(M,j){var ae=M.coordinates;return[ae[0],ae[1],0]}}})}}]),E}(gt);function En(h,T){for(var E=[],b=[],_=[],M=h+1,j=T+1,ae=h/2,ve=T/2,je=0;je<j;je++)for(var Rt=je-ve,Jt=0;Jt<M;Jt++){var wr=Jt-ae;b.push(wr/ae,-Rt/ve,0),_.push(Jt/h),_.push(1-je/T)}for(var Dr=0;Dr<T;Dr++)for(var xn=0;xn<h;xn++){var mn=xn+M*Dr,Bn=xn+M*(Dr+1),Ei=xn+1+M*(Dr+1),Ai=xn+1+M*Dr;E.push(mn,Bn,Ai),E.push(Bn,Ei,Ai)}return{vertices:b,indices:E,uvs:_}}function Un(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);T&&(b=b.filter(function(_){return Object.getOwnPropertyDescriptor(h,_).enumerable})),E.push.apply(E,b)}return E}function La(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?Un(Object(E),!0).forEach(function(b){Oe()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):Un(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}function no(h){var T=go();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function go(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var No=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,Vu=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;

vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos =(a_Uv * vec2(2.0) - vec2(1.0));


  vec4 p1 = vec4(pos, 0.0, 1.0);
	vec4 p2 = vec4(pos, 1.0, 1.0);

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1;
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w;
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z);
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0, 1, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);

}
`,Wl=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,$s=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,Ic=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 3.0;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
}
`,Il=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
varying float v_intensity;
void main() {
  v_texCoord = a_Uv;
  v_intensity = texture2D(u_texture, v_texCoord).r;
  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,fs=function(h){D()(E,h);var T=no(E);function E(){var b;X()(this,E);for(var _=arguments.length,M=new Array(_),j=0;j<_;j++)M[j]=arguments[j];return b=T.call.apply(T,[this].concat(M)),b.texture=void 0,b.colorTexture=void 0,b.heatmapFramerBuffer=void 0,b.intensityModel=void 0,b.colorModel=void 0,b.shapeType=void 0,b}return a()(E,[{key:"render",value:function(){var _=this,M=this.rendererService,j=M.clear,ae=M.useFramebuffer;ae(this.heatmapFramerBuffer,function(){j({color:[0,0,0,0],depth:1,stencil:0,framebuffer:_.heatmapFramerBuffer}),_.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var _,M=this.rendererService,j=M.createFramebuffer,ae=M.clear,ve=M.getViewportSize,je=M.createTexture2D,Rt=M.useFramebuffer,Jt=this.styleAttributeService.getLayerStyleAttribute("shape"),wr=(Jt==null||(_=Jt.scale)===null||_===void 0?void 0:_.field)||"heatmap";this.shapeType=wr,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=wr==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var Dr=this.layer.getLayerConfig(),xn=Dr.rampColors,mn=Object(Me.n)(xn),Bn=ve(),Ei=Bn.width,Ai=Bn.height;return this.heatmapFramerBuffer=j({color:je({width:Math.floor(Ei/4),height:Math.floor(Ai/4),wrapS:S.gl.CLAMP_TO_EDGE,wrapT:S.gl.CLAMP_TO_EDGE,min:S.gl.LINEAR,mag:S.gl.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:S.AttributeType.Attribute,descriptor:{name:"a_Dir",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(M,j,ae,ve){return[ae[3],ae[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(M,j,ae,ve){var je=M.size,Rt=je===void 0?1:je;return[Rt]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:Ic,fragmentShader:$s,triangulation:ci,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:S.gl.ONE,srcAlpha:1,dstRGB:S.gl.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){this.shaderModuleService.registerModule("heatmapColor",{vs:Il,fs:Wl});var _=this.shaderModuleService.getModule("heatmapColor"),M=_.vs,j=_.fs,ae=_.uniforms,ve=this.rendererService,je=ve.createAttribute,Rt=ve.createElements,Jt=ve.createBuffer,wr=ve.createModel;return wr({vs:M,fs:j,attributes:{a_Position:je({buffer:Jt({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:S.gl.FLOAT}),size:3}),a_Uv:je({buffer:Jt({data:[0,1,1,1,0,0,1,0],type:S.gl.FLOAT}),size:2})},uniforms:La({},ae),depth:{enable:!1},blend:this.getBlend(),count:6,elements:Rt({data:[0,2,1,2,3,1],type:S.gl.UNSIGNED_INT,count:6})})}},{key:"drawIntensityMode",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=_.intensity,ae=j===void 0?10:j,ve=_.radius,je=ve===void 0?5:ve;this.intensityModel.draw({uniforms:{u_opacity:M||1,u_radius:je,u_intensity:ae}})}},{key:"drawColorMode",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity;this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=cr.b.invert(cr.b.create(),cr.b.fromValues.apply(cr.b,Vt()(this.cameraService.getViewProjectionMatrixUncentered())));this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:Vt()(j)}})}},{key:"build3dHeatMap",value:function(){var _=this.rendererService.getViewportSize,M=_(),j=M.width,ae=M.height,ve=En(j/4,ae/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:Vu,fs:No});var je=this.shaderModuleService.getModule("heatmap3dColor"),Rt=je.vs,Jt=je.fs,wr=je.uniforms,Dr=this.rendererService,xn=Dr.createAttribute,mn=Dr.createElements,Bn=Dr.createBuffer,Ei=Dr.createModel;return Ei({vs:Rt,fs:Jt,attributes:{a_Position:xn({buffer:Bn({data:ve.vertices,type:S.gl.FLOAT}),size:3}),a_Uv:xn({buffer:Bn({data:ve.uvs,type:S.gl.FLOAT}),size:2})},primitive:S.gl.TRIANGLES,uniforms:La({},wr),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:S.gl.SRC_ALPHA,srcAlpha:1,dstRGB:S.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:mn({data:ve.indices,type:S.gl.UNSIGNED_INT,count:ve.indices.length})})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var _=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var M=this.layer.getLayerConfig(),j=M.rampColors,ae=Object(Me.n)(j);this.colorTexture=_({data:new Uint8Array(ae.data),width:ae.width,height:ae.height,wrapS:S.gl.CLAMP_TO_EDGE,wrapT:S.gl.CLAMP_TO_EDGE,min:S.gl.NEAREST,mag:S.gl.NEAREST,flipY:!1})}}]),E}(gt);function zs(h){var T=uo();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function uo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var hs=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Js=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  setPickingColor(a_PickingColor);
}
`,lu=function(h){D()(E,h);var T=zs(E);function E(){return X()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=_.coverage,ae=_.angle;return{u_opacity:M||1,u_coverage:j||.9,u_angle:ae||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:Js,fragmentShader:hs,triangulation:ga,depth:{enable:!1},primitive:S.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:S.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(M,j){var ae=M.coordinates;return[ae[0],ae[1],0]}}})}}]),E}(gt),Xl={heatmap:fs,heatmap3d:fs,grid:_o,grid3d:tn,hexagon:lu},ya=Xl;function Na(h){var T=ml();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function ml(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ns=function(h){D()(E,h);var T=Na(E);function E(){var b;X()(this,E);for(var _=arguments.length,M=new Array(_),j=0;j<_;j++)M[j]=arguments[j];return b=T.call.apply(T,[this].concat(M)),b.type="HeatMapLayer",b}return a()(E,[{key:"buildModels",value:function(){var _=this.getModelType();this.layerModel=new ya[_](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var _=this,M=this.getModelType();return M==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(j){return j.draw({uniforms:_.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var _,M=this.styleAttributeService.getLayerStyleAttribute("shape"),j=this.getLayerConfig(),ae=j.shape3d,ve=this.getSource(),je=ve.data.type,Rt=(M==null||(_=M.scale)===null||_===void 0?void 0:_.field)||"heatmap";return Rt==="heatmap"||Rt==="heatmap3d"?"heatmap":je==="hexagon"?(ae==null?void 0:ae.indexOf(Rt))===-1?"hexagon":"grid3d":je==="grid"?(ae==null?void 0:ae.indexOf(Rt))===-1?"grid":"grid3d":"heatmap"}}]),E}(ie);function ds(h){var T=Mt();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function Mt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var rr=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,Pr=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Vn=function(h){D()(E,h);var T=ds(E);function E(){var b;X()(this,E);for(var _=arguments.length,M=new Array(_),j=0;j<_;j++)M[j]=arguments[j];return b=T.call.apply(T,[this].concat(M)),b.texture=void 0,b}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity;return{u_opacity:M||1,u_texture:this.texture}}},{key:"initModels",value:function(){var _=this,M=this.layer.getSource(),j=this.rendererService.createTexture2D;return this.texture=j({height:0,width:0}),M.data.images.then(function(ae){_.texture=j({data:ae[0],width:ae[0].width,height:ae[0].height}),_.layerService.renderLayers()}),[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:Pr,fragmentShader:rr,triangulation:Pi,primitive:S.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(M,j,ae,ve){return[ae[3],ae[4]]}}})}}]),E}(gt),Ji={image:Vn},Ra=Ji;function Ha(h){var T=Qi();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function Qi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var xa=function(h){D()(E,h);var T=Ha(E);function E(){var b;X()(this,E);for(var _=arguments.length,M=new Array(_),j=0;j<_;j++)M[j]=arguments[j];return b=T.call.apply(T,[this].concat(M)),b.type="ImageLayer",b}return a()(E,[{key:"buildModels",value:function(){var _=this.getModelType();this.layerModel=new Ra[_](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var _=this.getModelType(),M={image:{}};return M[_]}},{key:"getModelType",value:function(){return"image"}}]),E}(ie);function Co(h){var T=Fs();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function Fs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ha=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Yl=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;
#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = a_Instance.rg;
  vec2 target =  a_Instance.ba;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  if(u_line_type == LineTypeDash) {
      v_distance_ratio = segmentIndex / segmentNumber;
      float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
    }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}
`,cu={solid:0,dash:1},ws=function(h){D()(E,h);var T=Co(E);function E(){return X()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=_.lineType,ae=j===void 0?"solid":j,ve=_.dashArray,je=ve===void 0?[10,5]:ve;return je.length===2&&je.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:cu[ae||"solid"],u_dash_array:je,u_blur:.9}}},{key:"getAnimateUniforms",value:function(){var _=this.layer.getLayerConfig(),M=_.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Yl,fragmentShader:ha,triangulation:gi,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(M,j,ae,ve){var je=M.size,Rt=je===void 0?1:je;return Array.isArray(Rt)?[Rt[0]]:[Rt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:S.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:4,update:function(M,j,ae,ve){return[ae[3],ae[4],ae[5],ae[6]]}}})}}]),E}(gt);function gl(h){var T=fu();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function fu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Gu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;
varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

   if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  setPickingColor(a_PickingColor);
}
`,Qs=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,rl={solid:0,dash:1},hu=function(h){D()(E,h);var T=gl(E);function E(){return X()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=_.lineType,ae=j===void 0?"solid":j,ve=_.dashArray,je=ve===void 0?[10,5]:ve;return je.length===2&&je.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:rl[ae]||0,u_dash_array:je}}},{key:"getAnimateUniforms",value:function(){var _=this.layer.getLayerConfig(),M=_.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:Gu,fragmentShader:Qs,triangulation:gi,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(M,j,ae,ve){var je=M.size,Rt=je===void 0?1:je;return Array.isArray(Rt)?[Rt[0]]:[Rt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:S.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:4,update:function(M,j,ae,ve){return[ae[3],ae[4],ae[5],ae[6]]}}})}}]),E}(gt);function pc(h){var T=Pf();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function Pf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var da=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Oc=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}
vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
}

void main() {
  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  setPickingColor(a_PickingColor);
}

`,vc={solid:0,dash:1},qc=function(h){D()(E,h);var T=pc(E);function E(){return X()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=_.lineType,ae=j===void 0?"solid":j,ve=_.dashArray,je=ve===void 0?[10,5]:ve;return je.length===2&&je.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:vc[ae]||0,u_dash_array:je}}},{key:"getAnimateUniforms",value:function(){var _=this.layer.getLayerConfig(),M=_.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Oc,fragmentShader:da,triangulation:gi,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(M,j,ae,ve){var je=M.size,Rt=je===void 0?1:je;return Array.isArray(Rt)?[Rt[0]]:[Rt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:S.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:4,update:function(M,j,ae,ve){return[ae[3],ae[4],ae[5],ae[6]]}}})}}]),E}(gt);function ef(h){var T=tf();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function tf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Qa=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;
varying vec4 v_color;
varying vec2 v_normal;


// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;
varying float v_distance_ratio;
varying vec4 v_dash_array;
varying float v_side;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
// [animate, duration, interval, trailLength],
void main() {
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
 // dash line
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
    // gl_FragColor.a *=(1.0- step(v_dash_array.x, mod(v_distance_ratio, dashLength)));
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Au=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5.\uFF0C0, 0];
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying vec2 v_normal;
varying float v_distance_ratio;
varying float v_side;


void main() {

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = a_Distance / a_Total_Distance;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = a_Distance / a_Total_Distance;
  }
  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));
  v_color = a_Color;
  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_side = a_Miter * a_Size.x;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  setPickingColor(a_PickingColor);
}
`,qs={solid:0,dash:1},ps=function(h){D()(E,h);var T=ef(E);function E(){return X()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=_.lineType,ae=j===void 0?"solid":j,ve=_.dashArray,je=ve===void 0?[10,5,0,0]:ve;return je.length===2&&je.push(0,0),{u_opacity:M||1,u_line_type:qs[ae],u_dash_array:je}}},{key:"getAnimateUniforms",value:function(){var _=this.layer.getLayerConfig(),M=_.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:Au,fragmentShader:Qa,triangulation:Di,primitive:S.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var _=this.layer.getLayerConfig(),M=_.lineType,j=M===void 0?"solid":M;this.styleAttributeService.registerStyleAttribute({name:"distance",type:S.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(ve,je,Rt,Jt){return[Rt[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:S.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(ve,je,Rt,Jt){return[Rt[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(ve,je,Rt,Jt){var wr=ve.size,Dr=wr===void 0?1:wr;return Array.isArray(Dr)?[Dr[0],Dr[1]]:[Dr,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(ve,je,Rt,Jt,wr){return wr}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:S.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(ve,je,Rt,Jt){return[Rt[4]]}}})}}]),E}(gt),Lc={arc:ws,arc3d:hu,greatcircle:qc,line:ps},mc=Lc;function yl(h){var T=nl();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function nl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var gc=function(h){D()(E,h);var T=yl(E);function E(){var b;X()(this,E);for(var _=arguments.length,M=new Array(_),j=0;j<_;j++)M[j]=arguments[j];return b=T.call.apply(T,[this].concat(M)),b.type="LineLayer",b}return a()(E,[{key:"buildModels",value:function(){var _=this.getModelType();this.layerModel=new mc[_](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var _=this.getModelType(),M={line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"}};return M[_]}},{key:"getModelType",value:function(){var _,M=this.styleAttributeService.getLayerStyleAttribute("shape"),j=M==null||(_=M.scale)===null||_===void 0?void 0:_.field;return j||"line"}}]),E}(ie);function eu(h){var T=Hu();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function Hu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Rc=`varying vec4 v_color;
uniform float u_opacity: 1.0;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Kl=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform mat4 u_ModelMatrix;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec3 size = a_Size * a_Position;

  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);

  float lightWeight = calc_lighting(pos);
  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(pos);
  setPickingColor(a_PickingColor);
}
`,wa=function(h){D()(E,h);var T=eu(E);function E(){return X()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=_.offsets;return{u_opacity:M||1,u_offsets:j||[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:Kl,fragmentShader:Rc,triangulation:vi,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(M,j,ae,ve){var je=M.size;if(je){var Rt=[];return Array.isArray(je)&&(Rt=je.length===2?[je[0],je[0],je[1]]:je),Array.isArray(je)||(Rt=[je]),Rt}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(M,j,ae,ve,je){return je}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:S.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(M,j){var ae=He(M.coordinates);return[ae[0],ae[1],0]}}})}}]),E}(gt);function Dc(h){var T=Mf();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function Mf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var yc=`#define Animate 0.0

uniform float u_blur : 0;
uniform float u_opacity : 1;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  lowp float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);
  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  // gl_FragColor = v_color * color_t;
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;
  if(u_aimate.x == Animate) {
    float d = length(v_data.xy);
    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);
    gl_FragColor = vec4(gl_FragColor.xyz, intensity);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,zc=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec2 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;

uniform float u_stroke_width : 2;
uniform vec2 u_offsets;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "projection"
#pragma include "picking"

void main() {
  // unpack color(vec2)
  v_color = a_Color;
  vec2 extrude = a_Extrude;

  float shape_type = a_Shape;

  float newSize = setPickingSize(a_Size);

  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = project_pixel(extrude * (newSize + u_stroke_width) + u_offsets);
  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  // TODO: billboard
  // anti-alias
  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);

  // construct point coords
  v_data = vec4(extrude, antialiasblur,shape_type);

  setPickingColor(a_PickingColor);
}
`,$l=function(h){D()(E,h);var T=Dc(E);function E(){return X()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=M===void 0?1:M,ae=_.stroke,ve=ae===void 0?"rgb(0,0,0,0)":ae,je=_.strokeWidth,Rt=je===void 0?1:je,Jt=_.strokeOpacity,wr=Jt===void 0?1:Jt,Dr=_.offsets,xn=Dr===void 0?[0,0]:Dr;return{u_opacity:j,u_stroke_width:Rt,u_stroke_color:Object(Me.s)(ve),u_stroke_opacity:wr,u_offsets:[-xn[0],xn[1]]}}},{key:"getAnimateUniforms",value:function(){var _=this.layer.getLayerConfig(),M=_.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Xi)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:zc,fragmentShader:yc,triangulation:Xi,depth:{enable:!1},blend:this.getBlend()})]}},{key:"animateOption2Array",value:function(_){return[_.enable?0:1,_.speed||1,_.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var _=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:S.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(j,ae,ve,je){var Rt=[1,1,-1,1,-1,-1,1,-1],Jt=je%4*2;return[Rt[Jt],Rt[Jt+1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(j,ae,ve,je){var Rt=j.size,Jt=Rt===void 0?5:Rt;return Array.isArray(Jt)?[Jt[0]]:[Jt]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:S.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(j,ae,ve,je){var Rt=j.shape,Jt=Rt===void 0?2:Rt,wr=_.layer.getLayerConfig().shape2d,Dr=wr.indexOf(Jt);return[Dr]}}})}}]),E}(gt);function Zu(h){var T=_u();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function _u(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ol=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec4 textureColor=texture2D(u_texture,pos);
if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
      gl_FragColor= textureColor;
}else {
      gl_FragColor= step(0.01, textureColor.z) * v_color;
}
gl_FragColor.a =gl_FragColor.a * u_opacity;
gl_FragColor = filterColor(gl_FragColor);
}
`,Fo=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Jl=function(h){D()(E,h);var T=Zu(E);function E(){var b;X()(this,E);for(var _=arguments.length,M=new Array(_),j=0;j<_;j++)M[j]=arguments[j];return b=T.call.apply(T,[this].concat(M)),b.texture=void 0,b}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity;return{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var _=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){_.updateTexture(),_.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:Fo,fragmentShader:Ol,triangulation:wi,primitive:S.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var _=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(j,ae,ve,je){var Rt=j.size;return Array.isArray(Rt)?[Rt[0]]:[Rt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(j,ae,ve,je){var Rt=_.fontService.mapping,Jt=j.shape,wr=_.fontService.getGlyph(Jt),Dr=Rt[wr],xn=Dr.x,mn=Dr.y;return[xn,mn]}}})}},{key:"updateTexture",value:function(){var _=this.rendererService.createTexture2D,M=this.fontService.canvas;this.texture=_({data:M,mag:S.gl.LINEAR,min:S.gl.LINEAR,width:M.width,height:M.height})}},{key:"initIconFontGlyphs",value:function(){var _=this,M=this.layer.getLayerConfig(),j=M.fontWeight,ae=j===void 0?"normal":j,ve=M.fontFamily,je=ve===void 0?"sans-serif":ve,Rt=this.layer.getEncodedData(),Jt=[];Rt.forEach(function(wr){var Dr=wr.shape,xn=Dr===void 0?"":Dr;xn=xn.toString();var mn=_.fontService.getGlyph(xn);Jt.indexOf(mn)===-1&&Jt.push(mn)}),this.fontService.setFontOptions({characterSet:Jt,fontWeight:ae,fontFamily:je,fontSize:48})}}]),E}(gt);function Ll(h){var T=xl();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function xl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Nc=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec4 textureColor=texture2D(u_texture,pos);
if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
      gl_FragColor= textureColor;
}else {
      gl_FragColor= step(0.01, textureColor.z) * v_color;
}
gl_FragColor.a =gl_FragColor.a * u_opacity;
gl_FragColor = filterColor(gl_FragColor);
}
`,Rl=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,tu=function(h){D()(E,h);var T=Ll(E);function E(){var b;X()(this,E);for(var _=arguments.length,M=new Array(_),j=0;j<_;j++)M[j]=arguments[j];return b=T.call.apply(T,[this].concat(M)),b.texture=void 0,b.updateTexture=function(){var ae=b.rendererService.createTexture2D;if(b.texture){b.texture.update({data:b.iconService.getCanvas()}),b.layer.render();return}b.texture=ae({data:b.iconService.getCanvas(),mag:S.gl.NEAREST,min:S.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:b.iconService.canvasHeight||128})},b}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=_.offsets,ae=j===void 0?[0,0]:j;return this.rendererService.getDirty()&&this.texture.bind(),{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_offsets:[-ae[0],ae[1]]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.texture&&this.texture.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:Rl,fragmentShader:Nc,triangulation:wi,primitive:S.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var _=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(j,ae,ve,je){var Rt=j.size,Jt=Rt===void 0?5:Rt;return Array.isArray(Jt)?[Jt[0]]:[Jt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(j,ae,ve,je){var Rt=_.iconService.getIconMap(),Jt=j.shape,wr=Rt[Jt]||{x:0,y:0},Dr=wr.x,xn=wr.y;return[Dr,xn]}}})}}]),E}(gt);function mf(h){var T=gf();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function gf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var rf=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "picking"
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a =gl_FragColor.a * u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,bl=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform vec2 u_offsets;

#pragma include "projection"
#pragma include "picking"
void main() {
  v_color = a_Color;
  vec2 offset = project_pixel(u_offsets);
  vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
    setPickingColor(a_PickingColor);
}
`;function Fa(h){var T=h.coordinates;return{vertices:Vt()(T),indices:[0],size:T.length}}var il=function(h){D()(E,h);var T=mf(E);function E(){return X()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=M===void 0?1:M,ae=_.stroke,ve=ae===void 0?"rgb(0,0,0,0)":ae,je=_.strokeWidth,Rt=je===void 0?1:je,Jt=_.offsets,wr=Jt===void 0?[0,0]:Jt;return{u_opacity:j,u_stroke_width:Rt,u_stroke_color:Object(Me.s)(ve),u_offsets:[-wr[0],wr[1]]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:bl,fragmentShader:rf,triangulation:Fa,depth:{enable:!1},primitive:S.gl.POINTS,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(M,j,ae,ve){var je=M.size,Rt=je===void 0?1:je;return Array.isArray(Rt)?[Rt[0]]:[Rt]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:S.BlendType.additive}}}]),E}(gt);function Dl(h,T){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=xc(h))||T&&h&&typeof h.length=="number"){E&&(h=E);var b=0,_=function(){};return{s:_,n:function(){return b>=h.length?{done:!0}:{done:!1,value:h[b++]}},e:function(je){throw je},f:_}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,j=!1,ae;return{s:function(){E=h[Symbol.iterator]()},n:function(){var je=E.next();return M=je.done,je},e:function(je){j=!0,ae=je},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(j)throw ae}}}}function xc(h,T){if(!!h){if(typeof h=="string")return Fc(h,T);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return Fc(h,T)}}function Fc(h,T){(T==null||T>h.length)&&(T=h.length);for(var E=0,b=new Array(T);E<T;E++)b[E]=h[E];return b}var zl=function(){function h(T,E,b){X()(this,h),this.boxCells=[],this.xCellCount=void 0,this.yCellCount=void 0,this.boxKeys=void 0,this.bboxes=void 0,this.width=void 0,this.height=void 0,this.xScale=void 0,this.yScale=void 0,this.boxUid=void 0;var _=this.boxCells;this.xCellCount=Math.ceil(T/b),this.yCellCount=Math.ceil(E/b);for(var M=0;M<this.xCellCount*this.yCellCount;M++)_.push([]);this.boxKeys=[],this.bboxes=[],this.width=T,this.height=E,this.xScale=this.xCellCount/T,this.yScale=this.yCellCount/E,this.boxUid=0}return a()(h,[{key:"insert",value:function(E,b,_,M,j){this.forEachCell(b,_,M,j,this.insertBoxCell,this.boxUid++),this.boxKeys.push(E),this.bboxes.push(b),this.bboxes.push(_),this.bboxes.push(M),this.bboxes.push(j)}},{key:"query",value:function(E,b,_,M,j){return this.queryHitTest(E,b,_,M,!1,j)}},{key:"hitTest",value:function(E,b,_,M,j){return this.queryHitTest(E,b,_,M,!0,j)}},{key:"insertBoxCell",value:function(E,b,_,M,j,ae){this.boxCells[j].push(ae)}},{key:"queryHitTest",value:function(E,b,_,M,j,ae){if(_<0||E>this.width||M<0||b>this.height)return j?!1:[];var ve=[];if(E<=0&&b<=0&&this.width<=_&&this.height<=M){if(j)return!0;for(var je=0;je<this.boxKeys.length;je++)ve.push({key:this.boxKeys[je],x1:this.bboxes[je*4],y1:this.bboxes[je*4+1],x2:this.bboxes[je*4+2],y2:this.bboxes[je*4+3]});return ae?ve.filter(ae):ve}var Rt={hitTest:j,seenUids:{box:{},circle:{}}};return this.forEachCell(E,b,_,M,this.queryCell,ve,Rt,ae),j?ve.length>0:ve}},{key:"queryCell",value:function(E,b,_,M,j,ae,ve,je){var Rt=ve.seenUids,Jt=this.boxCells[j];if(Jt!==null){var wr=this.bboxes,Dr=Dl(Jt),xn;try{for(Dr.s();!(xn=Dr.n()).done;){var mn=xn.value;if(!Rt.box[mn]){Rt.box[mn]=!0;var Bn=mn*4;if(E<=wr[Bn+2]&&b<=wr[Bn+3]&&_>=wr[Bn+0]&&M>=wr[Bn+1]&&(!je||je(this.boxKeys[mn]))){if(ve.hitTest)return ae.push(!0),!0;ae.push({key:this.boxKeys[mn],x1:wr[Bn],y1:wr[Bn+1],x2:wr[Bn+2],y2:wr[Bn+3]})}}}}catch(Ei){Dr.e(Ei)}finally{Dr.f()}}return!1}},{key:"forEachCell",value:function(E,b,_,M,j,ae,ve,je){for(var Rt=this.convertToXCellCoord(E),Jt=this.convertToYCellCoord(b),wr=this.convertToXCellCoord(_),Dr=this.convertToYCellCoord(M),xn=Rt;xn<=wr;xn++)for(var mn=Jt;mn<=Dr;mn++){var Bn=this.xCellCount*mn+xn;if(j.call(this,E,b,_,M,Bn,ae,ve,je))return}}},{key:"convertToXCellCoord",value:function(E){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(E*this.xScale)))}},{key:"convertToYCellCoord",value:function(E){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(E*this.yScale)))}}]),h}(),If=zl,Of=function(){function h(T,E){X()(this,h),this.width=void 0,this.height=void 0,this.grid=void 0,this.viewportPadding=100,this.screenRightBoundary=void 0,this.screenBottomBoundary=void 0,this.gridRightBoundary=void 0,this.gridBottomBoundary=void 0,this.width=T,this.height=E,this.viewportPadding=Math.max(T,E),this.grid=new If(T+this.viewportPadding,E+this.viewportPadding,25),this.screenRightBoundary=T+this.viewportPadding,this.screenBottomBoundary=E+this.viewportPadding,this.gridRightBoundary=T+2*this.viewportPadding,this.gridBottomBoundary=E+2*this.viewportPadding}return a()(h,[{key:"placeCollisionBox",value:function(E){var b=E.x1+E.anchorPointX+this.viewportPadding,_=E.y1+E.anchorPointY+this.viewportPadding,M=E.x2+E.anchorPointX+this.viewportPadding,j=E.y2+E.anchorPointY+this.viewportPadding;return!this.isInsideGrid(b,_,M,j)||this.grid.hitTest(b,_,M,j)?{box:[]}:{box:[b,_,M,j]}}},{key:"insertCollisionBox",value:function(E,b){var _={featureIndex:b};this.grid.insert(_,E[0],E[1],E[2],E[3])}},{key:"project",value:function(E,b,_){var M=cr.e.fromValues(b,_,0,1),j=cr.e.create(),ae=cr.b.fromValues.apply(cr.b,Vt()(E));return cr.e.transformMat4(j,M,ae),{x:(j[0]/j[3]+1)/2*this.width+this.viewportPadding,y:(-j[1]/j[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(E,b,_,M){return _>=0&&E<this.gridRightBoundary&&M>=0&&b<this.gridBottomBoundary}}]),h}();function nf(h,T){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=Sl(h))||T&&h&&typeof h.length=="number"){E&&(h=E);var b=0,_=function(){};return{s:_,n:function(){return b>=h.length?{done:!0}:{done:!1,value:h[b++]}},e:function(je){throw je},f:_}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,j=!1,ae;return{s:function(){E=h[Symbol.iterator]()},n:function(){var je=E.next();return M=je.done,je},e:function(je){j=!0,ae=je},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(j)throw ae}}}}function Sl(h,T){if(!!h){if(typeof h=="string")return Ql(h,T);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return Ql(h,T)}}function Ql(h,T){(T==null||T>h.length)&&(T=h.length);for(var E=0,b=new Array(T);E<T;E++)b[E]=h[E];return b}function Cu(h){var T=.5,E=.5;switch(h){case"right":case"top-right":case"bottom-right":T=1;break;case"left":case"top-left":case"bottom-left":T=0;break;default:T=.5}switch(h){case"bottom":case"bottom-right":case"bottom-left":E=1;break;case"top":case"top-right":case"top-left":E=0;break;default:E=.5}return{horizontalAlign:T,verticalAlign:E}}function Bs(h,T,E,b,_){if(!!_){var M=h[b],j=M.glyph;if(j)for(var ae=T[j].advance*M.scale,ve=(h[b].x+ae)*_,je=E;je<=b;je++)h[je].x-=ve}}function al(h,T,E,b,_,M,j){var ae=(T-E)*_,ve=(-b*j+.5)*M,je=nf(h),Rt;try{for(je.s();!(Rt=je.n()).done;){var Jt=Rt.value;Jt.x+=ae,Jt.y+=ve}}catch(wr){je.e(wr)}finally{je.f()}}function Bc(h,T,E,b,_,M,j){var ae=-8,ve=0,je=ae,Rt=0,Jt=h.positionedGlyphs,wr=M==="right"?1:M==="left"?0:.5,Dr=Jt.length;E.forEach(function(Ai){if(Ai.split("").forEach(function(oa){var sa=T[oa],to=0;sa&&(Jt.push({glyph:oa,x:ve,y:je+to,vertical:!1,scale:1,metrics:sa}),ve+=sa.advance+j)}),Jt.length!==Dr){var za=ve-j;Rt=Math.max(za,Rt),Bs(Jt,T,Dr,Jt.length-1,wr)}ve=0,je+=b});var xn=Cu(_),mn=xn.horizontalAlign,Bn=xn.verticalAlign;al(Jt,wr,mn,Bn,Rt,b,E.length);var Ei=je-ae;h.top+=-Bn*Ei,h.bottom=h.top+Ei,h.left+=-mn*Rt,h.right=h.left+Rt}function Wu(h,T,E,b,_,M){var j=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],ae=h.split(`
`),ve=[],je={positionedGlyphs:ve,top:j[1],bottom:j[1],left:j[0],right:j[0],lineCount:ae.length,text:h};return Bc(je,T,ae,E,b,_,M),ve.length?je:!1}function Ba(h){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],E=arguments.length>2?arguments[2]:void 0,b=h.positionedGlyphs,_=b===void 0?[]:b,M=[],j=nf(_),ae;try{for(j.s();!(ae=j.n()).done;){var ve=ae.value,je=ve.metrics,Rt=4,Jt=je.advance*ve.scale/2,wr=E?[ve.x+Jt,ve.y]:[0,0],Dr=E?[0,0]:[ve.x+Jt+T[0],ve.y+T[1]],xn=(0-Rt)*ve.scale-Jt+Dr[0],mn=(0-Rt)*ve.scale+Dr[1],Bn=xn+je.width*ve.scale,Ei=mn+je.height*ve.scale,Ai={x:xn,y:mn},za={x:Bn,y:mn},oa={x:xn,y:Ei},sa={x:Bn,y:Ei};M.push({tl:Ai,tr:za,bl:oa,br:sa,tex:je,glyphOffset:wr})}}catch(to){j.e(to)}finally{j.f()}return M}function du(h,T){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=ol(h))||T&&h&&typeof h.length=="number"){E&&(h=E);var b=0,_=function(){};return{s:_,n:function(){return b>=h.length?{done:!0}:{done:!1,value:h[b++]}},e:function(je){throw je},f:_}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,j=!1,ae;return{s:function(){E=h[Symbol.iterator]()},n:function(){var je=E.next();return M=je.done,je},e:function(je){j=!0,ae=je},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(j)throw ae}}}}function ol(h,T){if(!!h){if(typeof h=="string")return sl(h,T);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return sl(h,T)}}function sl(h,T){(T==null||T>h.length)&&(T=h.length);for(var E=0,b=new Array(T);E<T;E++)b[E]=h[E];return b}function zi(h){var T=pa();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function pa(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ps=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform float u_stroke_opacity: 1.0;
uniform vec4 u_stroke : [0, 0, 0, 1];
uniform float u_strokeWidth : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  lowp float buff = (6.0 - u_strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke.rgb, u_stroke.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Sa=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
   v_fontScale = fontScale;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
 highp float angle_sin = sin(a_Rotate);
 highp float angle_cos = cos(a_Rotate);
 mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  gl_Position = vec4(projected_position.xy / projected_position.w
    + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function Gi(h){var T=this,E=h.id,b=[],_=[];if(!T.glyphInfoMap||!T.glyphInfoMap[E])return{vertices:[],indices:[],size:7};var M=T.glyphInfoMap[E].centroid,j=M.length===2?[M[0],M[1],0]:M;return T.glyphInfoMap[E].glyphQuads.forEach(function(ae,ve){b.push.apply(b,Vt()(j).concat([ae.tex.x,ae.tex.y+ae.tex.height,ae.tl.x,ae.tl.y],Vt()(j),[ae.tex.x+ae.tex.width,ae.tex.y+ae.tex.height,ae.tr.x,ae.tr.y],Vt()(j),[ae.tex.x+ae.tex.width,ae.tex.y,ae.br.x,ae.br.y],Vt()(j),[ae.tex.x,ae.tex.y,ae.bl.x,ae.bl.y])),_.push(0+ve*4,1+ve*4,2+ve*4,2+ve*4,3+ve*4,0+ve*4)}),{vertices:b,indices:_,size:7}}var ql=function(h){D()(E,h);var T=zi(E);function E(){var b;X()(this,E);for(var _=arguments.length,M=new Array(_),j=0;j<_;j++)M[j]=arguments[j];return b=T.call.apply(T,[this].concat(M)),b.glyphInfo=void 0,b.glyphInfoMap={},b.texture=void 0,b.currentZoom=-1,b.extent=void 0,b.textureHeight=0,b.textCount=0,b.preTextStyle={},b.buildModels=function(){return b.initGlyph(),b.updateTexture(),b.filterGlyphs(),[b.layer.buildLayerModel({moduleName:"pointText",vertexShader:Sa,fragmentShader:Ps,triangulation:Gi.bind(it()(b)),depth:{enable:!1},blend:b.getBlend()})]},b}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=M===void 0?1:M,ae=_.stroke,ve=ae===void 0?"#fff":ae,je=_.strokeWidth,Rt=je===void 0?0:je,Jt=_.strokeOpacity,wr=Jt===void 0?1:Jt,Dr=_.textAnchor,xn=Dr===void 0?"center":Dr,mn=_.textAllowOverlap,Bn=mn===void 0?!1:mn,Ei=_.halo,Ai=Ei===void 0?.5:Ei,za=_.gamma,oa=za===void 0?2:za,sa=this.fontService,to=sa.canvas,_i=sa.mapping;return Object.keys(_i).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(_i).length),this.preTextStyle={textAnchor:xn,textAllowOverlap:Bn},{u_opacity:j,u_stroke_opacity:wr,u_sdf_map:this.texture,u_stroke:Object(Me.s)(ve),u_halo_blur:Ai,u_gamma_scale:oa,u_sdf_map_size:[to.width,to.height],u_strokeWidth:Rt}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var _=this.layer.getLayerConfig(),M=_.textAnchor,j=M===void 0?"center":M,ae=_.textAllowOverlap,ve=ae===void 0?!0:ae;return this.preTextStyle={textAnchor:j,textAllowOverlap:ve},this.buildModels()}},{key:"needUpdate",value:function(){var _=this.layer.getLayerConfig(),M=_.textAllowOverlap,j=M===void 0?!1:M,ae=this.mapService.getZoom(),ve=this.mapService.getBounds(),je=Object(Me.j)(this.extent,ve);return!j&&(Math.abs(this.currentZoom-ae)>1||!je)||j!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:S.AttributeType.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(M,j,ae,ve){var je=M.rotate,Rt=je===void 0?0:je;return Array.isArray(Rt)?[Rt[0]]:[Rt]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:S.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(M,j,ae,ve){return[ae[5],ae[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(M,j,ae,ve){var je=M.size,Rt=je===void 0?12:je;return Array.isArray(Rt)?[Rt[0]]:[Rt]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:S.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(M,j,ae,ve){return[ae[3],ae[4]]}}})}},{key:"textExtent",value:function(){var _=this.mapService.getBounds();return Object(Me.r)(_,.5)}},{key:"initTextFont",value:function(){var _=this.layer.getLayerConfig(),M=_.fontWeight,j=M===void 0?"400":M,ae=_.fontFamily,ve=ae===void 0?"sans-serif":ae,je=this.layer.getEncodedData(),Rt=[];je.forEach(function(Jt){var wr=Jt.shape,Dr=wr===void 0?"":wr;Dr=Dr.toString();var xn=du(Dr),mn;try{for(xn.s();!(mn=xn.n()).done;){var Bn=mn.value;Rt.indexOf(Bn)===-1&&Rt.push(Bn)}}catch(Ei){xn.e(Ei)}finally{xn.f()}}),this.fontService.setFontOptions({characterSet:Rt,fontWeight:j,fontFamily:ve})}},{key:"generateGlyphLayout",value:function(){var _=this,M=this.fontService.mapping,j=this.layer.getLayerConfig(),ae=j.spacing,ve=ae===void 0?2:ae,je=j.textAnchor,Rt=je===void 0?"center":je,Jt=j.textOffset,wr=this.layer.getEncodedData();this.glyphInfo=wr.map(function(Dr){var xn=Dr.shape,mn=xn===void 0?"":xn,Bn=Dr.coordinates,Ei=Dr.id,Ai=Dr.size,za=Ai===void 0?1:Ai,oa=Wu(mn.toString(),M,za,Rt,"center",ve,Jt),sa=Ba(oa,Jt,!1);return Dr.shaping=oa,Dr.glyphQuads=sa,Dr.centroid=He(Bn),_.glyphInfoMap[Ei]={shaping:oa,glyphQuads:sa,centroid:He(Bn)},Dr})}},{key:"filterGlyphs",value:function(){var _=this,M=this.layer.getLayerConfig(),j=M.padding,ae=j===void 0?[4,4]:j,ve=M.textAllowOverlap,je=ve===void 0?!1:ve;if(!je){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var Rt=this.rendererService.getViewportSize(),Jt=Rt.width,wr=Rt.height,Dr=new Of(Jt,wr),xn=this.glyphInfo.filter(function(mn){var Bn=mn.shaping,Ei=mn.id,Ai=Ei===void 0?0:Ei,za=mn.centroid,oa=mn.size,sa=oa/24,to=_.mapService.lngLatToContainer(za),_i=Dr.placeCollisionBox({x1:Bn.left*sa-ae[0],x2:Bn.right*sa+ae[0],y1:Bn.top*sa-ae[1],y2:Bn.bottom*sa+ae[1],anchorPointX:to.x,anchorPointY:to.y}),ro=_i.box;return ro&&ro.length?(Dr.insertCollisionBox(ro,Ai),!0):!1});xn.forEach(function(mn){_.glyphInfoMap[mn.id]=mn})}}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var _=this.rendererService.createTexture2D,M=this.fontService.canvas;this.textureHeight=M.height,this.texture&&this.texture.destroy(),this.texture=_({data:M,mag:S.gl.LINEAR,min:S.gl.LINEAR,width:M.width,height:M.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Sa,fragmentShader:Ps,triangulation:Gi.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),E}(gt),yf={fill:$l,image:tu,normal:il,extrude:wa,text:ql,icon:Jl},as=yf;function ul(h){var T=pu();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function pu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Xu=function(h){D()(E,h);var T=ul(E);function E(){var b;X()(this,E);for(var _=arguments.length,M=new Array(_),j=0;j<_;j++)M[j]=arguments[j];return b=T.call.apply(T,[this].concat(M)),b.type="PointLayer",b}return a()(E,[{key:"buildModels",value:function(){var _=this.getModelType();this.layerModel=new as[_](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var _=this.getModelType(),M={normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return M[_]}},{key:"getModelType",value:function(){var _=this.getEncodedData(),M=this.getLayerConfig(),j=M.shape2d,ae=M.shape3d,ve=this.iconService.getIconMap(),je=_.find(function(Jt){return Jt.hasOwnProperty("shape")});if(je){var Rt=je.shape;return Rt==="dot"?"normal":(j==null?void 0:j.indexOf(Rt))!==-1?"fill":(ae==null?void 0:ae.indexOf(Rt))!==-1?"extrude":ve.hasOwnProperty(Rt)?"image":this.fontService.getGlyph(Rt)!==""?"icon":"text"}else return"normal"}}]),E}(ie);function io(h){var T=os();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function os(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Nl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,lo=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,In=function(h){D()(E,h);var T=io(E);function E(){return X()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=M===void 0?1:M;return{u_opacity:j}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:lo,fragmentShader:Nl,triangulation:hi})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(M,j,ae,ve,je){return je}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(M,j,ae,ve){var je=M.size,Rt=je===void 0?10:je;return Array.isArray(Rt)?[Rt[0]]:[Rt]}}})}}]),E}(gt);function ks(h){var T=bc();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function bc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var El=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,wu=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,js=function(h){D()(E,h);var T=ks(E);function E(){return X()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=M===void 0?1:M;return{u_opacity:j}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:wu,fragmentShader:El,triangulation:Ka,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){}}]),E}(gt),qi={fill:js,line:ps,extrude:In,text:ql,point_fill:$l,point_image:tu,point_normal:il,point_extrude:wa},qr=qi;function kc(h){var T=Sc();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function Sc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ll=function(h){D()(E,h);var T=kc(E);function E(){var b;X()(this,E);for(var _=arguments.length,M=new Array(_),j=0;j<_;j++)M[j]=arguments[j];return b=T.call.apply(T,[this].concat(M)),b.type="PolygonLayer",b}return a()(E,[{key:"buildModels",value:function(){var _=this.getModelType();this.layerModel=new qr[_](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var _,M=this.styleAttributeService.getLayerStyleAttribute("shape"),j=M==null||(_=M.scale)===null||_===void 0?void 0:_.field;return j==="fill"?"fill":j==="extrude"?"extrude":j==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var _=this.getEncodedData(),M=this.getLayerConfig(),j=M.shape2d,ae=M.shape3d,ve=this.iconService.getIconMap(),je=_.find(function(Jt){return Jt.hasOwnProperty("shape")});if(je){var Rt=je.shape;return Rt==="dot"?"point_normal":(j==null?void 0:j.indexOf(Rt))!==-1?"point_fill":(ae==null?void 0:ae.indexOf(Rt))!==-1?"point_extrude":ve.hasOwnProperty(Rt)?"point_image":"text"}else return"fill"}}]),E}(ie);function vu(h){var T=Ms();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function Ms(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Is=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,$o=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Bo=function(h){D()(E,h);var T=vu(E);function E(){var b;X()(this,E);for(var _=arguments.length,M=new Array(_),j=0;j<_;j++)M[j]=arguments[j];return b=T.call.apply(T,[this].concat(M)),b.texture=void 0,b.colorTexture=void 0,b}return a()(E,[{key:"getUninforms",value:function(){var _=this.layer.getLayerConfig(),M=_.opacity,j=M===void 0?1:M,ae=_.clampLow,ve=ae===void 0?!0:ae,je=_.clampHigh,Rt=je===void 0?!0:je,Jt=_.noDataValue,wr=Jt===void 0?-9999999:Jt,Dr=_.domain,xn=Dr===void 0?[0,1]:Dr;return this.updateColorTexure(),{u_opacity:j||1,u_texture:this.texture,u_domain:xn,u_clampLow:ve,u_clampHigh:typeof Rt!="undefined"?Rt:ve,u_noDataValue:wr,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var _=this.layer.getSource(),M=this.rendererService.createTexture2D,j=_.data.dataArray[0];this.texture=M({data:j.data,width:j.width,height:j.height,format:S.gl.LUMINANCE,type:S.gl.FLOAT});var ae=this.layer.getLayerConfig(),ve=ae.rampColors,je=Object(Me.n)(ve);return this.colorTexture=M({data:je.data,width:je.width,height:je.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:$o,fragmentShader:Is,triangulation:Pi,primitive:S.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(M,j,ae,ve){return[ae[3],ae[4]]}}})}},{key:"updateColorTexure",value:function(){var _=this.rendererService.createTexture2D,M=this.layer.getLayerConfig(),j=M.rampColors,ae=Object(Me.n)(j);this.colorTexture=_({data:ae.data,width:ae.width,height:ae.height,flipY:!1})}}]),E}(gt),cl={raster:Bo,raster3d:Bo},Tl=cl;function Fl(h){var T=af();return function(){var b=Y()(h),_;if(T){var M=Y()(this).constructor;_=Reflect.construct(b,arguments,M)}else _=b.apply(this,arguments);return te()(this,_)}}function af(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Bl=function(h){D()(E,h);var T=Fl(E);function E(){var b;X()(this,E);for(var _=arguments.length,M=new Array(_),j=0;j<_;j++)M[j]=arguments[j];return b=T.call.apply(T,[this].concat(M)),b.type="RasterLayer",b}return a()(E,[{key:"buildModels",value:function(){var _=this.getModelType();this.layerModel=new Tl[_](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var _=this.getModelType(),M={raster:{},raster3d:{}};return M[_]}},{key:"getModelType",value:function(){return"raster"}}]),E}(ie),Os,ss,Mi,Yu,ka,wo,Al,mu;function gu(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);T&&(b=b.filter(function(_){return Object.getOwnPropertyDescriptor(h,_).enumerable})),E.push.apply(E,b)}return E}function Es(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?gu(Object(E),!0).forEach(function(b){Oe()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):gu(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}var Ec=(Os=Object(ar.injectable)(),ss=Object(ar.inject)(S.TYPES.IGlobalConfigService),Mi=Object(ar.inject)(S.TYPES.ILogService),Os(Yu=(ka=(mu=function(){function h(){X()(this,h),Le()(this,"configService",wo,this),Le()(this,"logger",Al,this)}return a()(h,[{key:"apply",value:function(E,b){var _=this,M=b.styleAttributeService;E.hooks.init.tap("DataMappingPlugin",function(){_.generateMaping(E,{styleAttributeService:M})}),E.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return E.dataState.dataMappingNeedUpdate=!1,_.generateMaping(E,{styleAttributeService:M}),!0}),E.hooks.beforeRender.tap("DataMappingPlugin",function(){if(!E.layerModelNeedUpdate){var j=M.getLayerStyleAttributes()||[],ae=M.getLayerStyleAttribute("filter"),ve=E.getSource().data.dataArray,je=j.filter(function(Jt){return Jt.needRemapping}),Rt=ve;(ae==null?void 0:ae.needRemapping)&&(ae==null?void 0:ae.scale)&&(Rt=ve.filter(function(Jt){return _.applyAttributeMapping(ae,Jt)[0]})),je.length&&((ae==null?void 0:ae.needRemapping)?(E.setEncodedData(_.mapping(j,Rt)),ae.needRemapping=!1):E.setEncodedData(_.mapping(je,Rt,E.getEncodedData())),_.logger.debug("remapping finished"),E.emit("remapping",null))}})}},{key:"generateMaping",value:function(E,b){var _=this,M=b.styleAttributeService,j=M.getLayerStyleAttributes()||[],ae=M.getLayerStyleAttribute("filter"),ve=E.getSource().data.dataArray,je=ve;(ae==null?void 0:ae.scale)&&(je=ve.filter(function(Rt){return _.applyAttributeMapping(ae,Rt)[0]})),E.setEncodedData(this.mapping(j,je))}},{key:"mapping",value:function(E,b,_){var M=this;return b.map(function(j,ae){var ve=_?_[ae]:{},je=Es({id:j._id,coordinates:j.coordinates},ve);return E.filter(function(Rt){return Rt.scale!==void 0}).forEach(function(Rt){var Jt=M.applyAttributeMapping(Rt,j);Rt.needRemapping=!1,Rt.name==="color"&&(Jt=Jt.map(function(wr){return Object(Me.s)(wr)})),je[Rt.name]=Array.isArray(Jt)&&Jt.length===1?Jt[0]:Jt}),je})}},{key:"applyAttributeMapping",value:function(E,b){var _;if(!E.scale)return[];var M=(E==null||(_=E.scale)===null||_===void 0?void 0:_.scalers)||[],j=[];return M.forEach(function(ae){var ve,je=ae.field;(b.hasOwnProperty(je)||((ve=E.scale)===null||ve===void 0?void 0:ve.type)==="variable")&&j.push(b[je])}),E.mapping?E.mapping(j):[]}}]),h}(),mu),wo=Ze()(ka.prototype,"configService",[ss],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Al=Ze()(ka.prototype,"logger",[Mi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ka))||Yu),$n=o("rlAn"),Fn,Tc,vs,ko=(Fn=Object(ar.injectable)(),Fn(Tc=(vs=function(){function h(){X()(this,h),this.mapService=void 0}return a()(h,[{key:"apply",value:function(E){var b=this;this.mapService=E.getContainer().get(S.TYPES.IMapService),E.hooks.init.tap("DataSourcePlugin",function(){var _=E.sourceOption,M=_.data,j=_.options;E.setSource(new $n.default(M,j)),b.updateClusterData(E)}),E.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var _=b.updateClusterData(E),M=E.dataState.dataSourceNeedUpdate;return E.dataState.dataSourceNeedUpdate=!1,_||M})}},{key:"updateClusterData",value:function(E){var b=E.getSource(),_=b.cluster,M=b.clusterOptions,j=M.zoom,ae=j===void 0?0:j,ve=M.maxZoom,je=ve===void 0?16:ve,Rt=this.mapService.getZoom()-1;return _&&Math.abs(ae-Rt)>1&&je>ae?(b.updateClusterData(Math.floor(Rt)),!0):!1}}]),h}(),vs))||Tc),Po=o("7tbW"),ru=o.n(Po),Pu=o("4qC0"),ec=o.n(Pu),Hi=o("J2iB"),Za=o.n(Hi),fl=function(h,T){return h<T?-1:h>T?1:h>=T?0:NaN},hl=function(h){return h.length===1&&(h=tc(h)),{left:function(E,b,_,M){for(_==null&&(_=0),M==null&&(M=E.length);_<M;){var j=_+M>>>1;h(E[j],b)<0?_=j+1:M=j}return _},right:function(E,b,_,M){for(_==null&&(_=0),M==null&&(M=E.length);_<M;){var j=_+M>>>1;h(E[j],b)>0?M=j:_=j+1}return _}}};function tc(h){return function(T,E){return fl(h(T),E)}}var Mu=hl(fl),Ls=Mu.right,kl=Mu.left,ms=Ls,xf=function(h,T){T==null&&(T=jl);for(var E=0,b=h.length-1,_=h[0],M=new Array(b<0?0:b);E<b;)M[E]=T(_,_=h[++E]);return M};function jl(h,T){return[h,T]}var jc=function(h,T,E){var b=h.length,_=T.length,M=new Array(b*_),j,ae,ve,je;for(E==null&&(E=jl),j=ve=0;j<b;++j)for(je=h[j],ae=0;ae<_;++ae,++ve)M[ve]=E(je,T[ae]);return M},bf=function(h,T){return T<h?-1:T>h?1:T>=h?0:NaN},Us=function(h){return h===null?NaN:+h},_l=function(h,T){var E=h.length,b=0,_=-1,M=0,j,ae,ve=0;if(T==null)for(;++_<E;)isNaN(j=Us(h[_]))||(ae=j-M,M+=ae/++b,ve+=ae*(j-M));else for(;++_<E;)isNaN(j=Us(T(h[_],_,h)))||(ae=j-M,M+=ae/++b,ve+=ae*(j-M));if(b>1)return ve/(b-1)},Ul=function(h,T){var E=_l(h,T);return E&&Math.sqrt(E)},Iu=function(h,T){var E=h.length,b=-1,_,M,j;if(T==null){for(;++b<E;)if((_=h[b])!=null&&_>=_)for(M=j=_;++b<E;)(_=h[b])!=null&&(M>_&&(M=_),j<_&&(j=_))}else for(;++b<E;)if((_=T(h[b],b,h))!=null&&_>=_)for(M=j=_;++b<E;)(_=T(h[b],b,h))!=null&&(M>_&&(M=_),j<_&&(j=_));return[M,j]},Ou=Array.prototype,Cl=Ou.slice,Ku=Ou.map,Rs=function(h){return function(){return h}},Ac=function(h){return h},rc=function(h,T,E){h=+h,T=+T,E=(_=arguments.length)<2?(T=h,h=0,1):_<3?1:+E;for(var b=-1,_=Math.max(0,Math.ceil((T-h)/E))|0,M=new Array(_);++b<_;)M[b]=h+b*E;return M},nc=Math.sqrt(50),ic=Math.sqrt(10),u=Math.sqrt(2),i=function(h,T,E){var b,_=-1,M,j,ae;if(T=+T,h=+h,E=+E,h===T&&E>0)return[h];if((b=T<h)&&(M=h,h=T,T=M),(ae=n(h,T,E))===0||!isFinite(ae))return[];if(ae>0)for(h=Math.ceil(h/ae),T=Math.floor(T/ae),j=new Array(M=Math.ceil(T-h+1));++_<M;)j[_]=(h+_)*ae;else for(h=Math.floor(h*ae),T=Math.ceil(T*ae),j=new Array(M=Math.ceil(h-T+1));++_<M;)j[_]=(h-_)/ae;return b&&j.reverse(),j};function n(h,T,E){var b=(T-h)/Math.max(0,E),_=Math.floor(Math.log(b)/Math.LN10),M=b/Math.pow(10,_);return _>=0?(M>=nc?10:M>=ic?5:M>=u?2:1)*Math.pow(10,_):-Math.pow(10,-_)/(M>=nc?10:M>=ic?5:M>=u?2:1)}function c(h,T,E){var b=Math.abs(T-h)/Math.max(0,E),_=Math.pow(10,Math.floor(Math.log(b)/Math.LN10)),M=b/_;return M>=nc?_*=10:M>=ic?_*=5:M>=u&&(_*=2),T<h?-_:_}var x=function(h){return Math.ceil(Math.log(h.length)/Math.LN2)+1},P=function(){var h=Ac,T=Iu,E=x;function b(_){var M,j=_.length,ae,ve=new Array(j);for(M=0;M<j;++M)ve[M]=h(_[M],M,_);var je=T(ve),Rt=je[0],Jt=je[1],wr=E(ve,Rt,Jt);Array.isArray(wr)||(wr=c(Rt,Jt,wr),wr=rc(Math.ceil(Rt/wr)*wr,Jt,wr));for(var Dr=wr.length;wr[0]<=Rt;)wr.shift(),--Dr;for(;wr[Dr-1]>Jt;)wr.pop(),--Dr;var xn=new Array(Dr+1),mn;for(M=0;M<=Dr;++M)mn=xn[M]=[],mn.x0=M>0?wr[M-1]:Rt,mn.x1=M<Dr?wr[M]:Jt;for(M=0;M<j;++M)ae=ve[M],Rt<=ae&&ae<=Jt&&xn[ms(wr,ae,0,Dr)].push(_[M]);return xn}return b.value=function(_){return arguments.length?(h=typeof _=="function"?_:Rs(_),b):h},b.domain=function(_){return arguments.length?(T=typeof _=="function"?_:Rs([_[0],_[1]]),b):T},b.thresholds=function(_){return arguments.length?(E=typeof _=="function"?_:Array.isArray(_)?Rs(Cl.call(_)):Rs(_),b):E},b},O=function(h,T,E){if(E==null&&(E=Us),!!(b=h.length)){if((T=+T)<=0||b<2)return+E(h[0],0,h);if(T>=1)return+E(h[b-1],b-1,h);var b,_=(b-1)*T,M=Math.floor(_),j=+E(h[M],M,h),ae=+E(h[M+1],M+1,h);return j+(ae-j)*(_-M)}},F=function(h,T,E){return h=Ku.call(h,Us).sort(fl),Math.ceil((E-T)/(2*(O(h,.75)-O(h,.25))*Math.pow(h.length,-1/3)))},ue=function(h,T,E){return Math.ceil((E-T)/(3.5*Ul(h)*Math.pow(h.length,-1/3)))},Ee=function(h,T){var E=h.length,b=-1,_,M;if(T==null){for(;++b<E;)if((_=h[b])!=null&&_>=_)for(M=_;++b<E;)(_=h[b])!=null&&_>M&&(M=_)}else for(;++b<E;)if((_=T(h[b],b,h))!=null&&_>=_)for(M=_;++b<E;)(_=T(h[b],b,h))!=null&&_>M&&(M=_);return M},Xe=function(h,T){var E=h.length,b=E,_=-1,M,j=0;if(T==null)for(;++_<E;)isNaN(M=Us(h[_]))?--b:j+=M;else for(;++_<E;)isNaN(M=Us(T(h[_],_,h)))?--b:j+=M;if(b)return j/b},qe=function(h,T){var E=h.length,b=-1,_,M=[];if(T==null)for(;++b<E;)isNaN(_=Us(h[b]))||M.push(_);else for(;++b<E;)isNaN(_=Us(T(h[b],b,h)))||M.push(_);return O(M.sort(fl),.5)},tt=function(h){for(var T=h.length,E,b=-1,_=0,M,j;++b<T;)_+=h[b].length;for(M=new Array(_);--T>=0;)for(j=h[T],E=j.length;--E>=0;)M[--_]=j[E];return M},zt=function(h,T){var E=h.length,b=-1,_,M;if(T==null){for(;++b<E;)if((_=h[b])!=null&&_>=_)for(M=_;++b<E;)(_=h[b])!=null&&M>_&&(M=_)}else for(;++b<E;)if((_=T(h[b],b,h))!=null&&_>=_)for(M=_;++b<E;)(_=T(h[b],b,h))!=null&&M>_&&(M=_);return M},Lt=function(h,T){for(var E=T.length,b=new Array(E);E--;)b[E]=h[T[E]];return b},Xt=function(h,T){if(!!(E=h.length)){var E,b=0,_=0,M,j=h[_];for(T==null&&(T=fl);++b<E;)(T(M=h[b],j)<0||T(j,j)!==0)&&(j=M,_=b);if(T(j,j)===0)return _}},Dt=function(h,T,E){for(var b=(E==null?h.length:E)-(T=T==null?0:+T),_,M;b;)M=Math.random()*b--|0,_=h[b+T],h[b+T]=h[M+T],h[M+T]=_;return h},Ut=function(h,T){var E=h.length,b=-1,_,M=0;if(T==null)for(;++b<E;)(_=+h[b])&&(M+=_);else for(;++b<E;)(_=+T(h[b],b,h))&&(M+=_);return M},er=function(h){if(!(M=h.length))return[];for(var T=-1,E=zt(h,qt),b=new Array(E);++T<E;)for(var _=-1,M,j=b[T]=new Array(M);++_<M;)j[_]=h[_][T];return b};function qt(h){return h.length}var Ir=function(){return er(arguments)};function hr(h,T){switch(arguments.length){case 0:break;case 1:this.range(h);break;default:this.range(T).domain(h);break}return this}function Tr(h,T){switch(arguments.length){case 0:break;case 1:this.interpolator(h);break;default:this.interpolator(T).domain(h);break}return this}var _r="$";function nn(){}nn.prototype=Yr.prototype={constructor:nn,has:function(T){return _r+T in this},get:function(T){return this[_r+T]},set:function(T,E){return this[_r+T]=E,this},remove:function(T){var E=_r+T;return E in this&&delete this[E]},clear:function(){for(var T in this)T[0]===_r&&delete this[T]},keys:function(){var T=[];for(var E in this)E[0]===_r&&T.push(E.slice(1));return T},values:function(){var T=[];for(var E in this)E[0]===_r&&T.push(this[E]);return T},entries:function(){var T=[];for(var E in this)E[0]===_r&&T.push({key:E.slice(1),value:this[E]});return T},size:function(){var T=0;for(var E in this)E[0]===_r&&++T;return T},empty:function(){for(var T in this)if(T[0]===_r)return!1;return!0},each:function(T){for(var E in this)E[0]===_r&&T(this[E],E.slice(1),this)}};function Yr(h,T){var E=new nn;if(h instanceof nn)h.each(function(ae,ve){E.set(ve,ae)});else if(Array.isArray(h)){var b=-1,_=h.length,M;if(T==null)for(;++b<_;)E.set(b,h[b]);else for(;++b<_;)E.set(T(M=h[b],b,h),M)}else if(h)for(var j in h)E.set(j,h[j]);return E}var yn=Yr,On=function(){var h=[],T=[],E,b,_;function M(ae,ve,je,Rt){if(ve>=h.length)return E!=null&&ae.sort(E),b!=null?b(ae):ae;for(var Jt=-1,wr=ae.length,Dr=h[ve++],xn,mn,Bn=yn(),Ei,Ai=je();++Jt<wr;)(Ei=Bn.get(xn=Dr(mn=ae[Jt])+""))?Ei.push(mn):Bn.set(xn,[mn]);return Bn.each(function(za,oa){Rt(Ai,oa,M(za,ve,je,Rt))}),Ai}function j(ae,ve){if(++ve>h.length)return ae;var je,Rt=T[ve-1];return b!=null&&ve>=h.length?je=ae.entries():(je=[],ae.each(function(Jt,wr){je.push({key:wr,values:j(Jt,ve)})})),Rt!=null?je.sort(function(Jt,wr){return Rt(Jt.key,wr.key)}):je}return _={object:function(ve){return M(ve,0,Qn,oi)},map:function(ve){return M(ve,0,yi,Zi)},entries:function(ve){return j(M(ve,0,yi,Zi),0)},key:function(ve){return h.push(ve),_},sortKeys:function(ve){return T[h.length-1]=ve,_},sortValues:function(ve){return E=ve,_},rollup:function(ve){return b=ve,_}}};function Qn(){return{}}function oi(h,T,E){h[T]=E}function yi(){return yn()}function Zi(h,T,E){h.set(T,E)}function An(){}var si=yn.prototype;An.prototype=xi.prototype={constructor:An,has:si.has,add:function(T){return T+="",this[_r+T]=T,this},remove:si.remove,clear:si.clear,values:si.keys,size:si.size,empty:si.empty,each:si.each};function xi(h,T){var E=new An;if(h instanceof An)h.each(function(M){E.add(M)});else if(h){var b=-1,_=h.length;if(T==null)for(;++b<_;)E.add(h[b]);else for(;++b<_;)E.add(T(h[b],b,h))}return E}var Wn=xi,Ti=function(h){var T=[];for(var E in h)T.push(E);return T},ri=function(h){var T=[];for(var E in h)T.push(h[E]);return T},Ii=function(h){var T=[];for(var E in h)T.push({key:E,value:h[E]});return T},Bi=Array.prototype,qa=Bi.map,Pa=Bi.slice,yo={name:"implicit"};function Ea(){var h=yn(),T=[],E=[],b=yo;function _(M){var j=M+"",ae=h.get(j);if(!ae){if(b!==yo)return b;h.set(j,ae=T.push(M))}return E[(ae-1)%E.length]}return _.domain=function(M){if(!arguments.length)return T.slice();T=[],h=yn();for(var j=-1,ae=M.length,ve,je;++j<ae;)h.has(je=(ve=M[j])+"")||h.set(je,T.push(ve));return _},_.range=function(M){return arguments.length?(E=Pa.call(M),_):E.slice()},_.unknown=function(M){return arguments.length?(b=M,_):b},_.copy=function(){return Ea(T,E).unknown(b)},hr.apply(_,arguments),_}function Wa(){var h=Ea().unknown(void 0),T=h.domain,E=h.range,b=[0,1],_,M,j=!1,ae=0,ve=0,je=.5;delete h.unknown;function Rt(){var Jt=T().length,wr=b[1]<b[0],Dr=b[wr-0],xn=b[1-wr];_=(xn-Dr)/Math.max(1,Jt-ae+ve*2),j&&(_=Math.floor(_)),Dr+=(xn-Dr-_*(Jt-ae))*je,M=_*(1-ae),j&&(Dr=Math.round(Dr),M=Math.round(M));var mn=rc(Jt).map(function(Bn){return Dr+_*Bn});return E(wr?mn.reverse():mn)}return h.domain=function(Jt){return arguments.length?(T(Jt),Rt()):T()},h.range=function(Jt){return arguments.length?(b=[+Jt[0],+Jt[1]],Rt()):b.slice()},h.rangeRound=function(Jt){return b=[+Jt[0],+Jt[1]],j=!0,Rt()},h.bandwidth=function(){return M},h.step=function(){return _},h.round=function(Jt){return arguments.length?(j=!!Jt,Rt()):j},h.padding=function(Jt){return arguments.length?(ae=Math.min(1,ve=+Jt),Rt()):ae},h.paddingInner=function(Jt){return arguments.length?(ae=Math.min(1,Jt),Rt()):ae},h.paddingOuter=function(Jt){return arguments.length?(ve=+Jt,Rt()):ve},h.align=function(Jt){return arguments.length?(je=Math.max(0,Math.min(1,Jt)),Rt()):je},h.copy=function(){return Wa(T(),b).round(j).paddingInner(ae).paddingOuter(ve).align(je)},hr.apply(Rt(),arguments)}function Ds(h){var T=h.copy;return h.padding=h.paddingOuter,delete h.paddingInner,delete h.paddingOuter,h.copy=function(){return Ds(T())},h}function xo(){return Ds(Wa.apply(null,arguments).paddingInner(1))}var yu=o("FmoU");function xu(h,T,E,b,_){var M=h*h,j=M*h;return((1-3*h+3*M-j)*T+(4-6*M+3*j)*E+(1+3*h+3*M-3*j)*b+j*_)/6}var jo=function(h){var T=h.length-1;return function(E){var b=E<=0?E=0:E>=1?(E=1,T-1):Math.floor(E*T),_=h[b],M=h[b+1],j=b>0?h[b-1]:2*_-M,ae=b<T-1?h[b+2]:2*M-_;return xu((E-b/T)*T,j,_,M,ae)}},Ts=function(h){var T=h.length;return function(E){var b=Math.floor(((E%=1)<0?++E:E)*T),_=h[(b+T-1)%T],M=h[b%T],j=h[(b+1)%T],ae=h[(b+2)%T];return xu((E-b/T)*T,_,M,j,ae)}},Lu=function(h){return function(){return h}};function ac(h,T){return function(E){return h+E*T}}function $u(h,T,E){return h=Math.pow(h,E),T=Math.pow(T,E)-h,E=1/E,function(b){return Math.pow(h+b*T,E)}}function oc(h,T){var E=T-h;return E?ac(h,E>180||E<-180?E-360*Math.round(E/360):E):Lu(isNaN(h)?T:h)}function sc(h){return(h=+h)==1?Ru:function(T,E){return E-T?$u(T,E,h):Lu(isNaN(T)?E:T)}}function Ru(h,T){var E=T-h;return E?ac(h,E):Lu(isNaN(h)?T:h)}var dl=function h(T){var E=sc(T);function b(_,M){var j=E((_=Object(yu.b)(_)).r,(M=Object(yu.b)(M)).r),ae=E(_.g,M.g),ve=E(_.b,M.b),je=Ru(_.opacity,M.opacity);return function(Rt){return _.r=j(Rt),_.g=ae(Rt),_.b=ve(Rt),_.opacity=je(Rt),_+""}}return b.gamma=h,b}(1);function As(h){return function(T){var E=T.length,b=new Array(E),_=new Array(E),M=new Array(E),j,ae;for(j=0;j<E;++j)ae=Object(yu.b)(T[j]),b[j]=ae.r||0,_[j]=ae.g||0,M[j]=ae.b||0;return b=h(b),_=h(_),M=h(M),ae.opacity=1,function(ve){return ae.r=b(ve),ae.g=_(ve),ae.b=M(ve),ae+""}}}var co=As(jo),Du=As(Ts),bu=function(h,T){T||(T=[]);var E=h?Math.min(T.length,h.length):0,b=T.slice(),_;return function(M){for(_=0;_<E;++_)b[_]=h[_]*(1-M)+T[_]*M;return b}};function Mo(h){return ArrayBuffer.isView(h)&&!(h instanceof DataView)}var Io=function(h,T){return(Mo(T)?bu:Oo)(h,T)};function Oo(h,T){var E=T?T.length:0,b=h?Math.min(E,h.length):0,_=new Array(b),M=new Array(E),j;for(j=0;j<b;++j)_[j]=zu(h[j],T[j]);for(;j<E;++j)M[j]=T[j];return function(ae){for(j=0;j<b;++j)M[j]=_[j](ae);return M}}var Jo=function(h,T){var E=new Date;return h=+h,T=+T,function(b){return E.setTime(h*(1-b)+T*b),E}},bo=function(h,T){return h=+h,T=+T,function(E){return h*(1-E)+T*E}},Uo=function(h,T){var E={},b={},_;(h===null||typeof h!="object")&&(h={}),(T===null||typeof T!="object")&&(T={});for(_ in T)_ in h?E[_]=zu(h[_],T[_]):b[_]=T[_];return function(M){for(_ in E)b[_]=E[_](M);return b}},Vs=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wl=new RegExp(Vs.source,"g");function Uc(h){return function(){return h}}function Vl(h){return function(T){return h(T)+""}}var Ju=function(h,T){var E=Vs.lastIndex=wl.lastIndex=0,b,_,M,j=-1,ae=[],ve=[];for(h=h+"",T=T+"";(b=Vs.exec(h))&&(_=wl.exec(T));)(M=_.index)>E&&(M=T.slice(E,M),ae[j]?ae[j]+=M:ae[++j]=M),(b=b[0])===(_=_[0])?ae[j]?ae[j]+=_:ae[++j]=_:(ae[++j]=null,ve.push({i:j,x:bo(b,_)})),E=wl.lastIndex;return E<T.length&&(M=T.slice(E),ae[j]?ae[j]+=M:ae[++j]=M),ae.length<2?ve[0]?Vl(ve[0].x):Uc(T):(T=ve.length,function(je){for(var Rt=0,Jt;Rt<T;++Rt)ae[(Jt=ve[Rt]).i]=Jt.x(je);return ae.join("")})},zu=function(h,T){var E=typeof T,b;return T==null||E==="boolean"?Lu(T):(E==="number"?bo:E==="string"?(b=Object(yu.a)(T))?(T=b,dl):Ju:T instanceof yu.a?dl:T instanceof Date?Jo:Mo(T)?bu:Array.isArray(T)?Oo:typeof T.valueOf!="function"&&typeof T.toString!="function"||isNaN(T)?Uo:bo)(h,T)},Nu=function(h,T){return h=+h,T=+T,function(E){return Math.round(h*(1-E)+T*E)}},Gs=function(h){return function(){return h}},Lo=function(h){return+h},Vc=[0,1];function gs(h){return h}function of(h,T){return(T-=h=+h)?function(E){return(E-h)/T}:Gs(isNaN(T)?NaN:.5)}function Lf(h){var T=h[0],E=h[h.length-1],b;return T>E&&(b=T,T=E,E=b),function(_){return Math.max(T,Math.min(E,_))}}function Rf(h,T,E){var b=h[0],_=h[1],M=T[0],j=T[1];return _<b?(b=of(_,b),M=E(j,M)):(b=of(b,_),M=E(M,j)),function(ae){return M(b(ae))}}function Uf(h,T,E){var b=Math.min(h.length,T.length)-1,_=new Array(b),M=new Array(b),j=-1;for(h[b]<h[0]&&(h=h.slice().reverse(),T=T.slice().reverse());++j<b;)_[j]=of(h[j],h[j+1]),M[j]=E(T[j],T[j+1]);return function(ae){var ve=ms(h,ae,1,b)-1;return M[ve](_[ve](ae))}}function Qu(h,T){return T.domain(h.domain()).range(h.range()).interpolate(h.interpolate()).clamp(h.clamp()).unknown(h.unknown())}function Sf(){var h=Vc,T=Vc,E=zu,b,_,M,j=gs,ae,ve,je;function Rt(){return ae=Math.min(h.length,T.length)>2?Uf:Rf,ve=je=null,Jt}function Jt(wr){return isNaN(wr=+wr)?M:(ve||(ve=ae(h.map(b),T,E)))(b(j(wr)))}return Jt.invert=function(wr){return j(_((je||(je=ae(T,h.map(b),bo)))(wr)))},Jt.domain=function(wr){return arguments.length?(h=qa.call(wr,Lo),j===gs||(j=Lf(h)),Rt()):h.slice()},Jt.range=function(wr){return arguments.length?(T=Pa.call(wr),Rt()):T.slice()},Jt.rangeRound=function(wr){return T=Pa.call(wr),E=Nu,Rt()},Jt.clamp=function(wr){return arguments.length?(j=wr?Lf(h):gs,Jt):j!==gs},Jt.interpolate=function(wr){return arguments.length?(E=wr,Rt()):E},Jt.unknown=function(wr){return arguments.length?(M=wr,Jt):M},function(wr,Dr){return b=wr,_=Dr,Rt()}}function sf(h,T){return Sf()(h,T)}var uc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Fu(h){if(!(T=uc.exec(h)))throw new Error("invalid format: "+h);var T;return new lc({fill:T[1],align:T[2],sign:T[3],symbol:T[4],zero:T[5],width:T[6],comma:T[7],precision:T[8]&&T[8].slice(1),trim:T[9],type:T[10]})}Fu.prototype=lc.prototype;function lc(h){this.fill=h.fill===void 0?" ":h.fill+"",this.align=h.align===void 0?">":h.align+"",this.sign=h.sign===void 0?"-":h.sign+"",this.symbol=h.symbol===void 0?"":h.symbol+"",this.zero=!!h.zero,this.width=h.width===void 0?void 0:+h.width,this.comma=!!h.comma,this.precision=h.precision===void 0?void 0:+h.precision,this.trim=!!h.trim,this.type=h.type===void 0?"":h.type+""}lc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};var Vf=function(h){return Math.abs(h=Math.round(h))>=1e21?h.toLocaleString("en").replace(/,/g,""):h.toString(10)};function _c(h,T){if((E=(h=T?h.toExponential(T-1):h.toExponential()).indexOf("e"))<0)return null;var E,b=h.slice(0,E);return[b.length>1?b[0]+b.slice(2):b,+h.slice(E+1)]}var Cc=function(h){return h=_c(Math.abs(h)),h?h[1]:NaN},Gf=function(h,T){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Cc(T)/3)))*3-Cc(Math.abs(h)))},Hf=function(h,T){return function(E,b){for(var _=E.length,M=[],j=0,ae=h[0],ve=0;_>0&&ae>0&&(ve+ae+1>b&&(ae=Math.max(1,b-ve)),M.push(E.substring(_-=ae,_+ae)),!((ve+=ae+1)>b));)ae=h[j=(j+1)%h.length];return M.reverse().join(T)}},ah=function(h){return function(T){return T.replace(/[0-9]/g,function(E){return h[+E]})}},Zf=function(h){e:for(var T=h.length,E=1,b=-1,_;E<T;++E)switch(h[E]){case".":b=_=E;break;case"0":b===0&&(b=E),_=E;break;default:if(!+h[E])break e;b>0&&(b=0);break}return b>0?h.slice(0,b)+h.slice(_+1):h},Df,ch=function(h,T){var E=_c(h,T);if(!E)return h+"";var b=E[0],_=E[1],M=_-(Df=Math.max(-8,Math.min(8,Math.floor(_/3)))*3)+1,j=b.length;return M===j?b:M>j?b+new Array(M-j+1).join("0"):M>0?b.slice(0,M)+"."+b.slice(M):"0."+new Array(1-M).join("0")+_c(h,Math.max(0,T+M-1))[0]},cc=function(h,T){var E=_c(h,T);if(!E)return h+"";var b=E[0],_=E[1];return _<0?"0."+new Array(-_).join("0")+b:b.length>_+1?b.slice(0,_+1)+"."+b.slice(_+1):b+new Array(_-b.length+2).join("0")},uf={"%":function(T,E){return(T*100).toFixed(E)},b:function(T){return Math.round(T).toString(2)},c:function(T){return T+""},d:Vf,e:function(T,E){return T.toExponential(E)},f:function(T,E){return T.toFixed(E)},g:function(T,E){return T.toPrecision(E)},o:function(T){return Math.round(T).toString(8)},p:function(T,E){return cc(T*100,E)},r:cc,s:ch,X:function(T){return Math.round(T).toString(16).toUpperCase()},x:function(T){return Math.round(T).toString(16)}},ao=function(h){return h},Gl=Array.prototype.map,lf=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],Gc=function(h){var T=h.grouping===void 0||h.thousands===void 0?ao:Hf(Gl.call(h.grouping,Number),h.thousands+""),E=h.currency===void 0?"":h.currency[0]+"",b=h.currency===void 0?"":h.currency[1]+"",_=h.decimal===void 0?".":h.decimal+"",M=h.numerals===void 0?ao:ah(Gl.call(h.numerals,String)),j=h.percent===void 0?"%":h.percent+"",ae=h.minus===void 0?"-":h.minus+"",ve=h.nan===void 0?"NaN":h.nan+"";function je(Jt){Jt=Fu(Jt);var wr=Jt.fill,Dr=Jt.align,xn=Jt.sign,mn=Jt.symbol,Bn=Jt.zero,Ei=Jt.width,Ai=Jt.comma,za=Jt.precision,oa=Jt.trim,sa=Jt.type;sa==="n"?(Ai=!0,sa="g"):uf[sa]||(za===void 0&&(za=12),oa=!0,sa="g"),(Bn||wr==="0"&&Dr==="=")&&(Bn=!0,wr="0",Dr="=");var to=mn==="$"?E:mn==="#"&&/[boxX]/.test(sa)?"0"+sa.toLowerCase():"",_i=mn==="$"?b:/[%p]/.test(sa)?j:"",ro=uf[sa],To=/[defgprs%]/.test(sa);za=za===void 0?6:/[gprs]/.test(sa)?Math.max(1,Math.min(21,za)):Math.max(0,Math.min(20,za));function Xs(Wi){var Cs=to,rs=_i,vf,Nh,Pc;if(sa==="c")rs=ro(Wi)+rs,Wi="";else{Wi=+Wi;var Sh=Wi<0||1/Wi<0;if(Wi=isNaN(Wi)?ve:ro(Math.abs(Wi),za),oa&&(Wi=Zf(Wi)),Sh&&+Wi==0&&xn!=="+"&&(Sh=!1),Cs=(Sh?xn==="("?xn:ae:xn==="-"||xn==="("?"":xn)+Cs,rs=(sa==="s"?lf[8+Df/3]:"")+rs+(Sh&&xn==="("?")":""),To){for(vf=-1,Nh=Wi.length;++vf<Nh;)if(Pc=Wi.charCodeAt(vf),48>Pc||Pc>57){rs=(Pc===46?_+Wi.slice(vf+1):Wi.slice(vf))+rs,Wi=Wi.slice(0,vf);break}}}Ai&&!Bn&&(Wi=T(Wi,Infinity));var uh=Cs.length+Wi.length+rs.length,$c=uh<Ei?new Array(Ei-uh+1).join(wr):"";switch(Ai&&Bn&&(Wi=T($c+Wi,$c.length?Ei-rs.length:Infinity),$c=""),Dr){case"<":Wi=Cs+Wi+rs+$c;break;case"=":Wi=Cs+$c+Wi+rs;break;case"^":Wi=$c.slice(0,uh=$c.length>>1)+Cs+Wi+rs+$c.slice(uh);break;default:Wi=$c+Cs+Wi+rs;break}return M(Wi)}return Xs.toString=function(){return Jt+""},Xs}function Rt(Jt,wr){var Dr=je((Jt=Fu(Jt),Jt.type="f",Jt)),xn=Math.max(-8,Math.min(8,Math.floor(Cc(wr)/3)))*3,mn=Math.pow(10,-xn),Bn=lf[8+xn/3];return function(Ei){return Dr(mn*Ei)+Bn}}return{format:je,formatPrefix:Rt}},nu,Pl,Ef;Tf({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Tf(h){return nu=Gc(h),Pl=nu.format,Ef=nu.formatPrefix,nu}var Hc=function(h,T){return h=Math.abs(h),T=Math.abs(T)-h,Math.max(0,Cc(T)-Cc(h))+1},cf=function(h){return Math.max(0,-Cc(Math.abs(h)))},Zc=function(h,T,E,b){var _=c(h,T,E),M;switch(b=Fu(b==null?",f":b),b.type){case"s":{var j=Math.max(Math.abs(h),Math.abs(T));return b.precision==null&&!isNaN(M=Gf(_,j))&&(b.precision=M),Ef(b,j)}case"":case"e":case"g":case"p":case"r":{b.precision==null&&!isNaN(M=Hc(_,Math.max(Math.abs(h),Math.abs(T))))&&(b.precision=M-(b.type==="e"));break}case"f":case"%":{b.precision==null&&!isNaN(M=cf(_))&&(b.precision=M-(b.type==="%")*2);break}}return Pl(b)};function Hl(h){var T=h.domain;return h.ticks=function(E){var b=T();return i(b[0],b[b.length-1],E==null?10:E)},h.tickFormat=function(E,b){var _=T();return Zc(_[0],_[_.length-1],E==null?10:E,b)},h.nice=function(E){E==null&&(E=10);var b=T(),_=0,M=b.length-1,j=b[_],ae=b[M],ve;return ae<j&&(ve=j,j=ae,ae=ve,ve=_,_=M,M=ve),ve=n(j,ae,E),ve>0?(j=Math.floor(j/ve)*ve,ae=Math.ceil(ae/ve)*ve,ve=n(j,ae,E)):ve<0&&(j=Math.ceil(j*ve)/ve,ae=Math.floor(ae*ve)/ve,ve=n(j,ae,E)),ve>0?(b[_]=Math.floor(j/ve)*ve,b[M]=Math.ceil(ae/ve)*ve,T(b)):ve<0&&(b[_]=Math.ceil(j*ve)/ve,b[M]=Math.floor(ae*ve)/ve,T(b)),h},h}function ne(){var h=sf(gs,gs);return h.copy=function(){return Qu(h,ne())},hr.apply(h,arguments),Hl(h)}function se(h){var T;function E(b){return isNaN(b=+b)?T:b}return E.invert=E,E.domain=E.range=function(b){return arguments.length?(h=qa.call(b,Lo),E):h.slice()},E.unknown=function(b){return arguments.length?(T=b,E):T},E.copy=function(){return se(h).unknown(T)},h=arguments.length?qa.call(h,Lo):[0,1],Hl(E)}var z=function(h,T){h=h.slice();var E=0,b=h.length-1,_=h[E],M=h[b],j;return M<_&&(j=E,E=b,b=j,j=_,_=M,M=j),h[E]=T.floor(_),h[b]=T.ceil(M),h};function V(h){return Math.log(h)}function _e(h){return Math.exp(h)}function ut(h){return-Math.log(-h)}function Ht(h){return-Math.exp(-h)}function ir(h){return isFinite(h)?+("1e"+h):h<0?0:h}function tr(h){return h===10?ir:h===Math.E?Math.exp:function(T){return Math.pow(h,T)}}function Or(h){return h===Math.E?Math.log:h===10&&Math.log10||h===2&&Math.log2||(h=Math.log(h),function(T){return Math.log(T)/h})}function an(h){return function(T){return-h(-T)}}function zn(h){var T=h(V,_e),E=T.domain,b=10,_,M;function j(){return _=Or(b),M=tr(b),E()[0]<0?(_=an(_),M=an(M),h(ut,Ht)):h(V,_e),T}return T.base=function(ae){return arguments.length?(b=+ae,j()):b},T.domain=function(ae){return arguments.length?(E(ae),j()):E()},T.ticks=function(ae){var ve=E(),je=ve[0],Rt=ve[ve.length-1],Jt;(Jt=Rt<je)&&(wr=je,je=Rt,Rt=wr);var wr=_(je),Dr=_(Rt),xn,mn,Bn,Ei=ae==null?10:+ae,Ai=[];if(!(b%1)&&Dr-wr<Ei){if(wr=Math.round(wr)-1,Dr=Math.round(Dr)+1,je>0){for(;wr<Dr;++wr)for(mn=1,xn=M(wr);mn<b;++mn)if(Bn=xn*mn,!(Bn<je)){if(Bn>Rt)break;Ai.push(Bn)}}else for(;wr<Dr;++wr)for(mn=b-1,xn=M(wr);mn>=1;--mn)if(Bn=xn*mn,!(Bn<je)){if(Bn>Rt)break;Ai.push(Bn)}}else Ai=i(wr,Dr,Math.min(Dr-wr,Ei)).map(M);return Jt?Ai.reverse():Ai},T.tickFormat=function(ae,ve){if(ve==null&&(ve=b===10?".0e":","),typeof ve!="function"&&(ve=Pl(ve)),ae===Infinity)return ve;ae==null&&(ae=10);var je=Math.max(1,b*ae/T.ticks().length);return function(Rt){var Jt=Rt/M(Math.round(_(Rt)));return Jt*b<b-.5&&(Jt*=b),Jt<=je?ve(Rt):""}},T.nice=function(){return E(z(E(),{floor:function(ve){return M(Math.floor(_(ve)))},ceil:function(ve){return M(Math.ceil(_(ve)))}}))},T}function Xn(){var h=zn(Sf()).domain([1,10]);return h.copy=function(){return Qu(h,Xn()).base(h.base())},hr.apply(h,arguments),h}function ni(h){return function(T){return Math.sign(T)*Math.log1p(Math.abs(T/h))}}function ra(h){return function(T){return Math.sign(T)*Math.expm1(Math.abs(T))*h}}function Oi(h){var T=1,E=h(ni(T),ra(T));return E.constant=function(b){return arguments.length?h(ni(T=+b),ra(T)):T},Hl(E)}function la(){var h=Oi(Sf());return h.copy=function(){return Qu(h,la()).constant(h.constant())},hr.apply(h,arguments)}function Yi(h){return function(T){return T<0?-Math.pow(-T,h):Math.pow(T,h)}}function ja(h){return h<0?-Math.sqrt(-h):Math.sqrt(h)}function Ro(h){return h<0?-h*h:h*h}function So(h){var T=h(gs,gs),E=1;function b(){return E===1?h(gs,gs):E===.5?h(ja,Ro):h(Yi(E),Yi(1/E))}return T.exponent=function(_){return arguments.length?(E=+_,b()):E},Hl(T)}function Ya(){var h=So(Sf());return h.copy=function(){return Qu(h,Ya()).exponent(h.exponent())},hr.apply(h,arguments),h}function Vo(){return Ya.apply(null,arguments).exponent(.5)}function ea(){var h=[],T=[],E=[],b;function _(){var j=0,ae=Math.max(1,T.length);for(E=new Array(ae-1);++j<ae;)E[j-1]=O(h,j/ae);return M}function M(j){return isNaN(j=+j)?b:T[ms(E,j)]}return M.invertExtent=function(j){var ae=T.indexOf(j);return ae<0?[NaN,NaN]:[ae>0?E[ae-1]:h[0],ae<E.length?E[ae]:h[h.length-1]]},M.domain=function(j){if(!arguments.length)return h.slice();h=[];for(var ae=0,ve=j.length,je;ae<ve;++ae)je=j[ae],je!=null&&!isNaN(je=+je)&&h.push(je);return h.sort(fl),_()},M.range=function(j){return arguments.length?(T=Pa.call(j),_()):T.slice()},M.unknown=function(j){return arguments.length?(b=j,M):b},M.quantiles=function(){return E.slice()},M.copy=function(){return ea().domain(h).range(T).unknown(b)},hr.apply(M,arguments)}function fo(){var h=0,T=1,E=1,b=[.5],_=[0,1],M;function j(ve){return ve<=ve?_[ms(b,ve,0,E)]:M}function ae(){var ve=-1;for(b=new Array(E);++ve<E;)b[ve]=((ve+1)*T-(ve-E)*h)/(E+1);return j}return j.domain=function(ve){return arguments.length?(h=+ve[0],T=+ve[1],ae()):[h,T]},j.range=function(ve){return arguments.length?(E=(_=Pa.call(ve)).length-1,ae()):_.slice()},j.invertExtent=function(ve){var je=_.indexOf(ve);return je<0?[NaN,NaN]:je<1?[h,b[0]]:je>=E?[b[E-1],T]:[b[je-1],b[je]]},j.unknown=function(ve){return arguments.length&&(M=ve),j},j.thresholds=function(){return b.slice()},j.copy=function(){return fo().domain([h,T]).range(_).unknown(M)},hr.apply(Hl(j),arguments)}function iu(){var h=[.5],T=[0,1],E,b=1;function _(M){return M<=M?T[ms(h,M,0,b)]:E}return _.domain=function(M){return arguments.length?(h=Pa.call(M),b=Math.min(h.length,T.length-1),_):h.slice()},_.range=function(M){return arguments.length?(T=Pa.call(M),b=Math.min(h.length,T.length-1),_):T.slice()},_.invertExtent=function(M){var j=T.indexOf(M);return[h[j-1],h[j]]},_.unknown=function(M){return arguments.length?(E=M,_):E},_.copy=function(){return iu().domain(h).range(T).unknown(E)},hr.apply(_,arguments)}var Ta=new Date,Ua=new Date;function bi(h,T,E,b){function _(M){return h(M=arguments.length===0?new Date:new Date(+M)),M}return _.floor=function(M){return h(M=new Date(+M)),M},_.ceil=function(M){return h(M=new Date(M-1)),T(M,1),h(M),M},_.round=function(M){var j=_(M),ae=_.ceil(M);return M-j<ae-M?j:ae},_.offset=function(M,j){return T(M=new Date(+M),j==null?1:Math.floor(j)),M},_.range=function(M,j,ae){var ve=[],je;if(M=_.ceil(M),ae=ae==null?1:Math.floor(ae),!(M<j)||!(ae>0))return ve;do ve.push(je=new Date(+M)),T(M,ae),h(M);while(je<M&&M<j);return ve},_.filter=function(M){return bi(function(j){if(j>=j)for(;h(j),!M(j);)j.setTime(j-1)},function(j,ae){if(j>=j)if(ae<0)for(;++ae<=0;)for(;T(j,-1),!M(j););else for(;--ae>=0;)for(;T(j,1),!M(j););})},E&&(_.count=function(M,j){return Ta.setTime(+M),Ua.setTime(+j),h(Ta),h(Ua),Math.floor(E(Ta,Ua))},_.every=function(M){return M=Math.floor(M),!isFinite(M)||!(M>0)?null:M>1?_.filter(b?function(j){return b(j)%M==0}:function(j){return _.count(0,j)%M==0}):_}),_}var Do=bi(function(h){h.setMonth(0,1),h.setHours(0,0,0,0)},function(h,T){h.setFullYear(h.getFullYear()+T)},function(h,T){return T.getFullYear()-h.getFullYear()},function(h){return h.getFullYear()});Do.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:bi(function(T){T.setFullYear(Math.floor(T.getFullYear()/h)*h),T.setMonth(0,1),T.setHours(0,0,0,0)},function(T,E){T.setFullYear(T.getFullYear()+E*h)})};var fc=Do,Wf=Do.range,fh=bi(function(h){h.setDate(1),h.setHours(0,0,0,0)},function(h,T){h.setMonth(h.getMonth()+T)},function(h,T){return T.getMonth()-h.getMonth()+(T.getFullYear()-h.getFullYear())*12},function(h){return h.getMonth()}),Xf=fh,Bu=fh.range,Yf=1e3,ff=6e4,Kf=36e5,Th=864e5,hh=6048e5;function Af(h){return bi(function(T){T.setDate(T.getDate()-(T.getDay()+7-h)%7),T.setHours(0,0,0,0)},function(T,E){T.setDate(T.getDate()+E*7)},function(T,E){return(E-T-(E.getTimezoneOffset()-T.getTimezoneOffset())*ff)/hh})}var oh=Af(0),$f=Af(1),dh=Af(2),Fh=Af(3),_f=Af(4),zf=Af(5),Ah=Af(6),xe=oh.range,Be=$f.range,Et=dh.range,gr=Fh.range,Mr=_f.range,Cr=zf.range,xr=Ah.range,Wr=bi(function(h){h.setHours(0,0,0,0)},function(h,T){h.setDate(h.getDate()+T)},function(h,T){return(T-h-(T.getTimezoneOffset()-h.getTimezoneOffset())*ff)/Th},function(h){return h.getDate()-1}),sn=Wr,en=Wr.range,Qr=bi(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*Yf-h.getMinutes()*ff)},function(h,T){h.setTime(+h+T*Kf)},function(h,T){return(T-h)/Kf},function(h){return h.getHours()}),fn=Qr,Cn=Qr.range,cn=bi(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*Yf)},function(h,T){h.setTime(+h+T*ff)},function(h,T){return(T-h)/ff},function(h){return h.getMinutes()}),rn=cn,yr=cn.range,vr=bi(function(h){h.setTime(h-h.getMilliseconds())},function(h,T){h.setTime(+h+T*Yf)},function(h,T){return(T-h)/Yf},function(h){return h.getUTCSeconds()}),Xr=vr,Pn=vr.range,Lr=bi(function(){},function(h,T){h.setTime(+h+T)},function(h,T){return T-h});Lr.every=function(h){return h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?bi(function(T){T.setTime(Math.floor(T/h)*h)},function(T,E){T.setTime(+T+E*h)},function(T,E){return(E-T)/h}):Lr};var qn=Lr,Jr=Lr.range;function Br(h){return bi(function(T){T.setUTCDate(T.getUTCDate()-(T.getUTCDay()+7-h)%7),T.setUTCHours(0,0,0,0)},function(T,E){T.setUTCDate(T.getUTCDate()+E*7)},function(T,E){return(E-T)/hh})}var Ur=Br(0),Kr=Br(1),Yn=Br(2),ti=Br(3),un=Br(4),Vr=Br(5),Nr=Br(6),di=Ur.range,pi=Kr.range,kn=Yn.range,Ni=ti.range,Ci=un.range,ki=Vr.range,ca=Nr.range,Go=bi(function(h){h.setUTCHours(0,0,0,0)},function(h,T){h.setUTCDate(h.getUTCDate()+T)},function(h,T){return(T-h)/Th},function(h){return h.getUTCDate()-1}),Ho=Go,ta=Go.range,ho=bi(function(h){h.setUTCMonth(0,1),h.setUTCHours(0,0,0,0)},function(h,T){h.setUTCFullYear(h.getUTCFullYear()+T)},function(h,T){return T.getUTCFullYear()-h.getUTCFullYear()},function(h){return h.getUTCFullYear()});ho.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:bi(function(T){T.setUTCFullYear(Math.floor(T.getUTCFullYear()/h)*h),T.setUTCMonth(0,1),T.setUTCHours(0,0,0,0)},function(T,E){T.setUTCFullYear(T.getUTCFullYear()+E*h)})};var Ma=ho,_s=ho.range;function Qo(h){if(0<=h.y&&h.y<100){var T=new Date(-1,h.m,h.d,h.H,h.M,h.S,h.L);return T.setFullYear(h.y),T}return new Date(h.y,h.m,h.d,h.H,h.M,h.S,h.L)}function ys(h){if(0<=h.y&&h.y<100){var T=new Date(Date.UTC(-1,h.m,h.d,h.H,h.M,h.S,h.L));return T.setUTCFullYear(h.y),T}return new Date(Date.UTC(h.y,h.m,h.d,h.H,h.M,h.S,h.L))}function qo(h,T,E){return{y:h,m:T,d:E,H:0,M:0,S:0,L:0}}function Hs(h){var T=h.dateTime,E=h.date,b=h.time,_=h.periods,M=h.days,j=h.shortDays,ae=h.months,ve=h.shortMonths,je=ji(_),Rt=es(_),Jt=ji(M),wr=es(M),Dr=ji(j),xn=es(j),mn=ji(ae),Bn=es(ae),Ei=ji(ve),Ai=es(ve),za={a:Sh,A:uh,b:$c,B:dd,c:null,d:Yt,e:Yt,f:on,g:us,G:Nf,H:jt,I:Qt,j:ur,L:kr,m:Gr,M:ln,p:sd,q:pd,Q:rd,s:ld,S:wn,u:Gn,U:ii,V:va,w:Ia,W:qu,x:null,X:null,y:ts,Y:Su,Z:Ml,"%":td},oa={a:vd,A:ud,b:md,B:Gh,c:null,d:Wc,e:Wc,f:Xc,g:Zh,G:Ch,H:_a,I:Da,j:wc,L:pl,m:Jf,M:po,p:gd,q:qh,Q:rd,s:ld,S:vl,u:hf,U:df,V:Xa,w:Cf,W:Ff,x:null,X:null,y:Hh,Y:ed,Z:Qf,"%":td},sa={a:Xs,A:Wi,b:Cs,B:rs,c:vf,d:g,e:g,f:Se,g:w,G:Rn,H:N,I:N,j:L,L:Z,m:d,M:K,p:To,q:s,Q:Fe,s:mt,S:ee,u:hc,U:Ot,V:Sr,w:au,W:mr,x:Nh,X:Pc,y:w,Y:Rn,Z:p,"%":pe};za.x=to(E,za),za.X=to(b,za),za.c=to(T,za),oa.x=to(E,oa),oa.X=to(b,oa),oa.c=to(T,oa);function to(Fi,Ga){return function(ua){var Dn=[],Mc=-1,Ss=0,Jc=Fi.length,Qc,Eh,yd;for(ua instanceof Date||(ua=new Date(+ua));++Mc<Jc;)Fi.charCodeAt(Mc)===37&&(Dn.push(Fi.slice(Ss,Mc)),(Eh=zo[Qc=Fi.charAt(++Mc)])!=null?Qc=Fi.charAt(++Mc):Eh=Qc==="e"?" ":"0",(yd=Ga[Qc])&&(Qc=yd(ua,Eh)),Dn.push(Qc),Ss=Mc+1);return Dn.push(Fi.slice(Ss,Mc)),Dn.join("")}}function _i(Fi,Ga){return function(ua){var Dn=qo(1900,void 0,1),Mc=ro(Dn,Fi,ua+="",0),Ss,Jc;if(Mc!=ua.length)return null;if("Q"in Dn)return new Date(Dn.Q);if("s"in Dn)return new Date(Dn.s*1e3+("L"in Dn?Dn.L:0));if(Ga&&!("Z"in Dn)&&(Dn.Z=0),"p"in Dn&&(Dn.H=Dn.H%12+Dn.p*12),Dn.m===void 0&&(Dn.m="q"in Dn?Dn.q:0),"V"in Dn){if(Dn.V<1||Dn.V>53)return null;"w"in Dn||(Dn.w=1),"Z"in Dn?(Ss=ys(qo(Dn.y,0,1)),Jc=Ss.getUTCDay(),Ss=Jc>4||Jc===0?Kr.ceil(Ss):Kr(Ss),Ss=Ho.offset(Ss,(Dn.V-1)*7),Dn.y=Ss.getUTCFullYear(),Dn.m=Ss.getUTCMonth(),Dn.d=Ss.getUTCDate()+(Dn.w+6)%7):(Ss=Qo(qo(Dn.y,0,1)),Jc=Ss.getDay(),Ss=Jc>4||Jc===0?$f.ceil(Ss):$f(Ss),Ss=sn.offset(Ss,(Dn.V-1)*7),Dn.y=Ss.getFullYear(),Dn.m=Ss.getMonth(),Dn.d=Ss.getDate()+(Dn.w+6)%7)}else("W"in Dn||"U"in Dn)&&("w"in Dn||(Dn.w="u"in Dn?Dn.u%7:"W"in Dn?1:0),Jc="Z"in Dn?ys(qo(Dn.y,0,1)).getUTCDay():Qo(qo(Dn.y,0,1)).getDay(),Dn.m=0,Dn.d="W"in Dn?(Dn.w+6)%7+Dn.W*7-(Jc+5)%7:Dn.w+Dn.U*7-(Jc+6)%7);return"Z"in Dn?(Dn.H+=Dn.Z/100|0,Dn.M+=Dn.Z%100,ys(Dn)):Qo(Dn)}}function ro(Fi,Ga,ua,Dn){for(var Mc=0,Ss=Ga.length,Jc=ua.length,Qc,Eh;Mc<Ss;){if(Dn>=Jc)return-1;if(Qc=Ga.charCodeAt(Mc++),Qc===37){if(Qc=Ga.charAt(Mc++),Eh=sa[Qc in zo?Ga.charAt(Mc++):Qc],!Eh||(Dn=Eh(Fi,ua,Dn))<0)return-1}else if(Qc!=ua.charCodeAt(Dn++))return-1}return Dn}function To(Fi,Ga,ua){var Dn=je.exec(Ga.slice(ua));return Dn?(Fi.p=Rt[Dn[0].toLowerCase()],ua+Dn[0].length):-1}function Xs(Fi,Ga,ua){var Dn=Dr.exec(Ga.slice(ua));return Dn?(Fi.w=xn[Dn[0].toLowerCase()],ua+Dn[0].length):-1}function Wi(Fi,Ga,ua){var Dn=Jt.exec(Ga.slice(ua));return Dn?(Fi.w=wr[Dn[0].toLowerCase()],ua+Dn[0].length):-1}function Cs(Fi,Ga,ua){var Dn=Ei.exec(Ga.slice(ua));return Dn?(Fi.m=Ai[Dn[0].toLowerCase()],ua+Dn[0].length):-1}function rs(Fi,Ga,ua){var Dn=mn.exec(Ga.slice(ua));return Dn?(Fi.m=Bn[Dn[0].toLowerCase()],ua+Dn[0].length):-1}function vf(Fi,Ga,ua){return ro(Fi,T,Ga,ua)}function Nh(Fi,Ga,ua){return ro(Fi,E,Ga,ua)}function Pc(Fi,Ga,ua){return ro(Fi,b,Ga,ua)}function Sh(Fi){return j[Fi.getDay()]}function uh(Fi){return M[Fi.getDay()]}function $c(Fi){return ve[Fi.getMonth()]}function dd(Fi){return ae[Fi.getMonth()]}function sd(Fi){return _[+(Fi.getHours()>=12)]}function pd(Fi){return 1+~~(Fi.getMonth()/3)}function vd(Fi){return j[Fi.getUTCDay()]}function ud(Fi){return M[Fi.getUTCDay()]}function md(Fi){return ve[Fi.getUTCMonth()]}function Gh(Fi){return ae[Fi.getUTCMonth()]}function gd(Fi){return _[+(Fi.getUTCHours()>=12)]}function qh(Fi){return 1+~~(Fi.getUTCMonth()/3)}return{format:function(Ga){var ua=to(Ga+="",za);return ua.toString=function(){return Ga},ua},parse:function(Ga){var ua=_i(Ga+="",!1);return ua.toString=function(){return Ga},ua},utcFormat:function(Ga){var ua=to(Ga+="",oa);return ua.toString=function(){return Ga},ua},utcParse:function(Ga){var ua=_i(Ga+="",!0);return ua.toString=function(){return Ga},ua}}}var zo={"-":"",_:" ","0":"0"},ui=/^\s*\d+/,Zs=/^%/,Aa=/[\\^$*+?|[\]().{}]/g;function bn(h,T,E){var b=h<0?"-":"",_=(b?-h:h)+"",M=_.length;return b+(M<E?new Array(E-M+1).join(T)+_:_)}function Li(h){return h.replace(Aa,"\\$&")}function ji(h){return new RegExp("^(?:"+h.map(Li).join("|")+")","i")}function es(h){for(var T={},E=-1,b=h.length;++E<b;)T[h[E].toLowerCase()]=E;return T}function au(h,T,E){var b=ui.exec(T.slice(E,E+1));return b?(h.w=+b[0],E+b[0].length):-1}function hc(h,T,E){var b=ui.exec(T.slice(E,E+1));return b?(h.u=+b[0],E+b[0].length):-1}function Ot(h,T,E){var b=ui.exec(T.slice(E,E+2));return b?(h.U=+b[0],E+b[0].length):-1}function Sr(h,T,E){var b=ui.exec(T.slice(E,E+2));return b?(h.V=+b[0],E+b[0].length):-1}function mr(h,T,E){var b=ui.exec(T.slice(E,E+2));return b?(h.W=+b[0],E+b[0].length):-1}function Rn(h,T,E){var b=ui.exec(T.slice(E,E+4));return b?(h.y=+b[0],E+b[0].length):-1}function w(h,T,E){var b=ui.exec(T.slice(E,E+2));return b?(h.y=+b[0]+(+b[0]>68?1900:2e3),E+b[0].length):-1}function p(h,T,E){var b=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(T.slice(E,E+6));return b?(h.Z=b[1]?0:-(b[2]+(b[3]||"00")),E+b[0].length):-1}function s(h,T,E){var b=ui.exec(T.slice(E,E+1));return b?(h.q=b[0]*3-3,E+b[0].length):-1}function d(h,T,E){var b=ui.exec(T.slice(E,E+2));return b?(h.m=b[0]-1,E+b[0].length):-1}function g(h,T,E){var b=ui.exec(T.slice(E,E+2));return b?(h.d=+b[0],E+b[0].length):-1}function L(h,T,E){var b=ui.exec(T.slice(E,E+3));return b?(h.m=0,h.d=+b[0],E+b[0].length):-1}function N(h,T,E){var b=ui.exec(T.slice(E,E+2));return b?(h.H=+b[0],E+b[0].length):-1}function K(h,T,E){var b=ui.exec(T.slice(E,E+2));return b?(h.M=+b[0],E+b[0].length):-1}function ee(h,T,E){var b=ui.exec(T.slice(E,E+2));return b?(h.S=+b[0],E+b[0].length):-1}function Z(h,T,E){var b=ui.exec(T.slice(E,E+3));return b?(h.L=+b[0],E+b[0].length):-1}function Se(h,T,E){var b=ui.exec(T.slice(E,E+6));return b?(h.L=Math.floor(b[0]/1e3),E+b[0].length):-1}function pe(h,T,E){var b=Zs.exec(T.slice(E,E+1));return b?E+b[0].length:-1}function Fe(h,T,E){var b=ui.exec(T.slice(E));return b?(h.Q=+b[0],E+b[0].length):-1}function mt(h,T,E){var b=ui.exec(T.slice(E));return b?(h.s=+b[0],E+b[0].length):-1}function Yt(h,T){return bn(h.getDate(),T,2)}function jt(h,T){return bn(h.getHours(),T,2)}function Qt(h,T){return bn(h.getHours()%12||12,T,2)}function ur(h,T){return bn(1+sn.count(fc(h),h),T,3)}function kr(h,T){return bn(h.getMilliseconds(),T,3)}function on(h,T){return kr(h,T)+"000"}function Gr(h,T){return bn(h.getMonth()+1,T,2)}function ln(h,T){return bn(h.getMinutes(),T,2)}function wn(h,T){return bn(h.getSeconds(),T,2)}function Gn(h){var T=h.getDay();return T===0?7:T}function ii(h,T){return bn(oh.count(fc(h)-1,h),T,2)}function Vi(h){var T=h.getDay();return T>=4||T===0?_f(h):_f.ceil(h)}function va(h,T){return h=Vi(h),bn(_f.count(fc(h),h)+(fc(h).getDay()===4),T,2)}function Ia(h){return h.getDay()}function qu(h,T){return bn($f.count(fc(h)-1,h),T,2)}function ts(h,T){return bn(h.getFullYear()%100,T,2)}function us(h,T){return h=Vi(h),bn(h.getFullYear()%100,T,2)}function Su(h,T){return bn(h.getFullYear()%1e4,T,4)}function Nf(h,T){var E=h.getDay();return h=E>=4||E===0?_f(h):_f.ceil(h),bn(h.getFullYear()%1e4,T,4)}function Ml(h){var T=h.getTimezoneOffset();return(T>0?"-":(T*=-1,"+"))+bn(T/60|0,"0",2)+bn(T%60,"0",2)}function Wc(h,T){return bn(h.getUTCDate(),T,2)}function _a(h,T){return bn(h.getUTCHours(),T,2)}function Da(h,T){return bn(h.getUTCHours()%12||12,T,2)}function wc(h,T){return bn(1+Ho.count(Ma(h),h),T,3)}function pl(h,T){return bn(h.getUTCMilliseconds(),T,3)}function Xc(h,T){return pl(h,T)+"000"}function Jf(h,T){return bn(h.getUTCMonth()+1,T,2)}function po(h,T){return bn(h.getUTCMinutes(),T,2)}function vl(h,T){return bn(h.getUTCSeconds(),T,2)}function hf(h){var T=h.getUTCDay();return T===0?7:T}function df(h,T){return bn(Ur.count(Ma(h)-1,h),T,2)}function _h(h){var T=h.getUTCDay();return T>=4||T===0?un(h):un.ceil(h)}function Xa(h,T){return h=_h(h),bn(un.count(Ma(h),h)+(Ma(h).getUTCDay()===4),T,2)}function Cf(h){return h.getUTCDay()}function Ff(h,T){return bn(Kr.count(Ma(h)-1,h),T,2)}function Hh(h,T){return bn(h.getUTCFullYear()%100,T,2)}function Zh(h,T){return h=_h(h),bn(h.getUTCFullYear()%100,T,2)}function ed(h,T){return bn(h.getUTCFullYear()%1e4,T,4)}function Ch(h,T){var E=h.getUTCDay();return h=E>=4||E===0?un(h):un.ceil(h),bn(h.getUTCFullYear()%1e4,T,4)}function Qf(){return"+0000"}function td(){return"%"}function rd(h){return+h}function ld(h){return Math.floor(+h/1e3)}var xs,qf,cd,e,t;r({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function r(h){return xs=Hs(h),qf=xs.format,cd=xs.parse,e=xs.utcFormat,t=xs.utcParse,xs}var l=1e3,f=l*60,m=f*60,A=m*24,I=A*7,U=A*30,re=A*365;function he(h){return new Date(h)}function Ae(h){return h instanceof Date?+h:+new Date(+h)}function Pe(h,T,E,b,_,M,j,ae,ve){var je=sf(gs,gs),Rt=je.invert,Jt=je.domain,wr=ve(".%L"),Dr=ve(":%S"),xn=ve("%I:%M"),mn=ve("%I %p"),Bn=ve("%a %d"),Ei=ve("%b %d"),Ai=ve("%B"),za=ve("%Y"),oa=[[j,1,l],[j,5,5*l],[j,15,15*l],[j,30,30*l],[M,1,f],[M,5,5*f],[M,15,15*f],[M,30,30*f],[_,1,m],[_,3,3*m],[_,6,6*m],[_,12,12*m],[b,1,A],[b,2,2*A],[E,1,I],[T,1,U],[T,3,3*U],[h,1,re]];function sa(_i){return(j(_i)<_i?wr:M(_i)<_i?Dr:_(_i)<_i?xn:b(_i)<_i?mn:T(_i)<_i?E(_i)<_i?Bn:Ei:h(_i)<_i?Ai:za)(_i)}function to(_i,ro,To,Xs){if(_i==null&&(_i=10),typeof _i=="number"){var Wi=Math.abs(To-ro)/_i,Cs=hl(function(rs){return rs[2]}).right(oa,Wi);Cs===oa.length?(Xs=c(ro/re,To/re,_i),_i=h):Cs?(Cs=oa[Wi/oa[Cs-1][2]<oa[Cs][2]/Wi?Cs-1:Cs],Xs=Cs[1],_i=Cs[0]):(Xs=Math.max(c(ro,To,_i),1),_i=ae)}return Xs==null?_i:_i.every(Xs)}return je.invert=function(_i){return new Date(Rt(_i))},je.domain=function(_i){return arguments.length?Jt(qa.call(_i,Ae)):Jt().map(he)},je.ticks=function(_i,ro){var To=Jt(),Xs=To[0],Wi=To[To.length-1],Cs=Wi<Xs,rs;return Cs&&(rs=Xs,Xs=Wi,Wi=rs),rs=to(_i,Xs,Wi,ro),rs=rs?rs.range(Xs,Wi+1):[],Cs?rs.reverse():rs},je.tickFormat=function(_i,ro){return ro==null?sa:ve(ro)},je.nice=function(_i,ro){var To=Jt();return(_i=to(_i,To[0],To[To.length-1],ro))?Jt(z(To,_i)):je},je.copy=function(){return Qu(je,Pe(h,T,E,b,_,M,j,ae,ve))},je}var ot=function(){return hr.apply(Pe(fc,Xf,oh,sn,fn,rn,Xr,qn,qf).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},wt=bi(function(h){h.setUTCDate(1),h.setUTCHours(0,0,0,0)},function(h,T){h.setUTCMonth(h.getUTCMonth()+T)},function(h,T){return T.getUTCMonth()-h.getUTCMonth()+(T.getUTCFullYear()-h.getUTCFullYear())*12},function(h){return h.getUTCMonth()}),Tt=wt,Wt=wt.range,Zt=bi(function(h){h.setUTCMinutes(0,0,0)},function(h,T){h.setTime(+h+T*Kf)},function(h,T){return(T-h)/Kf},function(h){return h.getUTCHours()}),nr=Zt,dr=Zt.range,br=bi(function(h){h.setUTCSeconds(0,0)},function(h,T){h.setTime(+h+T*ff)},function(h,T){return(T-h)/ff},function(h){return h.getUTCMinutes()}),zr=br,Rr=br.range,pn=function(){return hr.apply(Pe(Ma,Tt,Ur,Ho,nr,zr,Xr,qn,e).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function hn(){var h=0,T=1,E,b,_,M,j=gs,ae=!1,ve;function je(Rt){return isNaN(Rt=+Rt)?ve:j(_===0?.5:(Rt=(M(Rt)-E)*_,ae?Math.max(0,Math.min(1,Rt)):Rt))}return je.domain=function(Rt){return arguments.length?(E=M(h=+Rt[0]),b=M(T=+Rt[1]),_=E===b?0:1/(b-E),je):[h,T]},je.clamp=function(Rt){return arguments.length?(ae=!!Rt,je):ae},je.interpolator=function(Rt){return arguments.length?(j=Rt,je):j},je.unknown=function(Rt){return arguments.length?(ve=Rt,je):ve},function(Rt){return M=Rt,E=Rt(h),b=Rt(T),_=E===b?0:1/(b-E),je}}function Ln(h,T){return T.domain(h.domain()).interpolator(h.interpolator()).clamp(h.clamp()).unknown(h.unknown())}function Jn(){var h=Hl(hn()(gs));return h.copy=function(){return Ln(h,Jn())},Tr.apply(h,arguments)}function Kn(){var h=zn(hn()).domain([1,10]);return h.copy=function(){return Ln(h,Kn()).base(h.base())},Tr.apply(h,arguments)}function Nn(){var h=Oi(hn());return h.copy=function(){return Ln(h,Nn()).constant(h.constant())},Tr.apply(h,arguments)}function Si(){var h=So(hn());return h.copy=function(){return Ln(h,Si()).exponent(h.exponent())},Tr.apply(h,arguments)}function li(){return Si.apply(null,arguments).exponent(.5)}function ei(){var h=[],T=gs;function E(b){if(!isNaN(b=+b))return T((ms(h,b)-1)/(h.length-1))}return E.domain=function(b){if(!arguments.length)return h.slice();h=[];for(var _=0,M=b.length,j;_<M;++_)j=b[_],j!=null&&!isNaN(j=+j)&&h.push(j);return h.sort(fl),E},E.interpolator=function(b){return arguments.length?(T=b,E):T},E.copy=function(){return ei(T).domain(h)},Tr.apply(E,arguments)}function Ki(){var h=0,T=.5,E=1,b,_,M,j,ae,ve=gs,je,Rt=!1,Jt;function wr(Dr){return isNaN(Dr=+Dr)?Jt:(Dr=.5+((Dr=+je(Dr))-_)*(Dr<_?j:ae),ve(Rt?Math.max(0,Math.min(1,Dr)):Dr))}return wr.domain=function(Dr){return arguments.length?(b=je(h=+Dr[0]),_=je(T=+Dr[1]),M=je(E=+Dr[2]),j=b===_?0:.5/(_-b),ae=_===M?0:.5/(M-_),wr):[h,T,E]},wr.clamp=function(Dr){return arguments.length?(Rt=!!Dr,wr):Rt},wr.interpolator=function(Dr){return arguments.length?(ve=Dr,wr):ve},wr.unknown=function(Dr){return arguments.length?(Jt=Dr,wr):Jt},function(Dr){return je=Dr,b=Dr(h),_=Dr(T),M=Dr(E),j=b===_?0:.5/(_-b),ae=_===M?0:.5/(M-_),wr}}function Ri(){var h=Hl(Ki()(gs));return h.copy=function(){return Ln(h,Ri())},Tr.apply(h,arguments)}function Va(){var h=zn(Ki()).domain([.1,1,10]);return h.copy=function(){return Ln(h,Va()).base(h.base())},Tr.apply(h,arguments)}function mi(){var h=Oi(Ki());return h.copy=function(){return Ln(h,mi()).constant(h.constant())},Tr.apply(h,arguments)}function ia(){var h=So(Ki());return h.copy=function(){return Ln(h,ia()).exponent(h.exponent())},Tr.apply(h,arguments)}function Zo(){return ia.apply(null,arguments).exponent(.5)}var ba,Wo,Xo,ls,Eu,cs,el,ou,tl,su=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Ws=(ba={},Oe()(ba,S.ScaleTypes.LINEAR,ne),Oe()(ba,S.ScaleTypes.POWER,Ya),Oe()(ba,S.ScaleTypes.LOG,Xn),Oe()(ba,S.ScaleTypes.IDENTITY,se),Oe()(ba,S.ScaleTypes.TIME,ot),Oe()(ba,S.ScaleTypes.QUANTILE,ea),Oe()(ba,S.ScaleTypes.QUANTIZE,fo),Oe()(ba,S.ScaleTypes.THRESHOLD,iu),Oe()(ba,S.ScaleTypes.CAT,Ea),ba),uu=(Wo=Object(ar.injectable)(),Xo=Object(ar.inject)(S.TYPES.IGlobalConfigService),ls=Object(ar.inject)(S.TYPES.ILogService),Wo(Eu=(cs=(tl=function(){function h(){X()(this,h),Le()(this,"configService",el,this),Le()(this,"logger",ou,this),this.scaleCache={},this.scaleOptions={}}return a()(h,[{key:"apply",value:function(E,b){var _=this,M=b.styleAttributeService;E.hooks.init.tap("FeatureScalePlugin",function(){_.scaleOptions=E.getScaleOptions();var j=M.getLayerStyleAttributes(),ae=E.getSource().data.dataArray;ae.length!==0&&_.caculateScalesForAttributes(j||[],ae)}),E.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){_.scaleOptions=E.getScaleOptions();var j=M.getLayerStyleAttributes(),ae=E.getSource().data.dataArray;return _.caculateScalesForAttributes(j||[],ae),E.layerModelNeedUpdate=!0,!0}),E.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!E.layerModelNeedUpdate){_.scaleOptions=E.getScaleOptions();var j=M.getLayerStyleAttributes();if(j){var ae=E.getSource().data.dataArray;if(ae.length===0)return;var ve=j.filter(function(je){return je.needRescale});ve.length&&(_.caculateScalesForAttributes(ve,ae),_.logger.debug("rescale finished"))}}})}},{key:"isNumber",value:function(E){return!isNaN(parseFloat(E))&&isFinite(E)}},{key:"caculateScalesForAttributes",value:function(E,b){var _=this;this.scaleCache={},E.forEach(function(M){if(M.scale){var j=M.scale,ae=M.name;j.names=_.parseFields(M.scale.field||[]);var ve=[];j.names.forEach(function(je){ve.push(_.getOrCreateScale(je,M,b))}),ve.some(function(je){return je.type===S.StyleScaleType.VARIABLE})?(j.type=S.StyleScaleType.VARIABLE,ve.forEach(function(je){if(!j.callback){var Rt;if(j.values&&j.values!=="text"){var Jt;if(((Jt=je.option)===null||Jt===void 0?void 0:Jt.type)==="linear"&&j.values.length>2){var wr=je.scale.ticks(j.values.length);ae==="color"&&je.scale.domain(wr)}je.scale.range(j.values)}else((Rt=je.option)===null||Rt===void 0?void 0:Rt.type)==="cat"&&je.scale.range(je.option.domain)}})):(j.type=S.StyleScaleType.CONSTANT,j.defaultValues=ve.map(function(je,Rt){return je.scale(j.names[Rt])})),j.scalers=ve.map(function(je){return{field:je.field,func:je.scale,option:je.option}}),M.needRescale=!1}})}},{key:"getOrCreateScale",value:function(E,b,_){var M,j=[E,b.name].join("_"),ae=(M=b.scale)===null||M===void 0?void 0:M.values,ve=this.createScale(E,b.name,ae,_);return ve}},{key:"parseFields",value:function(E){return Array.isArray(E)?E:ec()(E)?E.split("*"):[E]}},{key:"createScale",value:function(E,b,_,M){var j,ae=this.scaleOptions[b]&&this.scaleOptions[b].field===E?this.scaleOptions[b]:this.scaleOptions[E],ve={field:E,scale:void 0,type:S.StyleScaleType.VARIABLE,option:ae};if(!M||!M.length)return ae&&ae.type?ve.scale=this.createDefaultScale(ae):(ve.scale=Ea([E]),ve.type=S.StyleScaleType.CONSTANT),ve;var je=(j=M.find(function(wr){return!Za()(wr[E])}))===null||j===void 0?void 0:j[E];if(this.isNumber(E)||Za()(je)&&!ae)ve.scale=Ea([E]),ve.type=S.StyleScaleType.CONSTANT;else{var Rt=ae&&ae.type||this.getDefaultType(je);_==="text"&&(Rt=S.ScaleTypes.CAT);var Jt=this.createDefaultScaleConfig(Rt,E,M);Object.assign(Jt,ae),ve.scale=this.createDefaultScale(Jt),ve.option=Jt}return ve}},{key:"getDefaultType",value:function(E){var b=S.ScaleTypes.LINEAR;return typeof E=="string"&&(b=su.test(E)?S.ScaleTypes.TIME:S.ScaleTypes.CAT),b}},{key:"createDefaultScaleConfig",value:function(E,b,_){var M={type:E},j=(_==null?void 0:_.map(function(ae){return ae[b]}))||[];return E!==S.ScaleTypes.CAT&&E!==S.ScaleTypes.QUANTILE?M.domain=Iu(j):E===S.ScaleTypes.CAT?M.domain=ru()(j):E===S.ScaleTypes.QUANTILE&&(M.domain=j),M}},{key:"createDefaultScale",value:function(E){var b=E.type,_=E.domain,M=Ws[b]();return _&&M.domain(_),M}}]),h}(),tl),el=Ze()(cs.prototype,"configService",[Xo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ou=Ze()(cs.prototype,"logger",[ls],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cs))||Eu),ma,aa,eo,vo,Tu,Eo,Yo,ku;function fa(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);T&&(b=b.filter(function(_){return Object.getOwnPropertyDescriptor(h,_).enumerable})),E.push.apply(E,b)}return E}function eh(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?fa(Object(E),!0).forEach(function(b){Oe()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):fa(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}var Yc=(ma=Object(ar.injectable)(),aa=Object(ar.inject)(S.TYPES.ICameraService),eo=Object(ar.inject)(S.TYPES.IRendererService),ma(vo=(Tu=(ku=function(){function h(){X()(this,h),Le()(this,"cameraService",Eo,this),Le()(this,"rendererService",Yo,this)}return a()(h,[{key:"apply",value:function(E){E.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){E.models.forEach(function(b){b.addUniforms(eh({},E.layerModel.getAnimateUniforms()))})})}}]),h}(),ku),Eo=Ze()(Tu.prototype,"cameraService",[aa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yo=Ze()(Tu.prototype,"rendererService",[eo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tu))||vo),pf,dc,ju=(pf=Object(ar.injectable)(),pf(dc=function(){function h(){X()(this,h)}return a()(h,[{key:"apply",value:function(E){E.hooks.init.tap("LayerModelPlugin",function(){E.prepareBuildModel(),E.buildModels(),E.styleNeedUpdate=!1}),E.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return E.prepareBuildModel(),E.clearModels(),E.buildModels(),E.layerModelNeedUpdate=!1,!1})}}]),h}())||dc),Bf,kf,th=(Bf=Object(ar.injectable)(),Bf(kf=function(){function h(){X()(this,h)}return a()(h,[{key:"apply",value:function(E){E.hooks.afterInit.tap("LayerStylePlugin",function(){E.updateLayerConfig({});var b=E.getLayerConfig(),_=b.autoFit,M=b.fitBoundsOptions;_&&setTimeout(function(){E.fitBounds(M)},100)})}}]),h}())||kf),wh,wf;function Ph(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);T&&(b=b.filter(function(_){return Object.getOwnPropertyDescriptor(h,_).enumerable})),E.push.apply(E,b)}return E}function rh(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?Ph(Object(E),!0).forEach(function(b){Oe()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):Ph(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}var ph={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Wh={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},Bh={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Xh={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},vh=["ambient","diffuse","specular"];function Mh(h){var T={u_DirectionalLights:new Array(3).fill(rh({},Bh)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(rh({},Xh)),u_NumOfSpotLights:0};return(!h||!h.length)&&(h=[Wh]),h.forEach(function(E,b){var _=E.type,M=_===void 0?"directional":_,j=Ke()(E,["type"]),ae=ph[M].lights,ve=ph[M].num,je=T[ve];T[ae][je]=rh(rh({},T[ae][je]),j),T[ve]++}),T}var Yh=(wh=Object(ar.injectable)(),wh(wf=function(){function h(){X()(this,h)}return a()(h,[{key:"apply",value:function(E){E.hooks.beforeRender.tap("LightingPlugin",function(){var b=E.getLayerConfig(),_=b.enableLighting;_&&E.models.forEach(function(M){return M.addUniforms(rh({},Mh()))})})}}]),h}())||wf),mh,nh,sh={NONE:0,ENCODE:1,HIGHLIGHT:2},Kh=(mh=Object(ar.injectable)(),mh(nh=function(){function h(){X()(this,h)}return a()(h,[{key:"apply",value:function(E,b){var _=b.rendererService,M=b.styleAttributeService;E.hooks.init.tap("PixelPickingPlugin",function(){var j=E.getLayerConfig(),ae=j.enablePicking;M.registerStyleAttribute({name:"pickingColor",type:S.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:S.gl.FLOAT},size:3,update:function(je,Rt){var Jt=je.id;return ae?Object(Me.l)(Jt):[0,0,0]}}})}),E.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var j=E.getLayerConfig(),ae=j.enablePicking;ae&&E.isVisible()&&E.models.forEach(function(ve){return ve.addUniforms({u_PickingStage:sh.ENCODE})})}),E.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var j=E.getLayerConfig(),ae=j.enablePicking;ae&&E.isVisible()&&E.models.forEach(function(ve){return ve.addUniforms({u_PickingStage:sh.HIGHLIGHT})})}),E.hooks.beforeHighlight.tap("PixelPickingPlugin",function(j){var ae=E.getLayerConfig(),ve=ae.highlightColor,je=typeof ve=="string"?Object(Me.s)(ve):ve||[1,0,0,1];E.updateLayerConfig({pickedFeatureID:Object(Me.k)(new Uint8Array(j))}),E.models.forEach(function(Rt){return Rt.addUniforms({u_PickingStage:sh.HIGHLIGHT,u_PickingColor:j,u_HighlightColor:je.map(function(Jt){return Jt*255})})})}),E.hooks.beforeSelect.tap("PixelPickingPlugin",function(j){var ae=E.getLayerConfig(),ve=ae.selectColor,je=typeof ve=="string"?Object(Me.s)(ve):ve||[1,0,0,1];E.updateLayerConfig({pickedFeatureID:Object(Me.k)(new Uint8Array(j))}),E.models.forEach(function(Rt){return Rt.addUniforms({u_PickingStage:sh.HIGHLIGHT,u_PickingColor:j,u_HighlightColor:je.map(function(Jt){return Jt*255})})})})}}]),h}())||nh),kh,gh,jh,Ih,yh,Uh,Vh=(kh=Object(ar.injectable)(),gh=Object(ar.inject)(S.TYPES.ILogService),kh(jh=(Ih=(Uh=function(){function h(){X()(this,h),Le()(this,"logger",yh,this)}return a()(h,[{key:"apply",value:function(E,b){var _=this,M=b.styleAttributeService;E.hooks.init.tap("RegisterStyleAttributePlugin",function(){_.registerBuiltinAttributes(M)})}},{key:"registerBuiltinAttributes",value:function(E){E.registerStyleAttribute({name:"position",type:S.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:S.gl.FLOAT},size:3,update:function(_,M,j){return j.length===2?[j[0],j[1],0]:[j[0],j[1],j[2]]}}}),E.registerStyleAttribute({name:"filter",type:S.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(_,M){var j=_.filter;return j?[1]:[0]}}}),E.registerStyleAttribute({name:"color",type:S.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:4,update:function(_,M){var j=_.color;return!j||!j.length?[1,1,1,1]:j}}})}}]),h}(),Uh),yh=Ze()(Ih.prototype,"logger",[gh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ih))||jh),Oh,Lh,xh,Rh,bh,jf,Dh,$h,Jh,nd,id=(Oh=Object(ar.injectable)(),Lh=Object(ar.inject)(S.TYPES.ICameraService),xh=Object(ar.inject)(S.TYPES.ICoordinateSystemService),Rh=Object(ar.inject)(S.TYPES.IRendererService),Oh(bh=(jf=(nd=function(){function h(){X()(this,h),Le()(this,"cameraService",Dh,this),Le()(this,"coordinateSystemService",$h,this),Le()(this,"rendererService",Jh,this)}return a()(h,[{key:"apply",value:function(E){var b=this;E.hooks.beforeRender.tap("ShaderUniformPlugin",function(){b.coordinateSystemService.refresh();var _=b.rendererService.getViewportSize(),M=_.width,j=_.height;E.models.forEach(function(ae){var ve;return ae.addUniforms((ve={},Oe()(ve,S.CameraUniform.ProjectionMatrix,b.cameraService.getProjectionMatrix()),Oe()(ve,S.CameraUniform.ViewMatrix,b.cameraService.getViewMatrix()),Oe()(ve,S.CameraUniform.ViewProjectionMatrix,b.cameraService.getViewProjectionMatrix()),Oe()(ve,S.CameraUniform.Zoom,b.cameraService.getZoom()),Oe()(ve,S.CameraUniform.ZoomScale,b.cameraService.getZoomScale()),Oe()(ve,S.CameraUniform.FocalDistance,b.cameraService.getFocalDistance()),Oe()(ve,S.CameraUniform.CameraPosition,b.cameraService.getCameraPosition()),Oe()(ve,S.CoordinateUniform.CoordinateSystem,b.coordinateSystemService.getCoordinateSystem()),Oe()(ve,S.CoordinateUniform.ViewportCenter,b.coordinateSystemService.getViewportCenter()),Oe()(ve,S.CoordinateUniform.ViewportCenterProjection,b.coordinateSystemService.getViewportCenterProjection()),Oe()(ve,S.CoordinateUniform.PixelsPerDegree,b.coordinateSystemService.getPixelsPerDegree()),Oe()(ve,S.CoordinateUniform.PixelsPerDegree2,b.coordinateSystemService.getPixelsPerDegree2()),Oe()(ve,S.CoordinateUniform.PixelsPerMeter,b.coordinateSystemService.getPixelsPerMeter()),Oe()(ve,"u_ViewportSize",[M,j]),Oe()(ve,"u_DevicePixelRatio",window.devicePixelRatio),Oe()(ve,"u_ModelMatrix",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Oe()(ve,"u_PickingBuffer",E.getLayerConfig().pickingBuffer||0),ve))})})}}]),h}(),nd),Dh=Ze()(jf.prototype,"cameraService",[Lh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$h=Ze()(jf.prototype,"coordinateSystemService",[xh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jh=Ze()(jf.prototype,"rendererService",[Rh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jf))||bh),ad,Qh,Sd=(ad=Object(ar.injectable)(),ad(Qh=function(){function h(){X()(this,h)}return a()(h,[{key:"apply",value:function(E){E.hooks.beforeRender.tap("UpdateModelPlugin",function(){E.layerModel&&E.layerModel.needUpdate()})}}]),h}())||Qh),fd,zh,bs,Kc,hd,ih,od=(fd=Object(ar.injectable)(),zh=Object(ar.inject)(S.TYPES.ILogService),fd(bs=(Kc=(ih=function(){function h(){X()(this,h),Le()(this,"logger",hd,this)}return a()(h,[{key:"apply",value:function(E,b){var _=this,M=b.styleAttributeService;E.hooks.init.tap("UpdateStyleAttributePlugin",function(){_.initStyleAttribute(E,{styleAttributeService:M})}),E.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){E.layerModelNeedUpdate||_.updateStyleAtrribute(E,{styleAttributeService:M})})}},{key:"updateStyleAtrribute",value:function(E,b){var _=this,M=b.styleAttributeService,j=M.getLayerStyleAttributes()||[],ae=M.getLayerStyleAttribute("filter"),ve=M.getLayerStyleAttribute("shape");if(ae&&ae.needRegenerateVertices||ve&&ve.needRegenerateVertices){E.layerModelNeedUpdate=!0,j.forEach(function(je){return je.needRegenerateVertices=!1});return}j.filter(function(je){return je.needRegenerateVertices}).forEach(function(je){M.updateAttributeByFeatureRange(je.name,E.getEncodedData(),je.featureRange.startIndex,je.featureRange.endIndex),je.needRegenerateVertices=!1,_.logger.debug("regenerate vertex attributes: ".concat(je.name," finished"))})}},{key:"initStyleAttribute",value:function(E,b){var _=this,M=b.styleAttributeService,j=M.getLayerStyleAttributes()||[];j.filter(function(ae){return ae.needRegenerateVertices}).forEach(function(ae){M.updateAttributeByFeatureRange(ae.name,E.getEncodedData(),ae.featureRange.startIndex,ae.featureRange.endIndex),ae.needRegenerateVertices=!1,_.logger.debug("init vertex attributes: ".concat(ae.name," finished"))})}}]),h}(),ih),hd=Ze()(Kc.prototype,"logger",[zh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kc))||bs);S.container.bind(S.TYPES.ILayerPlugin).to(ko).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(Vh).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(uu).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(Ec).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(th).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(od).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(Sd).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(rt).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(id).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(Yc).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(Yh).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(Kh).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(ju).inRequestScope()},t2Dn:function(Re,y,o){var S=o("hypo"),v=o("ljhN");function X(B,a,W){(W!==void 0&&!v(B[a],W)||W===void 0&&!(a in B))&&S(B,a,W)}Re.exports=X},u6S6:function(Re,y,o){var S=o("6acW"),v=o("sgoq"),X=v(function(B,a,W){return a=a.toLowerCase(),B+(W?S(a):a)});Re.exports=X},uhBA:function(Re,y,o){"use strict";var S=Object.prototype.hasOwnProperty,v="~";function X(){}Object.create&&(X.prototype=Object.create(null),new X().__proto__||(v=!1));function B(J,te,ce){this.fn=J,this.context=te,this.once=ce||!1}function a(J,te,ce,Y,ke){if(typeof ce!="function")throw new TypeError("The listener must be a function");var Ke=new B(ce,Y||J,ke),We=v?v+te:te;return J._events[We]?J._events[We].fn?J._events[We]=[J._events[We],Ke]:J._events[We].push(Ke):(J._events[We]=Ke,J._eventsCount++),J}function W(J,te){--J._eventsCount==0?J._events=new X:delete J._events[te]}function D(){this._events=new X,this._eventsCount=0}D.prototype.eventNames=function(){var te=[],ce,Y;if(this._eventsCount===0)return te;for(Y in ce=this._events)S.call(ce,Y)&&te.push(v?Y.slice(1):Y);return Object.getOwnPropertySymbols?te.concat(Object.getOwnPropertySymbols(ce)):te},D.prototype.listeners=function(te){var ce=v?v+te:te,Y=this._events[ce];if(!Y)return[];if(Y.fn)return[Y.fn];for(var ke=0,Ke=Y.length,We=new Array(Ke);ke<Ke;ke++)We[ke]=Y[ke].fn;return We},D.prototype.listenerCount=function(te){var ce=v?v+te:te,Y=this._events[ce];return Y?Y.fn?1:Y.length:0},D.prototype.emit=function(te,ce,Y,ke,Ke,We){var Oe=v?v+te:te;if(!this._events[Oe])return!1;var st=this._events[Oe],Le=arguments.length,xt,it;if(st.fn){switch(st.once&&this.removeListener(te,st.fn,void 0,!0),Le){case 1:return st.fn.call(st.context),!0;case 2:return st.fn.call(st.context,ce),!0;case 3:return st.fn.call(st.context,ce,Y),!0;case 4:return st.fn.call(st.context,ce,Y,ke),!0;case 5:return st.fn.call(st.context,ce,Y,ke,Ke),!0;case 6:return st.fn.call(st.context,ce,Y,ke,Ke,We),!0}for(it=1,xt=new Array(Le-1);it<Le;it++)xt[it-1]=arguments[it];st.fn.apply(st.context,xt)}else{var $e=st.length,Ze;for(it=0;it<$e;it++)switch(st[it].once&&this.removeListener(te,st[it].fn,void 0,!0),Le){case 1:st[it].fn.call(st[it].context);break;case 2:st[it].fn.call(st[it].context,ce);break;case 3:st[it].fn.call(st[it].context,ce,Y);break;case 4:st[it].fn.call(st[it].context,ce,Y,ke);break;default:if(!xt)for(Ze=1,xt=new Array(Le-1);Ze<Le;Ze++)xt[Ze-1]=arguments[Ze];st[it].fn.apply(st[it].context,xt)}}return!0},D.prototype.on=function(te,ce,Y){return a(this,te,ce,Y,!1)},D.prototype.once=function(te,ce,Y){return a(this,te,ce,Y,!0)},D.prototype.removeListener=function(te,ce,Y,ke){var Ke=v?v+te:te;if(!this._events[Ke])return this;if(!ce)return W(this,Ke),this;var We=this._events[Ke];if(We.fn)We.fn===ce&&(!ke||We.once)&&(!Y||We.context===Y)&&W(this,Ke);else{for(var Oe=0,st=[],Le=We.length;Oe<Le;Oe++)(We[Oe].fn!==ce||ke&&!We[Oe].once||Y&&We[Oe].context!==Y)&&st.push(We[Oe]);st.length?this._events[Ke]=st.length===1?st[0]:st:W(this,Ke)}return this},D.prototype.removeAllListeners=function(te){var ce;return te?(ce=v?v+te:te,this._events[ce]&&W(this,ce)):(this._events=new X,this._eventsCount=0),this},D.prototype.off=D.prototype.removeListener,D.prototype.addListener=D.prototype.on,D.prefixed=v,D.EventEmitter=D,Re.exports=D},ujMp:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.circularDependencyToException=y.listMetadataForTarget=y.listRegisteredBindingsForServiceIdentifier=y.getServiceIdentifierAsString=y.getFunctionName=void 0;var S=o("MON2");function v(te){if(typeof te=="function"){var ce=te;return ce.name}else{if(typeof te=="symbol")return te.toString();var ce=te;return ce}}y.getServiceIdentifierAsString=v;function X(te,ce,Y){var ke="",Ke=Y(te,ce);return Ke.length!==0&&(ke=`
Registered bindings:`,Ke.forEach(function(We){var Oe="Object";We.implementationType!==null&&(Oe=J(We.implementationType)),ke=ke+`
 `+Oe,We.constraint.metaData&&(ke=ke+" - "+We.constraint.metaData)})),ke}y.listRegisteredBindingsForServiceIdentifier=X;function B(te,ce){return te.parentRequest===null?!1:te.parentRequest.serviceIdentifier===ce?!0:B(te.parentRequest,ce)}function a(te){function ce(ke,Ke){Ke===void 0&&(Ke=[]);var We=v(ke.serviceIdentifier);return Ke.push(We),ke.parentRequest!==null?ce(ke.parentRequest,Ke):Ke}var Y=ce(te);return Y.reverse().join(" --> ")}function W(te){te.childRequests.forEach(function(ce){if(B(ce,ce.serviceIdentifier)){var Y=a(ce);throw new Error(S.CIRCULAR_DEPENDENCY+" "+Y)}else W(ce)})}y.circularDependencyToException=W;function D(te,ce){if(ce.isTagged()||ce.isNamed()){var Y="",ke=ce.getNamedTag(),Ke=ce.getCustomTags();return ke!==null&&(Y+=ke.toString()+`
`),Ke!==null&&Ke.forEach(function(We){Y+=We.toString()+`
`})," "+te+`
 `+te+" - "+Y}else return" "+te}y.listMetadataForTarget=D;function J(te){if(te.name)return te.name;var ce=te.toString(),Y=ce.match(/^function\s*([^\s(]+)/);return Y?Y[1]:"Anonymous function: "+ce}y.getFunctionName=J},"vN+2":function(Re,y){function o(){}Re.exports=o},"w/wX":function(Re,y,o){var S=o("QqLw"),v=o("ExA7"),X="[object Set]";function B(a){return v(a)&&S(a)==X}Re.exports=B},w26f:function(Re,y,o){(function(S){var v=200,X="__lodash_hash_undefined__",B=1/0,a="[object Function]",W="[object GeneratorFunction]",D=/[\\^$.*+?()[\]{}|]/g,J=/^\[object .+?Constructor\]$/,te=typeof S=="object"&&S&&S.Object===Object&&S,ce=typeof self=="object"&&self&&self.Object===Object&&self,Y=te||ce||Function("return this")();function ke(ht,Qe){var Vt=ht?ht.length:0;return!!Vt&&Oe(ht,Qe,0)>-1}function Ke(ht,Qe,Vt){for(var pr=-1,Zr=ht?ht.length:0;++pr<Zr;)if(Vt(Qe,ht[pr]))return!0;return!1}function We(ht,Qe,Vt,pr){for(var Zr=ht.length,cr=Vt+(pr?1:-1);pr?cr--:++cr<Zr;)if(Qe(ht[cr],cr,ht))return cr;return-1}function Oe(ht,Qe,Vt){if(Qe!==Qe)return We(ht,st,Vt);for(var pr=Vt-1,Zr=ht.length;++pr<Zr;)if(ht[pr]===Qe)return pr;return-1}function st(ht){return ht!==ht}function Le(ht,Qe){return ht.has(Qe)}function xt(ht,Qe){return ht==null?void 0:ht[Qe]}function it(ht){var Qe=!1;if(ht!=null&&typeof ht.toString!="function")try{Qe=!!(ht+"")}catch(Vt){}return Qe}function $e(ht){var Qe=-1,Vt=Array(ht.size);return ht.forEach(function(pr){Vt[++Qe]=pr}),Vt}var Ze=Array.prototype,St=Function.prototype,bt=Object.prototype,Ne=Y["__core-js_shared__"],ze=function(){var ht=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||"");return ht?"Symbol(src)_1."+ht:""}(),Ue=St.toString,lt=bt.hasOwnProperty,Me=bt.toString,ct=RegExp("^"+Ue.call(lt).replace(D,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Gt=Ze.splice,$t=ie(Y,"Map"),ar=ie(Y,"Set"),oe=ie(Object,"create");function Q(ht){var Qe=-1,Vt=ht?ht.length:0;for(this.clear();++Qe<Vt;){var pr=ht[Qe];this.set(pr[0],pr[1])}}function G(){this.__data__=oe?oe(null):{}}function Ce(ht){return this.has(ht)&&delete this.__data__[ht]}function be(ht){var Qe=this.__data__;if(oe){var Vt=Qe[ht];return Vt===X?void 0:Vt}return lt.call(Qe,ht)?Qe[ht]:void 0}function Te(ht){var Qe=this.__data__;return oe?Qe[ht]!==void 0:lt.call(Qe,ht)}function me(ht,Qe){var Vt=this.__data__;return Vt[ht]=oe&&Qe===void 0?X:Qe,this}Q.prototype.clear=G,Q.prototype.delete=Ce,Q.prototype.get=be,Q.prototype.has=Te,Q.prototype.set=me;function rt(ht){var Qe=-1,Vt=ht?ht.length:0;for(this.clear();++Qe<Vt;){var pr=ht[Qe];this.set(pr[0],pr[1])}}function Kt(){this.__data__=[]}function _t(ht){var Qe=this.__data__,Vt=yt(Qe,ht);if(Vt<0)return!1;var pr=Qe.length-1;return Vt==pr?Qe.pop():Gt.call(Qe,Vt,1),!0}function ge(ht){var Qe=this.__data__,Vt=yt(Qe,ht);return Vt<0?void 0:Qe[Vt][1]}function ye(ht){return yt(this.__data__,ht)>-1}function Ve(ht,Qe){var Vt=this.__data__,pr=yt(Vt,ht);return pr<0?Vt.push([ht,Qe]):Vt[pr][1]=Qe,this}rt.prototype.clear=Kt,rt.prototype.delete=_t,rt.prototype.get=ge,rt.prototype.has=ye,rt.prototype.set=Ve;function ft(ht){var Qe=-1,Vt=ht?ht.length:0;for(this.clear();++Qe<Vt;){var pr=ht[Qe];this.set(pr[0],pr[1])}}function Ie(){this.__data__={hash:new Q,map:new($t||rt),string:new Q}}function pt(ht){return Ye(this,ht).delete(ht)}function C(ht){return Ye(this,ht).get(ht)}function R(ht){return Ye(this,ht).has(ht)}function q(ht,Qe){return Ye(this,ht).set(ht,Qe),this}ft.prototype.clear=Ie,ft.prototype.delete=pt,ft.prototype.get=C,ft.prototype.has=R,ft.prototype.set=q;function fe(ht){var Qe=-1,Vt=ht?ht.length:0;for(this.__data__=new ft;++Qe<Vt;)this.add(ht[Qe])}function Ge(ht){return this.__data__.set(ht,X),this}function Je(ht){return this.__data__.has(ht)}fe.prototype.add=fe.prototype.push=Ge,fe.prototype.has=Je;function yt(ht,Qe){for(var Vt=ht.length;Vt--;)if(vt(ht[Vt][0],Qe))return Vt;return-1}function nt(ht){if(!gt(ht)||Bt(ht))return!1;var Qe=Ct(ht)||it(ht)?ct:J;return Qe.test(lr(ht))}function Nt(ht,Qe,Vt){var pr=-1,Zr=ke,cr=ht.length,jn=!0,Sn=[],ai=Sn;if(Vt)jn=!1,Zr=Ke;else if(cr>=v){var fi=Qe?null:$(ht);if(fi)return $e(fi);jn=!1,Zr=Le,ai=new fe}else ai=Qe?[]:Sn;e:for(;++pr<cr;){var Zn=ht[pr],Hn=Qe?Qe(Zn):Zn;if(Zn=Vt||Zn!==0?Zn:0,jn&&Hn===Hn){for(var k=ai.length;k--;)if(ai[k]===Hn)continue e;Qe&&ai.push(Hn),Sn.push(Zn)}else Zr(ai,Hn,Vt)||(ai!==Sn&&ai.push(Hn),Sn.push(Zn))}return Sn}var $=ar&&1/$e(new ar([,-0]))[1]==B?function(ht){return new ar(ht)}:we;function Ye(ht,Qe){var Vt=ht.__data__;return et(Qe)?Vt[typeof Qe=="string"?"string":"hash"]:Vt.map}function ie(ht,Qe){var Vt=xt(ht,Qe);return nt(Vt)?Vt:void 0}function et(ht){var Qe=typeof ht;return Qe=="string"||Qe=="number"||Qe=="symbol"||Qe=="boolean"?ht!=="__proto__":ht===null}function Bt(ht){return!!ze&&ze in ht}function lr(ht){if(ht!=null){try{return Ue.call(ht)}catch(Qe){}try{return ht+""}catch(Qe){}}return""}function dt(ht){return ht&&ht.length?Nt(ht):[]}function vt(ht,Qe){return ht===Qe||ht!==ht&&Qe!==Qe}function Ct(ht){var Qe=gt(ht)?Me.call(ht):"";return Qe==a||Qe==W}function gt(ht){var Qe=typeof ht;return!!ht&&(Qe=="object"||Qe=="function")}function we(){}Re.exports=dt}).call(this,o("yLpj"))},wclG:function(Re,y,o){var S=o("pFRH"),v=o("88Gu"),X=v(S);Re.exports=X},wnjb:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.MetadataReader=void 0;var S=o("xfSm"),v=function(){function X(){}return X.prototype.getConstructorMetadata=function(B){var a=Reflect.getMetadata(S.PARAM_TYPES,B),W=Reflect.getMetadata(S.TAGGED,B);return{compilerGeneratedMetadata:a,userGeneratedMetadata:W||{}}},X.prototype.getPropertiesMetadata=function(B){var a=Reflect.getMetadata(S.TAGGED_PROP,B)||[];return a},X}();y.MetadataReader=v},wrZu:function(Re,y,o){var S=o("+K+b"),v=o("XYm9"),X=o("b2z7"),B=o("otv/"),a=o("yP5f"),W="[object Boolean]",D="[object Date]",J="[object Map]",te="[object Number]",ce="[object RegExp]",Y="[object Set]",ke="[object String]",Ke="[object Symbol]",We="[object ArrayBuffer]",Oe="[object DataView]",st="[object Float32Array]",Le="[object Float64Array]",xt="[object Int8Array]",it="[object Int16Array]",$e="[object Int32Array]",Ze="[object Uint8Array]",St="[object Uint8ClampedArray]",bt="[object Uint16Array]",Ne="[object Uint32Array]";function ze(Ue,lt,Me){var ct=Ue.constructor;switch(lt){case We:return S(Ue);case W:case D:return new ct(+Ue);case Oe:return v(Ue,Me);case st:case Le:case xt:case it:case $e:case Ze:case St:case bt:case Ne:return a(Ue,Me);case J:return new ct;case te:case ke:return new ct(Ue);case ce:return X(Ue);case Y:return new ct;case Ke:return B(Ue)}}Re.exports=ze},wy8a:function(Re,y,o){var S=o("KxBF");function v(X,B,a){var W=X.length;return a=a===void 0?W:a,!B&&a>=W?X:S(X,B,a)}Re.exports=v},xfSm:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.POST_CONSTRUCT=y.DESIGN_PARAM_TYPES=y.PARAM_TYPES=y.TAGGED_PROP=y.TAGGED=y.MULTI_INJECT_TAG=y.INJECT_TAG=y.OPTIONAL_TAG=y.UNMANAGED_TAG=y.NAME_TAG=y.NAMED_TAG=void 0,y.NAMED_TAG="named",y.NAME_TAG="name",y.UNMANAGED_TAG="unmanaged",y.OPTIONAL_TAG="optional",y.INJECT_TAG="inject",y.MULTI_INJECT_TAG="multi_inject",y.TAGGED="inversify:tagged",y.TAGGED_PROP="inversify:tagged_props",y.PARAM_TYPES="inversify:paramtypes",y.DESIGN_PARAM_TYPES="design:paramtypes",y.POST_CONSTRUCT="post_construct"},xfeJ:function(Re,y){function o(S){return Function.toString.call(S).indexOf("[native code]")!==-1}Re.exports=o},xiII:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Request=void 0;var S=o("d9O0"),v=function(){function X(B,a,W,D,J){this.id=S.id(),this.serviceIdentifier=B,this.parentContext=a,this.parentRequest=W,this.target=J,this.childRequests=[],this.bindings=Array.isArray(D)?D:[D],this.requestScope=W===null?new Map:null}return X.prototype.addChildRequest=function(B,a,W){var D=new X(B,this.parentContext,this,a,W);return this.childRequests.push(D),D},X}();y.Request=v},xp6e:function(Re,y,o){"use strict";(function(S){o.d(y,"a",function(){return be}),o.d(y,"b",function(){return Kt}),o.d(y,"c",function(){return oe}),o.d(y,"d",function(){return rt});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function v(_t,ge,ye,Ve){function ft(Ie){return Ie instanceof ye?Ie:new ye(function(pt){pt(Ie)})}return new(ye||(ye=Promise))(function(Ie,pt){function C(fe){try{q(Ve.next(fe))}catch(Ge){pt(Ge)}}function R(fe){try{q(Ve.throw(fe))}catch(Ge){pt(Ge)}}function q(fe){fe.done?Ie(fe.value):ft(fe.value).then(C,R)}q((Ve=Ve.apply(_t,ge||[])).next())})}function X(_t,ge){var ye={label:0,sent:function(){if(Ie[0]&1)throw Ie[1];return Ie[1]},trys:[],ops:[]},Ve,ft,Ie,pt;return pt={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(pt[Symbol.iterator]=function(){return this}),pt;function C(q){return function(fe){return R([q,fe])}}function R(q){if(Ve)throw new TypeError("Generator is already executing.");for(;ye;)try{if(Ve=1,ft&&(Ie=q[0]&2?ft.return:q[0]?ft.throw||((Ie=ft.return)&&Ie.call(ft),0):ft.next)&&!(Ie=Ie.call(ft,q[1])).done)return Ie;switch(ft=0,Ie&&(q=[q[0]&2,Ie.value]),q[0]){case 0:case 1:Ie=q;break;case 4:return ye.label++,{value:q[1],done:!1};case 5:ye.label++,ft=q[1],q=[0];continue;case 7:q=ye.ops.pop(),ye.trys.pop();continue;default:if(Ie=ye.trys,!(Ie=Ie.length>0&&Ie[Ie.length-1])&&(q[0]===6||q[0]===2)){ye=0;continue}if(q[0]===3&&(!Ie||q[1]>Ie[0]&&q[1]<Ie[3])){ye.label=q[1];break}if(q[0]===6&&ye.label<Ie[1]){ye.label=Ie[1],Ie=q;break}if(Ie&&ye.label<Ie[2]){ye.label=Ie[2],ye.ops.push(q);break}Ie[2]&&ye.ops.pop(),ye.trys.pop();continue}q=ge.call(_t,ye)}catch(fe){q=[6,fe],ft=0}finally{Ve=Ie=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}}function B(_t,ge){var ye=typeof Symbol=="function"&&_t[Symbol.iterator];if(!ye)return _t;var Ve=ye.call(_t),ft,Ie=[],pt;try{for(;(ge===void 0||ge-- >0)&&!(ft=Ve.next()).done;)Ie.push(ft.value)}catch(C){pt={error:C}}finally{try{ft&&!ft.done&&(ye=Ve.return)&&ye.call(Ve)}finally{if(pt)throw pt.error}}return Ie}function a(){for(var _t=[],ge=0;ge<arguments.length;ge++)_t=_t.concat(B(arguments[ge]));return _t}function W(_t){return _t&&_t.__esModule&&Object.prototype.hasOwnProperty.call(_t,"default")?_t.default:_t}function D(_t,ge){return ge={exports:{}},_t(ge,ge.exports),ge.exports}var J=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=ye;function ye(Ve){return Ve&&typeof Ve.length=="number"&&Ve.length>=0&&Ve.length%1==0}_t.exports=ge.default});W(J);var te=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=function(ye){return function(){for(var Ve=[],ft=arguments.length;ft--;)Ve[ft]=arguments[ft];var Ie=Ve.pop();return ye.call(this,Ve,Ie)}},_t.exports=ge.default});W(te);var ce=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0}),ge.fallback=ft,ge.wrap=Ie;var ye=ge.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Ve=ge.hasNextTick=typeof S=="object"&&typeof S.nextTick=="function";function ft(C){setTimeout(C,0)}function Ie(C){return function(R){for(var q=[],fe=arguments.length-1;fe-- >0;)q[fe]=arguments[fe+1];return C(function(){return R.apply(void 0,q)})}}var pt;ye?pt=setImmediate:Ve?pt=S.nextTick:pt=ft,ge.default=Ie(pt)});W(ce);var Y=ce.fallback,ke=ce.wrap,Ke=ce.hasSetImmediate,We=ce.hasNextTick,Oe=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=Ie;var ye=ft(te),Ve=ft(ce);function ft(R){return R&&R.__esModule?R:{default:R}}function Ie(R){return(0,st.isAsync)(R)?function(){for(var q=[],fe=arguments.length;fe--;)q[fe]=arguments[fe];var Ge=q.pop(),Je=R.apply(this,q);return pt(Je,Ge)}:(0,ye.default)(function(q,fe){var Ge;try{Ge=R.apply(this,q)}catch(Je){return fe(Je)}if(Ge&&typeof Ge.then=="function")return pt(Ge,fe);fe(null,Ge)})}function pt(R,q){return R.then(function(fe){C(q,null,fe)},function(fe){C(q,fe&&fe.message?fe:new Error(fe))})}function C(R,q,fe){try{R(q,fe)}catch(Ge){(0,Ve.default)(function(Je){throw Je},Ge)}}_t.exports=ge.default});W(Oe);var st=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0}),ge.isAsyncIterable=ge.isAsyncGenerator=ge.isAsync=void 0;var ye=Ve(Oe);function Ve(R){return R&&R.__esModule?R:{default:R}}function ft(R){return R[Symbol.toStringTag]==="AsyncFunction"}function Ie(R){return R[Symbol.toStringTag]==="AsyncGenerator"}function pt(R){return typeof R[Symbol.asyncIterator]=="function"}function C(R){if(typeof R!="function")throw new Error("expected a function");return ft(R)?(0,ye.default)(R):R}ge.default=C,ge.isAsync=ft,ge.isAsyncGenerator=Ie,ge.isAsyncIterable=pt});W(st);var Le=st.isAsyncIterable,xt=st.isAsyncGenerator,it=st.isAsync,$e=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=ye;function ye(Ve,ft){if(ft===void 0&&(ft=Ve.length),!ft)throw new Error("arity is undefined");function Ie(){for(var pt=this,C=[],R=arguments.length;R--;)C[R]=arguments[R];return typeof C[ft-1]=="function"?Ve.apply(this,C):new Promise(function(q,fe){C[ft-1]=function(Ge){for(var Je=[],yt=arguments.length-1;yt-- >0;)Je[yt]=arguments[yt+1];if(Ge)return fe(Ge);q(Je.length>1?Je:Je[0])},Ve.apply(pt,C)})}return Object.defineProperty(Ie,"name",{configurable:!0,value:"awaitable("+Ve.name+")"}),Ie}_t.exports=ge.default});W($e);var Ze=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0});var ye=Ie(J),Ve=Ie(st),ft=Ie($e);function Ie(pt){return pt&&pt.__esModule?pt:{default:pt}}ge.default=(0,ft.default)(function(pt,C,R){var q=(0,ye.default)(C)?[]:{};pt(C,function(fe,Ge,Je){(0,Ve.default)(fe)(function(yt){for(var nt,Nt=[],$=arguments.length-1;$-- >0;)Nt[$]=arguments[$+1];Nt.length<2&&(nt=Nt,Nt=nt[0]),q[Ge]=Nt,Je(yt)})},function(fe){return R(fe,q)})},3),_t.exports=ge.default});W(Ze);var St=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=ye;function ye(Ve){function ft(){for(var Ie=[],pt=arguments.length;pt--;)Ie[pt]=arguments[pt];if(Ve!==null){var C=Ve;Ve=null,C.apply(this,Ie)}}return Object.assign(ft,Ve),ft}_t.exports=ge.default});W(St);var bt=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=function(ye){return ye[Symbol.iterator]&&ye[Symbol.iterator]()},_t.exports=ge.default});W(bt);var Ne=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=R;var ye=ft(J),Ve=ft(bt);function ft(q){return q&&q.__esModule?q:{default:q}}function Ie(q){var fe=-1,Ge=q.length;return function(){return++fe<Ge?{value:q[fe],key:fe}:null}}function pt(q){var fe=-1;return function(){var Je=q.next();return Je.done?null:(fe++,{value:Je.value,key:fe})}}function C(q){var fe=q?Object.keys(q):[],Ge=-1,Je=fe.length;return function(){var nt=fe[++Ge];return Ge<Je?{value:q[nt],key:nt}:null}}function R(q){if((0,ye.default)(q))return Ie(q);var fe=(0,Ve.default)(q);return fe?pt(fe):C(q)}_t.exports=ge.default});W(Ne);var ze=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=ye;function ye(Ve){return function(){for(var ft=[],Ie=arguments.length;Ie--;)ft[Ie]=arguments[Ie];if(Ve===null)throw new Error("Callback was already called.");var pt=Ve;Ve=null,pt.apply(this,ft)}}_t.exports=ge.default});W(ze);var Ue=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0});var ye={};ge.default=ye,_t.exports=ge.default});W(Ue);var lt=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=ft;var ye=Ve(Ue);function Ve(Ie){return Ie&&Ie.__esModule?Ie:{default:Ie}}function ft(Ie,pt,C,R){var q=!1,fe=!1,Ge=!1,Je=0,yt=0;function nt(){Je>=pt||Ge||q||(Ge=!0,Ie.next().then(function(Ye){var ie=Ye.value,et=Ye.done;if(!(fe||q)){if(Ge=!1,et){q=!0,Je<=0&&R(null);return}Je++,C(ie,yt,Nt),yt++,nt()}}).catch($))}function Nt(Ye,ie){if(Je-=1,!fe){if(Ye)return $(Ye);if(Ye===!1){q=!0,fe=!0;return}if(ie===ye.default||q&&Je<=0)return q=!0,R(null);nt()}}function $(Ye){fe||(Ge=!1,q=!0,R(Ye))}nt()}_t.exports=ge.default});W(lt);var Me=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0});var ye=C(St),Ve=C(Ne),ft=C(ze),Ie=C(lt),pt=C(Ue);function C(R){return R&&R.__esModule?R:{default:R}}ge.default=function(R){return function(q,fe,Ge){if(Ge=(0,ye.default)(Ge),R<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!q)return Ge(null);if((0,st.isAsyncGenerator)(q))return(0,Ie.default)(q,R,fe,Ge);if((0,st.isAsyncIterable)(q))return(0,Ie.default)(q[Symbol.asyncIterator](),R,fe,Ge);var Je=(0,Ve.default)(q),yt=!1,nt=!1,Nt=0,$=!1;function Ye(et,Bt){if(!nt)if(Nt-=1,et)yt=!0,Ge(et);else if(et===!1)yt=!0,nt=!0;else{if(Bt===pt.default||yt&&Nt<=0)return yt=!0,Ge(null);$||ie()}}function ie(){for($=!0;Nt<R&&!yt;){var et=Je();if(et===null){yt=!0,Nt<=0&&Ge(null);return}Nt+=1,fe(et.value,et.key,(0,ft.default)(Ye))}$=!1}ie()}},_t.exports=ge.default});W(Me);var ct=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0});var ye=Ie(Me),Ve=Ie(st),ft=Ie($e);function Ie(C){return C&&C.__esModule?C:{default:C}}function pt(C,R,q,fe){return(0,ye.default)(R)(C,(0,Ve.default)(q),fe)}ge.default=(0,ft.default)(pt,4),_t.exports=ge.default});W(ct);var Gt=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0});var ye=ft(ct),Ve=ft($e);function ft(pt){return pt&&pt.__esModule?pt:{default:pt}}function Ie(pt,C,R){return(0,ye.default)(pt,1,C,R)}ge.default=(0,Ve.default)(Ie,3),_t.exports=ge.default});W(Gt);var $t=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=Ie;var ye=ft(Ze),Ve=ft(Gt);function ft(pt){return pt&&pt.__esModule?pt:{default:pt}}function Ie(pt,C){return(0,ye.default)(Ve.default,pt,C)}_t.exports=ge.default}),ar=W($t),oe=function(){function _t(){for(var ge=arguments,ye=[],Ve=0;Ve<arguments.length;Ve++)ye[Ve]=ge[Ve];this.args=[],this.tasks=[]}return _t.prototype.call=function(){for(var ge=arguments,ye=[],Ve=0;Ve<arguments.length;Ve++)ye[Ve]=ge[Ve];return this.args=ye,ar(this.tasks)},_t.prototype.tap=function(ge,ye){var Ve=this;this.tasks.push(function(ft){ye.apply(void 0,a(Ve.args)),ft(null,ge)})},_t}(),Q=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0});var ye=q(J),Ve=q(Ue),ft=q(ct),Ie=q(St),pt=q(ze),C=q(st),R=q($e);function q(yt){return yt&&yt.__esModule?yt:{default:yt}}function fe(yt,nt,Nt){Nt=(0,Ie.default)(Nt);var $=0,Ye=0,ie=yt.length,et=!1;ie===0&&Nt(null);function Bt(lr,dt){lr===!1&&(et=!0),et!==!0&&(lr?Nt(lr):(++Ye===ie||dt===Ve.default)&&Nt(null))}for(;$<ie;$++)nt(yt[$],$,(0,pt.default)(Bt))}function Ge(yt,nt,Nt){return(0,ft.default)(yt,Infinity,nt,Nt)}function Je(yt,nt,Nt){var $=(0,ye.default)(yt)?fe:Ge;return $(yt,(0,C.default)(nt),Nt)}ge.default=(0,R.default)(Je,3),_t.exports=ge.default});W(Q);var G=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=Ie;var ye=ft(Q),Ve=ft(Ze);function ft(pt){return pt&&pt.__esModule?pt:{default:pt}}function Ie(pt,C){return(0,Ve.default)(ye.default,pt,C)}_t.exports=ge.default}),Ce=W(G),be=function(){function _t(){for(var ge=arguments,ye=[],Ve=0;Ve<arguments.length;Ve++)ye[Ve]=ge[Ve];this.tasks=[]}return _t.prototype.promise=function(){for(var ge=arguments,ye=[],Ve=0;Ve<arguments.length;Ve++)ye[Ve]=ge[Ve];return Ce(this.tasks)},_t.prototype.tapPromise=function(ge,ye){var Ve=this;this.tasks.push(function(ft){return v(Ve,void 0,void 0,function(){return X(this,function(Ie){switch(Ie.label){case 0:return[4,ye()];case 1:return Ie.sent(),ft(null,ge),[2]}})})})},_t}(),Te=D(function(_t,ge){Object.defineProperty(ge,"__esModule",{value:!0});var ye=pt(St),Ve=pt(ze),ft=pt(st),Ie=pt($e);function pt(R){return R&&R.__esModule?R:{default:R}}function C(R,q){if(q=(0,ye.default)(q),!Array.isArray(R))return q(new Error("First argument to waterfall must be an array of functions"));if(!R.length)return q();var fe=0;function Ge(yt){var nt=(0,ft.default)(R[fe++]);nt.apply(void 0,yt.concat([(0,Ve.default)(Je)]))}function Je(yt){for(var nt=[],Nt=arguments.length-1;Nt-- >0;)nt[Nt]=arguments[Nt+1];if(yt!==!1){if(yt||fe===R.length)return q.apply(void 0,[yt].concat(nt));Ge(nt)}}Ge([])}ge.default=(0,Ie.default)(C),_t.exports=ge.default}),me=W(Te),rt=function(){function _t(){for(var ge=arguments,ye=[],Ve=0;Ve<arguments.length;Ve++)ye[Ve]=ge[Ve];this.tasks=[]}return _t.prototype.call=function(){for(var ge=arguments,ye=[],Ve=0;Ve<arguments.length;Ve++)ye[Ve]=ge[Ve];return me(this.tasks)},_t.prototype.tap=function(ge,ye){this.tasks.length===0?this.tasks.push(function(Ve){var ft=ye();Ve(ft?null:!1,ft)}):this.tasks.push(function(Ve,ft){var Ie=ye();ft(Ie?null:!1,ge)})},_t}(),Kt=function(){function _t(){for(var ge=arguments,ye=[],Ve=0;Ve<arguments.length;Ve++)ye[Ve]=ge[Ve];this.tasks=[]}return _t.prototype.call=function(){for(var ge=arguments,ye=[],Ve=0;Ve<arguments.length;Ve++)ye[Ve]=ge[Ve];return ar(this.tasks)},_t.prototype.tap=function(ge,ye){this.tasks.push(function(Ve){var ft=ye();Ve(ft,ge)})},_t}()}).call(this,o("Q2Ig"))},yG8O:function(Re,y){function o(S,v,X,B){!X||Object.defineProperty(S,v,{enumerable:X.enumerable,configurable:X.configurable,writable:X.writable,value:X.initializer?X.initializer.call(B):void 0})}Re.exports=o},yHx3:function(Re,y){var o=Object.prototype,S=o.hasOwnProperty;function v(X){var B=X.length,a=new X.constructor(B);return B&&typeof X[0]=="string"&&S.call(X,"index")&&(a.index=X.index,a.input=X.input),a}Re.exports=v},yLV6:function(Re,y,o){var S;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(v,X,B,a){"use strict";var W=["","webkit","Moz","MS","ms","o"],D=X.createElement("div"),J="function",te=Math.round,ce=Math.abs,Y=Date.now;function ke(kt,De,It){return setTimeout($e(kt,It),De)}function Ke(kt,De,It){return Array.isArray(kt)?(We(kt,It[De],It),!0):!1}function We(kt,De,It){var fr;if(!!kt)if(kt.forEach)kt.forEach(De,It);else if(kt.length!==a)for(fr=0;fr<kt.length;)De.call(It,kt[fr],fr,kt),fr++;else for(fr in kt)kt.hasOwnProperty(fr)&&De.call(It,kt[fr],fr,kt)}function Oe(kt,De,It){var fr="DEPRECATED METHOD: "+De+`
`+It+` AT 
`;return function(){var tn=new Error("get-stack-trace"),En=tn&&tn.stack?tn.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Un=v.console&&(v.console.warn||v.console.log);return Un&&Un.call(v.console,fr,En),kt.apply(this,arguments)}}var st;typeof Object.assign!="function"?st=function(De){if(De===a||De===null)throw new TypeError("Cannot convert undefined or null to object");for(var It=Object(De),fr=1;fr<arguments.length;fr++){var tn=arguments[fr];if(tn!==a&&tn!==null)for(var En in tn)tn.hasOwnProperty(En)&&(It[En]=tn[En])}return It}:st=Object.assign;var Le=Oe(function(De,It,fr){for(var tn=Object.keys(It),En=0;En<tn.length;)(!fr||fr&&De[tn[En]]===a)&&(De[tn[En]]=It[tn[En]]),En++;return De},"extend","Use `assign`."),xt=Oe(function(De,It){return Le(De,It,!0)},"merge","Use `assign`.");function it(kt,De,It){var fr=De.prototype,tn;tn=kt.prototype=Object.create(fr),tn.constructor=kt,tn._super=fr,It&&st(tn,It)}function $e(kt,De){return function(){return kt.apply(De,arguments)}}function Ze(kt,De){return typeof kt==J?kt.apply(De&&De[0]||a,De):kt}function St(kt,De){return kt===a?De:kt}function bt(kt,De,It){We(lt(De),function(fr){kt.addEventListener(fr,It,!1)})}function Ne(kt,De,It){We(lt(De),function(fr){kt.removeEventListener(fr,It,!1)})}function ze(kt,De){for(;kt;){if(kt==De)return!0;kt=kt.parentNode}return!1}function Ue(kt,De){return kt.indexOf(De)>-1}function lt(kt){return kt.trim().split(/\s+/g)}function Me(kt,De,It){if(kt.indexOf&&!It)return kt.indexOf(De);for(var fr=0;fr<kt.length;){if(It&&kt[fr][It]==De||!It&&kt[fr]===De)return fr;fr++}return-1}function ct(kt){return Array.prototype.slice.call(kt,0)}function Gt(kt,De,It){for(var fr=[],tn=[],En=0;En<kt.length;){var Un=De?kt[En][De]:kt[En];Me(tn,Un)<0&&fr.push(kt[En]),tn[En]=Un,En++}return It&&(De?fr=fr.sort(function(no,go){return no[De]>go[De]}):fr=fr.sort()),fr}function $t(kt,De){for(var It,fr,tn=De[0].toUpperCase()+De.slice(1),En=0;En<W.length;){if(It=W[En],fr=It?It+tn:De,fr in kt)return fr;En++}return a}var ar=1;function oe(){return ar++}function Q(kt){var De=kt.ownerDocument||kt;return De.defaultView||De.parentWindow||v}var G=/mobile|tablet|ip(ad|hone|od)|android/i,Ce="ontouchstart"in v,be=$t(v,"PointerEvent")!==a,Te=Ce&&G.test(navigator.userAgent),me="touch",rt="pen",Kt="mouse",_t="kinect",ge=25,ye=1,Ve=2,ft=4,Ie=8,pt=1,C=2,R=4,q=8,fe=16,Ge=C|R,Je=q|fe,yt=Ge|Je,nt=["x","y"],Nt=["clientX","clientY"];function $(kt,De){var It=this;this.manager=kt,this.callback=De,this.element=kt.element,this.target=kt.options.inputTarget,this.domHandler=function(fr){Ze(kt.options.enable,[kt])&&It.handler(fr)},this.init()}$.prototype={handler:function(){},init:function(){this.evEl&&bt(this.element,this.evEl,this.domHandler),this.evTarget&&bt(this.target,this.evTarget,this.domHandler),this.evWin&&bt(Q(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ne(this.element,this.evEl,this.domHandler),this.evTarget&&Ne(this.target,this.evTarget,this.domHandler),this.evWin&&Ne(Q(this.element),this.evWin,this.domHandler)}};function Ye(kt){var De,It=kt.options.inputClass;return It?De=It:be?De=Hn:Te?De=He:Ce?De=Hr:De=jn,new De(kt,ie)}function ie(kt,De,It){var fr=It.pointers.length,tn=It.changedPointers.length,En=De&ye&&fr-tn==0,Un=De&(ft|Ie)&&fr-tn==0;It.isFirst=!!En,It.isFinal=!!Un,En&&(kt.session={}),It.eventType=De,et(kt,It),kt.emit("hammer.input",It),kt.recognize(It),kt.session.prevInput=It}function et(kt,De){var It=kt.session,fr=De.pointers,tn=fr.length;It.firstInput||(It.firstInput=dt(De)),tn>1&&!It.firstMultiple?It.firstMultiple=dt(De):tn===1&&(It.firstMultiple=!1);var En=It.firstInput,Un=It.firstMultiple,La=Un?Un.center:En.center,no=De.center=vt(fr);De.timeStamp=Y(),De.deltaTime=De.timeStamp-En.timeStamp,De.angle=ht(La,no),De.distance=we(La,no),Bt(It,De),De.offsetDirection=gt(De.deltaX,De.deltaY);var go=Ct(De.deltaTime,De.deltaX,De.deltaY);De.overallVelocityX=go.x,De.overallVelocityY=go.y,De.overallVelocity=ce(go.x)>ce(go.y)?go.x:go.y,De.scale=Un?Vt(Un.pointers,fr):1,De.rotation=Un?Qe(Un.pointers,fr):0,De.maxPointers=It.prevInput?De.pointers.length>It.prevInput.maxPointers?De.pointers.length:It.prevInput.maxPointers:De.pointers.length,lr(It,De);var No=kt.element;ze(De.srcEvent.target,No)&&(No=De.srcEvent.target),De.target=No}function Bt(kt,De){var It=De.center,fr=kt.offsetDelta||{},tn=kt.prevDelta||{},En=kt.prevInput||{};(De.eventType===ye||En.eventType===ft)&&(tn=kt.prevDelta={x:En.deltaX||0,y:En.deltaY||0},fr=kt.offsetDelta={x:It.x,y:It.y}),De.deltaX=tn.x+(It.x-fr.x),De.deltaY=tn.y+(It.y-fr.y)}function lr(kt,De){var It=kt.lastInterval||De,fr=De.timeStamp-It.timeStamp,tn,En,Un,La;if(De.eventType!=Ie&&(fr>ge||It.velocity===a)){var no=De.deltaX-It.deltaX,go=De.deltaY-It.deltaY,No=Ct(fr,no,go);En=No.x,Un=No.y,tn=ce(No.x)>ce(No.y)?No.x:No.y,La=gt(no,go),kt.lastInterval=De}else tn=It.velocity,En=It.velocityX,Un=It.velocityY,La=It.direction;De.velocity=tn,De.velocityX=En,De.velocityY=Un,De.direction=La}function dt(kt){for(var De=[],It=0;It<kt.pointers.length;)De[It]={clientX:te(kt.pointers[It].clientX),clientY:te(kt.pointers[It].clientY)},It++;return{timeStamp:Y(),pointers:De,center:vt(De),deltaX:kt.deltaX,deltaY:kt.deltaY}}function vt(kt){var De=kt.length;if(De===1)return{x:te(kt[0].clientX),y:te(kt[0].clientY)};for(var It=0,fr=0,tn=0;tn<De;)It+=kt[tn].clientX,fr+=kt[tn].clientY,tn++;return{x:te(It/De),y:te(fr/De)}}function Ct(kt,De,It){return{x:De/kt||0,y:It/kt||0}}function gt(kt,De){return kt===De?pt:ce(kt)>=ce(De)?kt<0?C:R:De<0?q:fe}function we(kt,De,It){It||(It=nt);var fr=De[It[0]]-kt[It[0]],tn=De[It[1]]-kt[It[1]];return Math.sqrt(fr*fr+tn*tn)}function ht(kt,De,It){It||(It=nt);var fr=De[It[0]]-kt[It[0]],tn=De[It[1]]-kt[It[1]];return Math.atan2(tn,fr)*180/Math.PI}function Qe(kt,De){return ht(De[1],De[0],Nt)+ht(kt[1],kt[0],Nt)}function Vt(kt,De){return we(De[0],De[1],Nt)/we(kt[0],kt[1],Nt)}var pr={mousedown:ye,mousemove:Ve,mouseup:ft},Zr="mousedown",cr="mousemove mouseup";function jn(){this.evEl=Zr,this.evWin=cr,this.pressed=!1,$.apply(this,arguments)}it(jn,$,{handler:function(De){var It=pr[De.type];It&ye&&De.button===0&&(this.pressed=!0),It&Ve&&De.which!==1&&(It=ft),!!this.pressed&&(It&ft&&(this.pressed=!1),this.callback(this.manager,It,{pointers:[De],changedPointers:[De],pointerType:Kt,srcEvent:De}))}});var Sn={pointerdown:ye,pointermove:Ve,pointerup:ft,pointercancel:Ie,pointerout:Ie},ai={2:me,3:rt,4:Kt,5:_t},fi="pointerdown",Zn="pointermove pointerup pointercancel";v.MSPointerEvent&&!v.PointerEvent&&(fi="MSPointerDown",Zn="MSPointerMove MSPointerUp MSPointerCancel");function Hn(){this.evEl=fi,this.evWin=Zn,$.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}it(Hn,$,{handler:function(De){var It=this.store,fr=!1,tn=De.type.toLowerCase().replace("ms",""),En=Sn[tn],Un=ai[De.pointerType]||De.pointerType,La=Un==me,no=Me(It,De.pointerId,"pointerId");En&ye&&(De.button===0||La)?no<0&&(It.push(De),no=It.length-1):En&(ft|Ie)&&(fr=!0),!(no<0)&&(It[no]=De,this.callback(this.manager,En,{pointers:It,changedPointers:[De],pointerType:Un,srcEvent:De}),fr&&It.splice(no,1))}});var k={touchstart:ye,touchmove:Ve,touchend:ft,touchcancel:Ie},H="touchstart",le="touchstart touchmove touchend touchcancel";function de(){this.evTarget=H,this.evWin=le,this.started=!1,$.apply(this,arguments)}it(de,$,{handler:function(De){var It=k[De.type];if(It===ye&&(this.started=!0),!!this.started){var fr=at.call(this,De,It);It&(ft|Ie)&&fr[0].length-fr[1].length==0&&(this.started=!1),this.callback(this.manager,It,{pointers:fr[0],changedPointers:fr[1],pointerType:me,srcEvent:De})}}});function at(kt,De){var It=ct(kt.touches),fr=ct(kt.changedTouches);return De&(ft|Ie)&&(It=Gt(It.concat(fr),"identifier",!0)),[It,fr]}var At={touchstart:ye,touchmove:Ve,touchend:ft,touchcancel:Ie},Ft="touchstart touchmove touchend touchcancel";function He(){this.evTarget=Ft,this.targetIds={},$.apply(this,arguments)}it(He,$,{handler:function(De){var It=At[De.type],fr=Pt.call(this,De,It);!fr||this.callback(this.manager,It,{pointers:fr[0],changedPointers:fr[1],pointerType:me,srcEvent:De})}});function Pt(kt,De){var It=ct(kt.touches),fr=this.targetIds;if(De&(ye|Ve)&&It.length===1)return fr[It[0].identifier]=!0,[It,It];var tn,En,Un=ct(kt.changedTouches),La=[],no=this.target;if(En=It.filter(function(go){return ze(go.target,no)}),De===ye)for(tn=0;tn<En.length;)fr[En[tn].identifier]=!0,tn++;for(tn=0;tn<Un.length;)fr[Un[tn].identifier]&&La.push(Un[tn]),De&(ft|Ie)&&delete fr[Un[tn].identifier],tn++;if(!!La.length)return[Gt(En.concat(La),"identifier",!0),La]}var or=2500,jr=25;function Hr(){$.apply(this,arguments);var kt=$e(this.handler,this);this.touch=new He(this.manager,kt),this.mouse=new jn(this.manager,kt),this.primaryTouch=null,this.lastTouches=[]}it(Hr,$,{handler:function(De,It,fr){var tn=fr.pointerType==me,En=fr.pointerType==Kt;if(!(En&&fr.sourceCapabilities&&fr.sourceCapabilities.firesTouchEvents)){if(tn)sr.call(this,It,fr);else if(En&&_n.call(this,fr))return;this.callback(De,It,fr)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function sr(kt,De){kt&ye?(this.primaryTouch=De.changedPointers[0].identifier,Fr.call(this,De)):kt&(ft|Ie)&&Fr.call(this,De)}function Fr(kt){var De=kt.changedPointers[0];if(De.identifier===this.primaryTouch){var It={x:De.clientX,y:De.clientY};this.lastTouches.push(It);var fr=this.lastTouches,tn=function(){var Un=fr.indexOf(It);Un>-1&&fr.splice(Un,1)};setTimeout(tn,or)}}function _n(kt){for(var De=kt.srcEvent.clientX,It=kt.srcEvent.clientY,fr=0;fr<this.lastTouches.length;fr++){var tn=this.lastTouches[fr],En=Math.abs(De-tn.x),Un=Math.abs(It-tn.y);if(En<=jr&&Un<=jr)return!0}return!1}var dn=$t(D.style,"touchAction"),Er=dn!==a,Tn="compute",vn="auto",gn="manipulation",Ar="none",$r="pan-x",Mn="pan-y",Xi=Di();function vi(kt,De){this.manager=kt,this.set(De)}vi.prototype={set:function(De){De==Tn&&(De=this.compute()),Er&&this.manager.element.style&&Xi[De]&&(this.manager.element.style[dn]=De),this.actions=De.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var De=[];return We(this.manager.recognizers,function(It){Ze(It.options.enable,[It])&&(De=De.concat(It.getTouchAction()))}),wi(De.join(" "))},preventDefaults:function(De){var It=De.srcEvent,fr=De.offsetDirection;if(this.manager.session.prevented){It.preventDefault();return}var tn=this.actions,En=Ue(tn,Ar)&&!Xi[Ar],Un=Ue(tn,Mn)&&!Xi[Mn],La=Ue(tn,$r)&&!Xi[$r];if(En){var no=De.pointers.length===1,go=De.distance<2,No=De.deltaTime<250;if(no&&go&&No)return}if(!(La&&Un)&&(En||Un&&fr&Ge||La&&fr&Je))return this.preventSrc(It)},preventSrc:function(De){this.manager.session.prevented=!0,De.preventDefault()}};function wi(kt){if(Ue(kt,Ar))return Ar;var De=Ue(kt,$r),It=Ue(kt,Mn);return De&&It?Ar:De||It?De?$r:Mn:Ue(kt,gn)?gn:vn}function Di(){if(!Er)return!1;var kt={},De=v.CSS&&v.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(It){kt[It]=De?v.CSS.supports("touch-action",It):!0}),kt}var Ka=1,hi=2,ga=4,Pi=8,gi=Pi,ci=16,Oa=32;function mo(kt){this.options=st({},this.defaults,kt||{}),this.id=oe(),this.manager=null,this.options.enable=St(this.options.enable,!0),this.state=Ka,this.simultaneous={},this.requireFail=[]}mo.prototype={defaults:{},set:function(De){return st(this.options,De),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(De){if(Ke(De,"recognizeWith",this))return this;var It=this.simultaneous;return De=Uu(De,this),It[De.id]||(It[De.id]=De,De.recognizeWith(this)),this},dropRecognizeWith:function(De){return Ke(De,"dropRecognizeWith",this)?this:(De=Uu(De,this),delete this.simultaneous[De.id],this)},requireFailure:function(De){if(Ke(De,"requireFailure",this))return this;var It=this.requireFail;return De=Uu(De,this),Me(It,De)===-1&&(It.push(De),De.requireFailure(this)),this},dropRequireFailure:function(De){if(Ke(De,"dropRequireFailure",this))return this;De=Uu(De,this);var It=Me(this.requireFail,De);return It>-1&&this.requireFail.splice(It,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(De){return!!this.simultaneous[De.id]},emit:function(De){var It=this,fr=this.state;function tn(En){It.manager.emit(En,De)}fr<Pi&&tn(It.options.event+$a(fr)),tn(It.options.event),De.additionalEvent&&tn(De.additionalEvent),fr>=Pi&&tn(It.options.event+$a(fr))},tryEmit:function(De){if(this.canEmit())return this.emit(De);this.state=Oa},canEmit:function(){for(var De=0;De<this.requireFail.length;){if(!(this.requireFail[De].state&(Oa|Ka)))return!1;De++}return!0},recognize:function(De){var It=st({},De);if(!Ze(this.options.enable,[this,It])){this.reset(),this.state=Oa;return}this.state&(gi|ci|Oa)&&(this.state=Ka),this.state=this.process(It),this.state&(hi|ga|Pi|ci)&&this.tryEmit(It)},process:function(De){},getTouchAction:function(){},reset:function(){}};function $a(kt){return kt&ci?"cancel":kt&Pi?"end":kt&ga?"move":kt&hi?"start":""}function Ko(kt){return kt==fe?"down":kt==q?"up":kt==C?"left":kt==R?"right":""}function Uu(kt,De){var It=De.manager;return It?It.get(kt):kt}function Ui(){mo.apply(this,arguments)}it(Ui,mo,{defaults:{pointers:1},attrTest:function(De){var It=this.options.pointers;return It===0||De.pointers.length===It},process:function(De){var It=this.state,fr=De.eventType,tn=It&(hi|ga),En=this.attrTest(De);return tn&&(fr&Ie||!En)?It|ci:tn||En?fr&ft?It|Pi:It&hi?It|ga:hi:Oa}});function Ca(){Ui.apply(this,arguments),this.pX=null,this.pY=null}it(Ca,Ui,{defaults:{event:"pan",threshold:10,pointers:1,direction:yt},getTouchAction:function(){var De=this.options.direction,It=[];return De&Ge&&It.push(Mn),De&Je&&It.push($r),It},directionTest:function(De){var It=this.options,fr=!0,tn=De.distance,En=De.direction,Un=De.deltaX,La=De.deltaY;return En&It.direction||(It.direction&Ge?(En=Un===0?pt:Un<0?C:R,fr=Un!=this.pX,tn=Math.abs(De.deltaX)):(En=La===0?pt:La<0?q:fe,fr=La!=this.pY,tn=Math.abs(De.deltaY))),De.direction=En,fr&&tn>It.threshold&&En&It.direction},attrTest:function(De){return Ui.prototype.attrTest.call(this,De)&&(this.state&hi||!(this.state&hi)&&this.directionTest(De))},emit:function(De){this.pX=De.deltaX,this.pY=De.deltaY;var It=Ko(De.direction);It&&(De.additionalEvent=this.options.event+It),this._super.emit.call(this,De)}});function ns(){Ui.apply(this,arguments)}it(ns,Ui,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ar]},attrTest:function(De){return this._super.attrTest.call(this,De)&&(Math.abs(De.scale-1)>this.options.threshold||this.state&hi)},emit:function(De){if(De.scale!==1){var It=De.scale<1?"in":"out";De.additionalEvent=this.options.event+It}this._super.emit.call(this,De)}});function na(){mo.apply(this,arguments),this._timer=null,this._input=null}it(na,mo,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[vn]},process:function(De){var It=this.options,fr=De.pointers.length===It.pointers,tn=De.distance<It.threshold,En=De.deltaTime>It.time;if(this._input=De,!tn||!fr||De.eventType&(ft|Ie)&&!En)this.reset();else if(De.eventType&ye)this.reset(),this._timer=ke(function(){this.state=gi,this.tryEmit()},It.time,this);else if(De.eventType&ft)return gi;return Oa},reset:function(){clearTimeout(this._timer)},emit:function(De){this.state===gi&&(De&&De.eventType&ft?this.manager.emit(this.options.event+"up",De):(this._input.timeStamp=Y(),this.manager.emit(this.options.event,this._input)))}});function Ja(){Ui.apply(this,arguments)}it(Ja,Ui,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ar]},attrTest:function(De){return this._super.attrTest.call(this,De)&&(Math.abs(De.rotation)>this.options.threshold||this.state&hi)}});function is(){Ui.apply(this,arguments)}it(is,Ui,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ge|Je,pointers:1},getTouchAction:function(){return Ca.prototype.getTouchAction.call(this)},attrTest:function(De){var It=this.options.direction,fr;return It&(Ge|Je)?fr=De.overallVelocity:It&Ge?fr=De.overallVelocityX:It&Je&&(fr=De.overallVelocityY),this._super.attrTest.call(this,De)&&It&De.offsetDirection&&De.distance>this.options.threshold&&De.maxPointers==this.options.pointers&&ce(fr)>this.options.velocity&&De.eventType&ft},emit:function(De){var It=Ko(De.offsetDirection);It&&this.manager.emit(this.options.event+It,De),this.manager.emit(this.options.event,De)}});function $i(){mo.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}it($i,mo,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[gn]},process:function(De){var It=this.options,fr=De.pointers.length===It.pointers,tn=De.distance<It.threshold,En=De.deltaTime<It.time;if(this.reset(),De.eventType&ye&&this.count===0)return this.failTimeout();if(tn&&En&&fr){if(De.eventType!=ft)return this.failTimeout();var Un=this.pTime?De.timeStamp-this.pTime<It.interval:!0,La=!this.pCenter||we(this.pCenter,De.center)<It.posThreshold;this.pTime=De.timeStamp,this.pCenter=De.center,!La||!Un?this.count=1:this.count+=1,this._input=De;var no=this.count%It.taps;if(no===0)return this.hasRequireFailures()?(this._timer=ke(function(){this.state=gi,this.tryEmit()},It.interval,this),hi):gi}return Oa},failTimeout:function(){return this._timer=ke(function(){this.state=Oa},this.options.interval,this),Oa},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==gi&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function oo(kt,De){return De=De||{},De.recognizers=St(De.recognizers,oo.defaults.preset),new Ao(kt,De)}oo.VERSION="2.0.7",oo.defaults={domEvents:!1,touchAction:Tn,enable:!0,inputTarget:null,inputClass:null,preset:[[Ja,{enable:!1}],[ns,{enable:!1},["rotate"]],[is,{direction:Ge}],[Ca,{direction:Ge},["swipe"]],[$i],[$i,{event:"doubletap",taps:2},["tap"]],[na]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var so=1,Ys=2;function Ao(kt,De){this.options=st({},oo.defaults,De||{}),this.options.inputTarget=this.options.inputTarget||kt,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=kt,this.input=Ye(this),this.touchAction=new vi(this,this.options.touchAction),Zl(this,!0),We(this.options.recognizers,function(It){var fr=this.add(new It[0](It[1]));It[2]&&fr.recognizeWith(It[2]),It[3]&&fr.requireFailure(It[3])},this)}Ao.prototype={set:function(De){return st(this.options,De),De.touchAction&&this.touchAction.update(),De.inputTarget&&(this.input.destroy(),this.input.target=De.inputTarget,this.input.init()),this},stop:function(De){this.session.stopped=De?Ys:so},recognize:function(De){var It=this.session;if(!It.stopped){this.touchAction.preventDefaults(De);var fr,tn=this.recognizers,En=It.curRecognizer;(!En||En&&En.state&gi)&&(En=It.curRecognizer=null);for(var Un=0;Un<tn.length;)fr=tn[Un],It.stopped!==Ys&&(!En||fr==En||fr.canRecognizeWith(En))?fr.recognize(De):fr.reset(),!En&&fr.state&(hi|ga|Pi)&&(En=It.curRecognizer=fr),Un++}},get:function(De){if(De instanceof mo)return De;for(var It=this.recognizers,fr=0;fr<It.length;fr++)if(It[fr].options.event==De)return It[fr];return null},add:function(De){if(Ke(De,"add",this))return this;var It=this.get(De.options.event);return It&&this.remove(It),this.recognizers.push(De),De.manager=this,this.touchAction.update(),De},remove:function(De){if(Ke(De,"remove",this))return this;if(De=this.get(De),De){var It=this.recognizers,fr=Me(It,De);fr!==-1&&(It.splice(fr,1),this.touchAction.update())}return this},on:function(De,It){if(De!==a&&It!==a){var fr=this.handlers;return We(lt(De),function(tn){fr[tn]=fr[tn]||[],fr[tn].push(It)}),this}},off:function(De,It){if(De!==a){var fr=this.handlers;return We(lt(De),function(tn){It?fr[tn]&&fr[tn].splice(Me(fr[tn],It),1):delete fr[tn]}),this}},emit:function(De,It){this.options.domEvents&&Ks(De,It);var fr=this.handlers[De]&&this.handlers[De].slice();if(!(!fr||!fr.length)){It.type=De,It.preventDefault=function(){It.srcEvent.preventDefault()};for(var tn=0;tn<fr.length;)fr[tn](It),tn++}},destroy:function(){this.element&&Zl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Zl(kt,De){var It=kt.element;if(!!It.style){var fr;We(kt.options.cssProps,function(tn,En){fr=$t(It.style,En),De?(kt.oldCssProps[fr]=It.style[fr],It.style[fr]=tn):It.style[fr]=kt.oldCssProps[fr]||""}),De||(kt.oldCssProps={})}}function Ks(kt,De){var It=X.createEvent("Event");It.initEvent(kt,!0,!0),It.gesture=De,De.target.dispatchEvent(It)}st(oo,{INPUT_START:ye,INPUT_MOVE:Ve,INPUT_END:ft,INPUT_CANCEL:Ie,STATE_POSSIBLE:Ka,STATE_BEGAN:hi,STATE_CHANGED:ga,STATE_ENDED:Pi,STATE_RECOGNIZED:gi,STATE_CANCELLED:ci,STATE_FAILED:Oa,DIRECTION_NONE:pt,DIRECTION_LEFT:C,DIRECTION_RIGHT:R,DIRECTION_UP:q,DIRECTION_DOWN:fe,DIRECTION_HORIZONTAL:Ge,DIRECTION_VERTICAL:Je,DIRECTION_ALL:yt,Manager:Ao,Input:$,TouchAction:vi,TouchInput:He,MouseInput:jn,PointerEventInput:Hn,TouchMouseInput:Hr,SingleTouchInput:de,Recognizer:mo,AttrRecognizer:Ui,Tap:$i,Pan:Ca,Swipe:is,Pinch:ns,Rotate:Ja,Press:na,on:bt,off:Ne,each:We,merge:xt,extend:Le,assign:st,inherit:it,bindFn:$e,prefixed:$t});var _o=typeof v!="undefined"?v:typeof self!="undefined"?self:{};_o.Hammer=oo,S=function(){return oo}.call(y,o,y,Re),S!==a&&(Re.exports=S)})(window,document,"Hammer")},yMAV:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Plan=void 0;var S=function(){function v(X,B){this.parentContext=X,this.rootRequest=B}return v}();y.Plan=S},yP5f:function(Re,y,o){var S=o("+K+b");function v(X,B){var a=B?S(X.buffer):X.buffer;return new X.constructor(a,X.byteOffset,X.length)}Re.exports=v},yU0y:function(Re,y,o){"use strict";o.d(y,"b",function(){return S}),o.d(y,"a",function(){return v}),o.d(y,"c",function(){return X});var S=1e-6,v=typeof Float32Array!="undefined"?Float32Array:Array,X=Math.random;function B(J){v=J}var a=Math.PI/180;function W(J){return J*a}function D(J,te){return Math.abs(J-te)<=S*Math.max(1,Math.abs(J),Math.abs(te))}Math.hypot||(Math.hypot=function(){for(var J=0,te=arguments.length;te--;)J+=arguments[te]*arguments[te];return Math.sqrt(J)})},yXPU:function(Re,y){function o(v,X,B,a,W,D,J){try{var te=v[D](J),ce=te.value}catch(Y){B(Y);return}te.done?X(ce):Promise.resolve(ce).then(a,W)}function S(v){return function(){var X=this,B=arguments;return new Promise(function(a,W){var D=v.apply(X,B);function J(ce){o(D,a,W,J,te,"next",ce)}function te(ce){o(D,a,W,J,te,"throw",ce)}J(void 0)})}}Re.exports=S},ycre:function(Re,y,o){var S=o("711d"),v=S("length");Re.exports=v},z4Hk:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingWhenSyntax=void 0;var S=o("406g"),v=o("RR/i"),X=function(){function B(a){this._binding=a}return B.prototype.when=function(a){return this._binding.constraint=a,new S.BindingOnSyntax(this._binding)},B.prototype.whenTargetNamed=function(a){return this._binding.constraint=v.namedConstraint(a),new S.BindingOnSyntax(this._binding)},B.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(a){var W=a.target!==null&&!a.target.isNamed()&&!a.target.isTagged();return W},new S.BindingOnSyntax(this._binding)},B.prototype.whenTargetTagged=function(a,W){return this._binding.constraint=v.taggedConstraint(a)(W),new S.BindingOnSyntax(this._binding)},B.prototype.whenInjectedInto=function(a){return this._binding.constraint=function(W){return v.typeConstraint(a)(W.parentRequest)},new S.BindingOnSyntax(this._binding)},B.prototype.whenParentNamed=function(a){return this._binding.constraint=function(W){return v.namedConstraint(a)(W.parentRequest)},new S.BindingOnSyntax(this._binding)},B.prototype.whenParentTagged=function(a,W){return this._binding.constraint=function(D){return v.taggedConstraint(a)(W)(D.parentRequest)},new S.BindingOnSyntax(this._binding)},B.prototype.whenAnyAncestorIs=function(a){return this._binding.constraint=function(W){return v.traverseAncerstors(W,v.typeConstraint(a))},new S.BindingOnSyntax(this._binding)},B.prototype.whenNoAncestorIs=function(a){return this._binding.constraint=function(W){return!v.traverseAncerstors(W,v.typeConstraint(a))},new S.BindingOnSyntax(this._binding)},B.prototype.whenAnyAncestorNamed=function(a){return this._binding.constraint=function(W){return v.traverseAncerstors(W,v.namedConstraint(a))},new S.BindingOnSyntax(this._binding)},B.prototype.whenNoAncestorNamed=function(a){return this._binding.constraint=function(W){return!v.traverseAncerstors(W,v.namedConstraint(a))},new S.BindingOnSyntax(this._binding)},B.prototype.whenAnyAncestorTagged=function(a,W){return this._binding.constraint=function(D){return v.traverseAncerstors(D,v.taggedConstraint(a)(W))},new S.BindingOnSyntax(this._binding)},B.prototype.whenNoAncestorTagged=function(a,W){return this._binding.constraint=function(D){return!v.traverseAncerstors(D,v.taggedConstraint(a)(W))},new S.BindingOnSyntax(this._binding)},B.prototype.whenAnyAncestorMatches=function(a){return this._binding.constraint=function(W){return v.traverseAncerstors(W,a)},new S.BindingOnSyntax(this._binding)},B.prototype.whenNoAncestorMatches=function(a){return this._binding.constraint=function(W){return!v.traverseAncerstors(W,a)},new S.BindingOnSyntax(this._binding)},B}();y.BindingWhenSyntax=X},zEVN:function(Re,y,o){var S=o("Gi0A"),v=o("sEf8"),X=o("mdPL"),B=X&&X.isMap,a=B?v(B):S;Re.exports=a},zZ0H:function(Re,y){function o(S){return S}Re.exports=o},zZPE:function(Re,y){var o="[object Object]";function S(ke){var Ke=!1;if(ke!=null&&typeof ke.toString!="function")try{Ke=!!(ke+"")}catch(We){}return Ke}function v(ke,Ke){return function(We){return ke(Ke(We))}}var X=Function.prototype,B=Object.prototype,a=X.toString,W=B.hasOwnProperty,D=a.call(Object),J=B.toString,te=v(Object.getPrototypeOf,Object);function ce(ke){return!!ke&&typeof ke=="object"}function Y(ke){if(!ce(ke)||J.call(ke)!=o||S(ke))return!1;var Ke=te(ke);if(Ke===null)return!0;var We=W.call(Ke,"constructor")&&Ke.constructor;return typeof We=="function"&&We instanceof We&&a.call(We)==D}Re.exports=Y},zoYe:function(Re,y,o){var S=o("nmnc"),v=o("eUgh"),X=o("Z0cm"),B=o("/9aa"),a=1/0,W=S?S.prototype:void 0,D=W?W.toString:void 0;function J(te){if(typeof te=="string")return te;if(X(te))return v(te,J)+"";if(B(te))return D?D.call(te):"";var ce=te+"";return ce=="0"&&1/te==-a?"-0":ce}Re.exports=J},zvhG:function(Re,y){Re.exports=o;function o(S,v,X,B){this.cx=3*S,this.bx=3*(X-S)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*v,this.by=3*(B-v)-this.cy,this.ay=1-this.cy-this.by,this.p1x=S,this.p1y=B,this.p2x=X,this.p2y=B}o.prototype.sampleCurveX=function(S){return((this.ax*S+this.bx)*S+this.cx)*S},o.prototype.sampleCurveY=function(S){return((this.ay*S+this.by)*S+this.cy)*S},o.prototype.sampleCurveDerivativeX=function(S){return(3*this.ax*S+2*this.bx)*S+this.cx},o.prototype.solveCurveX=function(S,v){typeof v=="undefined"&&(v=1e-6);var X,B,a,W,D;for(a=S,D=0;D<8;D++){if(W=this.sampleCurveX(a)-S,Math.abs(W)<v)return a;var J=this.sampleCurveDerivativeX(a);if(Math.abs(J)<1e-6)break;a=a-W/J}if(X=0,B=1,a=S,a<X)return X;if(a>B)return B;for(;X<B;){if(W=this.sampleCurveX(a),Math.abs(W-S)<v)return a;S>W?X=a:B=a,a=(B-X)*.5+X}return a},o.prototype.solve=function(S,v){return this.sampleCurveY(this.solveCurveX(S,v))}},zxMA:function(Re,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.QueryableString=void 0;var S=function(){function v(X){this.str=X}return v.prototype.startsWith=function(X){return this.str.indexOf(X)===0},v.prototype.endsWith=function(X){var B="",a=X.split("").reverse().join("");return B=this.str.split("").reverse().join(""),this.startsWith.call({str:B},a)},v.prototype.contains=function(X){return this.str.indexOf(X)!==-1},v.prototype.equals=function(X){return this.str===X},v.prototype.value=function(){return this.str},v}();y.QueryableString=S}}]);
